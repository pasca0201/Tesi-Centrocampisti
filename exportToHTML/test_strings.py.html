<html>
<head>
<title>test_strings.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #7a7e85;}
.s6 { color: #a5c261;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_strings.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">datetime</span><span class="s2">,</span>
    <span class="s1">timedelta</span><span class="s2">,</span>
<span class="s2">)</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">DataFrame</span><span class="s2">,</span>
    <span class="s1">Index</span><span class="s2">,</span>
    <span class="s1">MultiIndex</span><span class="s2">,</span>
    <span class="s1">Series</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">_testing </span><span class="s0">as </span><span class="s1">tm</span>
<span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">core</span><span class="s2">.</span><span class="s1">strings</span><span class="s2">.</span><span class="s1">accessor </span><span class="s0">import </span><span class="s1">StringMethods</span>
<span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">tests</span><span class="s2">.</span><span class="s1">strings </span><span class="s0">import </span><span class="s1">object_pyarrow_numpy</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;pattern&quot;</span><span class="s2">, [</span><span class="s4">0</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">])])</span>
<span class="s0">def </span><span class="s1">test_startswith_endswith_non_str_patterns</span><span class="s2">(</span><span class="s1">pattern</span><span class="s2">):</span>
    <span class="s5"># GH3485</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">])</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">f&quot;expected a string or tuple, not </span><span class="s0">{</span><span class="s1">type</span><span class="s2">(</span><span class="s1">pattern</span><span class="s2">).</span><span class="s1">__name__</span><span class="s0">}</span><span class="s3">&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">startswith</span><span class="s2">(</span><span class="s1">pattern</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">endswith</span><span class="s2">(</span><span class="s1">pattern</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_iter_raises</span><span class="s2">():</span>
    <span class="s5"># GH 54173</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">])</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;'StringMethods' object is not iterable&quot;</span><span class="s2">):</span>
        <span class="s1">iter</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">)</span>


<span class="s5"># test integer/float dtypes (inferred by constructor) and mixed</span>


<span class="s0">def </span><span class="s1">test_count</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;foofoo&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;foooofooofommmfoo&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">count</span><span class="s2">(</span><span class="s3">&quot;f[o]+&quot;</span><span class="s2">)</span>
    <span class="s1">expected_dtype </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64 </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s3">&quot;Int64&quot;</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">4</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_count_mixed_object</span><span class="s2">():</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s1">datetime</span><span class="s2">.</span><span class="s1">today</span><span class="s2">(), </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">count</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_repeat</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">repeat</span><span class="s2">(</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;aaa&quot;</span><span class="s2">, </span><span class="s3">&quot;bbb&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;ccc&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;ddd&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span>
    <span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">repeat</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;bb&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;cccc&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;dddddd&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span>
    <span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_repeat_mixed_object</span><span class="s2">():</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s1">datetime</span><span class="s2">.</span><span class="s1">today</span><span class="s2">(), </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">repeat</span><span class="s2">(</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;aaa&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;bbb&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;foofoofoo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;arg, repeat&quot;</span><span class="s2">, [[</span><span class="s0">None</span><span class="s2">, </span><span class="s4">4</span><span class="s2">], [</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">]])</span>
<span class="s0">def </span><span class="s1">test_repeat_with_null</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">, </span><span class="s1">arg</span><span class="s2">, </span><span class="s1">repeat</span><span class="s2">):</span>
    <span class="s5"># GH: 31632</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">arg</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">repeat</span><span class="s2">([</span><span class="s4">3</span><span class="s2">, </span><span class="s1">repeat</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;aaa&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_empty_str_methods</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">empty_str </span><span class="s2">= </span><span class="s1">empty </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy</span><span class="s2">:</span>
        <span class="s1">empty_int </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;int64&quot;</span><span class="s2">)</span>
        <span class="s1">empty_bool </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">bool</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">empty_int </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;Int64&quot;</span><span class="s2">)</span>
        <span class="s1">empty_bool </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;boolean&quot;</span><span class="s2">)</span>
    <span class="s1">empty_object </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">empty_bytes </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">empty_df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">()</span>

    <span class="s5"># GH7241</span>
    <span class="s5"># (extract) on empty series</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">empty</span><span class="s2">))</span>
    <span class="s0">assert </span><span class="s3">&quot;&quot; </span><span class="s2">== </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">()</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">title</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_int</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">count</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">contains</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">startswith</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">endswith</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">lower</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">upper</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">repeat</span><span class="s2">(</span><span class="s4">3</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">match</span><span class="s2">(</span><span class="s3">&quot;^a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span>
        <span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">),</span>
        <span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">extract</span><span class="s2">(</span><span class="s3">&quot;()&quot;</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
    <span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span>
        <span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">),</span>
        <span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">extract</span><span class="s2">(</span><span class="s3">&quot;()()&quot;</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
    <span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">extract</span><span class="s2">(</span><span class="s3">&quot;()&quot;</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s0">False</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span>
        <span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">),</span>
        <span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">extract</span><span class="s2">(</span><span class="s3">&quot;()()&quot;</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
    <span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">empty_df</span><span class="s2">.</span><span class="s1">set_axis</span><span class="s2">([], </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">), </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">get_dummies</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty_str</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_int</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">len</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_object</span><span class="s2">, </span><span class="s1">empty_str</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">findall</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_int</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">find</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_int</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">rfind</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">pad</span><span class="s2">(</span><span class="s4">42</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">center</span><span class="s2">(</span><span class="s4">42</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_object</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_object</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">rsplit</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_object</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">partition</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s0">False</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">empty_df</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">partition</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_object</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">rpartition</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">expand</span><span class="s2">=</span><span class="s0">False</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">empty_df</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">rpartition</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">stop</span><span class="s2">=</span><span class="s4">1</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">step</span><span class="s2">=</span><span class="s4">1</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">lstrip</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">rstrip</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">wrap</span><span class="s2">(</span><span class="s4">42</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s4">0</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_object</span><span class="s2">, </span><span class="s1">empty_bytes</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">(</span><span class="s3">&quot;ascii&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bytes</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">encode</span><span class="s2">(</span><span class="s3">&quot;ascii&quot;</span><span class="s2">))</span>
    <span class="s5"># ismethods should always return boolean (GH 29624)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">isalnum</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">isalpha</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">isdigit</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">isspace</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">islower</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">isupper</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">istitle</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">isnumeric</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_bool</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">isdecimal</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">capitalize</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">swapcase</span><span class="s2">())</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">normalize</span><span class="s2">(</span><span class="s3">&quot;NFC&quot;</span><span class="s2">))</span>

    <span class="s1">table </span><span class="s2">= </span><span class="s1">str</span><span class="s2">.</span><span class="s1">maketrans</span><span class="s2">(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">empty_str</span><span class="s2">, </span><span class="s1">empty</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">translate</span><span class="s2">(</span><span class="s1">table</span><span class="s2">))</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method, expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s3">&quot;isalnum&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;isalpha&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">]),</span>
        <span class="s2">(</span>
            <span class="s3">&quot;isdigit&quot;</span><span class="s2">,</span>
            <span class="s2">[</span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">],</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s3">&quot;isnumeric&quot;</span><span class="s2">,</span>
            <span class="s2">[</span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">],</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s3">&quot;isspace&quot;</span><span class="s2">,</span>
            <span class="s2">[</span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">],</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s3">&quot;islower&quot;</span><span class="s2">,</span>
            <span class="s2">[</span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">],</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s3">&quot;isupper&quot;</span><span class="s2">,</span>
            <span class="s2">[</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">],</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s3">&quot;istitle&quot;</span><span class="s2">,</span>
            <span class="s2">[</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">],</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_ismethods</span><span class="s2">(</span><span class="s1">method</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;Xy&quot;</span><span class="s2">, </span><span class="s3">&quot;4&quot;</span><span class="s2">, </span><span class="s3">&quot;3A&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;TT&quot;</span><span class="s2">, </span><span class="s3">&quot;55&quot;</span><span class="s2">, </span><span class="s3">&quot;-&quot;</span><span class="s2">, </span><span class="s3">&quot;  &quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span>
    <span class="s2">)</span>
    <span class="s1">expected_dtype </span><span class="s2">= </span><span class="s3">&quot;bool&quot; </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s3">&quot;boolean&quot;</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)()</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s5"># compare with standard library</span>
    <span class="s1">expected </span><span class="s2">= [</span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)() </span><span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">ser</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s1">list</span><span class="s2">(</span><span class="s1">result</span><span class="s2">) == </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method, expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s3">&quot;isnumeric&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;isdecimal&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">]),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_isnumeric_unicode</span><span class="s2">(</span><span class="s1">method</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s5"># 0x00bc: ¼ VULGAR FRACTION ONE QUARTER</span>
    <span class="s5"># 0x2605: ★ not number</span>
    <span class="s5"># 0x1378: ፸ ETHIOPIC NUMBER SEVENTY</span>
    <span class="s5"># 0xFF13: ３ Em 3  # noqa: RUF003</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;3&quot;</span><span class="s2">, </span><span class="s3">&quot;¼&quot;</span><span class="s2">, </span><span class="s3">&quot;★&quot;</span><span class="s2">, </span><span class="s3">&quot;፸&quot;</span><span class="s2">, </span><span class="s3">&quot;３&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype  </span><span class="s5"># noqa: RUF001</span>
    <span class="s2">)</span>
    <span class="s1">expected_dtype </span><span class="s2">= </span><span class="s3">&quot;bool&quot; </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s3">&quot;boolean&quot;</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)()</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s5"># compare with standard library</span>
    <span class="s1">expected </span><span class="s2">= [</span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)() </span><span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">ser</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s1">list</span><span class="s2">(</span><span class="s1">result</span><span class="s2">) == </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method, expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s3">&quot;isnumeric&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;isdecimal&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">]),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_isnumeric_unicode_missing</span><span class="s2">(</span><span class="s1">method</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">values </span><span class="s2">= [</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;¼&quot;</span><span class="s2">, </span><span class="s3">&quot;★&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;３&quot;</span><span class="s2">, </span><span class="s3">&quot;four&quot;</span><span class="s2">]  </span><span class="s5"># noqa: RUF001</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">values</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">expected_dtype </span><span class="s2">= </span><span class="s3">&quot;object&quot; </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s3">&quot;boolean&quot;</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)()</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_spilt_join_roundtrip</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a_b_c&quot;</span><span class="s2">, </span><span class="s3">&quot;c_d_e&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;f_g_h&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;_&quot;</span><span class="s2">).</span><span class="s1">str</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s3">&quot;_&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_spilt_join_roundtrip_mixed_object</span><span class="s2">():</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;a_b&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;asdf_cas_asdf&quot;</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s1">datetime</span><span class="s2">.</span><span class="s1">today</span><span class="s2">(), </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;_&quot;</span><span class="s2">).</span><span class="s1">str</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s3">&quot;_&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;a_b&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;asdf_cas_asdf&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_len</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;fooo&quot;</span><span class="s2">, </span><span class="s3">&quot;fooooo&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;fooooooo&quot;</span><span class="s2">, </span><span class="s3">&quot;foo</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s3">&quot;あ&quot;</span><span class="s2">],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">len</span><span class="s2">()</span>
    <span class="s1">expected_dtype </span><span class="s2">= </span><span class="s3">&quot;float64&quot; </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s3">&quot;Int64&quot;</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_len_mixed</span><span class="s2">():</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;a_b&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;asdf_cas_asdf&quot;</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s1">datetime</span><span class="s2">.</span><span class="s1">today</span><span class="s2">(), </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">len</span><span class="s2">()</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method,sub,start,end,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s3">&quot;index&quot;</span><span class="s2">, </span><span class="s3">&quot;EF&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;rindex&quot;</span><span class="s2">, </span><span class="s3">&quot;EF&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;index&quot;</span><span class="s2">, </span><span class="s3">&quot;EF&quot;</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;rindex&quot;</span><span class="s2">, </span><span class="s3">&quot;EF&quot;</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;index&quot;</span><span class="s2">, </span><span class="s3">&quot;E&quot;</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;rindex&quot;</span><span class="s2">, </span><span class="s3">&quot;E&quot;</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_index</span><span class="s2">(</span><span class="s1">method</span><span class="s2">, </span><span class="s1">sub</span><span class="s2">, </span><span class="s1">start</span><span class="s2">, </span><span class="s1">end</span><span class="s2">, </span><span class="s1">index_or_series</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
    <span class="s1">obj </span><span class="s2">= </span><span class="s1">index_or_series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;ABCDEFG&quot;</span><span class="s2">, </span><span class="s3">&quot;BCDEFEF&quot;</span><span class="s2">, </span><span class="s3">&quot;DEFGHIJEF&quot;</span><span class="s2">, </span><span class="s3">&quot;EFGHEF&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span>
    <span class="s2">)</span>
    <span class="s1">expected_dtype </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64 </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s3">&quot;Int64&quot;</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">index_or_series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected_dtype</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)(</span><span class="s1">sub</span><span class="s2">, </span><span class="s1">start</span><span class="s2">, </span><span class="s1">end</span><span class="s2">)</span>

    <span class="s0">if </span><span class="s1">index_or_series </span><span class="s0">is </span><span class="s1">Series</span><span class="s2">:</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_index_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s5"># compare with standard library</span>
    <span class="s1">expected </span><span class="s2">= [</span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">item</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)(</span><span class="s1">sub</span><span class="s2">, </span><span class="s1">start</span><span class="s2">, </span><span class="s1">end</span><span class="s2">) </span><span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">obj</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s1">list</span><span class="s2">(</span><span class="s1">result</span><span class="s2">) == </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_index_not_found_raises</span><span class="s2">(</span><span class="s1">index_or_series</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">obj </span><span class="s2">= </span><span class="s1">index_or_series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;ABCDEFG&quot;</span><span class="s2">, </span><span class="s3">&quot;BCDEFEF&quot;</span><span class="s2">, </span><span class="s3">&quot;DEFGHIJEF&quot;</span><span class="s2">, </span><span class="s3">&quot;EFGHEF&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;substring not found&quot;</span><span class="s2">):</span>
        <span class="s1">obj</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">index</span><span class="s2">(</span><span class="s3">&quot;DE&quot;</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;method&quot;</span><span class="s2">, [</span><span class="s3">&quot;index&quot;</span><span class="s2">, </span><span class="s3">&quot;rindex&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_index_wrong_type_raises</span><span class="s2">(</span><span class="s1">index_or_series</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">, </span><span class="s1">method</span><span class="s2">):</span>
    <span class="s1">obj </span><span class="s2">= </span><span class="s1">index_or_series</span><span class="s2">([], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;expected a string object, not int&quot;</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">getattr</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)(</span><span class="s4">0</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method, exp&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">[</span><span class="s3">&quot;index&quot;</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]],</span>
        <span class="s2">[</span><span class="s3">&quot;rindex&quot;</span><span class="s2">, [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]],</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_index_missing</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">, </span><span class="s1">method</span><span class="s2">, </span><span class="s1">exp</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;abcb&quot;</span><span class="s2">, </span><span class="s3">&quot;ab&quot;</span><span class="s2">, </span><span class="s3">&quot;bcbe&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">expected_dtype </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64 </span><span class="s0">if </span><span class="s1">any_string_dtype </span><span class="s0">in </span><span class="s1">object_pyarrow_numpy </span><span class="s0">else </span><span class="s3">&quot;Int64&quot;</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)(</span><span class="s3">&quot;b&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">exp </span><span class="s2">+ [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_pipe_failures</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s5"># #2119</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;A|B|C&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;|&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s3">&quot;|&quot;</span><span class="s2">, </span><span class="s3">&quot; &quot;</span><span class="s2">, </span><span class="s1">regex</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;A B C&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;start, stop, step, expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, [</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;baz&quot;</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, [</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, [</span><span class="s3">&quot;owtoofaa&quot;</span><span class="s2">, </span><span class="s3">&quot;owtrabaa&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;xuqzabaa&quot;</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, [</span><span class="s3">&quot;oto&quot;</span><span class="s2">, </span><span class="s3">&quot;ato&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;aqx&quot;</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, [</span><span class="s3">&quot;ofa&quot;</span><span class="s2">, </span><span class="s3">&quot;aba&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;aba&quot;</span><span class="s2">]),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_slice</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">stop</span><span class="s2">, </span><span class="s1">step</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;aafootwo&quot;</span><span class="s2">, </span><span class="s3">&quot;aabartwo&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;aabazqux&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">stop</span><span class="s2">, </span><span class="s1">step</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;start, stop, step, expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, [</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, [</span><span class="s3">&quot;oof&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;rab&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_slice_mixed_object</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">stop</span><span class="s2">, </span><span class="s1">step</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;aafootwo&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;aabartwo&quot;</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s1">datetime</span><span class="s2">.</span><span class="s1">today</span><span class="s2">(), </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">stop</span><span class="s2">, </span><span class="s1">step</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;start,stop,repl,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, [</span><span class="s3">&quot;shrt&quot;</span><span class="s2">, </span><span class="s3">&quot;a it longer&quot;</span><span class="s2">, </span><span class="s3">&quot;evnlongerthanthat&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, [</span><span class="s3">&quot;shzrt&quot;</span><span class="s2">, </span><span class="s3">&quot;a zit longer&quot;</span><span class="s2">, </span><span class="s3">&quot;evznlongerthanthat&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, [</span><span class="s3">&quot;shzort&quot;</span><span class="s2">, </span><span class="s3">&quot;a zbit longer&quot;</span><span class="s2">, </span><span class="s3">&quot;evzenlongerthanthat&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, [</span><span class="s3">&quot;shzort&quot;</span><span class="s2">, </span><span class="s3">&quot;a zbit longer&quot;</span><span class="s2">, </span><span class="s3">&quot;evzenlongerthanthat&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
        <span class="s2">(-</span><span class="s4">1</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, [</span><span class="s3">&quot;shorz&quot;</span><span class="s2">, </span><span class="s3">&quot;a bit longez&quot;</span><span class="s2">, </span><span class="s3">&quot;evenlongerthanthaz&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s0">None</span><span class="s2">, -</span><span class="s4">2</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, [</span><span class="s3">&quot;zrt&quot;</span><span class="s2">, </span><span class="s3">&quot;zer&quot;</span><span class="s2">, </span><span class="s3">&quot;zat&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, [</span><span class="s3">&quot;shortz&quot;</span><span class="s2">, </span><span class="s3">&quot;a bit znger&quot;</span><span class="s2">, </span><span class="s3">&quot;evenlozerthanthat&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
        <span class="s2">(-</span><span class="s4">10</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, [</span><span class="s3">&quot;zrt&quot;</span><span class="s2">, </span><span class="s3">&quot;a zit longer&quot;</span><span class="s2">, </span><span class="s3">&quot;evenlongzerthanthat&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_slice_replace</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">stop</span><span class="s2">, </span><span class="s1">repl</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;short&quot;</span><span class="s2">, </span><span class="s3">&quot;a bit longer&quot;</span><span class="s2">, </span><span class="s3">&quot;evenlongerthanthat&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">slice_replace</span><span class="s2">(</span><span class="s1">start</span><span class="s2">, </span><span class="s1">stop</span><span class="s2">, </span><span class="s1">repl</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method, exp&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">[</span><span class="s3">&quot;strip&quot;</span><span class="s2">, [</span><span class="s3">&quot;aa&quot;</span><span class="s2">, </span><span class="s3">&quot;bb&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;cc&quot;</span><span class="s2">]],</span>
        <span class="s2">[</span><span class="s3">&quot;lstrip&quot;</span><span class="s2">, [</span><span class="s3">&quot;aa   &quot;</span><span class="s2">, </span><span class="s3">&quot;bb </span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;cc  &quot;</span><span class="s2">]],</span>
        <span class="s2">[</span><span class="s3">&quot;rstrip&quot;</span><span class="s2">, [</span><span class="s3">&quot;  aa&quot;</span><span class="s2">, </span><span class="s3">&quot; bb&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;cc&quot;</span><span class="s2">]],</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_strip_lstrip_rstrip</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">, </span><span class="s1">method</span><span class="s2">, </span><span class="s1">exp</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;  aa   &quot;</span><span class="s2">, </span><span class="s3">&quot; bb </span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;cc  &quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)()</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">exp</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method, exp&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">[</span><span class="s3">&quot;strip&quot;</span><span class="s2">, [</span><span class="s3">&quot;aa&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;bb&quot;</span><span class="s2">]],</span>
        <span class="s2">[</span><span class="s3">&quot;lstrip&quot;</span><span class="s2">, [</span><span class="s3">&quot;aa  &quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;bb </span><span class="s0">\t\n</span><span class="s3">&quot;</span><span class="s2">]],</span>
        <span class="s2">[</span><span class="s3">&quot;rstrip&quot;</span><span class="s2">, [</span><span class="s3">&quot;  aa&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot; bb&quot;</span><span class="s2">]],</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_strip_lstrip_rstrip_mixed_object</span><span class="s2">(</span><span class="s1">method</span><span class="s2">, </span><span class="s1">exp</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;  aa  &quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot; bb </span><span class="s0">\t\n</span><span class="s3">&quot;</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s1">datetime</span><span class="s2">.</span><span class="s1">today</span><span class="s2">(), </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">])</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)()</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">exp </span><span class="s2">+ [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method, exp&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">[</span><span class="s3">&quot;strip&quot;</span><span class="s2">, [</span><span class="s3">&quot;ABC&quot;</span><span class="s2">, </span><span class="s3">&quot; BNSD&quot;</span><span class="s2">, </span><span class="s3">&quot;LDFJH &quot;</span><span class="s2">]],</span>
        <span class="s2">[</span><span class="s3">&quot;lstrip&quot;</span><span class="s2">, [</span><span class="s3">&quot;ABCxx&quot;</span><span class="s2">, </span><span class="s3">&quot; BNSD&quot;</span><span class="s2">, </span><span class="s3">&quot;LDFJH xx&quot;</span><span class="s2">]],</span>
        <span class="s2">[</span><span class="s3">&quot;rstrip&quot;</span><span class="s2">, [</span><span class="s3">&quot;xxABC&quot;</span><span class="s2">, </span><span class="s3">&quot;xx BNSD&quot;</span><span class="s2">, </span><span class="s3">&quot;LDFJH &quot;</span><span class="s2">]],</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_strip_lstrip_rstrip_args</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">, </span><span class="s1">method</span><span class="s2">, </span><span class="s1">exp</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;xxABCxx&quot;</span><span class="s2">, </span><span class="s3">&quot;xx BNSD&quot;</span><span class="s2">, </span><span class="s3">&quot;LDFJH xx&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)(</span><span class="s3">&quot;x&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">exp</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;prefix, expected&quot;</span><span class="s2">, [(</span><span class="s3">&quot;a&quot;</span><span class="s2">, [</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot; b c&quot;</span><span class="s2">, </span><span class="s3">&quot;bc&quot;</span><span class="s2">]), (</span><span class="s3">&quot;ab&quot;</span><span class="s2">, [</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s3">&quot;a b c&quot;</span><span class="s2">, </span><span class="s3">&quot;bc&quot;</span><span class="s2">])]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_removeprefix</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">, </span><span class="s1">prefix</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;ab&quot;</span><span class="s2">, </span><span class="s3">&quot;a b c&quot;</span><span class="s2">, </span><span class="s3">&quot;bc&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">removeprefix</span><span class="s2">(</span><span class="s1">prefix</span><span class="s2">)</span>
    <span class="s1">ser_expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">ser_expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;suffix, expected&quot;</span><span class="s2">, [(</span><span class="s3">&quot;c&quot;</span><span class="s2">, [</span><span class="s3">&quot;ab&quot;</span><span class="s2">, </span><span class="s3">&quot;a b &quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">]), (</span><span class="s3">&quot;bc&quot;</span><span class="s2">, [</span><span class="s3">&quot;ab&quot;</span><span class="s2">, </span><span class="s3">&quot;a b c&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">])]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_removesuffix</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">, </span><span class="s1">suffix</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;ab&quot;</span><span class="s2">, </span><span class="s3">&quot;a b c&quot;</span><span class="s2">, </span><span class="s3">&quot;bc&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">removesuffix</span><span class="s2">(</span><span class="s1">suffix</span><span class="s2">)</span>
    <span class="s1">ser_expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">ser_expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_string_slice_get_syntax</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;YYY&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;YYYYYYbYYY&quot;</span><span class="s2">, </span><span class="s3">&quot;BYYYcYYY&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;CYYYBYYY&quot;</span><span class="s2">, </span><span class="s3">&quot;dog&quot;</span><span class="s2">, </span><span class="s3">&quot;cYYYt&quot;</span><span class="s2">],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">,</span>
    <span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">[</span><span class="s4">0</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s4">0</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">[:</span><span class="s4">3</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">stop</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">[</span><span class="s4">2</span><span class="s2">::-</span><span class="s4">1</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">slice</span><span class="s2">(</span><span class="s1">start</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">step</span><span class="s2">=-</span><span class="s4">1</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_string_slice_out_of_bounds_nested</span><span class="s2">():</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">), (</span><span class="s4">1</span><span class="s2">,), (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">)])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">[</span><span class="s4">1</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">4</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_string_slice_out_of_bounds</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;ba&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">[</span><span class="s4">1</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;o&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_encode_decode</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a</span><span class="s0">\xe4</span><span class="s3">&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">).</span><span class="s1">str</span><span class="s2">.</span><span class="s1">encode</span><span class="s2">(</span><span class="s3">&quot;utf-8&quot;</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">(</span><span class="s3">&quot;utf-8&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">map</span><span class="s2">(</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">(</span><span class="s3">&quot;utf-8&quot;</span><span class="s2">)).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_encode_errors_kwarg</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a</span><span class="s0">\x9d</span><span class="s3">&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>

    <span class="s1">msg </span><span class="s2">= (</span>
        <span class="s3">r&quot;'charmap' codec can't encode character '\\x9d' in position 1: &quot;</span>
        <span class="s3">&quot;character maps to &lt;undefined&gt;&quot;</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">UnicodeEncodeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">encode</span><span class="s2">(</span><span class="s3">&quot;cp1252&quot;</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">encode</span><span class="s2">(</span><span class="s3">&quot;cp1252&quot;</span><span class="s2">, </span><span class="s3">&quot;ignore&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">map</span><span class="s2">(</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x</span><span class="s2">.</span><span class="s1">encode</span><span class="s2">(</span><span class="s3">&quot;cp1252&quot;</span><span class="s2">, </span><span class="s3">&quot;ignore&quot;</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_decode_errors_kwarg</span><span class="s2">():</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s6">b&quot;a&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;a</span><span class="s0">\x9d</span><span class="s6">&quot;</span><span class="s2">])</span>

    <span class="s1">msg </span><span class="s2">= (</span>
        <span class="s3">&quot;'charmap' codec can't decode byte 0x9d in position 1: &quot;</span>
        <span class="s3">&quot;character maps to &lt;undefined&gt;&quot;</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">UnicodeDecodeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">(</span><span class="s3">&quot;cp1252&quot;</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">(</span><span class="s3">&quot;cp1252&quot;</span><span class="s2">, </span><span class="s3">&quot;ignore&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">map</span><span class="s2">(</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">(</span><span class="s3">&quot;cp1252&quot;</span><span class="s2">, </span><span class="s3">&quot;ignore&quot;</span><span class="s2">)).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;form, expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s3">&quot;NFKC&quot;</span><span class="s2">, [</span><span class="s3">&quot;ABC&quot;</span><span class="s2">, </span><span class="s3">&quot;ABC&quot;</span><span class="s2">, </span><span class="s3">&quot;123&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;アイエ&quot;</span><span class="s2">]),</span>
        <span class="s2">(</span><span class="s3">&quot;NFC&quot;</span><span class="s2">, [</span><span class="s3">&quot;ABC&quot;</span><span class="s2">, </span><span class="s3">&quot;ＡＢＣ&quot;</span><span class="s2">, </span><span class="s3">&quot;１２３&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;ｱｲｴ&quot;</span><span class="s2">]),  </span><span class="s5"># noqa: RUF001</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_normalize</span><span class="s2">(</span><span class="s1">form</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;ABC&quot;</span><span class="s2">, </span><span class="s3">&quot;ＡＢＣ&quot;</span><span class="s2">, </span><span class="s3">&quot;１２３&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;ｱｲｴ&quot;</span><span class="s2">],  </span><span class="s5"># noqa: RUF001</span>
        <span class="s1">index</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">normalize</span><span class="s2">(</span><span class="s1">form</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_normalize_bad_arg_raises</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span><span class="s3">&quot;ABC&quot;</span><span class="s2">, </span><span class="s3">&quot;ＡＢＣ&quot;</span><span class="s2">, </span><span class="s3">&quot;１２３&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;ｱｲｴ&quot;</span><span class="s2">],  </span><span class="s5"># noqa: RUF001</span>
        <span class="s1">index</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;invalid normalization form&quot;</span><span class="s2">):</span>
        <span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">normalize</span><span class="s2">(</span><span class="s3">&quot;xxx&quot;</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_normalize_index</span><span class="s2">():</span>
    <span class="s1">idx </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;ＡＢＣ&quot;</span><span class="s2">, </span><span class="s3">&quot;１２３&quot;</span><span class="s2">, </span><span class="s3">&quot;ｱｲｴ&quot;</span><span class="s2">])  </span><span class="s5"># noqa: RUF001</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;ABC&quot;</span><span class="s2">, </span><span class="s3">&quot;123&quot;</span><span class="s2">, </span><span class="s3">&quot;アイエ&quot;</span><span class="s2">])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">idx</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">normalize</span><span class="s2">(</span><span class="s3">&quot;NFKC&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_index_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;values,inferred_type&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], </span><span class="s3">&quot;string&quot;</span><span class="s2">),</span>
        <span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s3">&quot;mixed-integer&quot;</span><span class="s2">),</span>
        <span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s4">1.3</span><span class="s2">], </span><span class="s3">&quot;mixed&quot;</span><span class="s2">),</span>
        <span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s4">1.3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s3">&quot;mixed-integer&quot;</span><span class="s2">),</span>
        <span class="s2">([</span><span class="s3">&quot;aa&quot;</span><span class="s2">, </span><span class="s1">datetime</span><span class="s2">(</span><span class="s4">2011</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)], </span><span class="s3">&quot;mixed&quot;</span><span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_index_str_accessor_visibility</span><span class="s2">(</span><span class="s1">values</span><span class="s2">, </span><span class="s1">inferred_type</span><span class="s2">, </span><span class="s1">index_or_series</span><span class="s2">):</span>
    <span class="s1">obj </span><span class="s2">= </span><span class="s1">index_or_series</span><span class="s2">(</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s0">if </span><span class="s1">index_or_series </span><span class="s0">is </span><span class="s1">Index</span><span class="s2">:</span>
        <span class="s0">assert </span><span class="s1">obj</span><span class="s2">.</span><span class="s1">inferred_type </span><span class="s2">== </span><span class="s1">inferred_type</span>

    <span class="s0">assert </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">.</span><span class="s1">str</span><span class="s2">, </span><span class="s1">StringMethods</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;values,inferred_type&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], </span><span class="s3">&quot;floating&quot;</span><span class="s2">),</span>
        <span class="s2">([</span><span class="s1">datetime</span><span class="s2">(</span><span class="s4">2011</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)], </span><span class="s3">&quot;datetime64&quot;</span><span class="s2">),</span>
        <span class="s2">([</span><span class="s1">timedelta</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)], </span><span class="s3">&quot;timedelta64&quot;</span><span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_index_str_accessor_non_string_values_raises</span><span class="s2">(</span>
    <span class="s1">values</span><span class="s2">, </span><span class="s1">inferred_type</span><span class="s2">, </span><span class="s1">index_or_series</span>
<span class="s2">):</span>
    <span class="s1">obj </span><span class="s2">= </span><span class="s1">index_or_series</span><span class="s2">(</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s0">if </span><span class="s1">index_or_series </span><span class="s0">is </span><span class="s1">Index</span><span class="s2">:</span>
        <span class="s0">assert </span><span class="s1">obj</span><span class="s2">.</span><span class="s1">inferred_type </span><span class="s2">== </span><span class="s1">inferred_type</span>

    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Can only use .str accessor with string values&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AttributeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">obj</span><span class="s2">.</span><span class="s1">str</span>


<span class="s0">def </span><span class="s1">test_index_str_accessor_multiindex_raises</span><span class="s2">():</span>
    <span class="s5"># MultiIndex has mixed dtype, but not allow to use accessor</span>
    <span class="s1">idx </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_tuples</span><span class="s2">([(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">), (</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">)])</span>
    <span class="s0">assert </span><span class="s1">idx</span><span class="s2">.</span><span class="s1">inferred_type </span><span class="s2">== </span><span class="s3">&quot;mixed&quot;</span>

    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Can only use .str accessor with Index, not MultiIndex&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AttributeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">idx</span><span class="s2">.</span><span class="s1">str</span>


<span class="s0">def </span><span class="s1">test_str_accessor_no_new_attributes</span><span class="s2">(</span><span class="s1">any_string_dtype</span><span class="s2">):</span>
    <span class="s5"># https://github.com/pandas-dev/pandas/issues/10673</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s3">&quot;aabbcde&quot;</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">any_string_dtype</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AttributeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;You cannot add any new attribute&quot;</span><span class="s2">):</span>
        <span class="s1">ser</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">xlabel </span><span class="s2">= </span><span class="s3">&quot;a&quot;</span>


<span class="s0">def </span><span class="s1">test_cat_on_bytes_raises</span><span class="s2">():</span>
    <span class="s1">lhs </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s3">&quot;abc&quot;</span><span class="s2">), </span><span class="s3">&quot;S1&quot;</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">))</span>
    <span class="s1">rhs </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s3">&quot;def&quot;</span><span class="s2">), </span><span class="s3">&quot;S1&quot;</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">))</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Cannot use .str.cat with values of inferred dtype 'bytes'&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">lhs</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">rhs</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_str_accessor_in_apply_func</span><span class="s2">():</span>
    <span class="s5"># https://github.com/pandas-dev/pandas/issues/38979</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">zip</span><span class="s2">(</span><span class="s3">&quot;abc&quot;</span><span class="s2">, </span><span class="s3">&quot;def&quot;</span><span class="s2">))</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;A/D&quot;</span><span class="s2">, </span><span class="s3">&quot;B/E&quot;</span><span class="s2">, </span><span class="s3">&quot;C/F&quot;</span><span class="s2">])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">apply</span><span class="s2">(</span><span class="s0">lambda </span><span class="s1">f</span><span class="s2">: </span><span class="s3">&quot;/&quot;</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s1">f</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">upper</span><span class="s2">()), </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_zfill</span><span class="s2">():</span>
    <span class="s5"># https://github.com/pandas-dev/pandas/issues/20868</span>
    <span class="s1">value </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;-1&quot;</span><span class="s2">, </span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;1000&quot;</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;-01&quot;</span><span class="s2">, </span><span class="s3">&quot;001&quot;</span><span class="s2">, </span><span class="s3">&quot;1000&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">value</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">zfill</span><span class="s2">(</span><span class="s4">3</span><span class="s2">), </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s1">value </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;-2&quot;</span><span class="s2">, </span><span class="s3">&quot;+5&quot;</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;-0002&quot;</span><span class="s2">, </span><span class="s3">&quot;+0005&quot;</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">value</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">zfill</span><span class="s2">(</span><span class="s4">5</span><span class="s2">), </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_zfill_with_non_integer_argument</span><span class="s2">():</span>
    <span class="s1">value </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;-2&quot;</span><span class="s2">, </span><span class="s3">&quot;+5&quot;</span><span class="s2">])</span>
    <span class="s1">wid </span><span class="s2">= </span><span class="s3">&quot;a&quot;</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">f&quot;width must be of integer type, not </span><span class="s0">{</span><span class="s1">type</span><span class="s2">(</span><span class="s1">wid</span><span class="s2">).</span><span class="s1">__name__</span><span class="s0">}</span><span class="s3">&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">value</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">zfill</span><span class="s2">(</span><span class="s1">wid</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_zfill_with_leading_sign</span><span class="s2">():</span>
    <span class="s1">value </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;-cat&quot;</span><span class="s2">, </span><span class="s3">&quot;-1&quot;</span><span class="s2">, </span><span class="s3">&quot;+dog&quot;</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;-0cat&quot;</span><span class="s2">, </span><span class="s3">&quot;-0001&quot;</span><span class="s2">, </span><span class="s3">&quot;+0dog&quot;</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">value</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">zfill</span><span class="s2">(</span><span class="s4">5</span><span class="s2">), </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_get_with_dict_label</span><span class="s2">():</span>
    <span class="s5"># GH47911</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span>
            <span class="s2">{</span><span class="s3">&quot;name&quot;</span><span class="s2">: </span><span class="s3">&quot;Hello&quot;</span><span class="s2">, </span><span class="s3">&quot;value&quot;</span><span class="s2">: </span><span class="s3">&quot;World&quot;</span><span class="s2">},</span>
            <span class="s2">{</span><span class="s3">&quot;name&quot;</span><span class="s2">: </span><span class="s3">&quot;Goodbye&quot;</span><span class="s2">, </span><span class="s3">&quot;value&quot;</span><span class="s2">: </span><span class="s3">&quot;Planet&quot;</span><span class="s2">},</span>
            <span class="s2">{</span><span class="s3">&quot;value&quot;</span><span class="s2">: </span><span class="s3">&quot;Sea&quot;</span><span class="s2">},</span>
        <span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s3">&quot;name&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;Hello&quot;</span><span class="s2">, </span><span class="s3">&quot;Goodbye&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s3">&quot;value&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;World&quot;</span><span class="s2">, </span><span class="s3">&quot;Planet&quot;</span><span class="s2">, </span><span class="s3">&quot;Sea&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_str_decode</span><span class="s2">():</span>
    <span class="s5"># GH 22613</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s6">b&quot;x&quot;</span><span class="s2">, </span><span class="s6">b&quot;y&quot;</span><span class="s2">]).</span><span class="s1">str</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">(</span><span class="s1">encoding</span><span class="s2">=</span><span class="s3">&quot;UTF-8&quot;</span><span class="s2">, </span><span class="s1">errors</span><span class="s2">=</span><span class="s3">&quot;strict&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;object&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
</pre>
</body>
</html>