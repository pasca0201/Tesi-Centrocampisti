<html>
<head>
<title>test_kolmogorov.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #7a7e85;}
.s5 { color: #6aab73;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_kolmogorov.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">itertools</span>
<span class="s0">import </span><span class="s1">sys</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">testing </span><span class="s0">import </span><span class="s1">assert_</span>
<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">special</span><span class="s2">.</span><span class="s1">_testutils </span><span class="s0">import </span><span class="s1">FuncData</span>

<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">special </span><span class="s0">import </span><span class="s1">kolmogorov</span><span class="s2">, </span><span class="s1">kolmogi</span><span class="s2">, </span><span class="s1">smirnov</span><span class="s2">, </span><span class="s1">smirnovi</span>
<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">special</span><span class="s2">.</span><span class="s1">_ufuncs </span><span class="s0">import </span><span class="s2">(</span><span class="s1">_kolmogc</span><span class="s2">, </span><span class="s1">_kolmogci</span><span class="s2">, </span><span class="s1">_kolmogp</span><span class="s2">,</span>
                                   <span class="s1">_smirnovc</span><span class="s2">, </span><span class="s1">_smirnovci</span><span class="s2">, </span><span class="s1">_smirnovp</span><span class="s2">)</span>

<span class="s1">_rtol </span><span class="s2">= </span><span class="s3">1e-10</span>

<span class="s0">class </span><span class="s1">TestSmirnov</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">smirnov</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)))</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">, </span><span class="s3">0.125</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">, </span><span class="s3">0.125 </span><span class="s2">* </span><span class="s3">0.125</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">, </span><span class="s3">0.125 </span><span class="s2">* </span><span class="s3">0.125 </span><span class="s2">* </span><span class="s3">0.125</span><span class="s2">)]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovc</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_x_equals_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s1">n</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">) </span><span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">itertools</span><span class="s2">.</span><span class="s1">chain</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">20</span><span class="s2">), </span><span class="s1">range</span><span class="s2">(</span><span class="s3">1010</span><span class="s2">, </span><span class="s3">1020</span><span class="s2">))]</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovc</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_x_equals_1</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s1">n</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">) </span><span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">itertools</span><span class="s2">.</span><span class="s1">chain</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">20</span><span class="s2">), </span><span class="s1">range</span><span class="s2">(</span><span class="s3">1010</span><span class="s2">, </span><span class="s3">1020</span><span class="s2">))]</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovc</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_x_equals_0point5</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.166666666667</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">4</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.09375</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.056</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.0327932098765</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">7</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.0191958707681</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">8</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.0112953186035</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">9</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.00661933257355</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">10</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.003888705</span><span class="s2">)]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovc</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_n_equals_1</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">101</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([[</span><span class="s3">1</span><span class="s2">]*</span><span class="s1">len</span><span class="s2">(</span><span class="s1">x</span><span class="s2">), </span><span class="s1">x</span><span class="s2">, </span><span class="s3">1</span><span class="s2">-</span><span class="s1">x</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovc</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_n_equals_2</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">101</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">power</span><span class="s2">(</span><span class="s3">1</span><span class="s2">-</span><span class="s1">x</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">n </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">] * </span><span class="s1">len</span><span class="s2">(</span><span class="s1">x</span><span class="s2">))</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">p</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovc</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_n_equals_3</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0.7</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">31</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">power</span><span class="s2">(</span><span class="s3">1</span><span class="s2">-</span><span class="s1">x</span><span class="s2">, </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">n </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">3</span><span class="s2">] * </span><span class="s1">len</span><span class="s2">(</span><span class="s1">x</span><span class="s2">))</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">p</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, -</span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovc</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_n_large</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># test for large values of n</span>
        <span class="s4"># Probabilities should go down as n goes up</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s3">0.4</span>
        <span class="s1">pvals </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s1">smirnov</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">) </span><span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s3">400</span><span class="s2">, </span><span class="s3">1100</span><span class="s2">, </span><span class="s3">20</span><span class="s2">)])</span>
        <span class="s1">dfs </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">diff</span><span class="s2">(</span><span class="s1">pvals</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">dfs </span><span class="s2">&lt;= </span><span class="s3">0</span><span class="s2">), </span><span class="s1">msg</span><span class="s2">=</span><span class="s5">'Not all diffs negative %s' </span><span class="s2">% </span><span class="s1">dfs</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestSmirnovi</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">smirnovi</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)))</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.4</span><span class="s2">, </span><span class="s3">0.6</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.6</span><span class="s2">, </span><span class="s3">0.4</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.99</span><span class="s2">, </span><span class="s3">0.01</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.01</span><span class="s2">, </span><span class="s3">0.99</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.125 </span><span class="s2">* </span><span class="s3">0.125</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0.125 </span><span class="s2">* </span><span class="s3">0.125 </span><span class="s2">* </span><span class="s3">0.125</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">10</span><span class="s2">, </span><span class="s3">1.0 </span><span class="s2">/ </span><span class="s3">16 </span><span class="s2">** </span><span class="s3">10</span><span class="s2">, </span><span class="s3">1 </span><span class="s2">- </span><span class="s3">1.0 </span><span class="s2">/ </span><span class="s3">16</span><span class="s2">)]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnovi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_x_equals_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s1">n</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">) </span><span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">itertools</span><span class="s2">.</span><span class="s1">chain</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">20</span><span class="s2">), </span><span class="s1">range</span><span class="s2">(</span><span class="s3">1010</span><span class="s2">, </span><span class="s3">1020</span><span class="s2">))]</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnovi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_x_equals_1</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s1">n</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">0</span><span class="s2">) </span><span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">itertools</span><span class="s2">.</span><span class="s1">chain</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">20</span><span class="s2">), </span><span class="s1">range</span><span class="s2">(</span><span class="s3">1010</span><span class="s2">, </span><span class="s3">1020</span><span class="s2">))]</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnovi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_n_equals_1</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pp </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">101</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s4"># dataset = np.array([(1, p, 1-p) for p in pp])</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([[</span><span class="s3">1</span><span class="s2">]*</span><span class="s1">len</span><span class="s2">(</span><span class="s1">pp</span><span class="s2">), </span><span class="s1">pp</span><span class="s2">, </span><span class="s3">1</span><span class="s2">-</span><span class="s1">pp</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnovi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_n_equals_2</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">101</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">power</span><span class="s2">(</span><span class="s3">1</span><span class="s2">-</span><span class="s1">x</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">n </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">] * </span><span class="s1">len</span><span class="s2">(</span><span class="s1">x</span><span class="s2">))</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">x</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnovi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_n_equals_3</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0.7</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">31</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">power</span><span class="s2">(</span><span class="s3">1</span><span class="s2">-</span><span class="s1">x</span><span class="s2">, </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">n </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">3</span><span class="s2">] * </span><span class="s1">len</span><span class="s2">(</span><span class="s1">x</span><span class="s2">))</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">x</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnovi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_round_trip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">_sm_smi</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p</span><span class="s2">):</span>
            <span class="s0">return </span><span class="s1">smirnov</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">smirnovi</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p</span><span class="s2">))</span>

        <span class="s0">def </span><span class="s1">_smc_smci</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p</span><span class="s2">):</span>
            <span class="s0">return </span><span class="s1">_smirnovc</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">_smirnovci</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p</span><span class="s2">))</span>

        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.4</span><span class="s2">, </span><span class="s3">0.4</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.6</span><span class="s2">, </span><span class="s3">0.6</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">, </span><span class="s3">0.875</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0.125</span><span class="s2">, </span><span class="s3">0.125</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">10</span><span class="s2">, </span><span class="s3">0.999</span><span class="s2">, </span><span class="s3">0.999</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">10</span><span class="s2">, </span><span class="s3">0.0001</span><span class="s2">, </span><span class="s3">0.0001</span><span class="s2">)]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_sm_smi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smc_smci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_x_equals_0point5</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.366025403784</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.297156508177</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">4</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.255520481121</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.234559536069</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.21715965898</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">7</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.202722580034</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">8</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.190621765256</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">9</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.180363501362</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">10</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.17157867006</span><span class="s2">)]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">smirnovi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
        <span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">] = </span><span class="s3">1 </span><span class="s2">- </span><span class="s1">dataset</span><span class="s2">[:, </span><span class="s3">1</span><span class="s2">]</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestSmirnovp</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">_smirnovp</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)))</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Check derivative at endpoints</span>
        <span class="s1">n1_10 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">10</span><span class="s2">)</span>
        <span class="s1">dataset0 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n1_10</span><span class="s2">,</span>
                                    <span class="s1">np</span><span class="s2">.</span><span class="s1">full_like</span><span class="s2">(</span><span class="s1">n1_10</span><span class="s2">, </span><span class="s3">0</span><span class="s2">),</span>
                                    <span class="s1">np</span><span class="s2">.</span><span class="s1">full_like</span><span class="s2">(</span><span class="s1">n1_10</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">)])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovp</span><span class="s2">, </span><span class="s1">dataset0</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

        <span class="s1">n2_10 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">10</span><span class="s2">)</span>
        <span class="s1">dataset1 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n2_10</span><span class="s2">,</span>
                                    <span class="s1">np</span><span class="s2">.</span><span class="s1">full_like</span><span class="s2">(</span><span class="s1">n2_10</span><span class="s2">, </span><span class="s3">1.0</span><span class="s2">),</span>
                                    <span class="s1">np</span><span class="s2">.</span><span class="s1">full_like</span><span class="s2">(</span><span class="s1">n2_10</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovp</span><span class="s2">, </span><span class="s1">dataset1</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_oneminusoneovern</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Check derivative at x=1-1/n</span>
        <span class="s1">n </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">20</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s3">1.0</span><span class="s2">/</span><span class="s1">n</span>
        <span class="s1">xm1 </span><span class="s2">= </span><span class="s3">1</span><span class="s2">-</span><span class="s3">1.0</span><span class="s2">/</span><span class="s1">n</span>
        <span class="s1">pp1 </span><span class="s2">= -</span><span class="s1">n </span><span class="s2">* </span><span class="s1">x</span><span class="s2">**(</span><span class="s1">n</span><span class="s2">-</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">pp1 </span><span class="s2">-= (</span><span class="s3">1</span><span class="s2">-</span><span class="s1">np</span><span class="s2">.</span><span class="s1">sign</span><span class="s2">(</span><span class="s1">n</span><span class="s2">-</span><span class="s3">2</span><span class="s2">)**</span><span class="s3">2</span><span class="s2">) * </span><span class="s3">0.5  </span><span class="s4"># n=2, x=0.5, 1-1/n = 0.5, need to adjust</span>
        <span class="s1">dataset1 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">xm1</span><span class="s2">, </span><span class="s1">pp1</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovp</span><span class="s2">, </span><span class="s1">dataset1</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_oneovertwon</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Check derivative at x=1/2n  (Discontinuous at x=1/n, so check at x=1/2n)</span>
        <span class="s1">n </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">20</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s3">1.0</span><span class="s2">/</span><span class="s3">2</span><span class="s2">/</span><span class="s1">n</span>
        <span class="s1">pp </span><span class="s2">= -(</span><span class="s1">n</span><span class="s2">*</span><span class="s1">x</span><span class="s2">+</span><span class="s3">1</span><span class="s2">) * (</span><span class="s3">1</span><span class="s2">+</span><span class="s1">x</span><span class="s2">)**(</span><span class="s1">n</span><span class="s2">-</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">dataset0 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">pp</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovp</span><span class="s2">, </span><span class="s1">dataset0</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_oneovern</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Check derivative at x=1/n</span>
        <span class="s4"># (Discontinuous at x=1/n, hard to tell if x==1/n, only use n=power of 2)</span>
        <span class="s1">n </span><span class="s2">= </span><span class="s3">2</span><span class="s2">**</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">10</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s3">1.0</span><span class="s2">/</span><span class="s1">n</span>
        <span class="s1">pp </span><span class="s2">= -(</span><span class="s1">n</span><span class="s2">*</span><span class="s1">x</span><span class="s2">+</span><span class="s3">1</span><span class="s2">) * (</span><span class="s3">1</span><span class="s2">+</span><span class="s1">x</span><span class="s2">)**(</span><span class="s1">n</span><span class="s2">-</span><span class="s3">2</span><span class="s2">) + </span><span class="s3">0.5</span>
        <span class="s1">dataset0 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">pp</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovp</span><span class="s2">, </span><span class="s1">dataset0</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span><span class="s1">sys</span><span class="s2">.</span><span class="s1">maxsize </span><span class="s2">&lt;= </span><span class="s3">2</span><span class="s2">**</span><span class="s3">32</span><span class="s2">,</span>
                       <span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;requires 64-bit platform&quot;</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_oneovernclose</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4"># Check derivative at x=1/n</span>
        <span class="s4"># (Discontinuous at x=1/n, test on either side: x=1/n +/- 2epsilon)</span>
        <span class="s1">n </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">3</span><span class="s2">, </span><span class="s3">20</span><span class="s2">)</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s3">1.0</span><span class="s2">/</span><span class="s1">n </span><span class="s2">- </span><span class="s3">2</span><span class="s2">*</span><span class="s1">np</span><span class="s2">.</span><span class="s1">finfo</span><span class="s2">(</span><span class="s1">float</span><span class="s2">).</span><span class="s1">eps</span>
        <span class="s1">pp </span><span class="s2">= -(</span><span class="s1">n</span><span class="s2">*</span><span class="s1">x</span><span class="s2">+</span><span class="s3">1</span><span class="s2">) * (</span><span class="s3">1</span><span class="s2">+</span><span class="s1">x</span><span class="s2">)**(</span><span class="s1">n</span><span class="s2">-</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">dataset0 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">pp</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovp</span><span class="s2">, </span><span class="s1">dataset0</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s3">1.0</span><span class="s2">/</span><span class="s1">n </span><span class="s2">+ </span><span class="s3">2</span><span class="s2">*</span><span class="s1">np</span><span class="s2">.</span><span class="s1">finfo</span><span class="s2">(</span><span class="s1">float</span><span class="s2">).</span><span class="s1">eps</span>
        <span class="s1">pp </span><span class="s2">= -(</span><span class="s1">n</span><span class="s2">*</span><span class="s1">x</span><span class="s2">+</span><span class="s3">1</span><span class="s2">) * (</span><span class="s3">1</span><span class="s2">+</span><span class="s1">x</span><span class="s2">)**(</span><span class="s1">n</span><span class="s2">-</span><span class="s3">2</span><span class="s2">) + </span><span class="s3">1</span>
        <span class="s1">dataset1 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">pp</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span>
            <span class="s1">_smirnovp</span><span class="s2">, </span><span class="s1">dataset1</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">), </span><span class="s3">2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span>
        <span class="s2">).</span><span class="s1">check</span><span class="s2">(</span><span class="s1">dtypes</span><span class="s2">=[</span><span class="s1">int</span><span class="s2">, </span><span class="s1">float</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestKolmogorov</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">kolmogorov</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)))</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1.0</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.96394524366487511</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.8275735551899077</span><span class="s2">, </span><span class="s3">0.5000000000000000</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.26999967167735456</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.00067092525577969533</span><span class="s2">)]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">kolmogorov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_linspace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">2.0</span><span class="s2">, </span><span class="s3">21</span><span class="s2">)</span>
        <span class="s1">dataset </span><span class="s2">= [</span><span class="s3">1.0000000000000000</span><span class="s2">, </span><span class="s3">1.0000000000000000</span><span class="s2">, </span><span class="s3">0.9999999999994950</span><span class="s2">,</span>
                   <span class="s3">0.9999906941986655</span><span class="s2">, </span><span class="s3">0.9971923267772983</span><span class="s2">, </span><span class="s3">0.9639452436648751</span><span class="s2">,</span>
                   <span class="s3">0.8642827790506042</span><span class="s2">, </span><span class="s3">0.7112351950296890</span><span class="s2">, </span><span class="s3">0.5441424115741981</span><span class="s2">,</span>
                   <span class="s3">0.3927307079406543</span><span class="s2">, </span><span class="s3">0.2699996716773546</span><span class="s2">, </span><span class="s3">0.1777181926064012</span><span class="s2">,</span>
                   <span class="s3">0.1122496666707249</span><span class="s2">, </span><span class="s3">0.0680922218447664</span><span class="s2">, </span><span class="s3">0.0396818795381144</span><span class="s2">,</span>
                   <span class="s3">0.0222179626165251</span><span class="s2">, </span><span class="s3">0.0119520432391966</span><span class="s2">, </span><span class="s3">0.0061774306344441</span><span class="s2">,</span>
                   <span class="s3">0.0030676213475797</span><span class="s2">, </span><span class="s3">0.0014636048371873</span><span class="s2">, </span><span class="s3">0.0006709252557797</span><span class="s2">]</span>

        <span class="s1">dataset_c </span><span class="s2">= [</span><span class="s3">0.0000000000000000</span><span class="s2">, </span><span class="s3">6.609305242245699e-53</span><span class="s2">, </span><span class="s3">5.050407338670114e-13</span><span class="s2">,</span>
                     <span class="s3">9.305801334566668e-06</span><span class="s2">, </span><span class="s3">0.0028076732227017</span><span class="s2">, </span><span class="s3">0.0360547563351249</span><span class="s2">,</span>
                     <span class="s3">0.1357172209493958</span><span class="s2">, </span><span class="s3">0.2887648049703110</span><span class="s2">, </span><span class="s3">0.4558575884258019</span><span class="s2">,</span>
                     <span class="s3">0.6072692920593457</span><span class="s2">, </span><span class="s3">0.7300003283226455</span><span class="s2">, </span><span class="s3">0.8222818073935988</span><span class="s2">,</span>
                     <span class="s3">0.8877503333292751</span><span class="s2">, </span><span class="s3">0.9319077781552336</span><span class="s2">, </span><span class="s3">0.9603181204618857</span><span class="s2">,</span>
                     <span class="s3">0.9777820373834749</span><span class="s2">, </span><span class="s3">0.9880479567608034</span><span class="s2">, </span><span class="s3">0.9938225693655559</span><span class="s2">,</span>
                     <span class="s3">0.9969323786524203</span><span class="s2">, </span><span class="s3">0.9985363951628127</span><span class="s2">, </span><span class="s3">0.9993290747442203</span><span class="s2">]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">kolmogorov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>
        <span class="s1">dataset_c </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">dataset_c</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">_kolmogc</span><span class="s2">, </span><span class="s1">dataset_c</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_linspacei</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0</span><span class="s2">, </span><span class="s3">1.0</span><span class="s2">, </span><span class="s3">21</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">dataset </span><span class="s2">= [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">1.3580986393225507</span><span class="s2">, </span><span class="s3">1.2238478702170823</span><span class="s2">,</span>
                   <span class="s3">1.1379465424937751</span><span class="s2">, </span><span class="s3">1.0727491749396481</span><span class="s2">, </span><span class="s3">1.0191847202536859</span><span class="s2">,</span>
                   <span class="s3">0.9730633753323726</span><span class="s2">, </span><span class="s3">0.9320695842357622</span><span class="s2">, </span><span class="s3">0.8947644549851197</span><span class="s2">,</span>
                   <span class="s3">0.8601710725555463</span><span class="s2">, </span><span class="s3">0.8275735551899077</span><span class="s2">, </span><span class="s3">0.7964065373291559</span><span class="s2">,</span>
                   <span class="s3">0.7661855555617682</span><span class="s2">, </span><span class="s3">0.7364542888171910</span><span class="s2">, </span><span class="s3">0.7067326523068980</span><span class="s2">,</span>
                   <span class="s3">0.6764476915028201</span><span class="s2">, </span><span class="s3">0.6448126061663567</span><span class="s2">, </span><span class="s3">0.6105590999244391</span><span class="s2">,</span>
                   <span class="s3">0.5711732651063401</span><span class="s2">, </span><span class="s3">0.5196103791686224</span><span class="s2">, </span><span class="s3">0.0000000000000000</span><span class="s2">]</span>

        <span class="s1">dataset_c </span><span class="s2">= [</span><span class="s3">0.0000000000000000</span><span class="s2">, </span><span class="s3">0.5196103791686225</span><span class="s2">, </span><span class="s3">0.5711732651063401</span><span class="s2">,</span>
                     <span class="s3">0.6105590999244391</span><span class="s2">, </span><span class="s3">0.6448126061663567</span><span class="s2">, </span><span class="s3">0.6764476915028201</span><span class="s2">,</span>
                     <span class="s3">0.7067326523068980</span><span class="s2">, </span><span class="s3">0.7364542888171910</span><span class="s2">, </span><span class="s3">0.7661855555617682</span><span class="s2">,</span>
                     <span class="s3">0.7964065373291559</span><span class="s2">, </span><span class="s3">0.8275735551899077</span><span class="s2">, </span><span class="s3">0.8601710725555463</span><span class="s2">,</span>
                     <span class="s3">0.8947644549851196</span><span class="s2">, </span><span class="s3">0.9320695842357622</span><span class="s2">, </span><span class="s3">0.9730633753323727</span><span class="s2">,</span>
                     <span class="s3">1.0191847202536859</span><span class="s2">, </span><span class="s3">1.0727491749396481</span><span class="s2">, </span><span class="s3">1.1379465424937754</span><span class="s2">,</span>
                     <span class="s3">1.2238478702170825</span><span class="s2">, </span><span class="s3">1.3580986393225509</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">p</span><span class="s2">[</span><span class="s3">1</span><span class="s2">:], </span><span class="s1">dataset</span><span class="s2">[</span><span class="s3">1</span><span class="s2">:]])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">kolmogi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>
        <span class="s1">dataset_c </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">p</span><span class="s2">[:-</span><span class="s3">1</span><span class="s2">], </span><span class="s1">dataset_c</span><span class="s2">[:-</span><span class="s3">1</span><span class="s2">]])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">_kolmogci</span><span class="s2">, </span><span class="s1">dataset_c</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_smallx</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">epsilon </span><span class="s2">= </span><span class="s3">0.1 </span><span class="s2">** </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">14</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.571173265106</span><span class="s2">, </span><span class="s3">0.441027698518</span><span class="s2">, </span><span class="s3">0.374219690278</span><span class="s2">, </span><span class="s3">0.331392659217</span><span class="s2">,</span>
                      <span class="s3">0.300820537459</span><span class="s2">, </span><span class="s3">0.277539353999</span><span class="s2">, </span><span class="s3">0.259023494805</span><span class="s2">, </span><span class="s3">0.243829561254</span><span class="s2">,</span>
                      <span class="s3">0.231063086389</span><span class="s2">, </span><span class="s3">0.220135543236</span><span class="s2">, </span><span class="s3">0.210641372041</span><span class="s2">, </span><span class="s3">0.202290283658</span><span class="s2">,</span>
                      <span class="s3">0.19487060742</span><span class="s2">])</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s3">1</span><span class="s2">-</span><span class="s1">epsilon</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">kolmogorov</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_round_trip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">_ki_k</span><span class="s2">(</span><span class="s1">_x</span><span class="s2">):</span>
            <span class="s0">return </span><span class="s1">kolmogi</span><span class="s2">(</span><span class="s1">kolmogorov</span><span class="s2">(</span><span class="s1">_x</span><span class="s2">))</span>

        <span class="s0">def </span><span class="s1">_kci_kc</span><span class="s2">(</span><span class="s1">_x</span><span class="s2">):</span>
            <span class="s0">return </span><span class="s1">_kolmogci</span><span class="s2">(</span><span class="s1">_kolmogc</span><span class="s2">(</span><span class="s1">_x</span><span class="s2">))</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0.0</span><span class="s2">, </span><span class="s3">2.0</span><span class="s2">, </span><span class="s3">21</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s4"># Exclude 0.1, 0.2.  0.2 almost makes succeeds, but 0.1 has no chance.</span>
        <span class="s1">x02 </span><span class="s2">= </span><span class="s1">x</span><span class="s2">[(</span><span class="s1">x </span><span class="s2">== </span><span class="s3">0</span><span class="s2">) | (</span><span class="s1">x </span><span class="s2">&gt; </span><span class="s3">0.21</span><span class="s2">)]</span>
        <span class="s1">dataset02 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">x02</span><span class="s2">, </span><span class="s1">x02</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">_ki_k</span><span class="s2">, </span><span class="s1">dataset02</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">x</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">_kci_kc</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>


<span class="s0">class </span><span class="s1">TestKolmogi</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">kolmogi</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)))</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s3">1.0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.96394524366487511</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">0.571173265106</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.5000000000000000</span><span class="s2">, </span><span class="s3">0.8275735551899077</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.26999967167735456</span><span class="s2">, </span><span class="s3">1</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.00067092525577969533</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">kolmogi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_smallpcdf</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">epsilon </span><span class="s2">= </span><span class="s3">0.5 </span><span class="s2">** </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">55</span><span class="s2">, </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s4"># kolmogi(1-p) == _kolmogci(p) if  1-(1-p) == p, but not necessarily otherwise</span>
        <span class="s4"># Use epsilon s.t. 1-(1-epsilon)) == epsilon,</span>
        <span class="s4"># so can use same x-array for both results</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.8275735551899077</span><span class="s2">, </span><span class="s3">0.5345255069097583</span><span class="s2">, </span><span class="s3">0.4320114038786941</span><span class="s2">,</span>
                      <span class="s3">0.3736868442620478</span><span class="s2">, </span><span class="s3">0.3345161714909591</span><span class="s2">, </span><span class="s3">0.3057833329315859</span><span class="s2">,</span>
                      <span class="s3">0.2835052890528936</span><span class="s2">, </span><span class="s3">0.2655578150208676</span><span class="s2">, </span><span class="s3">0.2506869966107999</span><span class="s2">,</span>
                      <span class="s3">0.2380971058736669</span><span class="s2">, </span><span class="s3">0.2272549289962079</span><span class="s2">, </span><span class="s3">0.2177876361600040</span><span class="s2">,</span>
                      <span class="s3">0.2094254686862041</span><span class="s2">, </span><span class="s3">0.2019676748836232</span><span class="s2">, </span><span class="s3">0.1952612948137504</span><span class="s2">,</span>
                      <span class="s3">0.1891874239646641</span><span class="s2">, </span><span class="s3">0.1836520225050326</span><span class="s2">, </span><span class="s3">0.1785795904846466</span><span class="s2">])</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s3">1</span><span class="s2">-</span><span class="s1">epsilon</span><span class="s2">, </span><span class="s1">x</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">kolmogi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">epsilon</span><span class="s2">, </span><span class="s1">x</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">_kolmogci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_smallpsf</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">epsilon </span><span class="s2">= </span><span class="s3">0.5 </span><span class="s2">** </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">55</span><span class="s2">, </span><span class="s3">3</span><span class="s2">)</span>
        <span class="s4"># kolmogi(p) == _kolmogci(1-p) if  1-(1-p) == p, but not necessarily otherwise</span>
        <span class="s4"># Use epsilon s.t. 1-(1-epsilon)) == epsilon,</span>
        <span class="s4"># so can use same x-array for both results</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">0.8275735551899077</span><span class="s2">, </span><span class="s3">1.3163786275161036</span><span class="s2">, </span><span class="s3">1.6651092133663343</span><span class="s2">,</span>
                      <span class="s3">1.9525136345289607</span><span class="s2">, </span><span class="s3">2.2027324540033235</span><span class="s2">, </span><span class="s3">2.4272929437460848</span><span class="s2">,</span>
                      <span class="s3">2.6327688477341593</span><span class="s2">, </span><span class="s3">2.8233300509220260</span><span class="s2">, </span><span class="s3">3.0018183401530627</span><span class="s2">,</span>
                      <span class="s3">3.1702735084088891</span><span class="s2">, </span><span class="s3">3.3302184446307912</span><span class="s2">, </span><span class="s3">3.4828258153113318</span><span class="s2">,</span>
                      <span class="s3">3.6290214150152051</span><span class="s2">, </span><span class="s3">3.7695513262825959</span><span class="s2">, </span><span class="s3">3.9050272690877326</span><span class="s2">,</span>
                      <span class="s3">4.0359582187082550</span><span class="s2">, </span><span class="s3">4.1627730557884890</span><span class="s2">, </span><span class="s3">4.2858371743264527</span><span class="s2">])</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">epsilon</span><span class="s2">, </span><span class="s1">x</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">kolmogi</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s3">1</span><span class="s2">-</span><span class="s1">epsilon</span><span class="s2">, </span><span class="s1">x</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">_kolmogci</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_round_trip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">_k_ki</span><span class="s2">(</span><span class="s1">_p</span><span class="s2">):</span>
            <span class="s0">return </span><span class="s1">kolmogorov</span><span class="s2">(</span><span class="s1">kolmogi</span><span class="s2">(</span><span class="s1">_p</span><span class="s2">))</span>

        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">, </span><span class="s3">1.0</span><span class="s2">, </span><span class="s3">10</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">column_stack</span><span class="s2">([</span><span class="s1">p</span><span class="s2">, </span><span class="s1">p</span><span class="s2">])</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">_k_ki</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>


<span class="s0">class </span><span class="s1">TestKolmogp</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">_kolmogp</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)))</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dataset </span><span class="s2">= [(</span><span class="s3">0.000000</span><span class="s2">, -</span><span class="s3">0.0</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.200000</span><span class="s2">, -</span><span class="s3">1.532420541338916e-10</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.400000</span><span class="s2">, -</span><span class="s3">0.1012254419260496</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.600000</span><span class="s2">, -</span><span class="s3">1.324123244249925</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">0.800000</span><span class="s2">, -</span><span class="s3">1.627024345636592</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1.000000</span><span class="s2">, -</span><span class="s3">1.071948558356941</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1.200000</span><span class="s2">, -</span><span class="s3">0.538512430720529</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1.400000</span><span class="s2">, -</span><span class="s3">0.2222133182429472</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1.600000</span><span class="s2">, -</span><span class="s3">0.07649302775520538</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">1.800000</span><span class="s2">, -</span><span class="s3">0.02208687346347873</span><span class="s2">),</span>
                   <span class="s2">(</span><span class="s3">2.000000</span><span class="s2">, -</span><span class="s3">0.005367402045629683</span><span class="s2">)]</span>

        <span class="s1">dataset </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dataset</span><span class="s2">)</span>
        <span class="s1">FuncData</span><span class="s2">(</span><span class="s1">_kolmogp</span><span class="s2">, </span><span class="s1">dataset</span><span class="s2">, (</span><span class="s3">0</span><span class="s2">,), </span><span class="s3">1</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">_rtol</span><span class="s2">).</span><span class="s1">check</span><span class="s2">()</span>
</pre>
</body>
</html>