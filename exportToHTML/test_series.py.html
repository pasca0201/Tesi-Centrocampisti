<html>
<head>
<title>test_series.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_series.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; Test cases for Series.plot &quot;&quot;&quot;</span>
<span class="s2">from </span><span class="s1">datetime </span><span class="s2">import </span><span class="s1">datetime</span>
<span class="s2">from </span><span class="s1">itertools </span><span class="s2">import </span><span class="s1">chain</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">compat </span><span class="s2">import </span><span class="s1">is_platform_linux</span>
<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">compat</span><span class="s3">.</span><span class="s1">numpy </span><span class="s2">import </span><span class="s1">np_version_gte1p24</span>
<span class="s2">import </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">util</span><span class="s3">.</span><span class="s1">_test_decorators </span><span class="s2">as </span><span class="s1">td</span>

<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">from </span><span class="s1">pandas </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">DataFrame</span><span class="s3">,</span>
    <span class="s1">Series</span><span class="s3">,</span>
    <span class="s1">date_range</span><span class="s3">,</span>
    <span class="s1">period_range</span><span class="s3">,</span>
    <span class="s1">plotting</span><span class="s3">,</span>
<span class="s3">)</span>
<span class="s2">import </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">_testing </span><span class="s2">as </span><span class="s1">tm</span>
<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">tests</span><span class="s3">.</span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">common </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">_check_ax_scales</span><span class="s3">,</span>
    <span class="s1">_check_axes_shape</span><span class="s3">,</span>
    <span class="s1">_check_colors</span><span class="s3">,</span>
    <span class="s1">_check_grid_settings</span><span class="s3">,</span>
    <span class="s1">_check_has_errorbars</span><span class="s3">,</span>
    <span class="s1">_check_legend_labels</span><span class="s3">,</span>
    <span class="s1">_check_plot_works</span><span class="s3">,</span>
    <span class="s1">_check_text_labels</span><span class="s3">,</span>
    <span class="s1">_check_ticks_props</span><span class="s3">,</span>
    <span class="s1">_unpack_cycler</span><span class="s3">,</span>
    <span class="s1">get_y_axis</span><span class="s3">,</span>
<span class="s3">)</span>

<span class="s1">mpl </span><span class="s3">= </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;matplotlib&quot;</span><span class="s3">)</span>
<span class="s1">plt </span><span class="s3">= </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;matplotlib.pyplot&quot;</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span>
<span class="s2">def </span><span class="s1">ts</span><span class="s3">():</span>
    <span class="s2">return </span><span class="s1">Series</span><span class="s3">(</span>
        <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
        <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">10</span><span class="s3">),</span>
        <span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;ts&quot;</span><span class="s3">,</span>
    <span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span>
<span class="s2">def </span><span class="s1">series</span><span class="s3">():</span>
    <span class="s2">return </span><span class="s1">Series</span><span class="s3">(</span>
        <span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">f&quot;i_</span><span class="s2">{</span><span class="s1">i</span><span class="s2">}</span><span class="s4">&quot; </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">)]</span>
    <span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestSeriesPlots</span><span class="s3">:</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kwargs&quot;</span><span class="s3">, [{</span><span class="s4">&quot;label&quot;</span><span class="s3">: </span><span class="s4">&quot;foo&quot;</span><span class="s3">}, {</span><span class="s4">&quot;use_index&quot;</span><span class="s3">: </span><span class="s2">False</span><span class="s3">}])</span>
    <span class="s2">def </span><span class="s1">test_plot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_tick_props</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">rot</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;scale, exp_scale&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">[{</span><span class="s4">&quot;logy&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">}, {</span><span class="s4">&quot;yaxis&quot;</span><span class="s3">: </span><span class="s4">&quot;log&quot;</span><span class="s3">}],</span>
            <span class="s3">[{</span><span class="s4">&quot;logx&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">}, {</span><span class="s4">&quot;xaxis&quot;</span><span class="s3">: </span><span class="s4">&quot;log&quot;</span><span class="s3">}],</span>
            <span class="s3">[{</span><span class="s4">&quot;loglog&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">}, {</span><span class="s4">&quot;xaxis&quot;</span><span class="s3">: </span><span class="s4">&quot;log&quot;</span><span class="s3">, </span><span class="s4">&quot;yaxis&quot;</span><span class="s3">: </span><span class="s4">&quot;log&quot;</span><span class="s3">}],</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_plot_scales</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">scale</span><span class="s3">, </span><span class="s1">exp_scale</span><span class="s3">):</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">style</span><span class="s3">=</span><span class="s4">&quot;.&quot;</span><span class="s3">, **</span><span class="s1">scale</span><span class="s3">)</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, **</span><span class="s1">exp_scale</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_ts_bar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">[:</span><span class="s5">10</span><span class="s3">].</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_ts_area_stacked</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plot_iseries</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">5</span><span class="s3">), </span><span class="s1">period_range</span><span class="s3">(</span><span class="s4">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">5</span><span class="s3">))</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ser</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kind&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s4">&quot;line&quot;</span><span class="s3">,</span>
            <span class="s4">&quot;bar&quot;</span><span class="s3">,</span>
            <span class="s4">&quot;barh&quot;</span><span class="s3">,</span>
            <span class="s1">pytest</span><span class="s3">.</span><span class="s1">param</span><span class="s3">(</span><span class="s4">&quot;kde&quot;</span><span class="s3">, </span><span class="s1">marks</span><span class="s3">=</span><span class="s1">td</span><span class="s3">.</span><span class="s1">skip_if_no</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)),</span>
            <span class="s4">&quot;hist&quot;</span><span class="s3">,</span>
            <span class="s4">&quot;box&quot;</span><span class="s3">,</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_plot_series_kinds</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">series</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">[:</span><span class="s5">5</span><span class="s3">].</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plot_series_barh</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">series</span><span class="s3">):</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">[:</span><span class="s5">10</span><span class="s3">].</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">barh</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_plot_series_bar_ax</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">10</span><span class="s3">)).</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s4">&quot;black&quot;</span>
        <span class="s3">)</span>
        <span class="s1">_check_colors</span><span class="s3">([</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]], </span><span class="s1">facecolors</span><span class="s3">=[</span><span class="s4">&quot;black&quot;</span><span class="s3">])</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kwargs&quot;</span><span class="s3">, [{}, {</span><span class="s4">&quot;layout&quot;</span><span class="s3">: (-</span><span class="s5">1</span><span class="s3">, </span><span class="s5">1</span><span class="s3">)}, {</span><span class="s4">&quot;layout&quot;</span><span class="s3">: (</span><span class="s5">1</span><span class="s3">, -</span><span class="s5">1</span><span class="s3">)}])</span>
    <span class="s2">def </span><span class="s1">test_plot_6951</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s6"># GH 6951</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">subplots</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s5">1</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">1</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_plot_figsize_and_title</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">series</span><span class="s3">):</span>
        <span class="s6"># figsize and title</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">title</span><span class="s3">=</span><span class="s4">&quot;Test&quot;</span><span class="s3">, </span><span class="s1">figsize</span><span class="s3">=(</span><span class="s5">16</span><span class="s3">, </span><span class="s5">8</span><span class="s3">), </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">title</span><span class="s3">, </span><span class="s4">&quot;Test&quot;</span><span class="s3">)</span>
        <span class="s1">_check_axes_shape</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">axes_num</span><span class="s3">=</span><span class="s5">1</span><span class="s3">, </span><span class="s1">layout</span><span class="s3">=(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">1</span><span class="s3">), </span><span class="s1">figsize</span><span class="s3">=(</span><span class="s5">16</span><span class="s3">, </span><span class="s5">8</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_dont_modify_rcParams</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH 8242</span>
        <span class="s1">key </span><span class="s3">= </span><span class="s4">&quot;axes.prop_cycle&quot;</span>
        <span class="s1">colors </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">rcParams</span><span class="s3">[</span><span class="s1">key</span><span class="s3">]</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">]).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">colors </span><span class="s3">== </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">rcParams</span><span class="s3">[</span><span class="s1">key</span><span class="s3">]</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kwargs&quot;</span><span class="s3">, [{}, {</span><span class="s4">&quot;secondary_y&quot;</span><span class="s3">: </span><span class="s2">True</span><span class="s3">}])</span>
    <span class="s2">def </span><span class="s1">test_ts_line_lim</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">kwargs</span><span class="s3">):</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, **</span><span class="s1">kwargs</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">(</span><span class="s1">orig</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)[</span><span class="s5">0</span><span class="s3">][</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">(</span><span class="s1">orig</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)[</span><span class="s5">0</span><span class="s3">][-</span><span class="s5">1</span><span class="s3">]</span>

    <span class="s2">def </span><span class="s1">test_ts_area_lim</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">line </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">(</span><span class="s1">orig</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">line</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">line</span><span class="s3">[-</span><span class="s5">1</span><span class="s3">]</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_ts_area_lim_xcompat</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s6"># GH 7471</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">x_compat</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">line </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">(</span><span class="s1">orig</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">line</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">line</span><span class="s3">[-</span><span class="s5">1</span><span class="s3">]</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s5">30</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_ts_tz_area_lim_xcompat</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">tz_ts </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">copy</span><span class="s3">()</span>
        <span class="s1">tz_ts</span><span class="s3">.</span><span class="s1">index </span><span class="s3">= </span><span class="s1">tz_ts</span><span class="s3">.</span><span class="s1">tz_localize</span><span class="s3">(</span><span class="s4">&quot;GMT&quot;</span><span class="s3">).</span><span class="s1">tz_convert</span><span class="s3">(</span><span class="s4">&quot;CET&quot;</span><span class="s3">)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">tz_ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">x_compat</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">line </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">(</span><span class="s1">orig</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">line</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">line</span><span class="s3">[-</span><span class="s5">1</span><span class="s3">]</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_ts_tz_area_lim_xcompat_secondary_y</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">tz_ts </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">copy</span><span class="s3">()</span>
        <span class="s1">tz_ts</span><span class="s3">.</span><span class="s1">index </span><span class="s3">= </span><span class="s1">tz_ts</span><span class="s3">.</span><span class="s1">tz_localize</span><span class="s3">(</span><span class="s4">&quot;GMT&quot;</span><span class="s3">).</span><span class="s1">tz_convert</span><span class="s3">(</span><span class="s4">&quot;CET&quot;</span><span class="s3">)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">tz_ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">(</span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">line </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">(</span><span class="s1">orig</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">line</span><span class="s3">[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">line</span><span class="s3">[-</span><span class="s5">1</span><span class="s3">]</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_area_sharey_dont_overwrite</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s6"># GH37942</span>
        <span class="s1">fig</span><span class="s3">, (</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">) = </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s1">sharey</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">abs</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;area&quot;</span><span class="s3">)</span>
        <span class="s1">abs</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax2</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;area&quot;</span><span class="s3">)</span>

        <span class="s2">assert </span><span class="s1">get_y_axis</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">).</span><span class="s1">joined</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">get_y_axis</span><span class="s3">(</span><span class="s1">ax2</span><span class="s3">).</span><span class="s1">joined</span><span class="s3">(</span><span class="s1">ax1</span><span class="s3">, </span><span class="s1">ax2</span><span class="s3">)</span>
        <span class="s1">plt</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s1">fig</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_label</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">])</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">label</span><span class="s3">=</span><span class="s4">&quot;LABEL&quot;</span><span class="s3">, </span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=[</span><span class="s4">&quot;LABEL&quot;</span><span class="s3">])</span>
        <span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_label_none</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">])</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=[</span><span class="s4">&quot;&quot;</span><span class="s3">])</span>
        <span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_label_ser_name</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;NAME&quot;</span><span class="s3">)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=[</span><span class="s4">&quot;NAME&quot;</span><span class="s3">])</span>
        <span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_label_ser_name_override</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;NAME&quot;</span><span class="s3">)</span>
        <span class="s6"># override the default</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">label</span><span class="s3">=</span><span class="s4">&quot;LABEL&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=[</span><span class="s4">&quot;LABEL&quot;</span><span class="s3">])</span>
        <span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_label_ser_name_override_dont_draw</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;NAME&quot;</span><span class="s3">)</span>
        <span class="s6"># Add lebel info, but don't draw</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">legend</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">label</span><span class="s3">=</span><span class="s4">&quot;LABEL&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_legend</span><span class="s3">() </span><span class="s2">is None  </span><span class="s6"># Hasn't been drawn</span>
        <span class="s1">ax</span><span class="s3">.</span><span class="s1">legend</span><span class="s3">()  </span><span class="s6"># draw it</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=[</span><span class="s4">&quot;LABEL&quot;</span><span class="s3">])</span>
        <span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">close</span><span class="s3">(</span><span class="s4">&quot;all&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_boolean</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH 23719</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s2">False</span><span class="s3">, </span><span class="s2">False</span><span class="s3">, </span><span class="s2">True</span><span class="s3">])</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">include_bool</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;no numeric data to plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;index&quot;</span><span class="s3">, [</span><span class="s2">None</span><span class="s3">, </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">4</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_line_area_nan_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">index</span><span class="s3">):</span>
        <span class="s1">values </span><span class="s3">= [</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s5">3</span><span class="s3">]</span>
        <span class="s1">d </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">index</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">d</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">)</span>
        <span class="s1">masked </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">()</span>
        <span class="s6"># remove nan for comparison purpose</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">delete</span><span class="s3">(</span><span class="s1">masked</span><span class="s3">.</span><span class="s1">data</span><span class="s3">, </span><span class="s5">2</span><span class="s3">), </span><span class="s1">exp</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">masked</span><span class="s3">.</span><span class="s1">mask</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s2">False</span><span class="s3">, </span><span class="s2">False</span><span class="s3">, </span><span class="s2">True</span><span class="s3">, </span><span class="s2">False</span><span class="s3">]))</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">d</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">d</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">d</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">area</span><span class="s3">, </span><span class="s1">stacked</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_ydata</span><span class="s3">(), </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_line_use_index_false</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">])</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">name </span><span class="s3">= </span><span class="s4">&quot;The Index&quot;</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">use_index</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">label </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">label </span><span class="s3">== </span><span class="s4">&quot;&quot;</span>

    <span class="s2">def </span><span class="s1">test_line_use_index_false_diff_var</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">])</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">name </span><span class="s3">= </span><span class="s4">&quot;The Index&quot;</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">use_index</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">label2 </span><span class="s3">= </span><span class="s1">ax2</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">label2 </span><span class="s3">== </span><span class="s4">&quot;&quot;</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span>
        <span class="s1">np_version_gte1p24 </span><span class="s2">and </span><span class="s1">is_platform_linux</span><span class="s3">(),</span>
        <span class="s1">reason</span><span class="s3">=</span><span class="s4">&quot;Weird rounding problems&quot;</span><span class="s3">,</span>
        <span class="s1">strict</span><span class="s3">=</span><span class="s2">False</span><span class="s3">,</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;axis, meth&quot;</span><span class="s3">, [(</span><span class="s4">&quot;yaxis&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">), (</span><span class="s4">&quot;xaxis&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_bar_log</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">axis</span><span class="s3">, </span><span class="s1">meth</span><span class="s3">):</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s5">1e-1</span><span class="s3">, </span><span class="s5">1e0</span><span class="s3">, </span><span class="s5">1e1</span><span class="s3">, </span><span class="s5">1e2</span><span class="s3">, </span><span class="s5">1e3</span><span class="s3">, </span><span class="s5">1e4</span><span class="s3">])</span>

        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">Series</span><span class="s3">([</span><span class="s5">200</span><span class="s3">, </span><span class="s5">500</span><span class="s3">]).</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">meth</span><span class="s3">)(</span><span class="s1">log</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">axis</span><span class="s3">).</span><span class="s1">get_ticklocs</span><span class="s3">(), </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span>
        <span class="s1">np_version_gte1p24 </span><span class="s2">and </span><span class="s1">is_platform_linux</span><span class="s3">(),</span>
        <span class="s1">reason</span><span class="s3">=</span><span class="s4">&quot;Weird rounding problems&quot;</span><span class="s3">,</span>
        <span class="s1">strict</span><span class="s3">=</span><span class="s2">False</span><span class="s3">,</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;axis, kind, res_meth&quot;</span><span class="s3">,</span>
        <span class="s3">[[</span><span class="s4">&quot;yaxis&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;get_ylim&quot;</span><span class="s3">], [</span><span class="s4">&quot;xaxis&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">, </span><span class="s4">&quot;get_xlim&quot;</span><span class="s3">]],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_bar_log_kind_bar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">axis</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">, </span><span class="s1">res_meth</span><span class="s3">):</span>
        <span class="s6"># GH 9905</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s5">1e-5</span><span class="s3">, </span><span class="s5">1e-4</span><span class="s3">, </span><span class="s5">1e-3</span><span class="s3">, </span><span class="s5">1e-2</span><span class="s3">, </span><span class="s5">1e-1</span><span class="s3">, </span><span class="s5">1e0</span><span class="s3">, </span><span class="s5">1e1</span><span class="s3">])</span>

        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">0.1</span><span class="s3">, </span><span class="s5">0.01</span><span class="s3">, </span><span class="s5">0.001</span><span class="s3">]).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">log</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">ymin </span><span class="s3">= </span><span class="s5">0.0007943282347242822</span>
        <span class="s1">ymax </span><span class="s3">= </span><span class="s5">0.12589254117941673</span>
        <span class="s1">res </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">res_meth</span><span class="s3">)()</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">res</span><span class="s3">[</span><span class="s5">0</span><span class="s3">], </span><span class="s1">ymin</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">res</span><span class="s3">[</span><span class="s5">1</span><span class="s3">], </span><span class="s1">ymax</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">axis</span><span class="s3">).</span><span class="s1">get_ticklocs</span><span class="s3">(), </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_bar_ignore_index</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">4</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">])</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">use_index</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), [</span><span class="s4">&quot;0&quot;</span><span class="s3">, </span><span class="s4">&quot;1&quot;</span><span class="s3">, </span><span class="s4">&quot;2&quot;</span><span class="s3">, </span><span class="s4">&quot;3&quot;</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_bar_user_colors</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">4</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">color</span><span class="s3">=[</span><span class="s4">&quot;red&quot;</span><span class="s3">, </span><span class="s4">&quot;blue&quot;</span><span class="s3">, </span><span class="s4">&quot;blue&quot;</span><span class="s3">, </span><span class="s4">&quot;red&quot;</span><span class="s3">])</span>
        <span class="s1">result </span><span class="s3">= [</span><span class="s1">p</span><span class="s3">.</span><span class="s1">get_facecolor</span><span class="s3">() </span><span class="s2">for </span><span class="s1">p </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">]</span>
        <span class="s1">expected </span><span class="s3">= [</span>
            <span class="s3">(</span><span class="s5">1.0</span><span class="s3">, </span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">),</span>
            <span class="s3">(</span><span class="s5">1.0</span><span class="s3">, </span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">),</span>
        <span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== </span><span class="s1">expected</span>

    <span class="s2">def </span><span class="s1">test_rotation_default</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">5</span><span class="s3">, </span><span class="s5">5</span><span class="s3">)))</span>
        <span class="s6"># Default rot 0</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_rotation_30</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">5</span><span class="s3">, </span><span class="s5">5</span><span class="s3">)))</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">rot</span><span class="s3">=</span><span class="s5">30</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s5">30</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_irregular_datetime</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">_matplotlib</span><span class="s3">.</span><span class="s1">converter </span><span class="s2">import </span><span class="s1">DatetimeConverter</span>

        <span class="s1">rng </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s4">&quot;3/1/2000&quot;</span><span class="s3">)</span>
        <span class="s1">rng </span><span class="s3">= </span><span class="s1">rng</span><span class="s3">[[</span><span class="s5">0</span><span class="s3">, </span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">5</span><span class="s3">, </span><span class="s5">9</span><span class="s3">, </span><span class="s5">10</span><span class="s3">, </span><span class="s5">11</span><span class="s3">, </span><span class="s5">12</span><span class="s3">]]</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s1">len</span><span class="s3">(</span><span class="s1">rng</span><span class="s3">)), </span><span class="s1">rng</span><span class="s3">)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">xp </span><span class="s3">= </span><span class="s1">DatetimeConverter</span><span class="s3">.</span><span class="s1">convert</span><span class="s3">(</span><span class="s1">datetime</span><span class="s3">(</span><span class="s5">1999</span><span class="s3">, </span><span class="s5">1</span><span class="s3">, </span><span class="s5">1</span><span class="s3">), </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">ax</span><span class="s3">.</span><span class="s1">set_xlim</span><span class="s3">(</span><span class="s4">&quot;1/1/1999&quot;</span><span class="s3">, </span><span class="s4">&quot;1/1/2001&quot;</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">xp </span><span class="s3">== </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s1">_check_ticks_props</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xrot</span><span class="s3">=</span><span class="s5">30</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_unsorted_index_xlim</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s3">[</span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s5">3.0</span><span class="s3">, </span><span class="s5">4.0</span><span class="s3">, </span><span class="s5">5.0</span><span class="s3">, </span><span class="s5">6.0</span><span class="s3">],</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s5">1.0</span><span class="s3">, </span><span class="s5">0.0</span><span class="s3">, </span><span class="s5">3.0</span><span class="s3">, </span><span class="s5">2.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s5">3.0</span><span class="s3">, </span><span class="s5">2.0</span><span class="s3">],</span>
        <span class="s3">)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">xmin</span><span class="s3">, </span><span class="s1">xmax </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>
        <span class="s1">lines </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">xmin </span><span class="s3">&lt;= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nanmin</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">(</span><span class="s1">orig</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)[</span><span class="s5">0</span><span class="s3">])</span>
        <span class="s2">assert </span><span class="s1">xmax </span><span class="s3">&gt;= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nanmax</span><span class="s3">(</span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_data</span><span class="s3">(</span><span class="s1">orig</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)[</span><span class="s5">0</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_pie_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># if sum of values is less than 1.0, pie handle them as rate and draw</span>
        <span class="s6"># semicircle.</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">integers</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">5</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;YLABEL&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">, </span><span class="s1">series</span><span class="s3">.</span><span class="s1">index</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s4">&quot;YLABEL&quot;</span>

    <span class="s2">def </span><span class="s1">test_pie_series_no_label</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">integers</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">5</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;YLABEL&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=</span><span class="s2">None</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">, [</span><span class="s4">&quot;&quot;</span><span class="s3">] * </span><span class="s5">5</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_pie_series_less_colors_than_elements</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">integers</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">5</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;YLABEL&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">color_args </span><span class="s3">= [</span><span class="s4">&quot;r&quot;</span><span class="s3">, </span><span class="s4">&quot;g&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">]</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">, </span><span class="s1">colors</span><span class="s3">=</span><span class="s1">color_args</span><span class="s3">)</span>

        <span class="s1">color_expected </span><span class="s3">= [</span><span class="s4">&quot;r&quot;</span><span class="s3">, </span><span class="s4">&quot;g&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;r&quot;</span><span class="s3">, </span><span class="s4">&quot;g&quot;</span><span class="s3">]</span>
        <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">, </span><span class="s1">facecolors</span><span class="s3">=</span><span class="s1">color_expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_pie_series_labels_and_colors</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">integers</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">5</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;YLABEL&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s6"># with labels and colors</span>
        <span class="s1">labels </span><span class="s3">= [</span><span class="s4">&quot;A&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">, </span><span class="s4">&quot;C&quot;</span><span class="s3">, </span><span class="s4">&quot;D&quot;</span><span class="s3">, </span><span class="s4">&quot;E&quot;</span><span class="s3">]</span>
        <span class="s1">color_args </span><span class="s3">= [</span><span class="s4">&quot;r&quot;</span><span class="s3">, </span><span class="s4">&quot;g&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;m&quot;</span><span class="s3">]</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=</span><span class="s1">labels</span><span class="s3">, </span><span class="s1">colors</span><span class="s3">=</span><span class="s1">color_args</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">)</span>
        <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">, </span><span class="s1">facecolors</span><span class="s3">=</span><span class="s1">color_args</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_pie_series_autopct_and_fontsize</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">integers</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">5</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">],</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;YLABEL&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">color_args </span><span class="s3">= [</span><span class="s4">&quot;r&quot;</span><span class="s3">, </span><span class="s4">&quot;g&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;m&quot;</span><span class="s3">]</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span>
            <span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">, </span><span class="s1">colors</span><span class="s3">=</span><span class="s1">color_args</span><span class="s3">, </span><span class="s1">autopct</span><span class="s3">=</span><span class="s4">&quot;%.2f&quot;</span><span class="s3">, </span><span class="s1">fontsize</span><span class="s3">=</span><span class="s5">7</span>
        <span class="s3">)</span>
        <span class="s1">pcts </span><span class="s3">= [</span><span class="s4">f&quot;</span><span class="s2">{</span><span class="s1">s</span><span class="s3">*</span><span class="s5">100</span><span class="s2">:</span><span class="s4">.2f</span><span class="s2">}</span><span class="s4">&quot; </span><span class="s2">for </span><span class="s1">s </span><span class="s2">in </span><span class="s1">series</span><span class="s3">.</span><span class="s1">values </span><span class="s3">/ </span><span class="s1">series</span><span class="s3">.</span><span class="s1">sum</span><span class="s3">()]</span>
        <span class="s1">expected_texts </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">chain</span><span class="s3">.</span><span class="s1">from_iterable</span><span class="s3">(</span><span class="s1">zip</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">pcts</span><span class="s3">)))</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">, </span><span class="s1">expected_texts</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">t </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">t</span><span class="s3">.</span><span class="s1">get_fontsize</span><span class="s3">() == </span><span class="s5">7</span>

    <span class="s2">def </span><span class="s1">test_pie_series_negative_raises</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># includes negative value</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">4</span><span class="s3">, -</span><span class="s5">1</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">, </span><span class="s4">&quot;e&quot;</span><span class="s3">])</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;pie plot doesn't allow negative values&quot;</span><span class="s3">):</span>
            <span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">test_pie_series_nan</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># includes nan</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s5">4</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;YLABEL&quot;</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">, [</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s4">&quot;d&quot;</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_pie_nan</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s5">1</span><span class="s3">, </span><span class="s5">1</span><span class="s3">])</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">pie</span><span class="s3">(</span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s4">&quot;0&quot;</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s4">&quot;2&quot;</span><span class="s3">, </span><span class="s4">&quot;3&quot;</span><span class="s3">]</span>
        <span class="s1">result </span><span class="s3">= [</span><span class="s1">x</span><span class="s3">.</span><span class="s1">get_text</span><span class="s3">() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">texts</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== </span><span class="s1">expected</span>

    <span class="s2">def </span><span class="s1">test_df_series_secondary_legend</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH 9779</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">30</span><span class="s3">, </span><span class="s5">3</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abc&quot;</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">30</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>

        <span class="s6"># primary -&gt; secondary (without passing ax)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s6"># both legends are drawn on left ax</span>
        <span class="s6"># left and right axis must be visible</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;x (right)&quot;</span><span class="s3">])</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">right_ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">test_df_series_secondary_legend_with_axes</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH 9779</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">30</span><span class="s3">, </span><span class="s5">3</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abc&quot;</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">30</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s6"># primary -&gt; secondary (with passing ax)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s6"># both legends are drawn on left ax</span>
        <span class="s6"># left and right axis must be visible</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=[</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;x (right)&quot;</span><span class="s3">])</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">right_ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">test_df_series_secondary_legend_both</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH 9779</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">30</span><span class="s3">, </span><span class="s5">3</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abc&quot;</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">30</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s6"># secondary -&gt; secondary (without passing ax)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s6"># both legends are drawn on left ax</span>
        <span class="s6"># left axis must be invisible and right axis must be visible</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s4">&quot;a (right)&quot;</span><span class="s3">, </span><span class="s4">&quot;b (right)&quot;</span><span class="s3">, </span><span class="s4">&quot;c (right)&quot;</span><span class="s3">, </span><span class="s4">&quot;x (right)&quot;</span><span class="s3">]</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">left_ax</span><span class="s3">, </span><span class="s1">labels</span><span class="s3">=</span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">assert not </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">left_ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">test_df_series_secondary_legend_both_with_axis</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH 9779</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">30</span><span class="s3">, </span><span class="s5">3</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abc&quot;</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">30</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s6"># secondary -&gt; secondary (with passing ax)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s6"># both legends are drawn on left ax</span>
        <span class="s6"># left axis must be invisible and right axis must be visible</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s4">&quot;a (right)&quot;</span><span class="s3">, </span><span class="s4">&quot;b (right)&quot;</span><span class="s3">, </span><span class="s4">&quot;c (right)&quot;</span><span class="s3">, </span><span class="s4">&quot;x (right)&quot;</span><span class="s3">]</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">left_ax</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">assert not </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">left_ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">test_df_series_secondary_legend_both_with_axis_2</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH 9779</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">30</span><span class="s3">, </span><span class="s5">3</span><span class="s3">)), </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abc&quot;</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">30</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s6"># secondary -&gt; secondary (with passing ax)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">mark_right</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">legend</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s6"># both legends are drawn on left ax</span>
        <span class="s6"># left axis must be invisible and right axis must be visible</span>
        <span class="s1">expected </span><span class="s3">= [</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">, </span><span class="s4">&quot;x (right)&quot;</span><span class="s3">]</span>
        <span class="s1">_check_legend_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">left_ax</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">assert not </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">left_ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yaxis</span><span class="s3">().</span><span class="s1">get_visible</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;input_logy, expected_scale&quot;</span><span class="s3">, [(</span><span class="s2">True</span><span class="s3">, </span><span class="s4">&quot;log&quot;</span><span class="s3">), (</span><span class="s4">&quot;sym&quot;</span><span class="s3">, </span><span class="s4">&quot;symlog&quot;</span><span class="s3">)]</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_secondary_logy</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">input_logy</span><span class="s3">, </span><span class="s1">expected_scale</span><span class="s3">):</span>
        <span class="s6"># GH 25545</span>
        <span class="s1">s1 </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">100</span><span class="s3">))</span>
        <span class="s1">s2 </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">100</span><span class="s3">))</span>

        <span class="s6"># GH 24980</span>
        <span class="s1">ax1 </span><span class="s3">= </span><span class="s1">s1</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">logy</span><span class="s3">=</span><span class="s1">input_logy</span><span class="s3">)</span>
        <span class="s1">ax2 </span><span class="s3">= </span><span class="s1">s2</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">secondary_y</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">logy</span><span class="s3">=</span><span class="s1">input_logy</span><span class="s3">)</span>

        <span class="s2">assert </span><span class="s1">ax1</span><span class="s3">.</span><span class="s1">get_yscale</span><span class="s3">() == </span><span class="s1">expected_scale</span>
        <span class="s2">assert </span><span class="s1">ax2</span><span class="s3">.</span><span class="s1">get_yscale</span><span class="s3">() == </span><span class="s1">expected_scale</span>

    <span class="s2">def </span><span class="s1">test_plot_fails_with_dupe_color_and_style</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">x </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">2</span><span class="s3">))</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">msg </span><span class="s3">= (</span>
            <span class="s4">&quot;Cannot pass 'style' string with a color symbol and 'color' keyword &quot;</span>
            <span class="s4">&quot;argument. Please use one or the other or pass 'style' without a color &quot;</span>
            <span class="s4">&quot;symbol&quot;</span>
        <span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">x</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">style</span><span class="s3">=</span><span class="s4">&quot;k--&quot;</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s4">&quot;k&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;bw_method, ind&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">[</span><span class="s4">&quot;scott&quot;</span><span class="s3">, </span><span class="s5">20</span><span class="s3">],</span>
            <span class="s3">[</span><span class="s2">None</span><span class="s3">, </span><span class="s5">20</span><span class="s3">],</span>
            <span class="s3">[</span><span class="s2">None</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">int_</span><span class="s3">(</span><span class="s5">20</span><span class="s3">)],</span>
            <span class="s3">[</span><span class="s5">0.5</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">linspace</span><span class="s3">(-</span><span class="s5">100</span><span class="s3">, </span><span class="s5">100</span><span class="s3">, </span><span class="s5">20</span><span class="s3">)],</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_kde_kwargs</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">bw_method</span><span class="s3">, </span><span class="s1">ind</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">kde</span><span class="s3">, </span><span class="s1">bw_method</span><span class="s3">=</span><span class="s1">bw_method</span><span class="s3">, </span><span class="s1">ind</span><span class="s3">=</span><span class="s1">ind</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_density_kwargs</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">sample_points </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">linspace</span><span class="s3">(-</span><span class="s5">100</span><span class="s3">, </span><span class="s5">100</span><span class="s3">, </span><span class="s5">20</span><span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">density</span><span class="s3">, </span><span class="s1">bw_method</span><span class="s3">=</span><span class="s5">0.5</span><span class="s3">, </span><span class="s1">ind</span><span class="s3">=</span><span class="s1">sample_points</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_kde_kwargs_check_axes</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">sample_points </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">linspace</span><span class="s3">(-</span><span class="s5">100</span><span class="s3">, </span><span class="s5">100</span><span class="s3">, </span><span class="s5">20</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">kde</span><span class="s3">(</span><span class="s1">logy</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">bw_method</span><span class="s3">=</span><span class="s5">0.5</span><span class="s3">, </span><span class="s1">ind</span><span class="s3">=</span><span class="s1">sample_points</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">yaxis</span><span class="s3">=</span><span class="s4">&quot;log&quot;</span><span class="s3">)</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">yaxis</span><span class="s3">.</span><span class="s1">get_label</span><span class="s3">(), </span><span class="s4">&quot;Density&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_kde_missing_vals</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">uniform</span><span class="s3">(</span><span class="s1">size</span><span class="s3">=</span><span class="s5">50</span><span class="s3">))</span>
        <span class="s1">s</span><span class="s3">[</span><span class="s5">0</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>
        <span class="s1">axes </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">kde</span><span class="s3">)</span>

        <span class="s6"># gh-14821: check if the values have any missing values</span>
        <span class="s2">assert </span><span class="s1">any</span><span class="s3">(~</span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">axes</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_xdata</span><span class="s3">()))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span><span class="s1">reason</span><span class="s3">=</span><span class="s4">&quot;Api changed in 3.6.0&quot;</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_boxplot_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">box</span><span class="s3">(</span><span class="s1">logy</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_ax_scales</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">yaxis</span><span class="s3">=</span><span class="s4">&quot;log&quot;</span><span class="s3">)</span>
        <span class="s1">xlabels </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">()</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">xlabels</span><span class="s3">, [</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">name</span><span class="s3">])</span>
        <span class="s1">ylabels </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_yticklabels</span><span class="s3">()</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ylabels</span><span class="s3">, [</span><span class="s4">&quot;&quot;</span><span class="s3">] * </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ylabels</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kind&quot;</span><span class="s3">,</span>
        <span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds </span><span class="s3">+ </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_series_kinds</span><span class="s3">,</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_kind_kwarg</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">3</span><span class="s3">))</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">close</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;kind&quot;</span><span class="s3">,</span>
        <span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds </span><span class="s3">+ </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_series_kinds</span><span class="s3">,</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_kind_attr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">3</span><span class="s3">))</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">getattr</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">)()</span>
        <span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">close</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_invalid_plot_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abcd&quot;</span><span class="s3">))</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;no numeric data to plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_valid_object_plot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">10</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">object</span><span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds</span><span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_partially_invalid_plot_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s5">1.0</span><span class="s3">, </span><span class="s5">2</span><span class="s3">])</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;no numeric data to plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_invalid_kind</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">])</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;invalid_kind is not a valid plot kind&quot;</span><span class="s3">):</span>
            <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;invalid_kind&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_dup_datetime_index_plot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">dr1 </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2009&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">4</span><span class="s3">)</span>
        <span class="s1">dr2 </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/2/2009&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">4</span><span class="s3">)</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">dr1</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">dr2</span><span class="s3">)</span>
        <span class="s1">values </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s1">index</span><span class="s3">.</span><span class="s1">size</span><span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">index</span><span class="s3">)</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_errorbar_asymmetrical</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH9536</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">err </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s5">2</span><span class="s3">, </span><span class="s5">10</span><span class="s3">))</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">err</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s1">err</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">vstack</span><span class="s3">([</span><span class="s1">i</span><span class="s3">.</span><span class="s1">vertices</span><span class="s3">[:, </span><span class="s5">1</span><span class="s3">] </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">collections</span><span class="s3">[</span><span class="s5">1</span><span class="s3">].</span><span class="s1">get_paths</span><span class="s3">()])</span>
        <span class="s1">expected </span><span class="s3">= (</span><span class="s1">err</span><span class="s3">.</span><span class="s1">T </span><span class="s3">* </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([-</span><span class="s5">1</span><span class="s3">, </span><span class="s5">1</span><span class="s3">])) + </span><span class="s1">s</span><span class="s3">.</span><span class="s1">to_numpy</span><span class="s3">().</span><span class="s1">reshape</span><span class="s3">(-</span><span class="s5">1</span><span class="s3">, </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">msg </span><span class="s3">= (</span>
            <span class="s4">&quot;Asymmetrical error bars should be provided &quot;</span>
            <span class="s4">f&quot;with the shape </span><span class="s2">\\</span><span class="s4">(2, </span><span class="s2">{</span><span class="s1">len</span><span class="s3">(</span><span class="s1">s</span><span class="s3">)</span><span class="s2">}\\</span><span class="s4">)&quot;</span>
        <span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">((</span><span class="s5">2</span><span class="s3">, </span><span class="s5">11</span><span class="s3">)))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;yerr&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">10</span><span class="s3">))),</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">10</span><span class="s3">)),</span>
            <span class="s1">list</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">10</span><span class="s3">))),</span>
            <span class="s1">DataFrame</span><span class="s3">(</span>
                <span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">10</span><span class="s3">, </span><span class="s5">2</span><span class="s3">))),</span>
                <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">],</span>
            <span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">yerr</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s5">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s5">1</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_yerr_0</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">s_err </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">10</span><span class="s3">))</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s1">s_err</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s5">1</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s5">0</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;yerr&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s5">12</span><span class="s3">))),</span>
            <span class="s1">DataFrame</span><span class="s3">(</span>
                <span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s5">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s5">12</span><span class="s3">, </span><span class="s5">2</span><span class="s3">))),</span>
                <span class="s1">columns</span><span class="s3">=[</span><span class="s4">&quot;x&quot;</span><span class="s3">, </span><span class="s4">&quot;y&quot;</span><span class="s3">],</span>
            <span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_ts</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">):</span>
        <span class="s6"># test time series plotting</span>
        <span class="s1">ix </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s4">&quot;1/1/2001&quot;</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;ME&quot;</span><span class="s3">)</span>
        <span class="s1">ts </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">12</span><span class="s3">), </span><span class="s1">index</span><span class="s3">=</span><span class="s1">ix</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">yerr</span><span class="s3">.</span><span class="s1">index </span><span class="s3">= </span><span class="s1">ix</span>

        <span class="s1">ax </span><span class="s3">= </span><span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">yerr</span><span class="s3">)</span>
        <span class="s1">_check_has_errorbars</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">, </span><span class="s1">xerr</span><span class="s3">=</span><span class="s5">0</span><span class="s3">, </span><span class="s1">yerr</span><span class="s3">=</span><span class="s5">1</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_invalid_yerr_shape</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s6"># check incorrect lengths and types</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">external_error_raised</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">):</span>
            <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">11</span><span class="s3">))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_errorbar_plot_invalid_yerr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">s_err </span><span class="s3">= [</span><span class="s4">&quot;zzz&quot;</span><span class="s3">] * </span><span class="s5">10</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">external_error_raised</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">):</span>
            <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">yerr</span><span class="s3">=</span><span class="s1">s_err</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_table_true</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">series</span><span class="s3">):</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">table</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_table_self</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">series</span><span class="s3">):</span>
        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">, </span><span class="s1">table</span><span class="s3">=</span><span class="s1">series</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_series_grid_settings</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># Make sure plot defaults to rcParams['axes.grid'] setting, GH 9792</span>
        <span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy&quot;</span><span class="s3">)</span>
        <span class="s1">_check_grid_settings</span><span class="s3">(</span>
            <span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">]),</span>
            <span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_series_kinds </span><span class="s3">+ </span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">PlotAccessor</span><span class="s3">.</span><span class="s1">_common_kinds</span><span class="s3">,</span>
        <span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;c&quot;</span><span class="s3">, [</span><span class="s4">&quot;r&quot;</span><span class="s3">, </span><span class="s4">&quot;red&quot;</span><span class="s3">, </span><span class="s4">&quot;green&quot;</span><span class="s3">, </span><span class="s4">&quot;#FF0000&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_standard_colors</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">c</span><span class="s3">):</span>
        <span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">_matplotlib</span><span class="s3">.</span><span class="s1">style </span><span class="s2">import </span><span class="s1">get_standard_colors</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s1">c</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">]</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=[</span><span class="s1">c</span><span class="s3">])</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">]</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s5">3</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s1">c</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">] * </span><span class="s5">3</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s5">3</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=[</span><span class="s1">c</span><span class="s3">])</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">] * </span><span class="s5">3</span>

    <span class="s2">def </span><span class="s1">test_standard_colors_all</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">from </span><span class="s1">matplotlib </span><span class="s2">import </span><span class="s1">colors</span>

        <span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">plotting</span><span class="s3">.</span><span class="s1">_matplotlib</span><span class="s3">.</span><span class="s1">style </span><span class="s2">import </span><span class="s1">get_standard_colors</span>

        <span class="s6"># multiple colors like mediumaquamarine</span>
        <span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">colors</span><span class="s3">.</span><span class="s1">cnames</span><span class="s3">:</span>
            <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s1">num_colors</span><span class="s3">=</span><span class="s5">1</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s1">c</span><span class="s3">)</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">]</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s1">num_colors</span><span class="s3">=</span><span class="s5">1</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=[</span><span class="s1">c</span><span class="s3">])</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">]</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s1">num_colors</span><span class="s3">=</span><span class="s5">3</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s1">c</span><span class="s3">)</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">] * </span><span class="s5">3</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s1">num_colors</span><span class="s3">=</span><span class="s5">3</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=[</span><span class="s1">c</span><span class="s3">])</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">] * </span><span class="s5">3</span>

        <span class="s6"># single letter colors like k</span>
        <span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">colors</span><span class="s3">.</span><span class="s1">ColorConverter</span><span class="s3">.</span><span class="s1">colors</span><span class="s3">:</span>
            <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s1">num_colors</span><span class="s3">=</span><span class="s5">1</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s1">c</span><span class="s3">)</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">]</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s1">num_colors</span><span class="s3">=</span><span class="s5">1</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=[</span><span class="s1">c</span><span class="s3">])</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">]</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s1">num_colors</span><span class="s3">=</span><span class="s5">3</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s1">c</span><span class="s3">)</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">] * </span><span class="s5">3</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s1">get_standard_colors</span><span class="s3">(</span><span class="s1">num_colors</span><span class="s3">=</span><span class="s5">3</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=[</span><span class="s1">c</span><span class="s3">])</span>
            <span class="s2">assert </span><span class="s1">result </span><span class="s3">== [</span><span class="s1">c</span><span class="s3">] * </span><span class="s5">3</span>

    <span class="s2">def </span><span class="s1">test_series_plot_color_kwargs</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH1890</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">12</span><span class="s3">) + </span><span class="s5">1</span><span class="s3">).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">color</span><span class="s3">=</span><span class="s4">&quot;green&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">(), </span><span class="s1">linecolors</span><span class="s3">=[</span><span class="s4">&quot;green&quot;</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_time_series_plot_color_kwargs</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># #1890</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">12</span><span class="s3">) + </span><span class="s5">1</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">12</span><span class="s3">)).</span><span class="s1">plot</span><span class="s3">(</span>
            <span class="s1">color</span><span class="s3">=</span><span class="s4">&quot;green&quot;</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span>
        <span class="s3">)</span>
        <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">(), </span><span class="s1">linecolors</span><span class="s3">=[</span><span class="s4">&quot;green&quot;</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_time_series_plot_color_with_empty_kwargs</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">import </span><span class="s1">matplotlib </span><span class="s2">as </span><span class="s1">mpl</span>

        <span class="s1">def_colors </span><span class="s3">= </span><span class="s1">_unpack_cycler</span><span class="s3">(</span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">rcParams</span><span class="s3">)</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">12</span><span class="s3">)</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s5">13</span><span class="s3">), </span><span class="s1">index</span><span class="s3">=</span><span class="s1">index</span><span class="s3">)</span>

        <span class="s1">ncolors </span><span class="s3">= </span><span class="s5">3</span>

        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s1">ncolors</span><span class="s3">):</span>
            <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">(), </span><span class="s1">linecolors</span><span class="s3">=</span><span class="s1">def_colors</span><span class="s3">[:</span><span class="s1">ncolors</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_xticklabels</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH11529</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">), </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">f&quot;P</span><span class="s2">{</span><span class="s1">i</span><span class="s2">:</span><span class="s4">02d</span><span class="s2">}</span><span class="s4">&quot; </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s5">10</span><span class="s3">)])</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">xticks</span><span class="s3">=[</span><span class="s5">0</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">5</span><span class="s3">, </span><span class="s5">9</span><span class="s3">], </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= [</span><span class="s4">f&quot;P</span><span class="s2">{</span><span class="s1">i</span><span class="s2">:</span><span class="s4">02d</span><span class="s2">}</span><span class="s4">&quot; </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s3">[</span><span class="s5">0</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">5</span><span class="s3">, </span><span class="s5">9</span><span class="s3">]]</span>
        <span class="s1">_check_text_labels</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticklabels</span><span class="s3">(), </span><span class="s1">exp</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_xtick_barPlot</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH28172</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">10</span><span class="s3">), </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">f&quot;P</span><span class="s2">{</span><span class="s1">i</span><span class="s2">:</span><span class="s4">02d</span><span class="s2">}</span><span class="s4">&quot; </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s5">10</span><span class="s3">)])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">xticks</span><span class="s3">=</span><span class="s1">range</span><span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">11</span><span class="s3">, </span><span class="s5">2</span><span class="s3">))</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">list</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">0</span><span class="s3">, </span><span class="s5">11</span><span class="s3">, </span><span class="s5">2</span><span class="s3">)))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">exp</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xticks</span><span class="s3">())</span>

    <span class="s2">def </span><span class="s1">test_custom_business_day_freq</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH7222</span>
        <span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">tseries</span><span class="s3">.</span><span class="s1">offsets </span><span class="s2">import </span><span class="s1">CustomBusinessDay</span>

        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">range</span><span class="s3">(</span><span class="s5">100</span><span class="s3">, </span><span class="s5">121</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">bdate_range</span><span class="s3">(</span>
                <span class="s1">start</span><span class="s3">=</span><span class="s4">&quot;2014-05-01&quot;</span><span class="s3">,</span>
                <span class="s1">end</span><span class="s3">=</span><span class="s4">&quot;2014-06-01&quot;</span><span class="s3">,</span>
                <span class="s1">freq</span><span class="s3">=</span><span class="s1">CustomBusinessDay</span><span class="s3">(</span><span class="s1">holidays</span><span class="s3">=[</span><span class="s4">&quot;2014-05-26&quot;</span><span class="s3">]),</span>
            <span class="s3">),</span>
        <span class="s3">)</span>

        <span class="s1">_check_plot_works</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">xfail</span><span class="s3">(</span>
        <span class="s1">reason</span><span class="s3">=</span><span class="s4">&quot;GH#24426, see also &quot;</span>
        <span class="s4">&quot;github.com/pandas-dev/pandas/commit/&quot;</span>
        <span class="s4">&quot;ef1bd69fa42bbed5d09dd17f08c44fc8bfc2b685#r61470674&quot;</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_plot_accessor_updates_on_inplace</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">4</span><span class="s3">])</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">before </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">.</span><span class="s1">get_ticklocs</span><span class="s3">()</span>

        <span class="s1">ser</span><span class="s3">.</span><span class="s1">drop</span><span class="s3">([</span><span class="s5">0</span><span class="s3">, </span><span class="s5">1</span><span class="s3">], </span><span class="s1">inplace</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">after </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">xaxis</span><span class="s3">.</span><span class="s1">get_ticklocs</span><span class="s3">()</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_numpy_array_equal</span><span class="s3">(</span><span class="s1">before</span><span class="s3">, </span><span class="s1">after</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;area&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_plot_xlim_for_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">):</span>
        <span class="s6"># test if xlim is also correctly plotted in Series for line and area</span>
        <span class="s6"># GH 27686</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">])</span>
        <span class="s1">_</span><span class="s3">, </span><span class="s1">ax </span><span class="s3">= </span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">subplots</span><span class="s3">()</span>
        <span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">ax</span><span class="s3">=</span><span class="s1">ax</span><span class="s3">)</span>
        <span class="s1">xlims </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">()</span>

        <span class="s2">assert </span><span class="s1">xlims</span><span class="s3">[</span><span class="s5">0</span><span class="s3">] &lt; </span><span class="s5">0</span>
        <span class="s2">assert </span><span class="s1">xlims</span><span class="s3">[</span><span class="s5">1</span><span class="s3">] &gt; </span><span class="s5">1</span>

    <span class="s2">def </span><span class="s1">test_plot_no_rows</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH 27758</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">int</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">df</span><span class="s3">.</span><span class="s1">empty</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()) == </span><span class="s5">1</span>
        <span class="s1">line </span><span class="s3">= </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">()[</span><span class="s5">0</span><span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">line</span><span class="s3">.</span><span class="s1">get_xdata</span><span class="s3">()) == </span><span class="s5">0</span>
        <span class="s2">assert </span><span class="s1">len</span><span class="s3">(</span><span class="s1">line</span><span class="s3">.</span><span class="s1">get_ydata</span><span class="s3">()) == </span><span class="s5">0</span>

    <span class="s2">def </span><span class="s1">test_plot_no_numeric_data</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">&quot;a&quot;</span><span class="s3">, </span><span class="s4">&quot;b&quot;</span><span class="s3">, </span><span class="s4">&quot;c&quot;</span><span class="s3">])</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;no numeric data to plot&quot;</span><span class="s3">):</span>
            <span class="s1">df</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;data, index&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">4</span><span class="s3">], [</span><span class="s5">3</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">1</span><span class="s3">, </span><span class="s5">0</span><span class="s3">]),</span>
            <span class="s3">([</span><span class="s5">10</span><span class="s3">, </span><span class="s5">50</span><span class="s3">, </span><span class="s5">20</span><span class="s3">, </span><span class="s5">30</span><span class="s3">], [</span><span class="s5">1910</span><span class="s3">, </span><span class="s5">1920</span><span class="s3">, </span><span class="s5">1980</span><span class="s3">, </span><span class="s5">1950</span><span class="s3">]),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_plot_order</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">index</span><span class="s3">):</span>
        <span class="s6"># GH38865 Verify plot order of a Series</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">data</span><span class="s3">=</span><span class="s1">data</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">index</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s4">&quot;bar&quot;</span><span class="s3">)</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">tolist</span><span class="s3">()</span>
        <span class="s1">result </span><span class="s3">= [</span>
            <span class="s1">patch</span><span class="s3">.</span><span class="s1">get_bbox</span><span class="s3">().</span><span class="s1">ymax</span>
            <span class="s2">for </span><span class="s1">patch </span><span class="s2">in </span><span class="s1">sorted</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">patches</span><span class="s3">, </span><span class="s1">key</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">patch</span><span class="s3">: </span><span class="s1">patch</span><span class="s3">.</span><span class="s1">get_bbox</span><span class="s3">().</span><span class="s1">xmax</span><span class="s3">)</span>
        <span class="s3">]</span>
        <span class="s2">assert </span><span class="s1">expected </span><span class="s3">== </span><span class="s1">result</span>

    <span class="s2">def </span><span class="s1">test_style_single_ok</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">style</span><span class="s3">=</span><span class="s4">&quot;s&quot;</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s4">&quot;C3&quot;</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">lines</span><span class="s3">[</span><span class="s5">0</span><span class="s3">].</span><span class="s1">get_color</span><span class="s3">() == </span><span class="s4">&quot;C3&quot;</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;index_name, old_label, new_label&quot;</span><span class="s3">,</span>
        <span class="s3">[(</span><span class="s2">None</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s4">&quot;new&quot;</span><span class="s3">), (</span><span class="s4">&quot;old&quot;</span><span class="s3">, </span><span class="s4">&quot;old&quot;</span><span class="s3">, </span><span class="s4">&quot;new&quot;</span><span class="s3">), (</span><span class="s2">None</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">)],</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;kind&quot;</span><span class="s3">, [</span><span class="s4">&quot;line&quot;</span><span class="s3">, </span><span class="s4">&quot;area&quot;</span><span class="s3">, </span><span class="s4">&quot;bar&quot;</span><span class="s3">, </span><span class="s4">&quot;barh&quot;</span><span class="s3">, </span><span class="s4">&quot;hist&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_xlabel_ylabel_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">kind</span><span class="s3">, </span><span class="s1">index_name</span><span class="s3">, </span><span class="s1">old_label</span><span class="s3">, </span><span class="s1">new_label</span><span class="s3">):</span>
        <span class="s6"># GH 9093</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">4</span><span class="s3">])</span>
        <span class="s1">ser</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">name </span><span class="s3">= </span><span class="s1">index_name</span>

        <span class="s6"># default is the ylabel is not shown and xlabel is index name (reverse for barh)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">kind </span><span class="s3">== </span><span class="s4">&quot;barh&quot;</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">() == </span><span class="s4">&quot;&quot;</span>
            <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s1">old_label</span>
        <span class="s2">elif </span><span class="s1">kind </span><span class="s3">== </span><span class="s4">&quot;hist&quot;</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">() == </span><span class="s4">&quot;&quot;</span>
            <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s4">&quot;Frequency&quot;</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s4">&quot;&quot;</span>
            <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">() == </span><span class="s1">old_label</span>

        <span class="s6"># old xlabel will be overridden and assigned ylabel will be used as ylabel</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">kind</span><span class="s3">=</span><span class="s1">kind</span><span class="s3">, </span><span class="s1">ylabel</span><span class="s3">=</span><span class="s1">new_label</span><span class="s3">, </span><span class="s1">xlabel</span><span class="s3">=</span><span class="s1">new_label</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_ylabel</span><span class="s3">() == </span><span class="s1">new_label</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlabel</span><span class="s3">() == </span><span class="s1">new_label</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s4">&quot;index&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">timedelta_range</span><span class="s3">(</span><span class="s1">start</span><span class="s3">=</span><span class="s5">0</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">2</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">=</span><span class="s4">&quot;D&quot;</span><span class="s3">),</span>
            <span class="s3">[</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s5">1</span><span class="s3">), </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s5">2</span><span class="s3">)],</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_timedelta_index</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">index</span><span class="s3">):</span>
        <span class="s6"># GH37454</span>
        <span class="s1">xlims </span><span class="s3">= (</span><span class="s5">3</span><span class="s3">, </span><span class="s5">1</span><span class="s3">)</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=</span><span class="s1">index</span><span class="s3">).</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">xlim</span><span class="s3">=(</span><span class="s1">xlims</span><span class="s3">))</span>
        <span class="s2">assert </span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_xlim</span><span class="s3">() == (</span><span class="s5">3</span><span class="s3">, </span><span class="s5">1</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_series_none_color</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># GH51953</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">])</span>
        <span class="s1">ax </span><span class="s3">= </span><span class="s1">series</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">(</span><span class="s1">color</span><span class="s3">=</span><span class="s2">None</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">_unpack_cycler</span><span class="s3">(</span><span class="s1">mpl</span><span class="s3">.</span><span class="s1">pyplot</span><span class="s3">.</span><span class="s1">rcParams</span><span class="s3">)[:</span><span class="s5">1</span><span class="s3">]</span>
        <span class="s1">_check_colors</span><span class="s3">(</span><span class="s1">ax</span><span class="s3">.</span><span class="s1">get_lines</span><span class="s3">(), </span><span class="s1">linecolors</span><span class="s3">=</span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">slow</span>
    <span class="s2">def </span><span class="s1">test_plot_no_warning</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">):</span>
        <span class="s6"># GH 55138</span>
        <span class="s6"># TODO(3.0): this can be removed once Period[B] deprecation is enforced</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s2">False</span><span class="s3">):</span>
            <span class="s1">_ </span><span class="s3">= </span><span class="s1">ts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">()</span>
</pre>
</body>
</html>