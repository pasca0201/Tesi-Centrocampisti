<html>
<head>
<title>test_randomstate.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #7a7e85;}
.s6 { color: #5f826b; font-style: italic;}
.s7 { color: #a5c261;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_randomstate.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">hashlib</span>
<span class="s0">import </span><span class="s1">pickle</span>
<span class="s0">import </span><span class="s1">sys</span>
<span class="s0">import </span><span class="s1">warnings</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>
<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">testing </span><span class="s0">import </span><span class="s2">(</span>
        <span class="s1">assert_</span><span class="s2">, </span><span class="s1">assert_raises</span><span class="s2">, </span><span class="s1">assert_equal</span><span class="s2">, </span><span class="s1">assert_warns</span><span class="s2">,</span>
        <span class="s1">assert_no_warnings</span><span class="s2">, </span><span class="s1">assert_array_equal</span><span class="s2">, </span><span class="s1">assert_array_almost_equal</span><span class="s2">,</span>
        <span class="s1">suppress_warnings</span><span class="s2">, </span><span class="s1">IS_WASM</span>
        <span class="s2">)</span>

<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">random </span><span class="s0">import </span><span class="s1">MT19937</span><span class="s2">, </span><span class="s1">PCG64</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">random</span>

<span class="s1">INT_FUNCS </span><span class="s2">= {</span><span class="s3">'binomial'</span><span class="s2">: (</span><span class="s4">100.0</span><span class="s2">, </span><span class="s4">0.6</span><span class="s2">),</span>
             <span class="s3">'geometric'</span><span class="s2">: (</span><span class="s4">.5</span><span class="s2">,),</span>
             <span class="s3">'hypergeometric'</span><span class="s2">: (</span><span class="s4">20</span><span class="s2">, </span><span class="s4">20</span><span class="s2">, </span><span class="s4">10</span><span class="s2">),</span>
             <span class="s3">'logseries'</span><span class="s2">: (</span><span class="s4">.5</span><span class="s2">,),</span>
             <span class="s3">'multinomial'</span><span class="s2">: (</span><span class="s4">20</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">(</span><span class="s4">6</span><span class="s2">) / </span><span class="s4">6.0</span><span class="s2">),</span>
             <span class="s3">'negative_binomial'</span><span class="s2">: (</span><span class="s4">100</span><span class="s2">, </span><span class="s4">.5</span><span class="s2">),</span>
             <span class="s3">'poisson'</span><span class="s2">: (</span><span class="s4">10.0</span><span class="s2">,),</span>
             <span class="s3">'zipf'</span><span class="s2">: (</span><span class="s4">2</span><span class="s2">,),</span>
             <span class="s2">}</span>

<span class="s0">if </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">long</span><span class="s2">).</span><span class="s1">max </span><span class="s2">&lt; </span><span class="s4">2</span><span class="s2">**</span><span class="s4">32</span><span class="s2">:</span>
    <span class="s5"># Windows and some 32-bit platforms, e.g., ARM</span>
    <span class="s1">INT_FUNC_HASHES </span><span class="s2">= {</span><span class="s3">'binomial'</span><span class="s2">: </span><span class="s3">'2fbead005fc63942decb5326d36a1f32fe2c9d32c904ee61e46866b88447c263'</span><span class="s2">,</span>
                       <span class="s3">'logseries'</span><span class="s2">: </span><span class="s3">'23ead5dcde35d4cfd4ef2c105e4c3d43304b45dc1b1444b7823b9ee4fa144ebb'</span><span class="s2">,</span>
                       <span class="s3">'geometric'</span><span class="s2">: </span><span class="s3">'0d764db64f5c3bad48c8c33551c13b4d07a1e7b470f77629bef6c985cac76fcf'</span><span class="s2">,</span>
                       <span class="s3">'hypergeometric'</span><span class="s2">: </span><span class="s3">'7b59bf2f1691626c5815cdcd9a49e1dd68697251d4521575219e4d2a1b8b2c67'</span><span class="s2">,</span>
                       <span class="s3">'multinomial'</span><span class="s2">: </span><span class="s3">'d754fa5b92943a38ec07630de92362dd2e02c43577fc147417dc5b9db94ccdd3'</span><span class="s2">,</span>
                       <span class="s3">'negative_binomial'</span><span class="s2">: </span><span class="s3">'8eb216f7cb2a63cf55605422845caaff002fddc64a7dc8b2d45acd477a49e824'</span><span class="s2">,</span>
                       <span class="s3">'poisson'</span><span class="s2">: </span><span class="s3">'70c891d76104013ebd6f6bcf30d403a9074b886ff62e4e6b8eb605bf1a4673b7'</span><span class="s2">,</span>
                       <span class="s3">'zipf'</span><span class="s2">: </span><span class="s3">'01f074f97517cd5d21747148ac6ca4074dde7fcb7acbaec0a936606fecacd93f'</span><span class="s2">,</span>
                       <span class="s2">}</span>
<span class="s0">else</span><span class="s2">:</span>
    <span class="s1">INT_FUNC_HASHES </span><span class="s2">= {</span><span class="s3">'binomial'</span><span class="s2">: </span><span class="s3">'8626dd9d052cb608e93d8868de0a7b347258b199493871a1dc56e2a26cacb112'</span><span class="s2">,</span>
                       <span class="s3">'geometric'</span><span class="s2">: </span><span class="s3">'8edd53d272e49c4fc8fbbe6c7d08d563d62e482921f3131d0a0e068af30f0db9'</span><span class="s2">,</span>
                       <span class="s3">'hypergeometric'</span><span class="s2">: </span><span class="s3">'83496cc4281c77b786c9b7ad88b74d42e01603a55c60577ebab81c3ba8d45657'</span><span class="s2">,</span>
                       <span class="s3">'logseries'</span><span class="s2">: </span><span class="s3">'65878a38747c176bc00e930ebafebb69d4e1e16cd3a704e264ea8f5e24f548db'</span><span class="s2">,</span>
                       <span class="s3">'multinomial'</span><span class="s2">: </span><span class="s3">'7a984ae6dca26fd25374479e118b22f55db0aedccd5a0f2584ceada33db98605'</span><span class="s2">,</span>
                       <span class="s3">'negative_binomial'</span><span class="s2">: </span><span class="s3">'d636d968e6a24ae92ab52fe11c46ac45b0897e98714426764e820a7d77602a61'</span><span class="s2">,</span>
                       <span class="s3">'poisson'</span><span class="s2">: </span><span class="s3">'956552176f77e7c9cb20d0118fc9cf690be488d790ed4b4c4747b965e61b0bb4'</span><span class="s2">,</span>
                       <span class="s3">'zipf'</span><span class="s2">: </span><span class="s3">'f84ba7feffda41e606e20b28dfc0f1ea9964a74574513d4a4cbc98433a8bfa45'</span><span class="s2">,</span>
                       <span class="s2">}</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span><span class="s2">(</span><span class="s1">scope</span><span class="s2">=</span><span class="s3">'module'</span><span class="s2">, </span><span class="s1">params</span><span class="s2">=</span><span class="s1">INT_FUNCS</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">int_func</span><span class="s2">(</span><span class="s1">request</span><span class="s2">):</span>
    <span class="s0">return </span><span class="s2">(</span><span class="s1">request</span><span class="s2">.</span><span class="s1">param</span><span class="s2">, </span><span class="s1">INT_FUNCS</span><span class="s2">[</span><span class="s1">request</span><span class="s2">.</span><span class="s1">param</span><span class="s2">],</span>
            <span class="s1">INT_FUNC_HASHES</span><span class="s2">[</span><span class="s1">request</span><span class="s2">.</span><span class="s1">param</span><span class="s2">])</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span>
<span class="s0">def </span><span class="s1">restore_singleton_bitgen</span><span class="s2">():</span>
    <span class="s6">&quot;&quot;&quot;Ensures that the singleton bitgen is restored after a test&quot;&quot;&quot;</span>
    <span class="s1">orig_bitgen </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">get_bit_generator</span><span class="s2">()</span>
    <span class="s0">yield</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">set_bit_generator</span><span class="s2">(</span><span class="s1">orig_bitgen</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">assert_mt19937_state_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">):</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">[</span><span class="s3">'bit_generator'</span><span class="s2">], </span><span class="s1">b</span><span class="s2">[</span><span class="s3">'bit_generator'</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'key'</span><span class="s2">], </span><span class="s1">b</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'key'</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'pos'</span><span class="s2">], </span><span class="s1">b</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'pos'</span><span class="s2">])</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">[</span><span class="s3">'has_gauss'</span><span class="s2">], </span><span class="s1">b</span><span class="s2">[</span><span class="s3">'has_gauss'</span><span class="s2">])</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">[</span><span class="s3">'gauss'</span><span class="s2">], </span><span class="s1">b</span><span class="s2">[</span><span class="s3">'gauss'</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestSeed</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_scalar</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">684</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s4">4294967295</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">419</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">10</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">468</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">10</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">468</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">([</span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">973</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">([</span><span class="s4">4294967295</span><span class="s2">])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">265</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_scalar</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, -</span><span class="s4">0.5</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [-</span><span class="s4">0.5</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [-</span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [</span><span class="s4">4294967296</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">4294967296</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, -</span><span class="s4">2</span><span class="s2">, </span><span class="s4">4294967296</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_invalid_array_shape</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-9832</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([],</span>
                                                               <span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">],</span>
                                                       <span class="s2">[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]])</span>

    <span class="s0">def </span><span class="s1">test_cannot_seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">rs </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">PCG64</span><span class="s2">(</span><span class="s4">0</span><span class="s2">))</span>
        <span class="s0">with </span><span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">):</span>
            <span class="s1">rs</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_initialization</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">, </span><span class="s1">MT19937</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestBinomial</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_n_zero</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Tests the corner case of n == 0 for the binomial distribution.</span>
        <span class="s5"># binomial(0, p) should be zero for any p in [0, 1].</span>
        <span class="s5"># This test addresses issue #3480.</span>
        <span class="s1">zeros </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">'int'</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">p </span><span class="s0">in </span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">.5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]:</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">p</span><span class="s2">) == </span><span class="s4">0</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s1">zeros</span><span class="s2">, </span><span class="s1">p</span><span class="s2">), </span><span class="s1">zeros</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_p_is_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Issue #4571.</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestMultinomial</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, [</span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">0.8</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_zero_probability</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, [</span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">0.8</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_int_negative_interval</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(-</span><span class="s4">5 </span><span class="s2">&lt;= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(-</span><span class="s4">5</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">) &lt; -</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(-</span><span class="s4">5</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(-</span><span class="s4">5 </span><span class="s2">&lt;= </span><span class="s1">x</span><span class="s2">))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">x </span><span class="s2">&lt; -</span><span class="s4">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_size</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-3173</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))).</span><span class="s1">shape</span><span class="s2">,</span>
                     <span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">,</span>
                      <span class="s1">float</span><span class="s2">(</span><span class="s4">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_invalid_prob</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s4">100</span><span class="s2">, [</span><span class="s4">1.1</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s4">100</span><span class="s2">, [-</span><span class="s4">.1</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_invalid_n</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, [</span><span class="s4">0.8</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_p_non_contiguous</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">15.</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">/= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">sum</span><span class="s2">(</span><span class="s1">p</span><span class="s2">[</span><span class="s4">1</span><span class="s2">::</span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">pvals </span><span class="s2">= </span><span class="s1">p</span><span class="s2">[</span><span class="s4">1</span><span class="s2">::</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">1432985819</span><span class="s2">)</span>
        <span class="s1">non_contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">=</span><span class="s1">pvals</span><span class="s2">)</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">1432985819</span><span class="s2">)</span>
        <span class="s1">contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ascontiguousarray</span><span class="s2">(</span><span class="s1">pvals</span><span class="s2">))</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">non_contig</span><span class="s2">, </span><span class="s1">contig</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_multinomial_pvals_float32</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">9.9e-01</span><span class="s2">, </span><span class="s4">9.9e-01</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">,</span>
                      <span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s1">pvals </span><span class="s2">= </span><span class="s1">x </span><span class="s2">/ </span><span class="s1">x</span><span class="s2">.</span><span class="s1">sum</span><span class="s2">()</span>
        <span class="s1">match </span><span class="s2">= </span><span class="s3">r&quot;[\w\s]*pvals array is cast to 64-bit floating&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">match</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_multinomial_n_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Non-index integer types should gracefully truncate floats</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100.5</span><span class="s2">, [</span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">0.8</span><span class="s2">])</span>

<span class="s0">class </span><span class="s1">TestSetState</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s4">1234567890</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">old </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">tomaxint</span><span class="s2">(</span><span class="s4">16</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">)</span>
        <span class="s1">new </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">tomaxint</span><span class="s2">(</span><span class="s4">16</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">old </span><span class="s2">== </span><span class="s1">new</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Make sure the cached every-other-Gaussian is reset.</span>
        <span class="s1">old </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">)</span>
        <span class="s1">new </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">old </span><span class="s2">== </span><span class="s1">new</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset_in_media_res</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># When the state is saved with a cached Gaussian, make sure the</span>
        <span class="s5"># cached Gaussian is restored.</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">()</span>
        <span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">()</span>
        <span class="s1">old </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">state</span><span class="s2">)</span>
        <span class="s1">new </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">old </span><span class="s2">== </span><span class="s1">new</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_backwards_compatibility</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Make sure we can accept old state tuples that do not have the</span>
        <span class="s5"># cached Gaussian value.</span>
        <span class="s1">old_state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[:-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">x1 </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">16</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">old_state</span><span class="s2">)</span>
        <span class="s1">x2 </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">16</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">)</span>
        <span class="s1">x3 </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">16</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">x1 </span><span class="s2">== </span><span class="s1">x2</span><span class="s2">))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">x1 </span><span class="s2">== </span><span class="s1">x3</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Ensure that the negative binomial results take floating point</span>
        <span class="s5"># arguments without truncation.</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">(</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_get_state_warning</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">rs </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">PCG64</span><span class="s2">())</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">)</span>
            <span class="s1">state </span><span class="s2">= </span><span class="s1">rs</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">()</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s4">1</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">dict</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">state</span><span class="s2">[</span><span class="s3">'bit_generator'</span><span class="s2">] == </span><span class="s3">'PCG64'</span>

    <span class="s0">def </span><span class="s1">test_invalid_legacy_state_setting</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">()</span>
        <span class="s1">new_state </span><span class="s2">= (</span><span class="s3">'Unknown'</span><span class="s2">, ) + </span><span class="s1">state</span><span class="s2">[</span><span class="s4">1</span><span class="s2">:]</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">, </span><span class="s1">new_state</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">,</span>
                      <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">new_state</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">))</span>
        <span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">(</span><span class="s1">legacy</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">del </span><span class="s1">state</span><span class="s2">[</span><span class="s3">'bit_generator'</span><span class="s2">]</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">, </span><span class="s1">state</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_pickle</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">random_sample</span><span class="s2">(</span><span class="s4">100</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">()</span>
        <span class="s1">pickled </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">(</span><span class="s1">legacy</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">pickled</span><span class="s2">[</span><span class="s3">'has_gauss'</span><span class="s2">], </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">rs_unpick </span><span class="s2">= </span><span class="s1">pickle</span><span class="s2">.</span><span class="s1">loads</span><span class="s2">(</span><span class="s1">pickle</span><span class="s2">.</span><span class="s1">dumps</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">))</span>
        <span class="s1">unpickled </span><span class="s2">= </span><span class="s1">rs_unpick</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">(</span><span class="s1">legacy</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_mt19937_state_equal</span><span class="s2">(</span><span class="s1">pickled</span><span class="s2">, </span><span class="s1">unpickled</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_state_setting</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">attr_state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">__getstate__</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">__setstate__</span><span class="s2">(</span><span class="s1">attr_state</span><span class="s2">)</span>
        <span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">(</span><span class="s1">legacy</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_mt19937_state_equal</span><span class="s2">(</span><span class="s1">attr_state</span><span class="s2">, </span><span class="s1">state</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_repr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">assert </span><span class="s1">repr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">random_state</span><span class="s2">).</span><span class="s1">startswith</span><span class="s2">(</span><span class="s3">'RandomState(MT19937)'</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestRandint</span><span class="s2">:</span>

    <span class="s1">rfunc </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span>

    <span class="s5"># valid integer/boolean types</span>
    <span class="s1">itype </span><span class="s2">= [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int16</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint16</span><span class="s2">,</span>
             <span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">]</span>

    <span class="s0">def </span><span class="s1">test_unsupported_type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">float</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_bounds_checking</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">lbnd </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rng_zero_and_extremes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>

            <span class="s1">tgt </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

            <span class="s1">tgt </span><span class="s2">= </span><span class="s1">lbnd</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

            <span class="s1">tgt </span><span class="s2">= (</span><span class="s1">lbnd </span><span class="s2">+ </span><span class="s1">ubnd</span><span class="s2">)//</span><span class="s4">2</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_full_range</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Test for ticket #1690</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>

            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s0">raise </span><span class="s1">AssertionError</span><span class="s2">(</span><span class="s3">&quot;No error should have been raised, &quot;</span>
                                     <span class="s3">&quot;but one was with the following &quot;</span>
                                     <span class="s3">&quot;message:</span><span class="s0">\n\n</span><span class="s3">%s&quot; </span><span class="s2">% </span><span class="s1">str</span><span class="s2">(</span><span class="s1">e</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_in_bounds_fuzz</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Don't use fixed seed</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">()</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">[</span><span class="s4">1</span><span class="s2">:]:</span>
            <span class="s0">for </span><span class="s1">ubnd </span><span class="s0">in </span><span class="s2">[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">16</span><span class="s2">]:</span>
                <span class="s1">vals </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">2</span><span class="s2">**</span><span class="s4">16</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
                <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">max</span><span class="s2">() &lt; </span><span class="s1">ubnd</span><span class="s2">)</span>
                <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">min</span><span class="s2">() &gt;= </span><span class="s4">2</span><span class="s2">)</span>

        <span class="s1">vals </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">2</span><span class="s2">**</span><span class="s4">16</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">max</span><span class="s2">() &lt; </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">min</span><span class="s2">() &gt;= </span><span class="s4">0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># We use a sha256 hash of generated sequences of 1000 samples</span>
        <span class="s5"># in the range [0, 6) for all but bool, where the range</span>
        <span class="s5"># is [0, 2). Hashes are for little endian numbers.</span>
        <span class="s1">tgt </span><span class="s2">= {</span><span class="s3">'bool'</span><span class="s2">: </span><span class="s3">'509aea74d792fb931784c4b0135392c65aec64beee12b0cc167548a2c3d31e71'</span><span class="s2">,</span>
               <span class="s3">'int16'</span><span class="s2">: </span><span class="s3">'7b07f1a920e46f6d0fe02314155a2330bcfd7635e708da50e536c5ebb631a7d4'</span><span class="s2">,</span>
               <span class="s3">'int32'</span><span class="s2">: </span><span class="s3">'e577bfed6c935de944424667e3da285012e741892dcb7051a8f1ce68ab05c92f'</span><span class="s2">,</span>
               <span class="s3">'int64'</span><span class="s2">: </span><span class="s3">'0fbead0b06759df2cfb55e43148822d4a1ff953c7eb19a5b08445a63bb64fa9e'</span><span class="s2">,</span>
               <span class="s3">'int8'</span><span class="s2">: </span><span class="s3">'001aac3a5acb935a9b186cbe14a1ca064b8bb2dd0b045d48abeacf74d0203404'</span><span class="s2">,</span>
               <span class="s3">'uint16'</span><span class="s2">: </span><span class="s3">'7b07f1a920e46f6d0fe02314155a2330bcfd7635e708da50e536c5ebb631a7d4'</span><span class="s2">,</span>
               <span class="s3">'uint32'</span><span class="s2">: </span><span class="s3">'e577bfed6c935de944424667e3da285012e741892dcb7051a8f1ce68ab05c92f'</span><span class="s2">,</span>
               <span class="s3">'uint64'</span><span class="s2">: </span><span class="s3">'0fbead0b06759df2cfb55e43148822d4a1ff953c7eb19a5b08445a63bb64fa9e'</span><span class="s2">,</span>
               <span class="s3">'uint8'</span><span class="s2">: </span><span class="s3">'001aac3a5acb935a9b186cbe14a1ca064b8bb2dd0b045d48abeacf74d0203404'</span><span class="s2">}</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">[</span><span class="s4">1</span><span class="s2">:]:</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">)</span>

            <span class="s5"># view as little endian for hash</span>
            <span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">== </span><span class="s3">'little'</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">byteswap</span><span class="s2">()</span>

            <span class="s1">res </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">val</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">)).</span><span class="s1">hexdigest</span><span class="s2">()</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">name</span><span class="s2">] == </span><span class="s1">res</span><span class="s2">)</span>

        <span class="s5"># bools do not depend on endianness</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">)</span>
        <span class="s1">val </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">bool</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">)</span>
        <span class="s1">res </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">val</span><span class="s2">).</span><span class="s1">hexdigest</span><span class="s2">()</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">bool</span><span class="s2">).</span><span class="s1">name</span><span class="s2">] == </span><span class="s1">res</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">skipif</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max </span><span class="s2">&lt; </span><span class="s4">2</span><span class="s2">**</span><span class="s4">32</span><span class="s2">,</span>
                        <span class="s1">reason</span><span class="s2">=</span><span class="s3">'Cannot test with 32-bit C long'</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_repeatability_32bit_boundary_broadcasting</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">3992670689</span><span class="s2">, </span><span class="s4">2438360420</span><span class="s2">, </span><span class="s4">2557845020</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">4107320065</span><span class="s2">, </span><span class="s4">4142558326</span><span class="s2">, </span><span class="s4">3216529513</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1605979228</span><span class="s2">, </span><span class="s4">2807061240</span><span class="s2">,  </span><span class="s4">665605495</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">3211410639</span><span class="s2">, </span><span class="s4">4128781000</span><span class="s2">,  </span><span class="s4">457175120</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1712592594</span><span class="s2">, </span><span class="s4">1282922662</span><span class="s2">, </span><span class="s4">3081439808</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">3997822960</span><span class="s2">, </span><span class="s4">2008322436</span><span class="s2">, </span><span class="s4">1563495165</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">1398375547</span><span class="s2">, </span><span class="s4">4269260146</span><span class="s2">,  </span><span class="s4">115316740</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">3414372578</span><span class="s2">, </span><span class="s4">3437564012</span><span class="s2">, </span><span class="s4">2112038651</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">3572980305</span><span class="s2">, </span><span class="s4">2260248732</span><span class="s2">, </span><span class="s4">3908238631</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">2561372503</span><span class="s2">,  </span><span class="s4">223155946</span><span class="s2">, </span><span class="s4">3127879445</span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">441282060</span><span class="s2">, </span><span class="s4">3514786552</span><span class="s2">, </span><span class="s4">2148440361</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1629275283</span><span class="s2">, </span><span class="s4">3479737011</span><span class="s2">, </span><span class="s4">3003195987</span><span class="s2">]],</span>
                            <span class="s2">[[ </span><span class="s4">412181688</span><span class="s2">,  </span><span class="s4">940383289</span><span class="s2">, </span><span class="s4">3047321305</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">2978368172</span><span class="s2">,  </span><span class="s4">764731833</span><span class="s2">, </span><span class="s4">2282559898</span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">105711276</span><span class="s2">,  </span><span class="s4">720447391</span><span class="s2">, </span><span class="s4">3596512484</span><span class="s2">]]])</span>
        <span class="s0">for </span><span class="s1">size </span><span class="s0">in </span><span class="s2">[</span><span class="s0">None</span><span class="s2">, (</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)]:</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">12345</span><span class="s2">)</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([[-</span><span class="s4">1</span><span class="s2">], [</span><span class="s4">0</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">]], [</span><span class="s4">2</span><span class="s2">**</span><span class="s4">32 </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">32</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">32 </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">],</span>
                           <span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">desired </span><span class="s0">if </span><span class="s1">size </span><span class="s0">is not None else </span><span class="s1">desired</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_int64_uint64_corner_case</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># When stored in Numpy arrays, `lbnd` is casted</span>
        <span class="s5"># as np.int64, and `ubnd` is casted as np.uint64.</span>
        <span class="s5"># Checking whether `lbnd` &gt;= `ubnd` used to be</span>
        <span class="s5"># done solely via direct comparison, which is incorrect</span>
        <span class="s5"># because when Numpy tries to compare both numbers,</span>
        <span class="s5"># it casts both to np.float64 because there is</span>
        <span class="s5"># no integer superset of np.int64 and np.uint64. However,</span>
        <span class="s5"># `ubnd` is too large to be represented in np.float64,</span>
        <span class="s5"># causing it be round down to np.iinfo(np.int64).max,</span>
        <span class="s5"># leading to a ValueError because `lbnd` now equals</span>
        <span class="s5"># the new `ubnd`.</span>

        <span class="s1">dt </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span>
        <span class="s1">tgt </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">lbnd </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>
        <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">)</span>

        <span class="s5"># None of these function calls should</span>
        <span class="s5"># generate a ValueError now.</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">tgt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_respect_dtype_singleton</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>

            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">))</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s2">(</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">int</span><span class="s2">):</span>
            <span class="s5"># The legacy random generation forces the use of &quot;long&quot; on this</span>
            <span class="s5"># branch even when the input is `int` and the default dtype</span>
            <span class="s5"># for int changed (dtype=int is also the functions default)</span>
            <span class="s1">op_dtype </span><span class="s2">= </span><span class="s3">&quot;long&quot; </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">int </span><span class="s0">else </span><span class="s3">&quot;bool&quot;</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">op_dtype</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">op_dtype</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>

            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">, </span><span class="s3">'dtype'</span><span class="s2">))</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">type</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">), </span><span class="s1">dt</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestRandomDist</span><span class="s2">:</span>
    <span class="s5"># Make sure the random distribution returns the correct value for a</span>
    <span class="s5"># given seed</span>

    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s4">1234567890</span>

    <span class="s0">def </span><span class="s1">test_rand</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rand</span><span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.61879477158567997</span><span class="s2">, </span><span class="s4">0.59162362775974664</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.88868358904449662</span><span class="s2">, </span><span class="s4">0.89165480011560816</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.4575674820298663</span><span class="s2">, </span><span class="s4">0.7781880808593471</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rand_singleton</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rand</span><span class="s2">()</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s4">0.61879477158567997</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_randn</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randn</span><span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.34016345771863121</span><span class="s2">, </span><span class="s4">1.73759122771936081</span><span class="s2">],</span>
                           <span class="s2">[</span><span class="s4">1.498988344300628</span><span class="s2">, -</span><span class="s4">0.2286433324536169</span><span class="s2">],</span>
                           <span class="s2">[</span><span class="s4">2.031033998682787</span><span class="s2">, </span><span class="s4">2.17032494605655257</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randn</span><span class="s2">()</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_randint</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(-</span><span class="s4">99</span><span class="s2">, </span><span class="s4">99</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">31</span><span class="s2">, </span><span class="s4">3</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">52</span><span class="s2">, </span><span class="s4">41</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">48</span><span class="s2">, -</span><span class="s4">66</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random_integers</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">)</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">(-</span><span class="s4">99</span><span class="s2">, </span><span class="s4">99</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">31</span><span class="s2">, </span><span class="s4">3</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">52</span><span class="s2">, </span><span class="s4">41</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">48</span><span class="s2">, -</span><span class="s4">66</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">)</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">(</span><span class="s4">198</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired </span><span class="s2">+ </span><span class="s4">100</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_tomaxint</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">rs </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">rs</span><span class="s2">.</span><span class="s1">tomaxint</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s0">if </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">long</span><span class="s2">).</span><span class="s1">max </span><span class="s2">== </span><span class="s4">2147483647</span><span class="s2">:</span>
            <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1328851649</span><span class="s2">,  </span><span class="s4">731237375</span><span class="s2">],</span>
                                <span class="s2">[</span><span class="s4">1270502067</span><span class="s2">,  </span><span class="s4">320041495</span><span class="s2">],</span>
                                <span class="s2">[</span><span class="s4">1908433478</span><span class="s2">,  </span><span class="s4">499156889</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">5707374374421908479</span><span class="s2">, </span><span class="s4">5456764827585442327</span><span class="s2">],</span>
                                <span class="s2">[</span><span class="s4">8196659375100692377</span><span class="s2">, </span><span class="s4">8224063923314595285</span><span class="s2">],</span>
                                <span class="s2">[</span><span class="s4">4220315081820346526</span><span class="s2">, </span><span class="s4">7177518203184491332</span><span class="s2">]],</span>
                               <span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>

        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">rs</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">rs</span><span class="s2">.</span><span class="s1">tomaxint</span><span class="s2">()</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_random_integers_max_int</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Tests whether random_integers can generate the</span>
        <span class="s5"># maximum allowed Python int that can be converted</span>
        <span class="s5"># into a C long. Previous implementations of this</span>
        <span class="s5"># method have thrown an OverflowError when attempting</span>
        <span class="s5"># to generate this integer.</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">)</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">,</span>
                                            <span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s4">1</span><span class="s2">)</span>

        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">)</span>
            <span class="s1">typer </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">type</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">(</span><span class="s1">typer</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">),</span>
                                            <span class="s1">typer</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">))</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random_integers_deprecated</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">warnings</span><span class="s2">.</span><span class="s1">catch_warnings</span><span class="s2">():</span>
            <span class="s1">warnings</span><span class="s2">.</span><span class="s1">simplefilter</span><span class="s2">(</span><span class="s3">&quot;error&quot;</span><span class="s2">, </span><span class="s1">DeprecationWarning</span><span class="s2">)</span>

            <span class="s5"># DeprecationWarning raised with high == None</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">,</span>
                          <span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">,</span>
                          <span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>

            <span class="s5"># DeprecationWarning raised with high != None</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">DeprecationWarning</span><span class="s2">,</span>
                          <span class="s1">random</span><span class="s2">.</span><span class="s1">random_integers</span><span class="s2">,</span>
                          <span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random_sample</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_sample</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.61879477158567997</span><span class="s2">, </span><span class="s4">0.59162362775974664</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.88868358904449662</span><span class="s2">, </span><span class="s4">0.89165480011560816</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.4575674820298663</span><span class="s2">, </span><span class="s4">0.7781880808593471</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random_sample</span><span class="s2">()</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_replace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_replace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">])</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_noreplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_noreplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">])</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_noninteger</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s3">'a'</span><span class="s2">, </span><span class="s3">'b'</span><span class="s2">, </span><span class="s3">'c'</span><span class="s2">, </span><span class="s3">'d'</span><span class="s2">], </span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">'c'</span><span class="s2">, </span><span class="s3">'d'</span><span class="s2">, </span><span class="s3">'c'</span><span class="s2">, </span><span class="s3">'d'</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, </span><span class="s4">3.</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]], </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [], </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">], </span><span class="s4">3</span><span class="s2">,</span>
                      <span class="s1">p</span><span class="s2">=[[</span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">], [</span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">1.1</span><span class="s2">, -</span><span class="s4">0.1</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s4">4</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s5"># gh-13087</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], -</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], (-</span><span class="s4">1</span><span class="s2">,), </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], (-</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">), </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s4">2</span><span class="s2">,</span>
                      <span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_choice_return_shape</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">]</span>
        <span class="s5"># Check scalar</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s0">None</span><span class="s2">], </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) </span><span class="s0">is None</span><span class="s2">)</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">arr</span><span class="s2">[</span><span class="s4">0</span><span class="s2">] = </span><span class="s1">a</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">arr</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) </span><span class="s0">is </span><span class="s1">a</span><span class="s2">)</span>

        <span class="s5"># Check 0-d array</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">tuple</span><span class="s2">()</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s0">None</span><span class="s2">], </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">ndim </span><span class="s2">== </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">arr</span><span class="s2">[</span><span class="s4">0</span><span class="s2">] = </span><span class="s1">a</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">arr</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">item</span><span class="s2">() </span><span class="s0">is </span><span class="s1">a</span><span class="s2">)</span>

        <span class="s5"># Check multi dimensional array</span>
        <span class="s1">s </span><span class="s2">= (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">]</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">6</span><span class="s2">), </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>

        <span class="s5"># Check zero-size</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, -</span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">0</span><span class="s2">,)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s3">'a'</span><span class="s2">, </span><span class="s3">'b'</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">,</span>
                     <span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">, [], </span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nan_probabilities</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">42</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">]</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_p_non_contiguous</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">(</span><span class="s4">10</span><span class="s2">) / </span><span class="s4">5</span>
        <span class="s1">p</span><span class="s2">[</span><span class="s4">1</span><span class="s2">::</span><span class="s4">2</span><span class="s2">] = </span><span class="s4">3.0</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">non_contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">[::</span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ascontiguousarray</span><span class="s2">(</span><span class="s1">p</span><span class="s2">[::</span><span class="s4">2</span><span class="s2">]))</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">non_contig</span><span class="s2">, </span><span class="s1">contig</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_bytes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">bytes</span><span class="s2">(</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s7">b'</span><span class="s0">\x82</span><span class="s7">Ui</span><span class="s0">\x9e\xff\x97</span><span class="s7">+Wf</span><span class="s0">\xa5</span><span class="s7">'</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Test lists, arrays (of various dtypes), and multidimensional versions</span>
        <span class="s5"># of both, c-contiguous or not:</span>
        <span class="s0">for </span><span class="s1">conv </span><span class="s0">in </span><span class="s2">[</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([]),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x</span><span class="s2">,</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">complex64</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: [(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([[</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">] </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">]),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">vstack</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">x</span><span class="s2">]).</span><span class="s1">T</span><span class="s2">,</span>
                     <span class="s5"># gh-11442</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: (</span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                                           <span class="s2">[(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">int</span><span class="s2">), (</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">int</span><span class="s2">)])</span>
                                <span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">recarray</span><span class="s2">)),</span>
                     <span class="s5"># gh-4270</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                                          <span class="s2">[(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">object</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">,)),</span>
                                           <span class="s2">(</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">,))])]:</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
            <span class="s1">alist </span><span class="s2">= </span><span class="s1">conv</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">alist</span><span class="s2">)</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">alist</span>
            <span class="s1">desired </span><span class="s2">= </span><span class="s1">conv</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_masked</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-3263</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ma</span><span class="s2">.</span><span class="s1">masked_values</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">reshape</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">20</span><span class="s2">), (</span><span class="s4">5</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)) % </span><span class="s4">3 </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">b </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ma</span><span class="s2">.</span><span class="s1">masked_values</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">20</span><span class="s2">) % </span><span class="s4">3 </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">a_orig </span><span class="s2">= </span><span class="s1">a</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">b_orig </span><span class="s2">= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">50</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">a</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span>
                <span class="s1">sorted</span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">a</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]), </span><span class="s1">sorted</span><span class="s2">(</span><span class="s1">a_orig</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">a_orig</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]))</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">b</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span>
                <span class="s1">sorted</span><span class="s2">(</span><span class="s1">b</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">b</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]), </span><span class="s1">sorted</span><span class="s2">(</span><span class="s1">b_orig</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">b_orig</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]))</span>

        <span class="s0">def </span><span class="s1">test_shuffle_invalid_objects</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s4">3</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_permutation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">alist </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">(</span><span class="s1">alist</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">arr_2d </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">atleast_2d</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]).</span><span class="s1">T</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">(</span><span class="s1">arr_2d</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">atleast_2d</span><span class="s2">(</span><span class="s1">desired</span><span class="s2">).</span><span class="s1">T</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">bad_x_str </span><span class="s2">= </span><span class="s3">&quot;abcd&quot;</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">IndexError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">, </span><span class="s1">bad_x_str</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">bad_x_float </span><span class="s2">= </span><span class="s4">1.2</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">IndexError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">, </span><span class="s1">bad_x_float</span><span class="s2">)</span>

        <span class="s1">integer_val </span><span class="s2">= </span><span class="s4">10</span>
        <span class="s1">desired </span><span class="s2">= [</span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">(</span><span class="s1">integer_val</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_beta</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span><span class="s2">(</span><span class="s4">.1</span><span class="s2">, </span><span class="s4">.9</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s4">1.45341850513746058e-02</span><span class="s2">, </span><span class="s4">5.31297615662868145e-04</span><span class="s2">],</span>
                 <span class="s2">[</span><span class="s4">1.85366619058432324e-06</span><span class="s2">, </span><span class="s4">4.19214516800110563e-03</span><span class="s2">],</span>
                 <span class="s2">[</span><span class="s4">1.58405155108498093e-04</span><span class="s2">, </span><span class="s4">1.26252891949397652e-04</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s4">100.123</span><span class="s2">, </span><span class="s4">.456</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">37</span><span class="s2">, </span><span class="s4">43</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">42</span><span class="s2">, </span><span class="s4">48</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">46</span><span class="s2">, </span><span class="s4">45</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s4">100.123</span><span class="s2">, </span><span class="s4">.456</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s4">37</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">(</span><span class="s4">50</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">63.87858175501090585</span><span class="s2">, </span><span class="s4">68.68407748911370447</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">65.77116116901505904</span><span class="s2">, </span><span class="s4">47.09686762438974483</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">72.3828403199695174</span><span class="s2">, </span><span class="s4">74.18408615260374006</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">51.72840233779265162</span><span class="s2">, </span><span class="s4">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">0.54539444573611562</span><span class="s2">, </span><span class="s4">0.45460555426388438</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">0.62345816822039413</span><span class="s2">, </span><span class="s4">0.37654183177960598</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">0.55206000085785778</span><span class="s2">, </span><span class="s4">0.44793999914214233</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">0.58964023305154301</span><span class="s2">, </span><span class="s4">0.41035976694845688</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">0.59266909280647828</span><span class="s2">, </span><span class="s4">0.40733090719352177</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">0.56974431743975207</span><span class="s2">, </span><span class="s4">0.43025568256024799</span><span class="s2">]]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>
        <span class="s1">bad_alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">5.4e-01</span><span class="s2">, -</span><span class="s4">1.0e-16</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">bad_alpha</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">51.72840233779265162</span><span class="s2">, </span><span class="s4">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_size</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-3173</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">51.72840233779265162</span><span class="s2">, </span><span class="s4">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">float</span><span class="s2">(</span><span class="s4">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_bad_alpha</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-2089</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">5.4e-01</span><span class="s2">, -</span><span class="s4">1.0e-16</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">alpha</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_alpha_non_contiguous</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">51.72840233779265162</span><span class="s2">, -</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">a</span><span class="s2">[::</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">non_contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ascontiguousarray</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">),</span>
                                  <span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">non_contig</span><span class="s2">, </span><span class="s1">contig</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s4">1.1234</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.08342649775011624</span><span class="s2">, </span><span class="s4">1.00607889924557314</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2.46628830085216721</span><span class="s2">, </span><span class="s4">2.49668106809923884</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.68717433461363442</span><span class="s2">, </span><span class="s4">1.69175666993575979</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_exponential_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">f</span><span class="s2">(</span><span class="s4">12</span><span class="s2">, </span><span class="s4">77</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.21975394418575878</span><span class="s2">, </span><span class="s4">1.75135759791559775</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.44803115017146489</span><span class="s2">, </span><span class="s4">1.22108959480396262</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.02176975757740629</span><span class="s2">, </span><span class="s4">1.34431827623300415</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">24.60509188649287182</span><span class="s2">, </span><span class="s4">28.54993563207210627</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">26.13476110204064184</span><span class="s2">, </span><span class="s4">12.56988482927716078</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">31.71863275789960568</span><span class="s2">, </span><span class="s4">33.30143302795922011</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_geometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">(</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">8</span><span class="s2">, </span><span class="s4">7</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">17</span><span class="s2">, </span><span class="s4">17</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">12</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_geometric_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s4">1.1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, [</span><span class="s4">1.1</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, -</span><span class="s4">0.1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, [-</span><span class="s4">0.1</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.19591898743416816</span><span class="s2">, </span><span class="s4">0.34405539668096674</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">1.4492522252274278</span><span class="s2">, -</span><span class="s4">1.47374816298446865</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.10651090478803416</span><span class="s2">, -</span><span class="s4">0.69535848626236174</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">10.1</span><span class="s2">, </span><span class="s4">5.5</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">9</span><span class="s2">, </span><span class="s4">9</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s5"># Test nbad = 0</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">15</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">12</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">12</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s5"># Test ngood = 0</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.66599721112760157</span><span class="s2">, </span><span class="s4">0.52829452552221945</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3.12791959514407125</span><span class="s2">, </span><span class="s4">3.18202813572992005</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">0.05391065675859356</span><span class="s2">, </span><span class="s4">1.74901336242837324</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logistic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.09232835305011444</span><span class="s2">, </span><span class="s4">0.8648196662399954</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">4.27818590694950185</span><span class="s2">, </span><span class="s4">4.33897006346929714</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">0.21682183359214885</span><span class="s2">, </span><span class="s4">2.63373365386060332</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">16.50698631688883822</span><span class="s2">, </span><span class="s4">36.54846706092654784</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">22.67886599981281748</span><span class="s2">, </span><span class="s4">0.71617561058995771</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">65.72798501792723869</span><span class="s2">, </span><span class="s4">86.84341601437161273</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">sigma</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logseries</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">p</span><span class="s2">=</span><span class="s4">.923456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">6</span><span class="s2">, </span><span class="s4">17</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logseries_zero</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">assert </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s4">0</span><span class="s2">) == </span><span class="s4">1</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;value&quot;</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nextafter</span><span class="s2">(</span><span class="s4">0.</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">), </span><span class="s4">1.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">5.</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_logseries_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">value</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s3">&quot;ignore&quot;</span><span class="s2">):</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
                <span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">value</span><span class="s2">)</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
                <span class="s5"># contiguous path:</span>
                <span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s1">value</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">))</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
                <span class="s5"># non-contiguous path:</span>
                <span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s1">value</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)[::</span><span class="s4">2</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_multinomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">20</span><span class="s2">, [</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6.</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_multivariate_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">mean </span><span class="s2">= (</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">cov </span><span class="s2">= [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]]</span>
        <span class="s1">size </span><span class="s2">= (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">, </span><span class="s1">size</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">1.463620246718631</span><span class="s2">, </span><span class="s4">11.73759122771936</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1.622445133300628</span><span class="s2">, </span><span class="s4">9.771356667546383</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">2.154490787682787</span><span class="s2">, </span><span class="s4">12.170324946056553</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1.719909438201865</span><span class="s2">, </span><span class="s4">9.230548443648306</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">0.689515026297799</span><span class="s2">, </span><span class="s4">9.880729819607714</span><span class="s2">],</span>
                             <span class="s2">[-</span><span class="s4">0.023054015651998</span><span class="s2">, </span><span class="s4">9.201096623542879</span><span class="s2">]]])</span>

        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

        <span class="s5"># Check for default size, was raising deprecation warning</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.895289569463708</span><span class="s2">, </span><span class="s4">9.17180864067987</span><span class="s2">])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

        <span class="s5"># Check that non positive-semidefinite covariance warns with</span>
        <span class="s5"># RuntimeWarning</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">cov </span><span class="s2">= [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]]</span>
        <span class="s1">assert_warns</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">)</span>

        <span class="s5"># and that it doesn't warn with RuntimeWarning check_valid='ignore'</span>
        <span class="s1">assert_no_warnings</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                           <span class="s1">check_valid</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">)</span>

        <span class="s5"># and that it raises with RuntimeWarning check_valid='raises'</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                      <span class="s1">check_valid</span><span class="s2">=</span><span class="s3">'raise'</span><span class="s2">)</span>

        <span class="s1">cov </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">], [</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">)</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s4">0</span>

        <span class="s1">mu </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">cov </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">eye</span><span class="s2">(</span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                      <span class="s1">check_valid</span><span class="s2">=</span><span class="s3">'other'</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">,</span>
                      <span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)), </span><span class="s1">cov</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">,</span>
                      <span class="s1">mu</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">,</span>
                      <span class="s1">mu</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">eye</span><span class="s2">(</span><span class="s4">3</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">=</span><span class="s4">100</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s4">.12345</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">848</span><span class="s2">, </span><span class="s4">841</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">892</span><span class="s2">, </span><span class="s4">611</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">779</span><span class="s2">, </span><span class="s4">647</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">, </span><span class="s4">100</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">, </span><span class="s4">100</span><span class="s2">,</span>
                          <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">23.91905354498517511</span><span class="s2">, </span><span class="s4">13.35324692733826346</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">31.22452661329736401</span><span class="s2">, </span><span class="s4">16.60047399466177254</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">5.03461598262724586</span><span class="s2">, </span><span class="s4">17.94973089023519464</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s4">.5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s4">.2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.47145377828516666</span><span class="s2">,  </span><span class="s4">0.15052899268012659</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.00943803056963588</span><span class="s2">,  </span><span class="s4">1.02647251615666169</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.332334982684171</span><span class="s2">,  </span><span class="s4">0.15451287602753125</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">9.597154162763948</span><span class="s2">, </span><span class="s4">11.725484450296079</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">10.413711048138335</span><span class="s2">, </span><span class="s4">3.694475922923986</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">13.484222138963087</span><span class="s2">, </span><span class="s4">14.377255424602957</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s4">1</span><span class="s2">,</span>
                                     <span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.40598099674926669</span><span class="s2">, </span><span class="s4">0.34207973179285761</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3.57715069265772545</span><span class="s2">, </span><span class="s4">7.92632662577829805</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.43741599463544162</span><span class="s2">, </span><span class="s4">1.1774208752428319</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">2.80378370443726244</span><span class="s2">, </span><span class="s4">3.59863924443872163</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3.121433477601256</span><span class="s2">, -</span><span class="s4">0.33382987590723379</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">4.18552478636557357</span><span class="s2">, </span><span class="s4">4.46410668111310471</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_pareto</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s4">2.46852460439034849e+03</span><span class="s2">, </span><span class="s4">1.41286880810518346e+03</span><span class="s2">],</span>
                 <span class="s2">[</span><span class="s4">5.28287797029485181e+07</span><span class="s2">, </span><span class="s4">6.57720981047328785e+07</span><span class="s2">],</span>
                 <span class="s2">[</span><span class="s4">1.40840323350391515e+02</span><span class="s2">, </span><span class="s4">1.98390255135251704e+05</span><span class="s2">]])</span>
        <span class="s5"># For some reason on 32-bit x86 Ubuntu 12.10 the [1, 0] entry in this</span>
        <span class="s5"># matrix differs by 24 nulps. Discussion:</span>
        <span class="s5">#   https://mail.python.org/pipermail/numpy-discussion/2012-September/063801.html</span>
        <span class="s5"># Consensus is that this is probably some gcc quirk that affects</span>
        <span class="s5"># rounding but not in any important way, so we just use a looser</span>
        <span class="s5"># tolerance on this test:</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">testing</span><span class="s2">.</span><span class="s1">assert_array_almost_equal_nulp</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">nulp</span><span class="s2">=</span><span class="s4">30</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">(</span><span class="s1">lam</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">lambig </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">lamneg </span><span class="s2">= -</span><span class="s4">1</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">lamneg</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, [</span><span class="s1">lamneg</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">lambig</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, [</span><span class="s1">lambig</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_power</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.02048932883240791</span><span class="s2">, </span><span class="s4">0.01424192241128213</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.38446073748535298</span><span class="s2">, </span><span class="s4">0.39499689943484395</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.00177699707563439</span><span class="s2">, </span><span class="s4">0.13115505880863756</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">13.8882496494248393</span><span class="s2">, </span><span class="s4">13.383318339044731</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">20.95413364294492098</span><span class="s2">, </span><span class="s4">21.08285015800712614</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">11.06066537006854311</span><span class="s2">, </span><span class="s4">17.35468505778271009</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_cauchy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_cauchy</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.77127660196445336</span><span class="s2">, -</span><span class="s4">6.55601161955910605</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.93582023391158309</span><span class="s2">, -</span><span class="s4">2.07479293013759447</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">4.74601644297011926</span><span class="s2">, </span><span class="s4">0.18338989290760804</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_exponential</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.96441739162374596</span><span class="s2">, </span><span class="s4">0.89556604882105506</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2.1953785836319808</span><span class="s2">, </span><span class="s4">2.22243285392490542</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.6116915921431676</span><span class="s2">, </span><span class="s4">1.50592546727413201</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">5.50841531318455058</span><span class="s2">, </span><span class="s4">6.62953470301903103</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">5.93988484943779227</span><span class="s2">, </span><span class="s4">2.31044849402133989</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">7.54838614231317084</span><span class="s2">, </span><span class="s4">8.012756093271868</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.34016345771863121</span><span class="s2">, </span><span class="s4">1.73759122771936081</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.498988344300628</span><span class="s2">, -</span><span class="s4">0.2286433324536169</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2.031033998682787</span><span class="s2">, </span><span class="s4">2.17032494605655257</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_randn_singleton</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">randn</span><span class="s2">()</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s4">1.34016345771863121</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.97140611862659965</span><span class="s2">, -</span><span class="s4">0.08830486548450577</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.36311143689505321</span><span class="s2">, -</span><span class="s4">0.55317463909867071</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">0.18473749069684214</span><span class="s2">, </span><span class="s4">0.61181537341755321</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_triangular</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">=</span><span class="s4">5.12</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">=</span><span class="s4">10.23</span><span class="s2">, </span><span class="s1">right</span><span class="s2">=</span><span class="s4">20.34</span><span class="s2">,</span>
                                   <span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">12.68117178949215784</span><span class="s2">, </span><span class="s4">12.4129206149193152</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">16.20131377335158263</span><span class="s2">, </span><span class="s4">16.25692138747600524</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">11.20400690911820263</span><span class="s2">, </span><span class="s4">14.4978144835829923</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_uniform</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">high</span><span class="s2">=</span><span class="s4">10.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">6.99097932346268003</span><span class="s2">, </span><span class="s4">6.73801597444323974</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">9.50364421400426274</span><span class="s2">, </span><span class="s4">9.53130618907631089</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">5.48995325769805476</span><span class="s2">, </span><span class="s4">8.47493103280052118</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_uniform_range_bounds</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">fmin </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">finfo</span><span class="s2">(</span><span class="s3">'float'</span><span class="s2">).</span><span class="s1">min</span>
        <span class="s1">fmax </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">finfo</span><span class="s2">(</span><span class="s3">'float'</span><span class="s2">).</span><span class="s1">max</span>

        <span class="s1">func </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, </span><span class="s1">fmin</span><span class="s2">, </span><span class="s1">fmax</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, [-</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">], [</span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, [</span><span class="s4">0</span><span class="s2">], [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">])</span>

        <span class="s5"># (fmax / 1e17) - fmin is within range, so this should not throw</span>
        <span class="s5"># account for i386 extended precision DBL_MAX / 1e17 + DBL_MAX &gt;</span>
        <span class="s5"># DBL_MAX by increasing fmin a bit</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nextafter</span><span class="s2">(</span><span class="s1">fmin</span><span class="s2">, </span><span class="s4">1</span><span class="s2">), </span><span class="s1">high</span><span class="s2">=</span><span class="s1">fmax </span><span class="s2">/ </span><span class="s4">1e17</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_scalar_exception_propagation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Tests that exceptions are correctly propagated in distributions</span>
        <span class="s5"># when called with objects that throw exceptions when converted to</span>
        <span class="s5"># scalars.</span>
        <span class="s5">#</span>
        <span class="s5"># Regression test for gh: 8865</span>

        <span class="s0">class </span><span class="s1">ThrowingFloat</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ndarray</span><span class="s2">):</span>
            <span class="s0">def </span><span class="s1">__float__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_float </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s4">1.0</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">ThrowingFloat</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">, </span><span class="s1">throwing_float</span><span class="s2">,</span>
                      <span class="s1">throwing_float</span><span class="s2">)</span>

        <span class="s0">class </span><span class="s1">ThrowingInteger</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ndarray</span><span class="s2">):</span>
            <span class="s0">def </span><span class="s1">__int__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_int </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s4">1</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">ThrowingInteger</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">throwing_int</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s4">1.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">2.28567572673902042</span><span class="s2">, </span><span class="s4">2.89163838442285037</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.38198375564286025</span><span class="s2">, </span><span class="s4">2.57638023113890746</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.19153771588353052</span><span class="s2">, </span><span class="s4">1.83509849681825354</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises_small</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># check infinite loop, gh-4720</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">r </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s4">0.</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s4">1.1e-8</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">10</span><span class="s2">**</span><span class="s4">6</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isfinite</span><span class="s2">(</span><span class="s1">r</span><span class="s2">).</span><span class="s1">all</span><span class="s2">())</span>

    <span class="s0">def </span><span class="s1">test_vonmises_large</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># guard against changes in RandomState when Generator is fixed</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s4">0.</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s4">1e7</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">4.634253748521111e-04</span><span class="s2">,</span>
                            <span class="s4">3.558873596114509e-04</span><span class="s2">,</span>
                            <span class="s2">-</span><span class="s4">2.337119622577433e-04</span><span class="s2">])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">8</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">r </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s4">0.</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">r</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_wald</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">1.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">3.82935265715889983</span><span class="s2">, </span><span class="s4">5.13125249184285526</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.35045403618358717</span><span class="s2">, </span><span class="s4">1.50832396872003538</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.24124319895843183</span><span class="s2">, </span><span class="s4">0.22031101461955038</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.97097342648766727</span><span class="s2">, </span><span class="s4">0.91422896443565516</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.89517770034962929</span><span class="s2">, </span><span class="s4">1.91414357960479564</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.67057783752390987</span><span class="s2">, </span><span class="s4">1.39494046635066793</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">12</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s4">12</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">, </span><span class="s1">a</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_zipf</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">66</span><span class="s2">, </span><span class="s4">29</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">13</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestBroadcast</span><span class="s2">:</span>
    <span class="s5"># tests that functions that broadcast behave</span>
    <span class="s5"># correctly when presented with non-scalar arguments</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s4">123456789</span>

    <span class="s0">def </span><span class="s1">set_seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_uniform</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">low </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">high </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">uniform </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.53283302478975902</span><span class="s2">,</span>
                            <span class="s4">0.53413660089041659</span><span class="s2">,</span>
                            <span class="s4">0.50955303552646702</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">high</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">, </span><span class="s1">high </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">normal </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2.2129019979039612</span><span class="s2">,</span>
                            <span class="s4">2.1283977976520019</span><span class="s2">,</span>
                            <span class="s4">1.8417114045748335</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">normal</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">normal</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_beta</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">b </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_b </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">beta </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.19843558305989056</span><span class="s2">,</span>
                            <span class="s4">0.075230336409423643</span><span class="s2">,</span>
                            <span class="s4">0.24976865978980844</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">beta</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">b</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">b</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_b</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">beta</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">bad_a</span><span class="s2">, </span><span class="s1">b </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">bad_b </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">exponential </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.76106853658845242</span><span class="s2">,</span>
                            <span class="s4">0.76386282278691653</span><span class="s2">,</span>
                            <span class="s4">0.71243813125891797</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">shape </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_shape </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">std_gamma </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.76106853658845242</span><span class="s2">,</span>
                            <span class="s4">0.76386282278691653</span><span class="s2">,</span>
                            <span class="s4">0.71243813125891797</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">std_gamma</span><span class="s2">(</span><span class="s1">shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">std_gamma</span><span class="s2">, </span><span class="s1">bad_shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">shape </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_shape </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">gamma </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.5221370731769048</span><span class="s2">,</span>
                            <span class="s4">1.5277256455738331</span><span class="s2">,</span>
                            <span class="s4">1.4248762625178359</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">bad_shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">bad_shape</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dfnum </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">dfden </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_dfnum </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_dfden </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">f </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">f</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.80038951638264799</span><span class="s2">,</span>
                            <span class="s4">0.86768719635363512</span><span class="s2">,</span>
                            <span class="s4">2.7251095168386801</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">f</span><span class="s2">(</span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">bad_dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dfnum </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">dfden </span><span class="s2">= [</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">nonc </span><span class="s2">= [</span><span class="s4">4</span><span class="s2">]</span>
        <span class="s1">bad_dfnum </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">bad_dfden </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_nonc </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">nonc_f </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">9.1393943263705211</span><span class="s2">,</span>
                            <span class="s4">13.025456344595602</span><span class="s2">,</span>
                            <span class="s4">8.8018098359100545</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s4">3</span><span class="s2">)))</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">bad_nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_small_df</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">6.869638627492048</span><span class="s2">, </span><span class="s4">0.785880199263955</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s4">0.9</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">chisquare </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.57022801133088286</span><span class="s2">,</span>
                            <span class="s4">0.51947702108840776</span><span class="s2">,</span>
                            <span class="s4">0.1320969254923558</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">chisquare</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">chisquare</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">nonc </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_nonc </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">nonc_chi </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">9.0015599467913763</span><span class="s2">,</span>
                            <span class="s4">4.5804135049718742</span><span class="s2">,</span>
                            <span class="s4">6.0872302432834564</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_chi</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_chi</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">bad_df</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">df</span><span class="s2">, </span><span class="s1">bad_nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">t </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">3.0702872575217643</span><span class="s2">,</span>
                            <span class="s4">5.8560725167361607</span><span class="s2">,</span>
                            <span class="s4">1.0274791436474273</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">t</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">t</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mu </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">kappa </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_kappa </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">vonmises </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2.9883443664201312</span><span class="s2">,</span>
                            <span class="s2">-</span><span class="s4">2.7064099483995943</span><span class="s2">,</span>
                            <span class="s2">-</span><span class="s4">1.8672476700665914</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">mu </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_kappa</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">kappa </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">, </span><span class="s1">bad_kappa </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_pareto</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">pareto </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.1405622680198362</span><span class="s2">,</span>
                            <span class="s4">1.1465519762044529</span><span class="s2">,</span>
                            <span class="s4">1.0389564467453547</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">pareto</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">pareto</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">weibull </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.76106853658845242</span><span class="s2">,</span>
                            <span class="s4">0.76386282278691653</span><span class="s2">,</span>
                            <span class="s4">0.71243813125891797</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">weibull</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_power</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">power </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.53283302478975902</span><span class="s2">,</span>
                            <span class="s4">0.53413660089041659</span><span class="s2">,</span>
                            <span class="s4">0.50955303552646702</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">power</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">power</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">laplace </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.067921356028507157</span><span class="s2">,</span>
                            <span class="s4">0.070715642226971326</span><span class="s2">,</span>
                            <span class="s4">0.019290950698972624</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">gumbel </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.2730318639556768</span><span class="s2">,</span>
                            <span class="s4">0.26936705726291116</span><span class="s2">,</span>
                            <span class="s4">0.33906220393037939</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logistic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">logistic </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.13152135837586171</span><span class="s2">,</span>
                            <span class="s4">0.13675915696285773</span><span class="s2">,</span>
                            <span class="s4">0.038216792802833396</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logistic</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logistic</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">(</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">), </span><span class="s4">1.0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">sigma </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_sigma </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">lognormal </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">9.1422086044848427</span><span class="s2">,</span>
                            <span class="s4">8.4013952870126261</span><span class="s2">,</span>
                            <span class="s4">6.3073234116578671</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_sigma</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_sigma</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">sigma </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">bad_sigma </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">bad_sigma </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">rayleigh </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.2337491937897689</span><span class="s2">,</span>
                            <span class="s4">1.2360119924878694</span><span class="s2">,</span>
                            <span class="s4">1.1936818095781789</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">rayleigh</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_wald</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_mean </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">wald </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.11873681120271318</span><span class="s2">,</span>
                            <span class="s4">0.12450084820795027</span><span class="s2">,</span>
                            <span class="s4">0.9096122728408238</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s1">bad_mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">, </span><span class="s1">bad_mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">, </span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s1">bad_mean</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">wald</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_triangular</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">left </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">right </span><span class="s2">= [</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">mode </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_left_one </span><span class="s2">= [</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">bad_mode_one </span><span class="s2">= [</span><span class="s4">4</span><span class="s2">]</span>
        <span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two </span><span class="s2">= </span><span class="s1">right </span><span class="s2">* </span><span class="s4">2</span>
        <span class="s1">triangular </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2.03339048710429</span><span class="s2">,</span>
                            <span class="s4">2.0347400359389356</span><span class="s2">,</span>
                            <span class="s4">2.0095991069536208</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_mode_one</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_mode_two</span><span class="s2">,</span>
                      <span class="s1">right</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">mode </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one</span><span class="s2">, </span><span class="s1">mode </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left</span><span class="s2">, </span><span class="s1">bad_mode_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">,</span>
                      <span class="s1">right</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left</span><span class="s2">, </span><span class="s1">bad_mode_one</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two</span><span class="s2">,</span>
                      <span class="s1">right </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">, </span><span class="s4">20.</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">, </span><span class="s4">25.</span><span class="s2">, </span><span class="s4">20.</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">n </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">bad_n </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s4">1.5</span><span class="s2">]</span>
        <span class="s1">binom </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">binom</span><span class="s2">(</span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">bad_n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_p_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_p_two</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">binom</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">bad_n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">n </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">bad_n </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s4">1.5</span><span class="s2">]</span>
        <span class="s1">neg_binom </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">neg_binom</span><span class="s2">(</span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">bad_n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_p_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_p_two</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">neg_binom</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">bad_n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">max_lam </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">().</span><span class="s1">_poisson_lam_max</span>

        <span class="s1">lam </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_lam_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_lam_two </span><span class="s2">= [</span><span class="s1">max_lam </span><span class="s2">* </span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">poisson </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">poisson</span><span class="s2">(</span><span class="s1">lam </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">bad_lam_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">bad_lam_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_zipf</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">zipf </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">zipf</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">):</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_geometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s4">1.5</span><span class="s2">]</span>
        <span class="s1">geom </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">geom</span><span class="s2">(</span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">geom</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">geom</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">ngood </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">nbad </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">nsample </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_ngood </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_nbad </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_nsample_one </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">bad_nsample_two </span><span class="s2">= [</span><span class="s4">4</span><span class="s2">]</span>
        <span class="s1">hypergeom </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">hypergeom</span><span class="s2">(</span><span class="s1">ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">bad_ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_two</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">hypergeom</span><span class="s2">(</span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">bad_ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">bad_nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nsample_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nsample_two</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">hypergeom</span><span class="s2">(</span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">bad_ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">bad_nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">20</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">20</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">25</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logseries</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">logseries </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">set_seed</span><span class="s2">()</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logseries</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logseries</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">skipif</span><span class="s2">(</span><span class="s1">IS_WASM</span><span class="s2">, </span><span class="s1">reason</span><span class="s2">=</span><span class="s3">&quot;can't start thread&quot;</span><span class="s2">)</span>
<span class="s0">class </span><span class="s1">TestThread</span><span class="s2">:</span>
    <span class="s5"># make sure each state produces the same sequence even in threads</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seeds </span><span class="s2">= </span><span class="s1">range</span><span class="s2">(</span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">function</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">):</span>
        <span class="s0">from </span><span class="s1">threading </span><span class="s0">import </span><span class="s1">Thread</span>

        <span class="s1">out1 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">),) + </span><span class="s1">sz</span><span class="s2">)</span>
        <span class="s1">out2 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">),) + </span><span class="s1">sz</span><span class="s2">)</span>

        <span class="s5"># threaded generation</span>
        <span class="s1">t </span><span class="s2">= [</span><span class="s1">Thread</span><span class="s2">(</span><span class="s1">target</span><span class="s2">=</span><span class="s1">function</span><span class="s2">, </span><span class="s1">args</span><span class="s2">=(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">s</span><span class="s2">), </span><span class="s1">o</span><span class="s2">))</span>
             <span class="s0">for </span><span class="s1">s</span><span class="s2">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">, </span><span class="s1">out1</span><span class="s2">)]</span>
        <span class="s2">[</span><span class="s1">x</span><span class="s2">.</span><span class="s1">start</span><span class="s2">() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t</span><span class="s2">]</span>
        <span class="s2">[</span><span class="s1">x</span><span class="s2">.</span><span class="s1">join</span><span class="s2">() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t</span><span class="s2">]</span>

        <span class="s5"># the same serial</span>
        <span class="s0">for </span><span class="s1">s</span><span class="s2">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">):</span>
            <span class="s1">function</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">s</span><span class="s2">), </span><span class="s1">o</span><span class="s2">)</span>

        <span class="s5"># these platforms change x87 fpu precision mode in threads</span>
        <span class="s0">if </span><span class="s1">np</span><span class="s2">.</span><span class="s1">intp</span><span class="s2">().</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">itemsize </span><span class="s2">== </span><span class="s4">4 </span><span class="s0">and </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">platform </span><span class="s2">== </span><span class="s3">&quot;win32&quot;</span><span class="s2">:</span>
            <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">out1</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">out1</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">10000</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s4">10000</span><span class="s2">,))</span>

    <span class="s0">def </span><span class="s1">test_exp</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">((</span><span class="s4">100</span><span class="s2">, </span><span class="s4">1000</span><span class="s2">)))</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">1000</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_multinomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, [</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6.</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">10000</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s4">10000</span><span class="s2">, </span><span class="s4">6</span><span class="s2">))</span>


<span class="s5"># See Issue #4263</span>
<span class="s0">class </span><span class="s1">TestSingleEltArrayInput</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argOne </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argThree </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">4</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape </span><span class="s2">= (</span><span class="s4">1</span><span class="s2">,)</span>

    <span class="s0">def </span><span class="s1">test_one_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= (</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">)</span>

        <span class="s1">probfuncs </span><span class="s2">= (</span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs</span><span class="s2">:  </span><span class="s5"># p &lt; 1.0</span>
                <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.5</span><span class="s2">]))</span>

            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">)</span>

            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_two_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= (</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">f</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">)</span>

        <span class="s1">probfuncs </span><span class="s2">= (</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs</span><span class="s2">:  </span><span class="s5"># p &lt;= 1</span>
                <span class="s1">argTwo </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.5</span><span class="s2">])</span>

            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">argTwo </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">argTwo</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">argTwo</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">argTwo</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_three_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= [</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">]</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>


<span class="s5"># Ensure returned array dtype is correct for platform</span>
<span class="s0">def </span><span class="s1">test_integer_dtype</span><span class="s2">(</span><span class="s1">int_func</span><span class="s2">):</span>
    <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">123456789</span><span class="s2">)</span>
    <span class="s1">fname</span><span class="s2">, </span><span class="s1">args</span><span class="s2">, </span><span class="s1">sha256 </span><span class="s2">= </span><span class="s1">int_func</span>
    <span class="s1">f </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">random</span><span class="s2">, </span><span class="s1">fname</span><span class="s2">)</span>
    <span class="s1">actual </span><span class="s2">= </span><span class="s1">f</span><span class="s2">(*</span><span class="s1">args</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">2</span><span class="s2">)</span>
    <span class="s1">assert_</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">))</span>


<span class="s0">def </span><span class="s1">test_integer_repeat</span><span class="s2">(</span><span class="s1">int_func</span><span class="s2">):</span>
    <span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">123456789</span><span class="s2">)</span>
    <span class="s1">fname</span><span class="s2">, </span><span class="s1">args</span><span class="s2">, </span><span class="s1">sha256 </span><span class="s2">= </span><span class="s1">int_func</span>
    <span class="s1">f </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">random</span><span class="s2">, </span><span class="s1">fname</span><span class="s2">)</span>
    <span class="s1">val </span><span class="s2">= </span><span class="s1">f</span><span class="s2">(*</span><span class="s1">args</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000000</span><span class="s2">)</span>
    <span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">!= </span><span class="s3">'little'</span><span class="s2">:</span>
        <span class="s1">val </span><span class="s2">= </span><span class="s1">val</span><span class="s2">.</span><span class="s1">byteswap</span><span class="s2">()</span>
    <span class="s1">res </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">val</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">)).</span><span class="s1">hexdigest</span><span class="s2">()</span>
    <span class="s1">assert_</span><span class="s2">(</span><span class="s1">res </span><span class="s2">== </span><span class="s1">sha256</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_broadcast_size_error</span><span class="s2">():</span>
    <span class="s5"># GH-16833</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, [</span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s4">0.3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>


<span class="s0">def </span><span class="s1">test_randomstate_ctor_old_style_pickle</span><span class="s2">():</span>
    <span class="s1">rs </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">0</span><span class="s2">))</span>
    <span class="s1">rs</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)</span>
    <span class="s5"># Directly call reduce which is used in pickling</span>
    <span class="s1">ctor</span><span class="s2">, </span><span class="s1">args</span><span class="s2">, </span><span class="s1">state_a </span><span class="s2">= </span><span class="s1">rs</span><span class="s2">.</span><span class="s1">__reduce__</span><span class="s2">()</span>
    <span class="s5"># Simulate unpickling an old pickle that only has the name</span>
    <span class="s0">assert </span><span class="s1">args</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">__class__</span><span class="s2">.</span><span class="s1">__name__ </span><span class="s2">== </span><span class="s3">&quot;MT19937&quot;</span>
    <span class="s1">b </span><span class="s2">= </span><span class="s1">ctor</span><span class="s2">(*(</span><span class="s3">&quot;MT19937&quot;</span><span class="s2">,))</span>
    <span class="s1">b</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">state_a</span><span class="s2">)</span>
    <span class="s1">state_b </span><span class="s2">= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">(</span><span class="s1">legacy</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">state_a</span><span class="s2">[</span><span class="s3">'bit_generator'</span><span class="s2">], </span><span class="s1">state_b</span><span class="s2">[</span><span class="s3">'bit_generator'</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">state_a</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'key'</span><span class="s2">], </span><span class="s1">state_b</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'key'</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">state_a</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'pos'</span><span class="s2">], </span><span class="s1">state_b</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'pos'</span><span class="s2">])</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">state_a</span><span class="s2">[</span><span class="s3">'has_gauss'</span><span class="s2">], </span><span class="s1">state_b</span><span class="s2">[</span><span class="s3">'has_gauss'</span><span class="s2">])</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">state_a</span><span class="s2">[</span><span class="s3">'gauss'</span><span class="s2">], </span><span class="s1">state_b</span><span class="s2">[</span><span class="s3">'gauss'</span><span class="s2">])</span>


<span class="s0">def </span><span class="s1">test_hot_swap</span><span class="s2">(</span><span class="s1">restore_singleton_bitgen</span><span class="s2">):</span>
    <span class="s5"># GH 21808</span>
    <span class="s1">def_bg </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s4">0</span><span class="s2">)</span>
    <span class="s1">bg </span><span class="s2">= </span><span class="s1">def_bg</span><span class="s2">.</span><span class="s1">bit_generator</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">set_bit_generator</span><span class="s2">(</span><span class="s1">bg</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">mtrand</span><span class="s2">.</span><span class="s1">_rand</span><span class="s2">.</span><span class="s1">_bit_generator</span><span class="s2">, </span><span class="s1">type</span><span class="s2">(</span><span class="s1">bg</span><span class="s2">))</span>

    <span class="s1">second_bg </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">get_bit_generator</span><span class="s2">()</span>
    <span class="s0">assert </span><span class="s1">bg </span><span class="s0">is </span><span class="s1">second_bg</span>


<span class="s0">def </span><span class="s1">test_seed_alt_bit_gen</span><span class="s2">(</span><span class="s1">restore_singleton_bitgen</span><span class="s2">):</span>
    <span class="s5"># GH 21808</span>
    <span class="s1">bg </span><span class="s2">= </span><span class="s1">PCG64</span><span class="s2">(</span><span class="s4">0</span><span class="s2">)</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">set_bit_generator</span><span class="s2">(</span><span class="s1">bg</span><span class="s2">)</span>
    <span class="s1">state </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">(</span><span class="s1">legacy</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)</span>
    <span class="s1">new_state </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">(</span><span class="s1">legacy</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">print</span><span class="s2">(</span><span class="s1">state</span><span class="s2">)</span>
    <span class="s1">print</span><span class="s2">(</span><span class="s1">new_state</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">state</span><span class="s2">[</span><span class="s3">&quot;bit_generator&quot;</span><span class="s2">] == </span><span class="s3">&quot;PCG64&quot;</span>
    <span class="s0">assert </span><span class="s1">state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;state&quot;</span><span class="s2">] != </span><span class="s1">new_state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;state&quot;</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s1">state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;inc&quot;</span><span class="s2">] != </span><span class="s1">new_state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;inc&quot;</span><span class="s2">]</span>


<span class="s0">def </span><span class="s1">test_state_error_alt_bit_gen</span><span class="s2">(</span><span class="s1">restore_singleton_bitgen</span><span class="s2">):</span>
    <span class="s5"># GH 21808</span>
    <span class="s1">state </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">()</span>
    <span class="s1">bg </span><span class="s2">= </span><span class="s1">PCG64</span><span class="s2">(</span><span class="s4">0</span><span class="s2">)</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">set_bit_generator</span><span class="s2">(</span><span class="s1">bg</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;state must be for a PCG64&quot;</span><span class="s2">):</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">set_state</span><span class="s2">(</span><span class="s1">state</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_swap_worked</span><span class="s2">(</span><span class="s1">restore_singleton_bitgen</span><span class="s2">):</span>
    <span class="s5"># GH 21808</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">98765</span><span class="s2">)</span>
    <span class="s1">vals </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2 </span><span class="s2">** </span><span class="s4">30</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)</span>
    <span class="s1">bg </span><span class="s2">= </span><span class="s1">PCG64</span><span class="s2">(</span><span class="s4">0</span><span class="s2">)</span>
    <span class="s1">state </span><span class="s2">= </span><span class="s1">bg</span><span class="s2">.</span><span class="s1">state</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">set_bit_generator</span><span class="s2">(</span><span class="s1">bg</span><span class="s2">)</span>
    <span class="s1">state_direct </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">get_state</span><span class="s2">(</span><span class="s1">legacy</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s0">for </span><span class="s1">field </span><span class="s0">in </span><span class="s1">state</span><span class="s2">:</span>
        <span class="s0">assert </span><span class="s1">state</span><span class="s2">[</span><span class="s1">field</span><span class="s2">] == </span><span class="s1">state_direct</span><span class="s2">[</span><span class="s1">field</span><span class="s2">]</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">(</span><span class="s4">98765</span><span class="s2">)</span>
    <span class="s1">pcg_vals </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2 </span><span class="s2">** </span><span class="s4">30</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)</span>
    <span class="s0">assert not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">vals </span><span class="s2">== </span><span class="s1">pcg_vals</span><span class="s2">)</span>
    <span class="s1">new_state </span><span class="s2">= </span><span class="s1">bg</span><span class="s2">.</span><span class="s1">state</span>
    <span class="s0">assert </span><span class="s1">new_state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;state&quot;</span><span class="s2">] != </span><span class="s1">state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;state&quot;</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s1">new_state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;inc&quot;</span><span class="s2">] == </span><span class="s1">new_state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;inc&quot;</span><span class="s2">]</span>


<span class="s0">def </span><span class="s1">test_swapped_singleton_against_direct</span><span class="s2">(</span><span class="s1">restore_singleton_bitgen</span><span class="s2">):</span>
    <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">set_bit_generator</span><span class="s2">(</span><span class="s1">PCG64</span><span class="s2">(</span><span class="s4">98765</span><span class="s2">))</span>
    <span class="s1">singleton_vals </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2 </span><span class="s2">** </span><span class="s4">30</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)</span>
    <span class="s1">rg </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">PCG64</span><span class="s2">(</span><span class="s4">98765</span><span class="s2">))</span>
    <span class="s1">non_singleton_vals </span><span class="s2">= </span><span class="s1">rg</span><span class="s2">.</span><span class="s1">randint</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2 </span><span class="s2">** </span><span class="s4">30</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">non_singleton_vals</span><span class="s2">, </span><span class="s1">singleton_vals</span><span class="s2">)</span>
</pre>
</body>
</html>