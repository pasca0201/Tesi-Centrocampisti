<html>
<head>
<title>test_arffread.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #7a7e85;}
.s6 { color: #5f826b; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_arffread.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">datetime</span>
<span class="s0">import </span><span class="s1">os</span>
<span class="s0">import </span><span class="s1">sys</span>
<span class="s0">from </span><span class="s1">os</span><span class="s2">.</span><span class="s1">path </span><span class="s0">import </span><span class="s1">join </span><span class="s0">as </span><span class="s1">pjoin</span>

<span class="s0">from </span><span class="s1">io </span><span class="s0">import </span><span class="s1">StringIO</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>

<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">testing </span><span class="s0">import </span><span class="s2">(</span><span class="s1">assert_array_almost_equal</span><span class="s2">,</span>
                           <span class="s1">assert_array_equal</span><span class="s2">, </span><span class="s1">assert_equal</span><span class="s2">, </span><span class="s1">assert_</span><span class="s2">)</span>
<span class="s0">from </span><span class="s1">pytest </span><span class="s0">import </span><span class="s1">raises </span><span class="s0">as </span><span class="s1">assert_raises</span>

<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">io</span><span class="s2">.</span><span class="s1">arff </span><span class="s0">import </span><span class="s1">loadarff</span>
<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">io</span><span class="s2">.</span><span class="s1">arff</span><span class="s2">.</span><span class="s1">_arffread </span><span class="s0">import </span><span class="s1">read_header</span><span class="s2">, </span><span class="s1">ParseArffError</span>


<span class="s1">data_path </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span><span class="s2">.</span><span class="s1">dirname</span><span class="s2">(</span><span class="s1">__file__</span><span class="s2">), </span><span class="s3">'data'</span><span class="s2">)</span>

<span class="s1">test1 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test1.arff'</span><span class="s2">)</span>
<span class="s1">test2 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test2.arff'</span><span class="s2">)</span>
<span class="s1">test3 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test3.arff'</span><span class="s2">)</span>

<span class="s1">test4 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test4.arff'</span><span class="s2">)</span>
<span class="s1">test5 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test5.arff'</span><span class="s2">)</span>
<span class="s1">test6 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test6.arff'</span><span class="s2">)</span>
<span class="s1">test7 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test7.arff'</span><span class="s2">)</span>
<span class="s1">test8 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test8.arff'</span><span class="s2">)</span>
<span class="s1">test9 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test9.arff'</span><span class="s2">)</span>
<span class="s1">test10 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test10.arff'</span><span class="s2">)</span>
<span class="s1">test11 </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'test11.arff'</span><span class="s2">)</span>
<span class="s1">test_quoted_nominal </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'quoted_nominal.arff'</span><span class="s2">)</span>
<span class="s1">test_quoted_nominal_spaces </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'quoted_nominal_spaces.arff'</span><span class="s2">)</span>

<span class="s1">expect4_data </span><span class="s2">= [(</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s3">'class1'</span><span class="s2">),</span>
                <span class="s2">(-</span><span class="s4">0.1</span><span class="s2">, -</span><span class="s4">0.2</span><span class="s2">, -</span><span class="s4">0.3</span><span class="s2">, -</span><span class="s4">0.4</span><span class="s2">, </span><span class="s3">'class2'</span><span class="s2">),</span>
                <span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s3">'class3'</span><span class="s2">)]</span>
<span class="s1">expected_types </span><span class="s2">= [</span><span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'nominal'</span><span class="s2">]</span>

<span class="s1">missing </span><span class="s2">= </span><span class="s1">pjoin</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'missing.arff'</span><span class="s2">)</span>
<span class="s1">expect_missing_raw </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s2">], [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">4</span><span class="s2">], [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]])</span>
<span class="s1">expect_missing </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">(</span><span class="s4">3</span><span class="s2">, [(</span><span class="s3">'yop'</span><span class="s2">, </span><span class="s1">float</span><span class="s2">), (</span><span class="s3">'yap'</span><span class="s2">, </span><span class="s1">float</span><span class="s2">)])</span>
<span class="s1">expect_missing</span><span class="s2">[</span><span class="s3">'yop'</span><span class="s2">] = </span><span class="s1">expect_missing_raw</span><span class="s2">[:, </span><span class="s4">0</span><span class="s2">]</span>
<span class="s1">expect_missing</span><span class="s2">[</span><span class="s3">'yap'</span><span class="s2">] = </span><span class="s1">expect_missing_raw</span><span class="s2">[:, </span><span class="s4">1</span><span class="s2">]</span>


<span class="s0">class </span><span class="s1">TestData</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test1</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Parsing trivial file with nothing.</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_test</span><span class="s2">(</span><span class="s1">test4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test2</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Parsing trivial file with some comments in the data section.</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_test</span><span class="s2">(</span><span class="s1">test5</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test3</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Parsing trivial file with nominal attribute of 1 character.</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_test</span><span class="s2">(</span><span class="s1">test6</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test4</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Parsing trivial file with trailing spaces in attribute declaration.</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_test</span><span class="s2">(</span><span class="s1">test11</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">_test</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">test_file</span><span class="s2">):</span>
        <span class="s1">data</span><span class="s2">, </span><span class="s1">meta </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">test_file</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)):</span>
            <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">4</span><span class="s2">):</span>
                <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">expect4_data</span><span class="s2">[</span><span class="s1">i</span><span class="s2">][</span><span class="s1">j</span><span class="s2">], </span><span class="s1">data</span><span class="s2">[</span><span class="s1">i</span><span class="s2">][</span><span class="s1">j</span><span class="s2">])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">types</span><span class="s2">(), </span><span class="s1">expected_types</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_filelike</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Test reading from file-like object (StringIO)</span>
        <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">test1</span><span class="s2">) </span><span class="s0">as </span><span class="s1">f1</span><span class="s2">:</span>
            <span class="s1">data1</span><span class="s2">, </span><span class="s1">meta1 </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">f1</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">test1</span><span class="s2">) </span><span class="s0">as </span><span class="s1">f2</span><span class="s2">:</span>
            <span class="s1">data2</span><span class="s2">, </span><span class="s1">meta2 </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">f2</span><span class="s2">.</span><span class="s1">read</span><span class="s2">()))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">data1 </span><span class="s2">== </span><span class="s1">data2</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">repr</span><span class="s2">(</span><span class="s1">meta1</span><span class="s2">) == </span><span class="s1">repr</span><span class="s2">(</span><span class="s1">meta2</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_path</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Test reading from `pathlib.Path` object</span>
        <span class="s0">from </span><span class="s1">pathlib </span><span class="s0">import </span><span class="s1">Path</span>

        <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">test1</span><span class="s2">) </span><span class="s0">as </span><span class="s1">f1</span><span class="s2">:</span>
            <span class="s1">data1</span><span class="s2">, </span><span class="s1">meta1 </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">f1</span><span class="s2">)</span>

        <span class="s1">data2</span><span class="s2">, </span><span class="s1">meta2 </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">Path</span><span class="s2">(</span><span class="s1">test1</span><span class="s2">))</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">data1 </span><span class="s2">== </span><span class="s1">data2</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">repr</span><span class="s2">(</span><span class="s1">meta1</span><span class="s2">) == </span><span class="s1">repr</span><span class="s2">(</span><span class="s1">meta2</span><span class="s2">))</span>


<span class="s0">class </span><span class="s1">TestMissingData</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_missing</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">data</span><span class="s2">, </span><span class="s1">meta </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">missing</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s2">[</span><span class="s3">'yop'</span><span class="s2">, </span><span class="s3">'yap'</span><span class="s2">]:</span>
            <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">data</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], </span><span class="s1">expect_missing</span><span class="s2">[</span><span class="s1">i</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestNoData</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_nodata</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># The file nodata.arff has no data in the @DATA section.</span>
        <span class="s5"># Reading it should result in an array with length 0.</span>
        <span class="s1">nodata_filename </span><span class="s2">= </span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s1">data_path</span><span class="s2">, </span><span class="s3">'nodata.arff'</span><span class="s2">)</span>
        <span class="s1">data</span><span class="s2">, </span><span class="s1">meta </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">nodata_filename</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">== </span><span class="s3">'big'</span><span class="s2">:</span>
            <span class="s1">end </span><span class="s2">= </span><span class="s3">'&gt;'</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">end </span><span class="s2">= </span><span class="s3">'&lt;'</span>
        <span class="s1">expected_dtype </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">([(</span><span class="s3">'sepallength'</span><span class="s2">, </span><span class="s3">f'</span><span class="s0">{</span><span class="s1">end</span><span class="s0">}</span><span class="s3">f8'</span><span class="s2">),</span>
                                   <span class="s2">(</span><span class="s3">'sepalwidth'</span><span class="s2">, </span><span class="s3">f'</span><span class="s0">{</span><span class="s1">end</span><span class="s0">}</span><span class="s3">f8'</span><span class="s2">),</span>
                                   <span class="s2">(</span><span class="s3">'petallength'</span><span class="s2">, </span><span class="s3">f'</span><span class="s0">{</span><span class="s1">end</span><span class="s0">}</span><span class="s3">f8'</span><span class="s2">),</span>
                                   <span class="s2">(</span><span class="s3">'petalwidth'</span><span class="s2">, </span><span class="s3">f'</span><span class="s0">{</span><span class="s1">end</span><span class="s0">}</span><span class="s3">f8'</span><span class="s2">),</span>
                                   <span class="s2">(</span><span class="s3">'class'</span><span class="s2">, </span><span class="s3">'S15'</span><span class="s2">)])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">data</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">expected_dtype</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">data</span><span class="s2">.</span><span class="s1">size</span><span class="s2">, </span><span class="s4">0</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestHeader</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_type_parsing</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Test parsing type of attribute from their value.</span>
        <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">test2</span><span class="s2">) </span><span class="s0">as </span><span class="s1">ofile</span><span class="s2">:</span>
            <span class="s1">rel</span><span class="s2">, </span><span class="s1">attrs </span><span class="s2">= </span><span class="s1">read_header</span><span class="s2">(</span><span class="s1">ofile</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= [</span><span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">,</span>
                    <span class="s3">'numeric'</span><span class="s2">, </span><span class="s3">'string'</span><span class="s2">, </span><span class="s3">'string'</span><span class="s2">, </span><span class="s3">'nominal'</span><span class="s2">, </span><span class="s3">'nominal'</span><span class="s2">]</span>

        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">)):</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">type_name </span><span class="s2">== </span><span class="s1">expected</span><span class="s2">[</span><span class="s1">i</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_badtype_parsing</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Test parsing wrong type of attribute from their value.</span>
        <span class="s0">def </span><span class="s1">badtype_read</span><span class="s2">():</span>
            <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">test3</span><span class="s2">) </span><span class="s0">as </span><span class="s1">ofile</span><span class="s2">:</span>
                <span class="s1">_</span><span class="s2">, </span><span class="s1">_ </span><span class="s2">= </span><span class="s1">read_header</span><span class="s2">(</span><span class="s1">ofile</span><span class="s2">)</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ParseArffError</span><span class="s2">, </span><span class="s1">badtype_read</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_fullheader1</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Parsing trivial header with nothing.</span>
        <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">test1</span><span class="s2">) </span><span class="s0">as </span><span class="s1">ofile</span><span class="s2">:</span>
            <span class="s1">rel</span><span class="s2">, </span><span class="s1">attrs </span><span class="s2">= </span><span class="s1">read_header</span><span class="s2">(</span><span class="s1">ofile</span><span class="s2">)</span>

        <span class="s5"># Test relation</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">rel </span><span class="s2">== </span><span class="s3">'test1'</span><span class="s2">)</span>

        <span class="s5"># Test numerical attributes</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">) == </span><span class="s4">5</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">4</span><span class="s2">):</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">name </span><span class="s2">== </span><span class="s3">'attr%d' </span><span class="s2">% </span><span class="s1">i</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s1">i</span><span class="s2">].</span><span class="s1">type_name </span><span class="s2">== </span><span class="s3">'numeric'</span><span class="s2">)</span>

        <span class="s5"># Test nominal attribute</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">4</span><span class="s2">].</span><span class="s1">name </span><span class="s2">== </span><span class="s3">'class'</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">4</span><span class="s2">].</span><span class="s1">values </span><span class="s2">== (</span><span class="s3">'class0'</span><span class="s2">, </span><span class="s3">'class1'</span><span class="s2">, </span><span class="s3">'class2'</span><span class="s2">, </span><span class="s3">'class3'</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_dateheader</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">test7</span><span class="s2">) </span><span class="s0">as </span><span class="s1">ofile</span><span class="s2">:</span>
            <span class="s1">rel</span><span class="s2">, </span><span class="s1">attrs </span><span class="s2">= </span><span class="s1">read_header</span><span class="s2">(</span><span class="s1">ofile</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">rel </span><span class="s2">== </span><span class="s3">'test7'</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">) == </span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">name </span><span class="s2">== </span><span class="s3">'attr_year'</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">date_format </span><span class="s2">== </span><span class="s3">'%Y'</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">1</span><span class="s2">].</span><span class="s1">name </span><span class="s2">== </span><span class="s3">'attr_month'</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">1</span><span class="s2">].</span><span class="s1">date_format </span><span class="s2">== </span><span class="s3">'%Y-%m'</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">2</span><span class="s2">].</span><span class="s1">name </span><span class="s2">== </span><span class="s3">'attr_date'</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">2</span><span class="s2">].</span><span class="s1">date_format </span><span class="s2">== </span><span class="s3">'%Y-%m-%d'</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">3</span><span class="s2">].</span><span class="s1">name </span><span class="s2">== </span><span class="s3">'attr_datetime_local'</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">3</span><span class="s2">].</span><span class="s1">date_format </span><span class="s2">== </span><span class="s3">'%Y-%m-%d %H:%M'</span><span class="s2">)</span>

        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">4</span><span class="s2">].</span><span class="s1">name </span><span class="s2">== </span><span class="s3">'attr_datetime_missing'</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">attrs</span><span class="s2">[</span><span class="s4">4</span><span class="s2">].</span><span class="s1">date_format </span><span class="s2">== </span><span class="s3">'%Y-%m-%d %H:%M'</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dateheader_unsupported</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">read_dateheader_unsupported</span><span class="s2">():</span>
            <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">test8</span><span class="s2">) </span><span class="s0">as </span><span class="s1">ofile</span><span class="s2">:</span>
                <span class="s1">_</span><span class="s2">, </span><span class="s1">_ </span><span class="s2">= </span><span class="s1">read_header</span><span class="s2">(</span><span class="s1">ofile</span><span class="s2">)</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">read_dateheader_unsupported</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestDateAttribute</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">test7</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_year_attribute</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s3">'1999'</span><span class="s2">,</span>
            <span class="s3">'2004'</span><span class="s2">,</span>
            <span class="s3">'1817'</span><span class="s2">,</span>
            <span class="s3">'2100'</span><span class="s2">,</span>
            <span class="s3">'2013'</span><span class="s2">,</span>
            <span class="s3">'1631'</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">'datetime64[Y]'</span><span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;attr_year&quot;</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_month_attribute</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s3">'1999-01'</span><span class="s2">,</span>
            <span class="s3">'2004-12'</span><span class="s2">,</span>
            <span class="s3">'1817-04'</span><span class="s2">,</span>
            <span class="s3">'2100-09'</span><span class="s2">,</span>
            <span class="s3">'2013-11'</span><span class="s2">,</span>
            <span class="s3">'1631-10'</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">'datetime64[M]'</span><span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;attr_month&quot;</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_date_attribute</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s3">'1999-01-31'</span><span class="s2">,</span>
            <span class="s3">'2004-12-01'</span><span class="s2">,</span>
            <span class="s3">'1817-04-28'</span><span class="s2">,</span>
            <span class="s3">'2100-09-10'</span><span class="s2">,</span>
            <span class="s3">'2013-11-30'</span><span class="s2">,</span>
            <span class="s3">'1631-10-15'</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">'datetime64[D]'</span><span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;attr_date&quot;</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_datetime_local_attribute</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s1">datetime</span><span class="s2">.</span><span class="s1">datetime</span><span class="s2">(</span><span class="s1">year</span><span class="s2">=</span><span class="s4">1999</span><span class="s2">, </span><span class="s1">month</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">day</span><span class="s2">=</span><span class="s4">31</span><span class="s2">, </span><span class="s1">hour</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">minute</span><span class="s2">=</span><span class="s4">1</span><span class="s2">),</span>
            <span class="s1">datetime</span><span class="s2">.</span><span class="s1">datetime</span><span class="s2">(</span><span class="s1">year</span><span class="s2">=</span><span class="s4">2004</span><span class="s2">, </span><span class="s1">month</span><span class="s2">=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">day</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">hour</span><span class="s2">=</span><span class="s4">23</span><span class="s2">, </span><span class="s1">minute</span><span class="s2">=</span><span class="s4">59</span><span class="s2">),</span>
            <span class="s1">datetime</span><span class="s2">.</span><span class="s1">datetime</span><span class="s2">(</span><span class="s1">year</span><span class="s2">=</span><span class="s4">1817</span><span class="s2">, </span><span class="s1">month</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">day</span><span class="s2">=</span><span class="s4">28</span><span class="s2">, </span><span class="s1">hour</span><span class="s2">=</span><span class="s4">13</span><span class="s2">, </span><span class="s1">minute</span><span class="s2">=</span><span class="s4">0</span><span class="s2">),</span>
            <span class="s1">datetime</span><span class="s2">.</span><span class="s1">datetime</span><span class="s2">(</span><span class="s1">year</span><span class="s2">=</span><span class="s4">2100</span><span class="s2">, </span><span class="s1">month</span><span class="s2">=</span><span class="s4">9</span><span class="s2">, </span><span class="s1">day</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">hour</span><span class="s2">=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">minute</span><span class="s2">=</span><span class="s4">0</span><span class="s2">),</span>
            <span class="s1">datetime</span><span class="s2">.</span><span class="s1">datetime</span><span class="s2">(</span><span class="s1">year</span><span class="s2">=</span><span class="s4">2013</span><span class="s2">, </span><span class="s1">month</span><span class="s2">=</span><span class="s4">11</span><span class="s2">, </span><span class="s1">day</span><span class="s2">=</span><span class="s4">30</span><span class="s2">, </span><span class="s1">hour</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">minute</span><span class="s2">=</span><span class="s4">55</span><span class="s2">),</span>
            <span class="s1">datetime</span><span class="s2">.</span><span class="s1">datetime</span><span class="s2">(</span><span class="s1">year</span><span class="s2">=</span><span class="s4">1631</span><span class="s2">, </span><span class="s1">month</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">day</span><span class="s2">=</span><span class="s4">15</span><span class="s2">, </span><span class="s1">hour</span><span class="s2">=</span><span class="s4">20</span><span class="s2">, </span><span class="s1">minute</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">'datetime64[m]'</span><span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;attr_datetime_local&quot;</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_datetime_missing</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s3">'nat'</span><span class="s2">,</span>
            <span class="s3">'2004-12-01T23:59'</span><span class="s2">,</span>
            <span class="s3">'nat'</span><span class="s2">,</span>
            <span class="s3">'nat'</span><span class="s2">,</span>
            <span class="s3">'2013-11-30T04:55'</span><span class="s2">,</span>
            <span class="s3">'1631-10-15T20:04'</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">'datetime64[m]'</span><span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;attr_datetime_missing&quot;</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_datetime_timezone</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ParseArffError</span><span class="s2">, </span><span class="s1">loadarff</span><span class="s2">, </span><span class="s1">test8</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestRelationalAttribute</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">test9</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_attributes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">_attributes</span><span class="s2">), </span><span class="s4">1</span><span class="s2">)</span>

        <span class="s1">relational </span><span class="s2">= </span><span class="s1">list</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">_attributes</span><span class="s2">.</span><span class="s1">values</span><span class="s2">())[</span><span class="s4">0</span><span class="s2">]</span>

        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">name</span><span class="s2">, </span><span class="s3">'attr_date_number'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">type_name</span><span class="s2">, </span><span class="s3">'relational'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">attributes</span><span class="s2">), </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">attributes</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">name</span><span class="s2">,</span>
                     <span class="s3">'attr_date'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">attributes</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">type_name</span><span class="s2">,</span>
                     <span class="s3">'date'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">attributes</span><span class="s2">[</span><span class="s4">1</span><span class="s2">].</span><span class="s1">name</span><span class="s2">,</span>
                     <span class="s3">'attr_number'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">attributes</span><span class="s2">[</span><span class="s4">1</span><span class="s2">].</span><span class="s1">type_name</span><span class="s2">,</span>
                     <span class="s3">'numeric'</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_data</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dtype_instance </span><span class="s2">= [(</span><span class="s3">'attr_date'</span><span class="s2">, </span><span class="s3">'datetime64[D]'</span><span class="s2">),</span>
                          <span class="s2">(</span><span class="s3">'attr_number'</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">)]</span>

        <span class="s1">expected </span><span class="s2">= [</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([(</span><span class="s3">'1999-01-31'</span><span class="s2">, </span><span class="s4">1</span><span class="s2">), (</span><span class="s3">'1935-11-27'</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)],</span>
                     <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_instance</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([(</span><span class="s3">'2004-12-01'</span><span class="s2">, </span><span class="s4">2</span><span class="s2">), (</span><span class="s3">'1942-08-13'</span><span class="s2">, </span><span class="s4">20</span><span class="s2">)],</span>
                     <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_instance</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([(</span><span class="s3">'1817-04-28'</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)],</span>
                     <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_instance</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([(</span><span class="s3">'2100-09-10'</span><span class="s2">, </span><span class="s4">4</span><span class="s2">), (</span><span class="s3">'1957-04-17'</span><span class="s2">, </span><span class="s4">40</span><span class="s2">),</span>
                      <span class="s2">(</span><span class="s3">'1721-01-14'</span><span class="s2">, </span><span class="s4">400</span><span class="s2">)],</span>
                     <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_instance</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([(</span><span class="s3">'2013-11-30'</span><span class="s2">, </span><span class="s4">5</span><span class="s2">)],</span>
                     <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_instance</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([(</span><span class="s3">'1631-10-15'</span><span class="s2">, </span><span class="s4">6</span><span class="s2">)],</span>
                     <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_instance</span><span class="s2">)</span>
        <span class="s2">]</span>

        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;attr_date_number&quot;</span><span class="s2">])):</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;attr_date_number&quot;</span><span class="s2">][</span><span class="s1">i</span><span class="s2">],</span>
                               <span class="s1">expected</span><span class="s2">[</span><span class="s1">i</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestRelationalAttributeLong</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">test10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_attributes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">_attributes</span><span class="s2">), </span><span class="s4">1</span><span class="s2">)</span>

        <span class="s1">relational </span><span class="s2">= </span><span class="s1">list</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">_attributes</span><span class="s2">.</span><span class="s1">values</span><span class="s2">())[</span><span class="s4">0</span><span class="s2">]</span>

        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">name</span><span class="s2">, </span><span class="s3">'attr_relational'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">type_name</span><span class="s2">, </span><span class="s3">'relational'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">attributes</span><span class="s2">), </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">attributes</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">name</span><span class="s2">,</span>
                     <span class="s3">'attr_number'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">relational</span><span class="s2">.</span><span class="s1">attributes</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">type_name</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_data</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dtype_instance </span><span class="s2">= [(</span><span class="s3">'attr_number'</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">)]</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([(</span><span class="s1">n</span><span class="s2">,) </span><span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">30000</span><span class="s2">)],</span>
                            <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_instance</span><span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;attr_relational&quot;</span><span class="s2">][</span><span class="s4">0</span><span class="s2">],</span>
                           <span class="s1">expected</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestQuotedNominal</span><span class="s2">:</span>
    <span class="s6">&quot;&quot;&quot; 
    Regression test for issue #10232: 
     
    Exception in loadarff with quoted nominal attributes. 
    &quot;&quot;&quot;</span>

    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">test_quoted_nominal</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_attributes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">_attributes</span><span class="s2">), </span><span class="s4">2</span><span class="s2">)</span>

        <span class="s1">age</span><span class="s2">, </span><span class="s1">smoker </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">_attributes</span><span class="s2">.</span><span class="s1">values</span><span class="s2">()</span>

        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">age</span><span class="s2">.</span><span class="s1">name</span><span class="s2">, </span><span class="s3">'age'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">age</span><span class="s2">.</span><span class="s1">type_name</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">smoker</span><span class="s2">.</span><span class="s1">name</span><span class="s2">, </span><span class="s3">'smoker'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">smoker</span><span class="s2">.</span><span class="s1">type_name</span><span class="s2">, </span><span class="s3">'nominal'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">smoker</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, [</span><span class="s3">'yes'</span><span class="s2">, </span><span class="s3">'no'</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_data</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>

        <span class="s1">age_dtype_instance </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span>
        <span class="s1">smoker_dtype_instance </span><span class="s2">= </span><span class="s3">'&lt;S3'</span>

        <span class="s1">age_expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s4">18</span><span class="s2">,</span>
            <span class="s4">24</span><span class="s2">,</span>
            <span class="s4">44</span><span class="s2">,</span>
            <span class="s4">56</span><span class="s2">,</span>
            <span class="s4">89</span><span class="s2">,</span>
            <span class="s4">11</span><span class="s2">,</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">age_dtype_instance</span><span class="s2">)</span>

        <span class="s1">smoker_expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s3">'no'</span><span class="s2">,</span>
            <span class="s3">'yes'</span><span class="s2">,</span>
            <span class="s3">'no'</span><span class="s2">,</span>
            <span class="s3">'no'</span><span class="s2">,</span>
            <span class="s3">'yes'</span><span class="s2">,</span>
            <span class="s3">'no'</span><span class="s2">,</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">smoker_dtype_instance</span><span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;age&quot;</span><span class="s2">], </span><span class="s1">age_expected</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;smoker&quot;</span><span class="s2">], </span><span class="s1">smoker_expected</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestQuotedNominalSpaces</span><span class="s2">:</span>
    <span class="s6">&quot;&quot;&quot; 
    Regression test for issue #10232: 
     
    Exception in loadarff with quoted nominal attributes. 
    &quot;&quot;&quot;</span>

    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta </span><span class="s2">= </span><span class="s1">loadarff</span><span class="s2">(</span><span class="s1">test_quoted_nominal_spaces</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_attributes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">_attributes</span><span class="s2">), </span><span class="s4">2</span><span class="s2">)</span>

        <span class="s1">age</span><span class="s2">, </span><span class="s1">smoker </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">meta</span><span class="s2">.</span><span class="s1">_attributes</span><span class="s2">.</span><span class="s1">values</span><span class="s2">()</span>

        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">age</span><span class="s2">.</span><span class="s1">name</span><span class="s2">, </span><span class="s3">'age'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">age</span><span class="s2">.</span><span class="s1">type_name</span><span class="s2">, </span><span class="s3">'numeric'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">smoker</span><span class="s2">.</span><span class="s1">name</span><span class="s2">, </span><span class="s3">'smoker'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">smoker</span><span class="s2">.</span><span class="s1">type_name</span><span class="s2">, </span><span class="s3">'nominal'</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">smoker</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, [</span><span class="s3">'  yes'</span><span class="s2">, </span><span class="s3">'no  '</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_data</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>

        <span class="s1">age_dtype_instance </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span>
        <span class="s1">smoker_dtype_instance </span><span class="s2">= </span><span class="s3">'&lt;S5'</span>

        <span class="s1">age_expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s4">18</span><span class="s2">,</span>
            <span class="s4">24</span><span class="s2">,</span>
            <span class="s4">44</span><span class="s2">,</span>
            <span class="s4">56</span><span class="s2">,</span>
            <span class="s4">89</span><span class="s2">,</span>
            <span class="s4">11</span><span class="s2">,</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">age_dtype_instance</span><span class="s2">)</span>

        <span class="s1">smoker_expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s3">'no  '</span><span class="s2">,</span>
            <span class="s3">'  yes'</span><span class="s2">,</span>
            <span class="s3">'no  '</span><span class="s2">,</span>
            <span class="s3">'no  '</span><span class="s2">,</span>
            <span class="s3">'  yes'</span><span class="s2">,</span>
            <span class="s3">'no  '</span><span class="s2">,</span>
        <span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">smoker_dtype_instance</span><span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;age&quot;</span><span class="s2">], </span><span class="s1">age_expected</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[</span><span class="s3">&quot;smoker&quot;</span><span class="s2">], </span><span class="s1">smoker_expected</span><span class="s2">)</span>
</pre>
</body>
</html>