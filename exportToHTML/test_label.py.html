<html>
<head>
<title>test_label.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #7a7e85;}
.s5 { color: #2aacb8;}
.s6 { color: #5f826b; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_label.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>
<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">sparse </span><span class="s0">import </span><span class="s1">issparse</span>

<span class="s0">from </span><span class="s1">sklearn </span><span class="s0">import </span><span class="s1">datasets</span>
<span class="s0">from </span><span class="s1">sklearn</span><span class="s2">.</span><span class="s1">preprocessing</span><span class="s2">.</span><span class="s1">_label </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">LabelBinarizer</span><span class="s2">,</span>
    <span class="s1">LabelEncoder</span><span class="s2">,</span>
    <span class="s1">MultiLabelBinarizer</span><span class="s2">,</span>
    <span class="s1">_inverse_binarize_multiclass</span><span class="s2">,</span>
    <span class="s1">_inverse_binarize_thresholding</span><span class="s2">,</span>
    <span class="s1">label_binarize</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">from </span><span class="s1">sklearn</span><span class="s2">.</span><span class="s1">utils</span><span class="s2">.</span><span class="s1">_testing </span><span class="s0">import </span><span class="s1">assert_array_equal</span><span class="s2">, </span><span class="s1">ignore_warnings</span>
<span class="s0">from </span><span class="s1">sklearn</span><span class="s2">.</span><span class="s1">utils</span><span class="s2">.</span><span class="s1">fixes </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">COO_CONTAINERS</span><span class="s2">,</span>
    <span class="s1">CSC_CONTAINERS</span><span class="s2">,</span>
    <span class="s1">CSR_CONTAINERS</span><span class="s2">,</span>
    <span class="s1">DOK_CONTAINERS</span><span class="s2">,</span>
    <span class="s1">LIL_CONTAINERS</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">from </span><span class="s1">sklearn</span><span class="s2">.</span><span class="s1">utils</span><span class="s2">.</span><span class="s1">multiclass </span><span class="s0">import </span><span class="s1">type_of_target</span>
<span class="s0">from </span><span class="s1">sklearn</span><span class="s2">.</span><span class="s1">utils</span><span class="s2">.</span><span class="s1">validation </span><span class="s0">import </span><span class="s1">_to_object_array</span>

<span class="s1">iris </span><span class="s2">= </span><span class="s1">datasets</span><span class="s2">.</span><span class="s1">load_iris</span><span class="s2">()</span>


<span class="s0">def </span><span class="s1">toarray</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
    <span class="s0">if </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s3">&quot;toarray&quot;</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">a</span><span class="s2">.</span><span class="s1">toarray</span><span class="s2">()</span>
    <span class="s0">return </span><span class="s1">a</span>


<span class="s0">def </span><span class="s1">test_label_binarizer</span><span class="s2">():</span>
    <span class="s4"># one-class case defaults to negative label</span>
    <span class="s4"># For dense case:</span>
    <span class="s1">inp </span><span class="s2">= [</span><span class="s3">&quot;pos&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">]</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]]).</span><span class="s1">T</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, [</span><span class="s3">&quot;pos&quot;</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">), </span><span class="s1">inp</span><span class="s2">)</span>

    <span class="s4"># For sparse case:</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">issparse</span><span class="s2">(</span><span class="s1">got</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, [</span><span class="s3">&quot;pos&quot;</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">got</span><span class="s2">.</span><span class="s1">toarray</span><span class="s2">())</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">.</span><span class="s1">toarray</span><span class="s2">()), </span><span class="s1">inp</span><span class="s2">)</span>

    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s4"># two-class case</span>
    <span class="s1">inp </span><span class="s2">= [</span><span class="s3">&quot;neg&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">, </span><span class="s3">&quot;neg&quot;</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]]).</span><span class="s1">T</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, [</span><span class="s3">&quot;neg&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>

    <span class="s1">to_invert </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">to_invert</span><span class="s2">), </span><span class="s1">inp</span><span class="s2">)</span>

    <span class="s4"># multi-class case</span>
    <span class="s1">inp </span><span class="s2">= [</span><span class="s3">&quot;spam&quot;</span><span class="s2">, </span><span class="s3">&quot;ham&quot;</span><span class="s2">, </span><span class="s3">&quot;eggs&quot;</span><span class="s2">, </span><span class="s3">&quot;ham&quot;</span><span class="s2">, </span><span class="s3">&quot;0&quot;</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
        <span class="s2">[[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]]</span>
    <span class="s2">)</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, [</span><span class="s3">&quot;0&quot;</span><span class="s2">, </span><span class="s3">&quot;eggs&quot;</span><span class="s2">, </span><span class="s3">&quot;ham&quot;</span><span class="s2">, </span><span class="s3">&quot;spam&quot;</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">), </span><span class="s1">inp</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_label_binarizer_unseen_labels</span><span class="s2">():</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">()</span>

    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]])</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">([</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>

    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
        <span class="s2">[[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]]</span>
    <span class="s2">)</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;f&quot;</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_label_binarizer_set_label_encoding</span><span class="s2">():</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span><span class="s1">neg_label</span><span class="s2">=-</span><span class="s5">2</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s5">0</span><span class="s2">)</span>

    <span class="s4"># two-class case with pos_label=0</span>
    <span class="s1">inp </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">]]).</span><span class="s1">T</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">), </span><span class="s1">inp</span><span class="s2">)</span>

    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span><span class="s1">neg_label</span><span class="s2">=-</span><span class="s5">2</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s5">2</span><span class="s2">)</span>

    <span class="s4"># multi-class case</span>
    <span class="s1">inp </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
        <span class="s2">[</span>
            <span class="s2">[-</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">, +</span><span class="s5">2</span><span class="s2">],</span>
            <span class="s2">[-</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">, +</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">],</span>
            <span class="s2">[-</span><span class="s5">2</span><span class="s2">, +</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">],</span>
            <span class="s2">[-</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">, +</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">],</span>
            <span class="s2">[+</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">2</span><span class="s2">],</span>
        <span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">lb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">), </span><span class="s1">inp</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s3">&quot;Int64&quot;</span><span class="s2">, </span><span class="s3">&quot;Float64&quot;</span><span class="s2">, </span><span class="s3">&quot;boolean&quot;</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;unique_first&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_label_binarizer_pandas_nullable</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">unique_first</span><span class="s2">):</span>
    <span class="s6">&quot;&quot;&quot;Checks that LabelBinarizer works with pandas nullable dtypes. 
 
    Non-regression test for gh-25637. 
    &quot;&quot;&quot;</span>
    <span class="s1">pd </span><span class="s2">= </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;pandas&quot;</span><span class="s2">)</span>

    <span class="s1">y_true </span><span class="s2">= </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s0">if </span><span class="s1">unique_first</span><span class="s2">:</span>
        <span class="s4"># Calling unique creates a pandas array which has a different interface</span>
        <span class="s4"># compared to a pandas Series. Specifically, pandas arrays do not have &quot;iloc&quot;.</span>
        <span class="s1">y_true </span><span class="s2">= </span><span class="s1">y_true</span><span class="s2">.</span><span class="s1">unique</span><span class="s2">()</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">().</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">y_true</span><span class="s2">)</span>
    <span class="s1">y_out </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>

    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">y_out</span><span class="s2">, [[</span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">]])</span>


<span class="s2">@</span><span class="s1">ignore_warnings</span>
<span class="s0">def </span><span class="s1">test_label_binarizer_errors</span><span class="s2">():</span>
    <span class="s4"># Check that invalid arguments yield ValueError</span>
    <span class="s1">one_class </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">().</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">one_class</span><span class="s2">)</span>

    <span class="s1">multi_label </span><span class="s2">= [(</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">), (</span><span class="s5">0</span><span class="s2">,), (</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">)]</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;You appear to be using a legacy multi-label data representation.&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">lb</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">multi_label</span><span class="s2">)</span>

    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">()</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;This LabelBinarizer instance is not fitted yet&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">lb</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">([])</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">lb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">([])</span>

    <span class="s1">input_labels </span><span class="s2">= [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;neg_label=2 must be strictly less than pos_label=1.&quot;</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span><span class="s1">neg_label</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">lb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">input_labels</span><span class="s2">)</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;neg_label=2 must be strictly less than pos_label=2.&quot;</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span><span class="s1">neg_label</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s5">2</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">lb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">input_labels</span><span class="s2">)</span>
    <span class="s1">err_msg </span><span class="s2">= (</span>
        <span class="s3">&quot;Sparse binarization is only supported with non zero pos_label and zero &quot;</span>
        <span class="s3">&quot;neg_label, got pos_label=2 and neg_label=1&quot;</span>
    <span class="s2">)</span>
    <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span><span class="s1">neg_label</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">lb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">input_labels</span><span class="s2">)</span>

    <span class="s4"># Sequence of seq type should raise ValueError</span>
    <span class="s1">y_seq_of_seqs </span><span class="s2">= [[], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], [</span><span class="s5">3</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">]]</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;You appear to be using a legacy multi-label data representation&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">LabelBinarizer</span><span class="s2">().</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">y_seq_of_seqs</span><span class="s2">)</span>

    <span class="s4"># Fail on the dimension of 'binary'</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;output_type='binary', but y.shape&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">_inverse_binarize_thresholding</span><span class="s2">(</span>
            <span class="s1">y</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]]),</span>
            <span class="s1">output_type</span><span class="s2">=</span><span class="s3">&quot;binary&quot;</span><span class="s2">,</span>
            <span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">],</span>
            <span class="s1">threshold</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">)</span>

    <span class="s4"># Fail on multioutput data</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;Multioutput target data is not supported with label binarization&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">LabelBinarizer</span><span class="s2">().</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]]))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">label_binarize</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]]), </span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;csr_container&quot;</span><span class="s2">, </span><span class="s1">CSR_CONTAINERS</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_label_binarizer_sparse_errors</span><span class="s2">(</span><span class="s1">csr_container</span><span class="s2">):</span>
    <span class="s4"># Fail on y_type</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;foo format is not supported&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">_inverse_binarize_thresholding</span><span class="s2">(</span>
            <span class="s1">y</span><span class="s2">=</span><span class="s1">csr_container</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]]),</span>
            <span class="s1">output_type</span><span class="s2">=</span><span class="s3">&quot;foo&quot;</span><span class="s2">,</span>
            <span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">],</span>
            <span class="s1">threshold</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">)</span>

    <span class="s4"># Fail on the number of classes</span>
    <span class="s1">err_msg </span><span class="s2">= </span><span class="s3">&quot;The number of class is not equal to the number of dimension of y.&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">_inverse_binarize_thresholding</span><span class="s2">(</span>
            <span class="s1">y</span><span class="s2">=</span><span class="s1">csr_container</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]]),</span>
            <span class="s1">output_type</span><span class="s2">=</span><span class="s3">&quot;foo&quot;</span><span class="s2">,</span>
            <span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">],</span>
            <span class="s1">threshold</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;values, classes, unknown&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;int64&quot;</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;int64&quot;</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">4</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;int64&quot;</span><span class="s2">),</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;d&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">),</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;d&quot;</span><span class="s2">]),</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
    <span class="s1">ids</span><span class="s2">=[</span><span class="s3">&quot;int64&quot;</span><span class="s2">, </span><span class="s3">&quot;object&quot;</span><span class="s2">, </span><span class="s3">&quot;str&quot;</span><span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_label_encoder</span><span class="s2">(</span><span class="s1">values</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">, </span><span class="s1">unknown</span><span class="s2">):</span>
    <span class="s4"># Test LabelEncoder's transform, fit_transform and</span>
    <span class="s4"># inverse_transform methods</span>
    <span class="s1">le </span><span class="s2">= </span><span class="s1">LabelEncoder</span><span class="s2">()</span>
    <span class="s1">le</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">le</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">le</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">values</span><span class="s2">), [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">le</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]), </span><span class="s1">values</span><span class="s2">)</span>
    <span class="s1">le </span><span class="s2">= </span><span class="s1">LabelEncoder</span><span class="s2">()</span>
    <span class="s1">ret </span><span class="s2">= </span><span class="s1">le</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">ret</span><span class="s2">, [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;unseen labels&quot;</span><span class="s2">):</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">unknown</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_label_encoder_negative_ints</span><span class="s2">():</span>
    <span class="s1">le </span><span class="s2">= </span><span class="s1">LabelEncoder</span><span class="s2">()</span>
    <span class="s1">le</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">le</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, [-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">le</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">]), [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]), [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">6</span><span class="s2">])</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s3">&quot;str&quot;</span><span class="s2">, </span><span class="s3">&quot;object&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_label_encoder_str_bad_shape</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">):</span>
    <span class="s1">le </span><span class="s2">= </span><span class="s1">LabelEncoder</span><span class="s2">()</span>
    <span class="s1">le</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;apple&quot;</span><span class="s2">, </span><span class="s3">&quot;orange&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">))</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;should be a 1d array&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">(</span><span class="s3">&quot;apple&quot;</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_label_encoder_errors</span><span class="s2">():</span>
    <span class="s4"># Check that invalid arguments yield ValueError</span>
    <span class="s1">le </span><span class="s2">= </span><span class="s1">LabelEncoder</span><span class="s2">()</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">([])</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">([])</span>

    <span class="s4"># Fail on unseen labels</span>
    <span class="s1">le </span><span class="s2">= </span><span class="s1">LabelEncoder</span><span class="s2">()</span>
    <span class="s1">le</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;contains previously unseen labels&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">([-</span><span class="s5">2</span><span class="s2">])</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">([-</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">3</span><span class="s2">, -</span><span class="s5">4</span><span class="s2">])</span>

    <span class="s4"># Fail on inverse_transform(&quot;&quot;)</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">r&quot;should be a 1d array.+shape \(\)&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">le</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s3">&quot;&quot;</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;values&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;int64&quot;</span><span class="s2">),</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">),</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]),</span>
    <span class="s2">],</span>
    <span class="s1">ids</span><span class="s2">=[</span><span class="s3">&quot;int64&quot;</span><span class="s2">, </span><span class="s3">&quot;object&quot;</span><span class="s2">, </span><span class="s3">&quot;str&quot;</span><span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_label_encoder_empty_array</span><span class="s2">(</span><span class="s1">values</span><span class="s2">):</span>
    <span class="s1">le </span><span class="s2">= </span><span class="s1">LabelEncoder</span><span class="s2">()</span>
    <span class="s1">le</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s4"># test empty transform</span>
    <span class="s1">transformed </span><span class="s2">= </span><span class="s1">le</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">([])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([]), </span><span class="s1">transformed</span><span class="s2">)</span>
    <span class="s4"># test empty inverse transform</span>
    <span class="s1">inverse_transformed </span><span class="s2">= </span><span class="s1">le</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">([])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([]), </span><span class="s1">inverse_transformed</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_sparse_output_multilabel_binarizer</span><span class="s2">():</span>
    <span class="s4"># test input as iterable of iterables</span>
    <span class="s1">inputs </span><span class="s2">= [</span>
        <span class="s0">lambda</span><span class="s2">: [(</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">), (</span><span class="s5">1</span><span class="s2">,), (</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">)],</span>
        <span class="s0">lambda</span><span class="s2">: ({</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">}, {</span><span class="s5">1</span><span class="s2">}, {</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">}),</span>
        <span class="s0">lambda</span><span class="s2">: </span><span class="s1">iter</span><span class="s2">([</span><span class="s1">iter</span><span class="s2">((</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">)), </span><span class="s1">iter</span><span class="s2">((</span><span class="s5">1</span><span class="s2">,)), {</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">}]),</span>
    <span class="s2">]</span>
    <span class="s1">indicator_mat </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>

    <span class="s1">inverse </span><span class="s2">= </span><span class="s1">inputs</span><span class="s2">[</span><span class="s5">0</span><span class="s2">]()</span>
    <span class="s0">for </span><span class="s1">sparse_output </span><span class="s0">in </span><span class="s2">[</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">]:</span>
        <span class="s0">for </span><span class="s1">inp </span><span class="s0">in </span><span class="s1">inputs</span><span class="s2">:</span>
            <span class="s4"># With fit_transform</span>
            <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s1">sparse_output</span><span class="s2">)</span>
            <span class="s1">got </span><span class="s2">= </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">())</span>
            <span class="s0">assert </span><span class="s1">issparse</span><span class="s2">(</span><span class="s1">got</span><span class="s2">) == </span><span class="s1">sparse_output</span>
            <span class="s0">if </span><span class="s1">sparse_output</span><span class="s2">:</span>
                <span class="s4"># verify CSR assumption that indices and indptr have same dtype</span>
                <span class="s0">assert </span><span class="s1">got</span><span class="s2">.</span><span class="s1">indices</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">got</span><span class="s2">.</span><span class="s1">indptr</span><span class="s2">.</span><span class="s1">dtype</span>
                <span class="s1">got </span><span class="s2">= </span><span class="s1">got</span><span class="s2">.</span><span class="s1">toarray</span><span class="s2">()</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">indicator_mat</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">) == </span><span class="s1">inverse</span>

            <span class="s4"># With fit</span>
            <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s1">sparse_output</span><span class="s2">)</span>
            <span class="s1">got </span><span class="s2">= </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">()).</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">())</span>
            <span class="s0">assert </span><span class="s1">issparse</span><span class="s2">(</span><span class="s1">got</span><span class="s2">) == </span><span class="s1">sparse_output</span>
            <span class="s0">if </span><span class="s1">sparse_output</span><span class="s2">:</span>
                <span class="s4"># verify CSR assumption that indices and indptr have same dtype</span>
                <span class="s0">assert </span><span class="s1">got</span><span class="s2">.</span><span class="s1">indices</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">got</span><span class="s2">.</span><span class="s1">indptr</span><span class="s2">.</span><span class="s1">dtype</span>
                <span class="s1">got </span><span class="s2">= </span><span class="s1">got</span><span class="s2">.</span><span class="s1">toarray</span><span class="s2">()</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">indicator_mat</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">) == </span><span class="s1">inverse</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;csr_container&quot;</span><span class="s2">, </span><span class="s1">CSR_CONTAINERS</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_sparse_output_multilabel_binarizer_errors</span><span class="s2">(</span><span class="s1">csr_container</span><span class="s2">):</span>
    <span class="s1">inp </span><span class="s2">= </span><span class="s1">iter</span><span class="s2">([</span><span class="s1">iter</span><span class="s2">((</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">)), </span><span class="s1">iter</span><span class="s2">((</span><span class="s5">1</span><span class="s2">,)), {</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">}])</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span>
            <span class="s1">csr_container</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]]))</span>
        <span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer</span><span class="s2">():</span>
    <span class="s4"># test input as iterable of iterables</span>
    <span class="s1">inputs </span><span class="s2">= [</span>
        <span class="s0">lambda</span><span class="s2">: [(</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">), (</span><span class="s5">1</span><span class="s2">,), (</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">)],</span>
        <span class="s0">lambda</span><span class="s2">: ({</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">}, {</span><span class="s5">1</span><span class="s2">}, {</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">}),</span>
        <span class="s0">lambda</span><span class="s2">: </span><span class="s1">iter</span><span class="s2">([</span><span class="s1">iter</span><span class="s2">((</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">)), </span><span class="s1">iter</span><span class="s2">((</span><span class="s5">1</span><span class="s2">,)), {</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">}]),</span>
    <span class="s2">]</span>
    <span class="s1">indicator_mat </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s1">inverse </span><span class="s2">= </span><span class="s1">inputs</span><span class="s2">[</span><span class="s5">0</span><span class="s2">]()</span>
    <span class="s0">for </span><span class="s1">inp </span><span class="s0">in </span><span class="s1">inputs</span><span class="s2">:</span>
        <span class="s4"># With fit_transform</span>
        <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
        <span class="s1">got </span><span class="s2">= </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">())</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">indicator_mat</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">) == </span><span class="s1">inverse</span>

        <span class="s4"># With fit</span>
        <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
        <span class="s1">got </span><span class="s2">= </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">()).</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">())</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">indicator_mat</span><span class="s2">, </span><span class="s1">got</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">got</span><span class="s2">) == </span><span class="s1">inverse</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer_empty_sample</span><span class="s2">():</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
    <span class="s1">y </span><span class="s2">= [[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">], []]</span>
    <span class="s1">Y </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">y</span><span class="s2">), </span><span class="s1">Y</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer_unknown_class</span><span class="s2">():</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
    <span class="s1">y </span><span class="s2">= [[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]]</span>
    <span class="s1">Y </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]])</span>
    <span class="s1">warning_message </span><span class="s2">= </span><span class="s3">&quot;unknown class.* will be ignored&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">warns</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">warning_message</span><span class="s2">):</span>
        <span class="s1">matrix </span><span class="s2">= </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">y</span><span class="s2">).</span><span class="s1">transform</span><span class="s2">([[</span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>

    <span class="s1">Y </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">warns</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">warning_message</span><span class="s2">):</span>
        <span class="s1">matrix </span><span class="s2">= </span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">y</span><span class="s2">).</span><span class="s1">transform</span><span class="s2">([[</span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">matrix</span><span class="s2">, </span><span class="s1">Y</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer_given_classes</span><span class="s2">():</span>
    <span class="s1">inp </span><span class="s2">= [(</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">), (</span><span class="s5">1</span><span class="s2">,), (</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">)]</span>
    <span class="s1">indicator_mat </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]])</span>
    <span class="s4"># fit_transform()</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>

    <span class="s4"># fit().transform()</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">).</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>

    <span class="s4"># ensure works with extra class</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span>
        <span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">hstack</span><span class="s2">(([[</span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">]], </span><span class="s1">indicator_mat</span><span class="s2">))</span>
    <span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, [</span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>

    <span class="s4"># ensure fit is no-op as iterable is not consumed</span>
    <span class="s1">inp </span><span class="s2">= </span><span class="s1">iter</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">).</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>

    <span class="s4"># ensure a ValueError is thrown if given duplicate classes</span>
    <span class="s1">err_msg </span><span class="s2">= (</span>
        <span class="s3">&quot;The classes argument contains duplicate classes. Remove &quot;</span>
        <span class="s3">&quot;these duplicates before passing them to MultiLabelBinarizer.&quot;</span>
    <span class="s2">)</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">err_msg</span><span class="s2">):</span>
        <span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer_multiple_calls</span><span class="s2">():</span>
    <span class="s1">inp </span><span class="s2">= [(</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">), (</span><span class="s5">1</span><span class="s2">,), (</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">)]</span>
    <span class="s1">indicator_mat </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]])</span>

    <span class="s1">indicator_mat2 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>

    <span class="s4"># first call</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>
    <span class="s4"># second call change class</span>
    <span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes </span><span class="s2">= [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat2</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer_same_length_sequence</span><span class="s2">():</span>
    <span class="s4"># Ensure sequences of the same length are not interpreted as a 2-d array</span>
    <span class="s1">inp </span><span class="s2">= [[</span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">]]</span>
    <span class="s1">indicator_mat </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]])</span>
    <span class="s4"># fit_transform()</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">indicator_mat</span><span class="s2">), </span><span class="s1">inp</span><span class="s2">)</span>

    <span class="s4"># fit().transform()</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">).</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">indicator_mat</span><span class="s2">), </span><span class="s1">inp</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer_non_integer_labels</span><span class="s2">():</span>
    <span class="s1">tuple_classes </span><span class="s2">= </span><span class="s1">_to_object_array</span><span class="s2">([(</span><span class="s5">1</span><span class="s2">,), (</span><span class="s5">2</span><span class="s2">,), (</span><span class="s5">3</span><span class="s2">,)])</span>
    <span class="s1">inputs </span><span class="s2">= [</span>
        <span class="s2">([(</span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;3&quot;</span><span class="s2">), (</span><span class="s3">&quot;1&quot;</span><span class="s2">,), (</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2&quot;</span><span class="s2">)], [</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;3&quot;</span><span class="s2">]),</span>
        <span class="s2">([(</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">), (</span><span class="s3">&quot;a&quot;</span><span class="s2">,), (</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">)], [</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]),</span>
        <span class="s2">([((</span><span class="s5">2</span><span class="s2">,), (</span><span class="s5">3</span><span class="s2">,)), ((</span><span class="s5">1</span><span class="s2">,),), ((</span><span class="s5">1</span><span class="s2">,), (</span><span class="s5">2</span><span class="s2">,))], </span><span class="s1">tuple_classes</span><span class="s2">),</span>
    <span class="s2">]</span>
    <span class="s1">indicator_mat </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s0">for </span><span class="s1">inp</span><span class="s2">, </span><span class="s1">classes </span><span class="s0">in </span><span class="s1">inputs</span><span class="s2">:</span>
        <span class="s4"># fit_transform()</span>
        <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
        <span class="s1">inp </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">)</span>
        <span class="s1">indicator_mat_inv </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">indicator_mat</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">indicator_mat_inv</span><span class="s2">, </span><span class="s1">inp</span><span class="s2">)</span>

        <span class="s4"># fit().transform()</span>
        <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">).</span><span class="s1">transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">classes_</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">)</span>
        <span class="s1">indicator_mat_inv </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">indicator_mat</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">indicator_mat_inv</span><span class="s2">, </span><span class="s1">inp</span><span class="s2">)</span>

    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">):</span>
        <span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">([({}), ({}, {</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s3">&quot;b&quot;</span><span class="s2">})])</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer_non_unique</span><span class="s2">():</span>
    <span class="s1">inp </span><span class="s2">= [(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">)]</span>
    <span class="s1">indicator_mat </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]])</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">), </span><span class="s1">indicator_mat</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_multilabel_binarizer_inverse_validation</span><span class="s2">():</span>
    <span class="s1">inp </span><span class="s2">= [(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">)]</span>
    <span class="s1">mlb </span><span class="s2">= </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()</span>
    <span class="s1">mlb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">)</span>
    <span class="s4"># Not binary</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]]))</span>
    <span class="s4"># The following binary cases are fine, however</span>
    <span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]]))</span>
    <span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]]))</span>
    <span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]]))</span>

    <span class="s4"># Wrong shape</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">]]))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">mlb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]]))</span>


<span class="s0">def </span><span class="s1">test_label_binarize_with_class_order</span><span class="s2">():</span>
    <span class="s1">out </span><span class="s2">= </span><span class="s1">label_binarize</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">6</span><span class="s2">], </span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">6</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># Modified class order</span>
    <span class="s1">out </span><span class="s2">= </span><span class="s1">label_binarize</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">6</span><span class="s2">], </span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">6</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s1">out </span><span class="s2">= </span><span class="s1">label_binarize</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">check_binarized_results</span><span class="s2">(</span><span class="s1">y</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">, </span><span class="s1">neg_label</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
    <span class="s0">for </span><span class="s1">sparse_output </span><span class="s0">in </span><span class="s2">[</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">]:</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">pos_label </span><span class="s2">== </span><span class="s5">0 </span><span class="s0">or </span><span class="s1">neg_label </span><span class="s2">!= </span><span class="s5">0</span><span class="s2">) </span><span class="s0">and </span><span class="s1">sparse_output</span><span class="s2">:</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
                <span class="s1">label_binarize</span><span class="s2">(</span>
                    <span class="s1">y</span><span class="s2">,</span>
                    <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
                    <span class="s1">neg_label</span><span class="s2">=</span><span class="s1">neg_label</span><span class="s2">,</span>
                    <span class="s1">pos_label</span><span class="s2">=</span><span class="s1">pos_label</span><span class="s2">,</span>
                    <span class="s1">sparse_output</span><span class="s2">=</span><span class="s1">sparse_output</span><span class="s2">,</span>
                <span class="s2">)</span>
            <span class="s0">continue</span>

        <span class="s4"># check label_binarize</span>
        <span class="s1">binarized </span><span class="s2">= </span><span class="s1">label_binarize</span><span class="s2">(</span>
            <span class="s1">y</span><span class="s2">,</span>
            <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
            <span class="s1">neg_label</span><span class="s2">=</span><span class="s1">neg_label</span><span class="s2">,</span>
            <span class="s1">pos_label</span><span class="s2">=</span><span class="s1">pos_label</span><span class="s2">,</span>
            <span class="s1">sparse_output</span><span class="s2">=</span><span class="s1">sparse_output</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">toarray</span><span class="s2">(</span><span class="s1">binarized</span><span class="s2">), </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">issparse</span><span class="s2">(</span><span class="s1">binarized</span><span class="s2">) == </span><span class="s1">sparse_output</span>

        <span class="s4"># check inverse</span>
        <span class="s1">y_type </span><span class="s2">= </span><span class="s1">type_of_target</span><span class="s2">(</span><span class="s1">y</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">y_type </span><span class="s2">== </span><span class="s3">&quot;multiclass&quot;</span><span class="s2">:</span>
            <span class="s1">inversed </span><span class="s2">= </span><span class="s1">_inverse_binarize_multiclass</span><span class="s2">(</span><span class="s1">binarized</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">)</span>

        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">inversed </span><span class="s2">= </span><span class="s1">_inverse_binarize_thresholding</span><span class="s2">(</span>
                <span class="s1">binarized</span><span class="s2">,</span>
                <span class="s1">output_type</span><span class="s2">=</span><span class="s1">y_type</span><span class="s2">,</span>
                <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
                <span class="s1">threshold</span><span class="s2">=((</span><span class="s1">neg_label </span><span class="s2">+ </span><span class="s1">pos_label</span><span class="s2">) / </span><span class="s5">2.0</span><span class="s2">),</span>
            <span class="s2">)</span>

        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">toarray</span><span class="s2">(</span><span class="s1">inversed</span><span class="s2">), </span><span class="s1">toarray</span><span class="s2">(</span><span class="s1">y</span><span class="s2">))</span>

        <span class="s4"># Check label binarizer</span>
        <span class="s1">lb </span><span class="s2">= </span><span class="s1">LabelBinarizer</span><span class="s2">(</span>
            <span class="s1">neg_label</span><span class="s2">=</span><span class="s1">neg_label</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s1">pos_label</span><span class="s2">, </span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s1">sparse_output</span>
        <span class="s2">)</span>
        <span class="s1">binarized </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">y</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">toarray</span><span class="s2">(</span><span class="s1">binarized</span><span class="s2">), </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">issparse</span><span class="s2">(</span><span class="s1">binarized</span><span class="s2">) == </span><span class="s1">sparse_output</span>
        <span class="s1">inverse_output </span><span class="s2">= </span><span class="s1">lb</span><span class="s2">.</span><span class="s1">inverse_transform</span><span class="s2">(</span><span class="s1">binarized</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">toarray</span><span class="s2">(</span><span class="s1">inverse_output</span><span class="s2">), </span><span class="s1">toarray</span><span class="s2">(</span><span class="s1">y</span><span class="s2">))</span>
        <span class="s0">assert </span><span class="s1">issparse</span><span class="s2">(</span><span class="s1">inverse_output</span><span class="s2">) == </span><span class="s1">issparse</span><span class="s2">(</span><span class="s1">y</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_label_binarize_binary</span><span class="s2">():</span>
    <span class="s1">y </span><span class="s2">= [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]</span>
    <span class="s1">classes </span><span class="s2">= [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]</span>
    <span class="s1">pos_label </span><span class="s2">= </span><span class="s5">2</span>
    <span class="s1">neg_label </span><span class="s2">= -</span><span class="s5">1</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">], [-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">]])[:, </span><span class="s5">1</span><span class="s2">].</span><span class="s1">reshape</span><span class="s2">((-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">))</span>

    <span class="s1">check_binarized_results</span><span class="s2">(</span><span class="s1">y</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">, </span><span class="s1">neg_label</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># Binary case where sparse_output = True will not result in a ValueError</span>
    <span class="s1">y </span><span class="s2">= [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]</span>
    <span class="s1">classes </span><span class="s2">= [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]</span>
    <span class="s1">pos_label </span><span class="s2">= </span><span class="s5">3</span>
    <span class="s1">neg_label </span><span class="s2">= </span><span class="s5">0</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">3</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])[:, </span><span class="s5">1</span><span class="s2">].</span><span class="s1">reshape</span><span class="s2">((-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">))</span>

    <span class="s1">check_binarized_results</span><span class="s2">(</span><span class="s1">y</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">, </span><span class="s1">neg_label</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_label_binarize_multiclass</span><span class="s2">():</span>
    <span class="s1">y </span><span class="s2">= [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]</span>
    <span class="s1">classes </span><span class="s2">= [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]</span>
    <span class="s1">pos_label </span><span class="s2">= </span><span class="s5">2</span>
    <span class="s1">neg_label </span><span class="s2">= </span><span class="s5">0</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s5">2 </span><span class="s2">* </span><span class="s1">np</span><span class="s2">.</span><span class="s1">eye</span><span class="s2">(</span><span class="s5">3</span><span class="s2">)</span>

    <span class="s1">check_binarized_results</span><span class="s2">(</span><span class="s1">y</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">, </span><span class="s1">neg_label</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">label_binarize</span><span class="s2">(</span>
            <span class="s1">y</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">, </span><span class="s1">neg_label</span><span class="s2">=-</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s1">pos_label</span><span class="s2">, </span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s0">True</span>
        <span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;arr_type&quot;</span><span class="s2">,</span>
    <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">]</span>
    <span class="s2">+ </span><span class="s1">COO_CONTAINERS</span>
    <span class="s2">+ </span><span class="s1">CSC_CONTAINERS</span>
    <span class="s2">+ </span><span class="s1">CSR_CONTAINERS</span>
    <span class="s2">+ </span><span class="s1">DOK_CONTAINERS</span>
    <span class="s2">+ </span><span class="s1">LIL_CONTAINERS</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_label_binarize_multilabel</span><span class="s2">(</span><span class="s1">arr_type</span><span class="s2">):</span>
    <span class="s1">y_ind </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]])</span>
    <span class="s1">classes </span><span class="s2">= [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]</span>
    <span class="s1">pos_label </span><span class="s2">= </span><span class="s5">2</span>
    <span class="s1">neg_label </span><span class="s2">= </span><span class="s5">0</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">pos_label </span><span class="s2">* </span><span class="s1">y_ind</span>
    <span class="s1">y </span><span class="s2">= </span><span class="s1">arr_type</span><span class="s2">(</span><span class="s1">y_ind</span><span class="s2">)</span>

    <span class="s1">check_binarized_results</span><span class="s2">(</span><span class="s1">y</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">, </span><span class="s1">neg_label</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">label_binarize</span><span class="s2">(</span>
            <span class="s1">y</span><span class="s2">, </span><span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">, </span><span class="s1">neg_label</span><span class="s2">=-</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s1">pos_label</span><span class="s2">, </span><span class="s1">sparse_output</span><span class="s2">=</span><span class="s0">True</span>
        <span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_invalid_input_label_binarize</span><span class="s2">():</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">label_binarize</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s1">pos_label</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">neg_label</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;continuous target data is not &quot;</span><span class="s2">):</span>
        <span class="s1">label_binarize</span><span class="s2">([</span><span class="s5">1.2</span><span class="s2">, </span><span class="s5">2.7</span><span class="s2">], </span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;mismatch with the labels&quot;</span><span class="s2">):</span>
        <span class="s1">label_binarize</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]], </span><span class="s1">classes</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;csr_container&quot;</span><span class="s2">, </span><span class="s1">CSR_CONTAINERS</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_inverse_binarize_multiclass</span><span class="s2">(</span><span class="s1">csr_container</span><span class="s2">):</span>
    <span class="s1">got </span><span class="s2">= </span><span class="s1">_inverse_binarize_multiclass</span><span class="s2">(</span>
        <span class="s1">csr_container</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, -</span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]]), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">3</span><span class="s2">)</span>
    <span class="s2">)</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">got</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">]))</span>


<span class="s0">def </span><span class="s1">test_nan_label_encoder</span><span class="s2">():</span>
    <span class="s6">&quot;&quot;&quot;Check that label encoder encodes nans in transform. 
 
    Non-regression test for #22628. 
    &quot;&quot;&quot;</span>
    <span class="s1">le </span><span class="s2">= </span><span class="s1">LabelEncoder</span><span class="s2">()</span>
    <span class="s1">le</span><span class="s2">.</span><span class="s1">fit</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

    <span class="s1">y_trans </span><span class="s2">= </span><span class="s1">le</span><span class="s2">.</span><span class="s1">transform</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">y_trans</span><span class="s2">, [</span><span class="s5">2</span><span class="s2">])</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;encoder&quot;</span><span class="s2">, [</span><span class="s1">LabelEncoder</span><span class="s2">(), </span><span class="s1">LabelBinarizer</span><span class="s2">(), </span><span class="s1">MultiLabelBinarizer</span><span class="s2">()]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_label_encoders_do_not_have_set_output</span><span class="s2">(</span><span class="s1">encoder</span><span class="s2">):</span>
    <span class="s6">&quot;&quot;&quot;Check that label encoders do not define set_output and work with y as a kwarg. 
 
    Non-regression test for #26854. 
    &quot;&quot;&quot;</span>
    <span class="s0">assert not </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">encoder</span><span class="s2">, </span><span class="s3">&quot;set_output&quot;</span><span class="s2">)</span>
    <span class="s1">y_encoded_with_kwarg </span><span class="s2">= </span><span class="s1">encoder</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">(</span><span class="s1">y</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">])</span>
    <span class="s1">y_encoded_positional </span><span class="s2">= </span><span class="s1">encoder</span><span class="s2">.</span><span class="s1">fit_transform</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">])</span>
    <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">y_encoded_with_kwarg</span><span class="s2">, </span><span class="s1">y_encoded_positional</span><span class="s2">)</span>
</pre>
</body>
</html>