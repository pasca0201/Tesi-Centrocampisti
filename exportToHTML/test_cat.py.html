<html>
<head>
<title>test_cat.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #7a7e85;}
.s5 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_cat.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">re</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">_test_decorators </span><span class="s0">as </span><span class="s1">td</span>

<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">DataFrame</span><span class="s2">,</span>
    <span class="s1">Index</span><span class="s2">,</span>
    <span class="s1">MultiIndex</span><span class="s2">,</span>
    <span class="s1">Series</span><span class="s2">,</span>
    <span class="s1">_testing </span><span class="s0">as </span><span class="s1">tm</span><span class="s2">,</span>
    <span class="s1">concat</span><span class="s2">,</span>
    <span class="s1">option_context</span><span class="s2">,</span>
<span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;other&quot;</span><span class="s2">, [</span><span class="s0">None</span><span class="s2">, </span><span class="s1">Series</span><span class="s2">, </span><span class="s1">Index</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_str_cat_name</span><span class="s2">(</span><span class="s1">index_or_series</span><span class="s2">, </span><span class="s1">other</span><span class="s2">):</span>
    <span class="s4"># GH 21053</span>
    <span class="s1">box </span><span class="s2">= </span><span class="s1">index_or_series</span>
    <span class="s1">values </span><span class="s2">= [</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">]</span>
    <span class="s0">if </span><span class="s1">other</span><span class="s2">:</span>
        <span class="s1">other </span><span class="s2">= </span><span class="s1">other</span><span class="s2">(</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">other </span><span class="s2">= </span><span class="s1">values</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">box</span><span class="s2">(</span><span class="s1">values</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;name&quot;</span><span class="s2">).</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">other</span><span class="s2">, </span><span class="s1">sep</span><span class="s2">=</span><span class="s3">&quot;,&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result</span><span class="s2">.</span><span class="s1">name </span><span class="s2">== </span><span class="s3">&quot;name&quot;</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;infer_string&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">param</span><span class="s2">(</span><span class="s0">True</span><span class="s2">, </span><span class="s1">marks</span><span class="s2">=</span><span class="s1">td</span><span class="s2">.</span><span class="s1">skip_if_no</span><span class="s2">(</span><span class="s3">&quot;pyarrow&quot;</span><span class="s2">))]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_str_cat</span><span class="s2">(</span><span class="s1">index_or_series</span><span class="s2">, </span><span class="s1">infer_string</span><span class="s2">):</span>
    <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;future.infer_string&quot;</span><span class="s2">, </span><span class="s1">infer_string</span><span class="s2">):</span>
        <span class="s1">box </span><span class="s2">= </span><span class="s1">index_or_series</span>
        <span class="s4"># test_cat above tests &quot;str_cat&quot; from ndarray;</span>
        <span class="s4"># here testing &quot;str.cat&quot; from Series/Index to ndarray/list</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">box</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

        <span class="s4"># single array</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s3">&quot;aabbc&quot;</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s3">&quot;aabbc-&quot;</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">sep</span><span class="s2">=</span><span class="s3">&quot;_&quot;</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;NA&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s3">&quot;a_a_b_b_c_NA&quot;</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

        <span class="s1">t </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">box</span><span class="s2">([</span><span class="s3">&quot;aa&quot;</span><span class="s2">, </span><span class="s3">&quot;a-&quot;</span><span class="s2">, </span><span class="s3">&quot;bb&quot;</span><span class="s2">, </span><span class="s3">&quot;bd&quot;</span><span class="s2">, </span><span class="s3">&quot;cfoo&quot;</span><span class="s2">, </span><span class="s3">&quot;--&quot;</span><span class="s2">])</span>

        <span class="s4"># Series/Index with array</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">t</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s4"># Series/Index with list</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s1">t</span><span class="s2">), </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s4"># errors for incorrect lengths</span>
        <span class="s1">rgx </span><span class="s2">= </span><span class="s3">r&quot;If `others` contains arrays or lists \(or other list-likes.*&quot;</span>
        <span class="s1">z </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;3&quot;</span><span class="s2">])</span>

        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">z</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>

        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s1">z</span><span class="s2">))</span>


<span class="s0">def </span><span class="s1">test_str_cat_raises_intuitive_error</span><span class="s2">(</span><span class="s1">index_or_series</span><span class="s2">):</span>
    <span class="s4"># GH 11334</span>
    <span class="s1">box </span><span class="s2">= </span><span class="s1">index_or_series</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">box</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">])</span>
    <span class="s1">message </span><span class="s2">= </span><span class="s3">&quot;Did you mean to supply a `sep` keyword?&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">message</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s3">&quot;|&quot;</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">message</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s3">&quot;    &quot;</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;infer_string&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">param</span><span class="s2">(</span><span class="s0">True</span><span class="s2">, </span><span class="s1">marks</span><span class="s2">=</span><span class="s1">td</span><span class="s2">.</span><span class="s1">skip_if_no</span><span class="s2">(</span><span class="s3">&quot;pyarrow&quot;</span><span class="s2">))]</span>
<span class="s2">)</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;sep&quot;</span><span class="s2">, [</span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;dtype_target&quot;</span><span class="s2">, [</span><span class="s3">&quot;object&quot;</span><span class="s2">, </span><span class="s3">&quot;category&quot;</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;dtype_caller&quot;</span><span class="s2">, [</span><span class="s3">&quot;object&quot;</span><span class="s2">, </span><span class="s3">&quot;category&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_str_cat_categorical</span><span class="s2">(</span>
    <span class="s1">index_or_series</span><span class="s2">, </span><span class="s1">dtype_caller</span><span class="s2">, </span><span class="s1">dtype_target</span><span class="s2">, </span><span class="s1">sep</span><span class="s2">, </span><span class="s1">infer_string</span>
<span class="s2">):</span>
    <span class="s1">box </span><span class="s2">= </span><span class="s1">index_or_series</span>

    <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;future.infer_string&quot;</span><span class="s2">, </span><span class="s1">infer_string</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_caller</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">s </span><span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index </span><span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">s</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">s</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s1">t </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_target</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s3">&quot;ab&quot;</span><span class="s2">, </span><span class="s3">&quot;aa&quot;</span><span class="s2">, </span><span class="s3">&quot;bb&quot;</span><span class="s2">, </span><span class="s3">&quot;ac&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object </span><span class="s0">if </span><span class="s1">dtype_caller </span><span class="s2">== </span><span class="s3">&quot;object&quot; </span><span class="s0">else None</span>
        <span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= (</span>
            <span class="s1">expected</span>
            <span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index</span>
            <span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span>
                <span class="s1">expected</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">s</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_caller</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">dtype</span>
            <span class="s2">)</span>
        <span class="s2">)</span>

        <span class="s4"># Series/Index with unaligned Index -&gt; t.values</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">t</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">sep</span><span class="s2">=</span><span class="s1">sep</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s4"># Series/Index with Series having matching Index</span>
        <span class="s1">t </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">t</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">s</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype_caller</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">t</span><span class="s2">, </span><span class="s1">sep</span><span class="s2">=</span><span class="s1">sep</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s4"># Series/Index with Series.values</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">t</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">sep</span><span class="s2">=</span><span class="s1">sep</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s4"># Series/Index with Series having different Index</span>
        <span class="s1">t </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">t</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">t</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s3">&quot;aa&quot;</span><span class="s2">, </span><span class="s3">&quot;aa&quot;</span><span class="s2">, </span><span class="s3">&quot;bb&quot;</span><span class="s2">, </span><span class="s3">&quot;bb&quot;</span><span class="s2">, </span><span class="s3">&quot;aa&quot;</span><span class="s2">],</span>
            <span class="s1">dtype</span><span class="s2">=</span><span class="s1">object </span><span class="s0">if </span><span class="s1">dtype_caller </span><span class="s2">== </span><span class="s3">&quot;object&quot; </span><span class="s0">else None</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">dtype </span><span class="s2">= </span><span class="s1">object </span><span class="s0">if </span><span class="s1">dtype_caller </span><span class="s2">== </span><span class="s3">&quot;object&quot; </span><span class="s0">else </span><span class="s1">s</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">categories</span><span class="s2">.</span><span class="s1">dtype</span>
        <span class="s1">expected </span><span class="s2">= (</span>
            <span class="s1">expected</span>
            <span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index</span>
            <span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span>
                <span class="s1">expected</span><span class="s2">,</span>
                <span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">str</span><span class="s2">[:</span><span class="s5">1</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">),</span>
                <span class="s1">dtype</span><span class="s2">=</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">,</span>
            <span class="s2">)</span>
        <span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">t</span><span class="s2">, </span><span class="s1">sep</span><span class="s2">=</span><span class="s1">sep</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;data&quot;</span><span class="s2">,</span>
    <span class="s2">[[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], [</span><span class="s5">0.1</span><span class="s2">, </span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.3</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">]],</span>
    <span class="s1">ids</span><span class="s2">=[</span><span class="s3">&quot;integers&quot;</span><span class="s2">, </span><span class="s3">&quot;floats&quot;</span><span class="s2">, </span><span class="s3">&quot;mixed&quot;</span><span class="s2">],</span>
<span class="s2">)</span>
<span class="s4"># without dtype=object, np.array would cast [1, 2, 'b'] to ['1', '2', 'b']</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;box&quot;</span><span class="s2">,</span>
    <span class="s2">[</span><span class="s1">Series</span><span class="s2">, </span><span class="s1">Index</span><span class="s2">, </span><span class="s1">list</span><span class="s2">, </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)],</span>
    <span class="s1">ids</span><span class="s2">=[</span><span class="s3">&quot;Series&quot;</span><span class="s2">, </span><span class="s3">&quot;Index&quot;</span><span class="s2">, </span><span class="s3">&quot;list&quot;</span><span class="s2">, </span><span class="s3">&quot;np.array&quot;</span><span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_str_cat_wrong_dtype_raises</span><span class="s2">(</span><span class="s1">box</span><span class="s2">, </span><span class="s1">data</span><span class="s2">):</span>
    <span class="s4"># GH 22722</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">])</span>
    <span class="s1">t </span><span class="s2">= </span><span class="s1">box</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>

    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Concatenation requires list-likes containing only strings.*&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s4"># need to use outer and na_rep, as otherwise Index would not raise</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">t</span><span class="s2">, </span><span class="s1">join</span><span class="s2">=</span><span class="s3">&quot;outer&quot;</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_str_cat_mixed_inputs</span><span class="s2">(</span><span class="s1">index_or_series</span><span class="s2">):</span>
    <span class="s1">box </span><span class="s2">= </span><span class="s1">index_or_series</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">])</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">s </span><span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index </span><span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">s</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">)</span>

    <span class="s1">t </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s1">d </span><span class="s2">= </span><span class="s1">concat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">s</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">)], </span><span class="s1">axis</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>

    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;aAa&quot;</span><span class="s2">, </span><span class="s3">&quot;bBb&quot;</span><span class="s2">, </span><span class="s3">&quot;cCc&quot;</span><span class="s2">, </span><span class="s3">&quot;dDd&quot;</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected </span><span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index </span><span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>

    <span class="s4"># Series/Index with DataFrame</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">d</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># Series/Index with two-dimensional ndarray</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">d</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># Series/Index with list of Series</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">s</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># Series/Index with mixed list of Series/array</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># Series/Index with list of Series; different indexes</span>
    <span class="s1">t</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= [</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">box</span><span class="s2">([</span><span class="s3">&quot;aDa&quot;</span><span class="s2">, </span><span class="s3">&quot;bAb&quot;</span><span class="s2">, </span><span class="s3">&quot;cBc&quot;</span><span class="s2">, </span><span class="s3">&quot;dCd&quot;</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected </span><span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index </span><span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">s</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># Series/Index with mixed list; different index</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># Series/Index with DataFrame; different indexes</span>
    <span class="s1">d</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= [</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">]</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">box</span><span class="s2">([</span><span class="s3">&quot;aDd&quot;</span><span class="s2">, </span><span class="s3">&quot;bAa&quot;</span><span class="s2">, </span><span class="s3">&quot;cBb&quot;</span><span class="s2">, </span><span class="s3">&quot;dCc&quot;</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected </span><span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index </span><span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">d</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># errors for incorrect lengths</span>
    <span class="s1">rgx </span><span class="s2">= </span><span class="s3">r&quot;If `others` contains arrays or lists \(or other list-likes.*&quot;</span>
    <span class="s1">z </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;3&quot;</span><span class="s2">])</span>
    <span class="s1">e </span><span class="s2">= </span><span class="s1">concat</span><span class="s2">([</span><span class="s1">z</span><span class="s2">, </span><span class="s1">z</span><span class="s2">], </span><span class="s1">axis</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>

    <span class="s4"># two-dimensional ndarray</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">e</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>

    <span class="s4"># list of list-likes</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">z</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">])</span>

    <span class="s4"># mixed list of Series/list-like</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">z</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">s</span><span class="s2">])</span>

    <span class="s4"># errors for incorrect arguments in list-like</span>
    <span class="s1">rgx </span><span class="s2">= </span><span class="s3">&quot;others must be Series, Index, DataFrame,.*&quot;</span>
    <span class="s4"># make sure None/NaN do not crash checks in _get_series_list</span>
    <span class="s1">u </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">])</span>

    <span class="s4"># mix of string and Series</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">u</span><span class="s2">, </span><span class="s3">&quot;u&quot;</span><span class="s2">])</span>

    <span class="s4"># DataFrame in list</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">u</span><span class="s2">, </span><span class="s1">d</span><span class="s2">])</span>

    <span class="s4"># 2-dim ndarray in list</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">u</span><span class="s2">, </span><span class="s1">d</span><span class="s2">.</span><span class="s1">values</span><span class="s2">])</span>

    <span class="s4"># nested lists</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">u</span><span class="s2">, [</span><span class="s1">u</span><span class="s2">, </span><span class="s1">d</span><span class="s2">]])</span>

    <span class="s4"># forbidden input type: set</span>
    <span class="s4"># GH 23009</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">set</span><span class="s2">(</span><span class="s1">u</span><span class="s2">))</span>

    <span class="s4"># forbidden input type: set in list</span>
    <span class="s4"># GH 23009</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">u</span><span class="s2">, </span><span class="s1">set</span><span class="s2">(</span><span class="s1">u</span><span class="s2">)])</span>

    <span class="s4"># other forbidden input type, e.g. int</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s5">1</span><span class="s2">)</span>

    <span class="s4"># nested list-likes</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">iter</span><span class="s2">([</span><span class="s1">t</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">list</span><span class="s2">(</span><span class="s1">s</span><span class="s2">)]))</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;join&quot;</span><span class="s2">, [</span><span class="s3">&quot;left&quot;</span><span class="s2">, </span><span class="s3">&quot;outer&quot;</span><span class="s2">, </span><span class="s3">&quot;inner&quot;</span><span class="s2">, </span><span class="s3">&quot;right&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_str_cat_align_indexed</span><span class="s2">(</span><span class="s1">index_or_series</span><span class="s2">, </span><span class="s1">join</span><span class="s2">):</span>
    <span class="s4"># https://github.com/pandas-dev/pandas/issues/18657</span>
    <span class="s1">box </span><span class="s2">= </span><span class="s1">index_or_series</span>

    <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">])</span>
    <span class="s1">t </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;E&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">])</span>
    <span class="s1">sa</span><span class="s2">, </span><span class="s1">ta </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">align</span><span class="s2">(</span><span class="s1">t</span><span class="s2">, </span><span class="s1">join</span><span class="s2">=</span><span class="s1">join</span><span class="s2">)</span>
    <span class="s4"># result after manual alignment of inputs</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">sa</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">ta</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>

    <span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index</span><span class="s2">:</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">(</span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">sa </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">(</span><span class="s1">sa</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">t</span><span class="s2">, </span><span class="s1">join</span><span class="s2">=</span><span class="s1">join</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;join&quot;</span><span class="s2">, [</span><span class="s3">&quot;left&quot;</span><span class="s2">, </span><span class="s3">&quot;outer&quot;</span><span class="s2">, </span><span class="s3">&quot;inner&quot;</span><span class="s2">, </span><span class="s3">&quot;right&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_str_cat_align_mixed_inputs</span><span class="s2">(</span><span class="s1">join</span><span class="s2">):</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">])</span>
    <span class="s1">t </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">3</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])</span>
    <span class="s1">d </span><span class="s2">= </span><span class="s1">concat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">t</span><span class="s2">], </span><span class="s1">axis</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>

    <span class="s1">expected_outer </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;aaa&quot;</span><span class="s2">, </span><span class="s3">&quot;bbb&quot;</span><span class="s2">, </span><span class="s3">&quot;c--&quot;</span><span class="s2">, </span><span class="s3">&quot;ddd&quot;</span><span class="s2">, </span><span class="s3">&quot;-ee&quot;</span><span class="s2">])</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_outer</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s1">s</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s1">t</span><span class="s2">.</span><span class="s1">index</span><span class="s2">, </span><span class="s1">how</span><span class="s2">=</span><span class="s1">join</span><span class="s2">)]</span>

    <span class="s4"># list of Series</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">t</span><span class="s2">], </span><span class="s1">join</span><span class="s2">=</span><span class="s1">join</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># DataFrame</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">d</span><span class="s2">, </span><span class="s1">join</span><span class="s2">=</span><span class="s1">join</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># mixed list of indexed/unindexed</span>
    <span class="s1">u </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">])</span>
    <span class="s1">expected_outer </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;aaA&quot;</span><span class="s2">, </span><span class="s3">&quot;bbB&quot;</span><span class="s2">, </span><span class="s3">&quot;c-C&quot;</span><span class="s2">, </span><span class="s3">&quot;ddD&quot;</span><span class="s2">, </span><span class="s3">&quot;-e-&quot;</span><span class="s2">])</span>
    <span class="s4"># joint index of rhs [t, u]; u will be forced have index of s</span>
    <span class="s1">rhs_idx </span><span class="s2">= (</span>
        <span class="s1">t</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">intersection</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">join </span><span class="s2">== </span><span class="s3">&quot;inner&quot;</span>
        <span class="s0">else </span><span class="s1">t</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">union</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">join </span><span class="s2">== </span><span class="s3">&quot;outer&quot;</span>
        <span class="s0">else </span><span class="s1">t</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">difference</span><span class="s2">(</span><span class="s1">t</span><span class="s2">.</span><span class="s1">index</span><span class="s2">))</span>
    <span class="s2">)</span>

    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_outer</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s1">s</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s1">rhs_idx</span><span class="s2">, </span><span class="s1">how</span><span class="s2">=</span><span class="s1">join</span><span class="s2">)]</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">u</span><span class="s2">], </span><span class="s1">join</span><span class="s2">=</span><span class="s1">join</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;others must be Series,.*&quot;</span><span class="s2">):</span>
        <span class="s4"># nested lists are forbidden</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">list</span><span class="s2">(</span><span class="s1">u</span><span class="s2">)], </span><span class="s1">join</span><span class="s2">=</span><span class="s1">join</span><span class="s2">)</span>

    <span class="s4"># errors for incorrect lengths</span>
    <span class="s1">rgx </span><span class="s2">= </span><span class="s3">r&quot;If `others` contains arrays or lists \(or other list-likes.*&quot;</span>
    <span class="s1">z </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;1&quot;</span><span class="s2">, </span><span class="s3">&quot;2&quot;</span><span class="s2">, </span><span class="s3">&quot;3&quot;</span><span class="s2">]).</span><span class="s1">values</span>

    <span class="s4"># unindexed object of wrong length</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">z</span><span class="s2">, </span><span class="s1">join</span><span class="s2">=</span><span class="s1">join</span><span class="s2">)</span>

    <span class="s4"># unindexed object of wrong length in list</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">rgx</span><span class="s2">):</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">z</span><span class="s2">], </span><span class="s1">join</span><span class="s2">=</span><span class="s1">join</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_str_cat_all_na</span><span class="s2">(</span><span class="s1">index_or_series</span><span class="s2">, </span><span class="s1">index_or_series2</span><span class="s2">):</span>
    <span class="s4"># GH 24044</span>
    <span class="s1">box </span><span class="s2">= </span><span class="s1">index_or_series</span>
    <span class="s1">other </span><span class="s2">= </span><span class="s1">index_or_series2</span>

    <span class="s4"># check that all NaNs in caller / target work</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">])</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">s </span><span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Index </span><span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">s</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">)</span>
    <span class="s1">t </span><span class="s2">= </span><span class="s1">other</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s5">4</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s4"># add index of s for alignment</span>
    <span class="s1">t </span><span class="s2">= </span><span class="s1">t </span><span class="s0">if </span><span class="s1">other </span><span class="s2">== </span><span class="s1">Index </span><span class="s0">else </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">t</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">)</span>

    <span class="s4"># all-NA target</span>
    <span class="s0">if </span><span class="s1">box </span><span class="s2">== </span><span class="s1">Series</span><span class="s2">:</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s5">4</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">.</span><span class="s1">index</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">s</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:  </span><span class="s4"># box == Index</span>
        <span class="s4"># TODO: Strimg option, this should return string dtype</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s5">4</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">t</span><span class="s2">, </span><span class="s1">join</span><span class="s2">=</span><span class="s3">&quot;left&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># all-NA caller (only for Series)</span>
    <span class="s0">if </span><span class="s1">other </span><span class="s2">== </span><span class="s1">Series</span><span class="s2">:</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s5">4</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">t</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">t</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">s</span><span class="s2">, </span><span class="s1">join</span><span class="s2">=</span><span class="s3">&quot;left&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_str_cat_special_cases</span><span class="s2">():</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">])</span>
    <span class="s1">t </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">3</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])</span>

    <span class="s4"># iterator of elements with different types</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;aaa&quot;</span><span class="s2">, </span><span class="s3">&quot;bbb&quot;</span><span class="s2">, </span><span class="s3">&quot;c-c&quot;</span><span class="s2">, </span><span class="s3">&quot;ddd&quot;</span><span class="s2">, </span><span class="s3">&quot;-e-&quot;</span><span class="s2">])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">iter</span><span class="s2">([</span><span class="s1">t</span><span class="s2">, </span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">]), </span><span class="s1">join</span><span class="s2">=</span><span class="s3">&quot;outer&quot;</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s4"># right-align with different indexes in others</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;aa-&quot;</span><span class="s2">, </span><span class="s3">&quot;d-d&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">t</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[[</span><span class="s5">0</span><span class="s2">]], </span><span class="s1">t</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[[</span><span class="s5">3</span><span class="s2">]]], </span><span class="s1">join</span><span class="s2">=</span><span class="s3">&quot;right&quot;</span><span class="s2">, </span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_cat_on_filtered_index</span><span class="s2">():</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s1">index</span><span class="s2">=</span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">(</span>
            <span class="s2">[[</span><span class="s5">2011</span><span class="s2">, </span><span class="s5">2012</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]], </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;year&quot;</span><span class="s2">, </span><span class="s3">&quot;month&quot;</span><span class="s2">]</span>
        <span class="s2">)</span>
    <span class="s2">)</span>

    <span class="s1">df </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">reset_index</span><span class="s2">()</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">df</span><span class="s2">[</span><span class="s1">df</span><span class="s2">.</span><span class="s1">month </span><span class="s2">&gt; </span><span class="s5">1</span><span class="s2">]</span>

    <span class="s1">str_year </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">year</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s3">&quot;str&quot;</span><span class="s2">)</span>
    <span class="s1">str_month </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">month</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s3">&quot;str&quot;</span><span class="s2">)</span>
    <span class="s1">str_both </span><span class="s2">= </span><span class="s1">str_year</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">str_month</span><span class="s2">, </span><span class="s1">sep</span><span class="s2">=</span><span class="s3">&quot; &quot;</span><span class="s2">)</span>

    <span class="s0">assert </span><span class="s1">str_both</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">1</span><span class="s2">] == </span><span class="s3">&quot;2011 2&quot;</span>

    <span class="s1">str_multiple </span><span class="s2">= </span><span class="s1">str_year</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">([</span><span class="s1">str_month</span><span class="s2">, </span><span class="s1">str_month</span><span class="s2">], </span><span class="s1">sep</span><span class="s2">=</span><span class="s3">&quot; &quot;</span><span class="s2">)</span>

    <span class="s0">assert </span><span class="s1">str_multiple</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">1</span><span class="s2">] == </span><span class="s3">&quot;2011 2 2&quot;</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;klass&quot;</span><span class="s2">, [</span><span class="s1">tuple</span><span class="s2">, </span><span class="s1">list</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">, </span><span class="s1">Series</span><span class="s2">, </span><span class="s1">Index</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_cat_different_classes</span><span class="s2">(</span><span class="s1">klass</span><span class="s2">):</span>
    <span class="s4"># https://github.com/pandas-dev/pandas/issues/33425</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">klass</span><span class="s2">([</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s2">]))</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;ax&quot;</span><span class="s2">, </span><span class="s3">&quot;by&quot;</span><span class="s2">, </span><span class="s3">&quot;cz&quot;</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_cat_on_series_dot_str</span><span class="s2">():</span>
    <span class="s4"># GH 28277</span>
    <span class="s1">ps </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;AbC&quot;</span><span class="s2">, </span><span class="s3">&quot;de&quot;</span><span class="s2">, </span><span class="s3">&quot;FGHI&quot;</span><span class="s2">, </span><span class="s3">&quot;j&quot;</span><span class="s2">, </span><span class="s3">&quot;kLLLm&quot;</span><span class="s2">])</span>

    <span class="s1">message </span><span class="s2">= </span><span class="s1">re</span><span class="s2">.</span><span class="s1">escape</span><span class="s2">(</span>
        <span class="s3">&quot;others must be Series, Index, DataFrame, np.ndarray &quot;</span>
        <span class="s3">&quot;or list-like (either containing only strings or &quot;</span>
        <span class="s3">&quot;containing only objects of type Series/Index/&quot;</span>
        <span class="s3">&quot;np.ndarray[1-dim])&quot;</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">message</span><span class="s2">):</span>
        <span class="s1">ps</span><span class="s2">.</span><span class="s1">str</span><span class="s2">.</span><span class="s1">cat</span><span class="s2">(</span><span class="s1">others</span><span class="s2">=</span><span class="s1">ps</span><span class="s2">.</span><span class="s1">str</span><span class="s2">)</span>
</pre>
</body>
</html>