<html>
<head>
<title>validators.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #7a7e85;}
.s5 { color: #6aab73;}
.s6 { color: #2aacb8;}
.s7 { color: #a5c261;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
validators.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Various low level data validators.&quot;&quot;&quot;</span>

<span class="s2">import </span><span class="s1">calendar</span>
<span class="s2">from </span><span class="s1">io </span><span class="s2">import </span><span class="s1">open</span>
<span class="s2">import </span><span class="s1">fs</span><span class="s3">.</span><span class="s1">base</span>
<span class="s2">import </span><span class="s1">fs</span><span class="s3">.</span><span class="s1">osfs</span>

<span class="s2">from </span><span class="s1">collections</span><span class="s3">.</span><span class="s1">abc </span><span class="s2">import </span><span class="s1">Mapping</span>
<span class="s2">from </span><span class="s1">fontTools</span><span class="s3">.</span><span class="s1">ufoLib</span><span class="s3">.</span><span class="s1">utils </span><span class="s2">import </span><span class="s1">numberTypes</span>


<span class="s4"># -------</span>
<span class="s4"># Generic</span>
<span class="s4"># -------</span>


<span class="s2">def </span><span class="s1">isDictEnough</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Some objects will likely come in that aren't 
    dicts but are dict-ish enough. 
    &quot;&quot;&quot;</span>
    <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">Mapping</span><span class="s3">):</span>
        <span class="s2">return True</span>
    <span class="s2">for </span><span class="s1">attr </span><span class="s2">in </span><span class="s3">(</span><span class="s5">&quot;keys&quot;</span><span class="s3">, </span><span class="s5">&quot;values&quot;</span><span class="s3">, </span><span class="s5">&quot;items&quot;</span><span class="s3">):</span>
        <span class="s2">if not </span><span class="s1">hasattr</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">attr</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">genericTypeValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">typ</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Generic. (Added at version 2.) 
    &quot;&quot;&quot;</span>
    <span class="s2">return </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">typ</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">genericIntListValidator</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, </span><span class="s1">validValues</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Generic. (Added at version 2.) 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
        <span class="s2">return False</span>
    <span class="s1">valuesSet </span><span class="s3">= </span><span class="s1">set</span><span class="s3">(</span><span class="s1">values</span><span class="s3">)</span>
    <span class="s1">validValuesSet </span><span class="s3">= </span><span class="s1">set</span><span class="s3">(</span><span class="s1">validValues</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">valuesSet </span><span class="s3">- </span><span class="s1">validValuesSet</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">values</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">int</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">genericNonNegativeIntValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Generic. (Added at version 3.) 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">int</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">value </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">genericNonNegativeNumberValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Generic. (Added at version 3.) 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">numberTypes</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">value </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">prototype</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Generic. (Added at version 3.) 
    &quot;&quot;&quot;</span>
    <span class="s4"># not a dict</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">Mapping</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s4"># missing required keys</span>
    <span class="s2">for </span><span class="s1">key</span><span class="s3">, (</span><span class="s1">typ</span><span class="s3">, </span><span class="s1">required</span><span class="s3">) </span><span class="s2">in </span><span class="s1">prototype</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
        <span class="s2">if not </span><span class="s1">required</span><span class="s3">:</span>
            <span class="s2">continue</span>
        <span class="s2">if </span><span class="s1">key </span><span class="s2">not in </span><span class="s1">value</span><span class="s3">:</span>
            <span class="s2">return False</span>
    <span class="s4"># unknown keys</span>
    <span class="s2">for </span><span class="s1">key </span><span class="s2">in </span><span class="s1">value</span><span class="s3">.</span><span class="s1">keys</span><span class="s3">():</span>
        <span class="s2">if </span><span class="s1">key </span><span class="s2">not in </span><span class="s1">prototype</span><span class="s3">:</span>
            <span class="s2">return False</span>
    <span class="s4"># incorrect types</span>
    <span class="s2">for </span><span class="s1">key</span><span class="s3">, </span><span class="s1">v </span><span class="s2">in </span><span class="s1">value</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
        <span class="s1">prototypeType</span><span class="s3">, </span><span class="s1">required </span><span class="s3">= </span><span class="s1">prototype</span><span class="s3">[</span><span class="s1">key</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">v </span><span class="s2">is None and not </span><span class="s1">required</span><span class="s3">:</span>
            <span class="s2">continue</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">v</span><span class="s3">, </span><span class="s1">prototypeType</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s4"># --------------</span>
<span class="s4"># fontinfo.plist</span>
<span class="s4"># --------------</span>

<span class="s4"># Data Validators</span>


<span class="s2">def </span><span class="s1">fontInfoStyleMapStyleNameValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s1">options </span><span class="s3">= [</span><span class="s5">&quot;regular&quot;</span><span class="s3">, </span><span class="s5">&quot;italic&quot;</span><span class="s3">, </span><span class="s5">&quot;bold&quot;</span><span class="s3">, </span><span class="s5">&quot;bold italic&quot;</span><span class="s3">]</span>
    <span class="s2">return </span><span class="s1">value </span><span class="s2">in </span><span class="s1">options</span>


<span class="s2">def </span><span class="s1">fontInfoOpenTypeGaspRangeRecordsValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">list</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">value</span><span class="s3">) == </span><span class="s6">0</span><span class="s3">:</span>
        <span class="s2">return True</span>
    <span class="s1">validBehaviors </span><span class="s3">= [</span><span class="s6">0</span><span class="s3">, </span><span class="s6">1</span><span class="s3">, </span><span class="s6">2</span><span class="s3">, </span><span class="s6">3</span><span class="s3">]</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">rangeMaxPPEM</span><span class="s3">=(</span><span class="s1">int</span><span class="s3">, </span><span class="s2">True</span><span class="s3">), </span><span class="s1">rangeGaspBehavior</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">True</span><span class="s3">))</span>
    <span class="s1">ppemOrder </span><span class="s3">= []</span>
    <span class="s2">for </span><span class="s1">rangeRecord </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">rangeRecord</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
            <span class="s2">return False</span>
        <span class="s1">ppem </span><span class="s3">= </span><span class="s1">rangeRecord</span><span class="s3">[</span><span class="s5">&quot;rangeMaxPPEM&quot;</span><span class="s3">]</span>
        <span class="s1">behavior </span><span class="s3">= </span><span class="s1">rangeRecord</span><span class="s3">[</span><span class="s5">&quot;rangeGaspBehavior&quot;</span><span class="s3">]</span>
        <span class="s1">ppemValidity </span><span class="s3">= </span><span class="s1">genericNonNegativeIntValidator</span><span class="s3">(</span><span class="s1">ppem</span><span class="s3">)</span>
        <span class="s2">if not </span><span class="s1">ppemValidity</span><span class="s3">:</span>
            <span class="s2">return False</span>
        <span class="s1">behaviorValidity </span><span class="s3">= </span><span class="s1">genericIntListValidator</span><span class="s3">(</span><span class="s1">behavior</span><span class="s3">, </span><span class="s1">validBehaviors</span><span class="s3">)</span>
        <span class="s2">if not </span><span class="s1">behaviorValidity</span><span class="s3">:</span>
            <span class="s2">return False</span>
        <span class="s1">ppemOrder</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">ppem</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">ppemOrder </span><span class="s3">!= </span><span class="s1">sorted</span><span class="s3">(</span><span class="s1">ppemOrder</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoOpenTypeHeadCreatedValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s4"># format: 0000/00/00 00:00:00</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s4"># basic formatting</span>
    <span class="s2">if not </span><span class="s1">len</span><span class="s3">(</span><span class="s1">value</span><span class="s3">) == </span><span class="s6">19</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">value</span><span class="s3">.</span><span class="s1">count</span><span class="s3">(</span><span class="s5">&quot; &quot;</span><span class="s3">) != </span><span class="s6">1</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s1">date</span><span class="s3">, </span><span class="s1">time </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">&quot; &quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">date</span><span class="s3">.</span><span class="s1">count</span><span class="s3">(</span><span class="s5">&quot;/&quot;</span><span class="s3">) != </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">time</span><span class="s3">.</span><span class="s1">count</span><span class="s3">(</span><span class="s5">&quot;:&quot;</span><span class="s3">) != </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s4"># date</span>
    <span class="s1">year</span><span class="s3">, </span><span class="s1">month</span><span class="s3">, </span><span class="s1">day </span><span class="s3">= </span><span class="s1">date</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">&quot;/&quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">year</span><span class="s3">) != </span><span class="s6">4</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">month</span><span class="s3">) != </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">day</span><span class="s3">) != </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">try</span><span class="s3">:</span>
        <span class="s1">year </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">year</span><span class="s3">)</span>
        <span class="s1">month </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">month</span><span class="s3">)</span>
        <span class="s1">day </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">day</span><span class="s3">)</span>
    <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">month </span><span class="s3">&lt; </span><span class="s6">1 </span><span class="s2">or </span><span class="s1">month </span><span class="s3">&gt; </span><span class="s6">12</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s1">monthMaxDay </span><span class="s3">= </span><span class="s1">calendar</span><span class="s3">.</span><span class="s1">monthrange</span><span class="s3">(</span><span class="s1">year</span><span class="s3">, </span><span class="s1">month</span><span class="s3">)[</span><span class="s6">1</span><span class="s3">]</span>
    <span class="s2">if </span><span class="s1">day </span><span class="s3">&lt; </span><span class="s6">1 </span><span class="s2">or </span><span class="s1">day </span><span class="s3">&gt; </span><span class="s1">monthMaxDay</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s4"># time</span>
    <span class="s1">hour</span><span class="s3">, </span><span class="s1">minute</span><span class="s3">, </span><span class="s1">second </span><span class="s3">= </span><span class="s1">time</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">&quot;:&quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">hour</span><span class="s3">) != </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">minute</span><span class="s3">) != </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">second</span><span class="s3">) != </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">try</span><span class="s3">:</span>
        <span class="s1">hour </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">hour</span><span class="s3">)</span>
        <span class="s1">minute </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">minute</span><span class="s3">)</span>
        <span class="s1">second </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">second</span><span class="s3">)</span>
    <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">hour </span><span class="s3">&lt; </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">hour </span><span class="s3">&gt; </span><span class="s6">23</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">minute </span><span class="s3">&lt; </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">minute </span><span class="s3">&gt; </span><span class="s6">59</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">second </span><span class="s3">&lt; </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">second </span><span class="s3">&gt; </span><span class="s6">59</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s4"># fallback</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoOpenTypeNameRecordsValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">list</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span>
        <span class="s1">nameID</span><span class="s3">=(</span><span class="s1">int</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s1">platformID</span><span class="s3">=(</span><span class="s1">int</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s1">encodingID</span><span class="s3">=(</span><span class="s1">int</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s1">languageID</span><span class="s3">=(</span><span class="s1">int</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s1">string</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
    <span class="s3">)</span>
    <span class="s2">for </span><span class="s1">nameRecord </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">nameRecord</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoOpenTypeOS2WeightClassValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">int</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">value </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoOpenTypeOS2WidthClassValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">int</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">value </span><span class="s3">&lt; </span><span class="s6">1</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">value </span><span class="s3">&gt; </span><span class="s6">9</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoVersion2OpenTypeOS2PanoseValidator</span><span class="s3">(</span><span class="s1">values</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">values</span><span class="s3">) != </span><span class="s6">10</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">values</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">int</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s4"># XXX further validation?</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoVersion3OpenTypeOS2PanoseValidator</span><span class="s3">(</span><span class="s1">values</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">values</span><span class="s3">) != </span><span class="s6">10</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">values</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">int</span><span class="s3">):</span>
            <span class="s2">return False</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s2">return False</span>
    <span class="s4"># XXX further validation?</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoOpenTypeOS2FamilyClassValidator</span><span class="s3">(</span><span class="s1">values</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">values</span><span class="s3">) != </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">values</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">int</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s1">classID</span><span class="s3">, </span><span class="s1">subclassID </span><span class="s3">= </span><span class="s1">values</span>
    <span class="s2">if </span><span class="s1">classID </span><span class="s3">&lt; </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">classID </span><span class="s3">&gt; </span><span class="s6">14</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">subclassID </span><span class="s3">&lt; </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">subclassID </span><span class="s3">&gt; </span><span class="s6">15</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoPostscriptBluesValidator</span><span class="s3">(</span><span class="s1">values</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">values</span><span class="s3">) &gt; </span><span class="s6">14</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">values</span><span class="s3">) % </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">values</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">numberTypes</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoPostscriptOtherBluesValidator</span><span class="s3">(</span><span class="s1">values</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">values</span><span class="s3">) &gt; </span><span class="s6">10</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">values</span><span class="s3">) % </span><span class="s6">2</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">values</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">numberTypes</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoPostscriptStemsValidator</span><span class="s3">(</span><span class="s1">values</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">values</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">values</span><span class="s3">) &gt; </span><span class="s6">12</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">value </span><span class="s2">in </span><span class="s1">values</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">numberTypes</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoPostscriptWindowsCharacterSetValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 2+. 
    &quot;&quot;&quot;</span>
    <span class="s1">validValues </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s6">1</span><span class="s3">, </span><span class="s6">21</span><span class="s3">))</span>
    <span class="s2">if </span><span class="s1">value </span><span class="s2">not in </span><span class="s1">validValues</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataUniqueIDValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">id</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">))</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataVendorValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= {</span>
        <span class="s5">&quot;name&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s5">&quot;url&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;dir&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;class&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s3">}</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s5">&quot;dir&quot; </span><span class="s2">in </span><span class="s1">value </span><span class="s2">and </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;dir&quot;</span><span class="s3">) </span><span class="s2">not in </span><span class="s3">(</span><span class="s5">&quot;ltr&quot;</span><span class="s3">, </span><span class="s5">&quot;rtl&quot;</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataCreditsValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">credits</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">True</span><span class="s3">))</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if not </span><span class="s1">len</span><span class="s3">(</span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;credits&quot;</span><span class="s3">]):</span>
        <span class="s2">return False</span>
    <span class="s1">dictPrototype </span><span class="s3">= {</span>
        <span class="s5">&quot;name&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s5">&quot;url&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;role&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;dir&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;class&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s3">}</span>
    <span class="s2">for </span><span class="s1">credit </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;credits&quot;</span><span class="s3">]:</span>
        <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">credit</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
            <span class="s2">return False</span>
        <span class="s2">if </span><span class="s5">&quot;dir&quot; </span><span class="s2">in </span><span class="s1">credit </span><span class="s2">and </span><span class="s1">credit</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;dir&quot;</span><span class="s3">) </span><span class="s2">not in </span><span class="s3">(</span><span class="s5">&quot;ltr&quot;</span><span class="s3">, </span><span class="s5">&quot;rtl&quot;</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataDescriptionValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">url</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">), </span><span class="s1">text</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">True</span><span class="s3">))</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">text </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;text&quot;</span><span class="s3">]:</span>
        <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataTextValue</span><span class="s3">(</span><span class="s1">text</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataLicenseValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">url</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">), </span><span class="s1">text</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">False</span><span class="s3">), </span><span class="s1">id</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">))</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s5">&quot;text&quot; </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">for </span><span class="s1">text </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;text&quot;</span><span class="s3">]:</span>
            <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataTextValue</span><span class="s3">(</span><span class="s1">text</span><span class="s3">):</span>
                <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataTrademarkValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">text</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">True</span><span class="s3">))</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">text </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;text&quot;</span><span class="s3">]:</span>
        <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataTextValue</span><span class="s3">(</span><span class="s1">text</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataCopyrightValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">text</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">True</span><span class="s3">))</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">text </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;text&quot;</span><span class="s3">]:</span>
        <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataTextValue</span><span class="s3">(</span><span class="s1">text</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataLicenseeValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= {</span><span class="s5">&quot;name&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">), </span><span class="s5">&quot;dir&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">), </span><span class="s5">&quot;class&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">)}</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s5">&quot;dir&quot; </span><span class="s2">in </span><span class="s1">value </span><span class="s2">and </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;dir&quot;</span><span class="s3">) </span><span class="s2">not in </span><span class="s3">(</span><span class="s5">&quot;ltr&quot;</span><span class="s3">, </span><span class="s5">&quot;rtl&quot;</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataTextValue</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= {</span>
        <span class="s5">&quot;text&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s5">&quot;language&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;dir&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;class&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s3">}</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s5">&quot;dir&quot; </span><span class="s2">in </span><span class="s1">value </span><span class="s2">and </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;dir&quot;</span><span class="s3">) </span><span class="s2">not in </span><span class="s3">(</span><span class="s5">&quot;ltr&quot;</span><span class="s3">, </span><span class="s5">&quot;rtl&quot;</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataExtensionsValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">list</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if not </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">extension </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataExtensionValidator</span><span class="s3">(</span><span class="s1">extension</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataExtensionValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">names</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">False</span><span class="s3">), </span><span class="s1">items</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">True</span><span class="s3">), </span><span class="s1">id</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">))</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s5">&quot;names&quot; </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">for </span><span class="s1">name </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;names&quot;</span><span class="s3">]:</span>
            <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataExtensionNameValidator</span><span class="s3">(</span><span class="s1">name</span><span class="s3">):</span>
                <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">item </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;items&quot;</span><span class="s3">]:</span>
        <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataExtensionItemValidator</span><span class="s3">(</span><span class="s1">item</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataExtensionItemValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span><span class="s1">id</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">), </span><span class="s1">names</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">True</span><span class="s3">), </span><span class="s1">values</span><span class="s3">=(</span><span class="s1">list</span><span class="s3">, </span><span class="s2">True</span><span class="s3">))</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">name </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;names&quot;</span><span class="s3">]:</span>
        <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataExtensionNameValidator</span><span class="s3">(</span><span class="s1">name</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">val </span><span class="s2">in </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;values&quot;</span><span class="s3">]:</span>
        <span class="s2">if not </span><span class="s1">fontInfoWOFFMetadataExtensionValueValidator</span><span class="s3">(</span><span class="s1">val</span><span class="s3">):</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataExtensionNameValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= {</span>
        <span class="s5">&quot;text&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s5">&quot;language&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;dir&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;class&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s3">}</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s5">&quot;dir&quot; </span><span class="s2">in </span><span class="s1">value </span><span class="s2">and </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;dir&quot;</span><span class="s3">) </span><span class="s2">not in </span><span class="s3">(</span><span class="s5">&quot;ltr&quot;</span><span class="s3">, </span><span class="s5">&quot;rtl&quot;</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">fontInfoWOFFMetadataExtensionValueValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s1">dictPrototype </span><span class="s3">= {</span>
        <span class="s5">&quot;text&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
        <span class="s5">&quot;language&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;dir&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
        <span class="s5">&quot;class&quot;</span><span class="s3">: (</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s3">}</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">dictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s5">&quot;dir&quot; </span><span class="s2">in </span><span class="s1">value </span><span class="s2">and </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;dir&quot;</span><span class="s3">) </span><span class="s2">not in </span><span class="s3">(</span><span class="s5">&quot;ltr&quot;</span><span class="s3">, </span><span class="s5">&quot;rtl&quot;</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s4"># ----------</span>
<span class="s4"># Guidelines</span>
<span class="s4"># ----------</span>


<span class="s2">def </span><span class="s1">guidelinesValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">identifiers</span><span class="s3">=</span><span class="s2">None</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">list</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">identifiers </span><span class="s2">is None</span><span class="s3">:</span>
        <span class="s1">identifiers </span><span class="s3">= </span><span class="s1">set</span><span class="s3">()</span>
    <span class="s2">for </span><span class="s1">guide </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">guidelineValidator</span><span class="s3">(</span><span class="s1">guide</span><span class="s3">):</span>
            <span class="s2">return False</span>
        <span class="s1">identifier </span><span class="s3">= </span><span class="s1">guide</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;identifier&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">identifier </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">identifier </span><span class="s2">in </span><span class="s1">identifiers</span><span class="s3">:</span>
                <span class="s2">return False</span>
            <span class="s1">identifiers</span><span class="s3">.</span><span class="s1">add</span><span class="s3">(</span><span class="s1">identifier</span><span class="s3">)</span>
    <span class="s2">return True</span>


<span class="s1">_guidelineDictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span>
    <span class="s1">x</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">y</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">angle</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">name</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">color</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">identifier</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
<span class="s3">)</span>


<span class="s2">def </span><span class="s1">guidelineValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">_guidelineDictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s1">x </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
    <span class="s1">y </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;y&quot;</span><span class="s3">)</span>
    <span class="s1">angle </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;angle&quot;</span><span class="s3">)</span>
    <span class="s4"># x or y must be present</span>
    <span class="s2">if </span><span class="s1">x </span><span class="s2">is None and </span><span class="s1">y </span><span class="s2">is None</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s4"># if x or y are None, angle must not be present</span>
    <span class="s2">if </span><span class="s1">x </span><span class="s2">is None or </span><span class="s1">y </span><span class="s2">is None</span><span class="s3">:</span>
        <span class="s2">if </span><span class="s1">angle </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s2">return False</span>
    <span class="s4"># if x and y are defined, angle must be defined</span>
    <span class="s2">if </span><span class="s1">x </span><span class="s2">is not None and </span><span class="s1">y </span><span class="s2">is not None and </span><span class="s1">angle </span><span class="s2">is None</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s4"># angle must be between 0 and 360</span>
    <span class="s2">if </span><span class="s1">angle </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s2">if </span><span class="s1">angle </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s2">return False</span>
        <span class="s2">if </span><span class="s1">angle </span><span class="s3">&gt; </span><span class="s6">360</span><span class="s3">:</span>
            <span class="s2">return False</span>
    <span class="s4"># identifier must be 1 or more characters</span>
    <span class="s1">identifier </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;identifier&quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">identifier </span><span class="s2">is not None and not </span><span class="s1">identifierValidator</span><span class="s3">(</span><span class="s1">identifier</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s4"># color must follow the proper format</span>
    <span class="s1">color </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;color&quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">color </span><span class="s2">is not None and not </span><span class="s1">colorValidator</span><span class="s3">(</span><span class="s1">color</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s4"># -------</span>
<span class="s4"># Anchors</span>
<span class="s4"># -------</span>


<span class="s2">def </span><span class="s1">anchorsValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">identifiers</span><span class="s3">=</span><span class="s2">None</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">list</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">identifiers </span><span class="s2">is None</span><span class="s3">:</span>
        <span class="s1">identifiers </span><span class="s3">= </span><span class="s1">set</span><span class="s3">()</span>
    <span class="s2">for </span><span class="s1">anchor </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">if not </span><span class="s1">anchorValidator</span><span class="s3">(</span><span class="s1">anchor</span><span class="s3">):</span>
            <span class="s2">return False</span>
        <span class="s1">identifier </span><span class="s3">= </span><span class="s1">anchor</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;identifier&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">identifier </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">identifier </span><span class="s2">in </span><span class="s1">identifiers</span><span class="s3">:</span>
                <span class="s2">return False</span>
            <span class="s1">identifiers</span><span class="s3">.</span><span class="s1">add</span><span class="s3">(</span><span class="s1">identifier</span><span class="s3">)</span>
    <span class="s2">return True</span>


<span class="s1">_anchorDictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span>
    <span class="s1">x</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">y</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">name</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">color</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">identifier</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
<span class="s3">)</span>


<span class="s2">def </span><span class="s1">anchorValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">_anchorDictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s1">x </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
    <span class="s1">y </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;y&quot;</span><span class="s3">)</span>
    <span class="s4"># x and y must be present</span>
    <span class="s2">if </span><span class="s1">x </span><span class="s2">is None or </span><span class="s1">y </span><span class="s2">is None</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s4"># identifier must be 1 or more characters</span>
    <span class="s1">identifier </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;identifier&quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">identifier </span><span class="s2">is not None and not </span><span class="s1">identifierValidator</span><span class="s3">(</span><span class="s1">identifier</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s4"># color must follow the proper format</span>
    <span class="s1">color </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;color&quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">color </span><span class="s2">is not None and not </span><span class="s1">colorValidator</span><span class="s3">(</span><span class="s1">color</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s4"># ----------</span>
<span class="s4"># Identifier</span>
<span class="s4"># ----------</span>


<span class="s2">def </span><span class="s1">identifierValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
 
    &gt;&gt;&gt; identifierValidator(&quot;a&quot;) 
    True 
    &gt;&gt;&gt; identifierValidator(&quot;&quot;) 
    False 
    &gt;&gt;&gt; identifierValidator(&quot;a&quot; * 101) 
    False 
    &quot;&quot;&quot;</span>
    <span class="s1">validCharactersMin </span><span class="s3">= </span><span class="s6">0x20</span>
    <span class="s1">validCharactersMax </span><span class="s3">= </span><span class="s6">0x7E</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">if not </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">value</span><span class="s3">) &gt; </span><span class="s6">100</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">c </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s1">c </span><span class="s3">= </span><span class="s1">ord</span><span class="s3">(</span><span class="s1">c</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">c </span><span class="s3">&lt; </span><span class="s1">validCharactersMin </span><span class="s2">or </span><span class="s1">c </span><span class="s3">&gt; </span><span class="s1">validCharactersMax</span><span class="s3">:</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s4"># -----</span>
<span class="s4"># Color</span>
<span class="s4"># -----</span>


<span class="s2">def </span><span class="s1">colorValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
 
    &gt;&gt;&gt; colorValidator(&quot;0,0,0,0&quot;) 
    True 
    &gt;&gt;&gt; colorValidator(&quot;.5,.5,.5,.5&quot;) 
    True 
    &gt;&gt;&gt; colorValidator(&quot;0.5,0.5,0.5,0.5&quot;) 
    True 
    &gt;&gt;&gt; colorValidator(&quot;1,1,1,1&quot;) 
    True 
 
    &gt;&gt;&gt; colorValidator(&quot;2,0,0,0&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;0,2,0,0&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;0,0,2,0&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;0,0,0,2&quot;) 
    False 
 
    &gt;&gt;&gt; colorValidator(&quot;1r,1,1,1&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;1,1g,1,1&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;1,1,1b,1&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;1,1,1,1a&quot;) 
    False 
 
    &gt;&gt;&gt; colorValidator(&quot;1 1 1 1&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;1 1,1,1&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;1,1 1,1&quot;) 
    False 
    &gt;&gt;&gt; colorValidator(&quot;1,1,1 1&quot;) 
    False 
 
    &gt;&gt;&gt; colorValidator(&quot;1, 1, 1, 1&quot;) 
    True 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s1">parts </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">split</span><span class="s3">(</span><span class="s5">&quot;,&quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">parts</span><span class="s3">) != </span><span class="s6">4</span><span class="s3">:</span>
        <span class="s2">return False</span>
    <span class="s2">for </span><span class="s1">part </span><span class="s2">in </span><span class="s1">parts</span><span class="s3">:</span>
        <span class="s1">part </span><span class="s3">= </span><span class="s1">part</span><span class="s3">.</span><span class="s1">strip</span><span class="s3">()</span>
        <span class="s1">converted </span><span class="s3">= </span><span class="s2">False</span>
        <span class="s2">try</span><span class="s3">:</span>
            <span class="s1">part </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">part</span><span class="s3">)</span>
            <span class="s1">converted </span><span class="s3">= </span><span class="s2">True</span>
        <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
            <span class="s2">pass</span>
        <span class="s2">if not </span><span class="s1">converted</span><span class="s3">:</span>
            <span class="s2">try</span><span class="s3">:</span>
                <span class="s1">part </span><span class="s3">= </span><span class="s1">float</span><span class="s3">(</span><span class="s1">part</span><span class="s3">)</span>
                <span class="s1">converted </span><span class="s3">= </span><span class="s2">True</span>
            <span class="s2">except </span><span class="s1">ValueError</span><span class="s3">:</span>
                <span class="s2">pass</span>
        <span class="s2">if not </span><span class="s1">converted</span><span class="s3">:</span>
            <span class="s2">return False</span>
        <span class="s2">if </span><span class="s1">part </span><span class="s3">&lt; </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s2">return False</span>
        <span class="s2">if </span><span class="s1">part </span><span class="s3">&gt; </span><span class="s6">1</span><span class="s3">:</span>
            <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s4"># -----</span>
<span class="s4"># image</span>
<span class="s4"># -----</span>

<span class="s1">pngSignature </span><span class="s3">= </span><span class="s7">b&quot;</span><span class="s2">\x89</span><span class="s7">PNG</span><span class="s2">\r\n\x1a\n</span><span class="s7">&quot;</span>

<span class="s1">_imageDictPrototype </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">(</span>
    <span class="s1">fileName</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">True</span><span class="s3">),</span>
    <span class="s1">xScale</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">xyScale</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">yxScale</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">yScale</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">xOffset</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">yOffset</span><span class="s3">=((</span><span class="s1">int</span><span class="s3">, </span><span class="s1">float</span><span class="s3">), </span><span class="s2">False</span><span class="s3">),</span>
    <span class="s1">color</span><span class="s3">=(</span><span class="s1">str</span><span class="s3">, </span><span class="s2">False</span><span class="s3">),</span>
<span class="s3">)</span>


<span class="s2">def </span><span class="s1">imageValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">genericDictValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">_imageDictPrototype</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s4"># fileName must be one or more characters</span>
    <span class="s2">if not </span><span class="s1">value</span><span class="s3">[</span><span class="s5">&quot;fileName&quot;</span><span class="s3">]:</span>
        <span class="s2">return False</span>
    <span class="s4"># color must follow the proper format</span>
    <span class="s1">color </span><span class="s3">= </span><span class="s1">value</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s5">&quot;color&quot;</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">color </span><span class="s2">is not None and not </span><span class="s1">colorValidator</span><span class="s3">(</span><span class="s1">color</span><span class="s3">):</span>
        <span class="s2">return False</span>
    <span class="s2">return True</span>


<span class="s2">def </span><span class="s1">pngValidator</span><span class="s3">(</span><span class="s1">path</span><span class="s3">=</span><span class="s2">None</span><span class="s3">, </span><span class="s1">data</span><span class="s3">=</span><span class="s2">None</span><span class="s3">, </span><span class="s1">fileObj</span><span class="s3">=</span><span class="s2">None</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Version 3+. 
 
    This checks the signature of the image data. 
    &quot;&quot;&quot;</span>
    <span class="s2">assert </span><span class="s1">path </span><span class="s2">is not None or </span><span class="s1">data </span><span class="s2">is not None or </span><span class="s1">fileObj </span><span class="s2">is not None</span>
    <span class="s2">if </span><span class="s1">path </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s2">with </span><span class="s1">open</span><span class="s3">(</span><span class="s1">path</span><span class="s3">, </span><span class="s5">&quot;rb&quot;</span><span class="s3">) </span><span class="s2">as </span><span class="s1">f</span><span class="s3">:</span>
            <span class="s1">signature </span><span class="s3">= </span><span class="s1">f</span><span class="s3">.</span><span class="s1">read</span><span class="s3">(</span><span class="s6">8</span><span class="s3">)</span>
    <span class="s2">elif </span><span class="s1">data </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s1">signature </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[:</span><span class="s6">8</span><span class="s3">]</span>
    <span class="s2">elif </span><span class="s1">fileObj </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s1">pos </span><span class="s3">= </span><span class="s1">fileObj</span><span class="s3">.</span><span class="s1">tell</span><span class="s3">()</span>
        <span class="s1">signature </span><span class="s3">= </span><span class="s1">fileObj</span><span class="s3">.</span><span class="s1">read</span><span class="s3">(</span><span class="s6">8</span><span class="s3">)</span>
        <span class="s1">fileObj</span><span class="s3">.</span><span class="s1">seek</span><span class="s3">(</span><span class="s1">pos</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">signature </span><span class="s3">!= </span><span class="s1">pngSignature</span><span class="s3">:</span>
        <span class="s2">return False</span><span class="s3">, </span><span class="s5">&quot;Image does not begin with the PNG signature.&quot;</span>
    <span class="s2">return True</span><span class="s3">, </span><span class="s2">None</span>


<span class="s4"># -------------------</span>
<span class="s4"># layercontents.plist</span>
<span class="s4"># -------------------</span>


<span class="s2">def </span><span class="s1">layerContentsValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">ufoPathOrFileSystem</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Check the validity of layercontents.plist. 
    Version 3+. 
    &quot;&quot;&quot;</span>
    <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">ufoPathOrFileSystem</span><span class="s3">, </span><span class="s1">fs</span><span class="s3">.</span><span class="s1">base</span><span class="s3">.</span><span class="s1">FS</span><span class="s3">):</span>
        <span class="s1">fileSystem </span><span class="s3">= </span><span class="s1">ufoPathOrFileSystem</span>
    <span class="s2">else</span><span class="s3">:</span>
        <span class="s1">fileSystem </span><span class="s3">= </span><span class="s1">fs</span><span class="s3">.</span><span class="s1">osfs</span><span class="s3">.</span><span class="s1">OSFS</span><span class="s3">(</span><span class="s1">ufoPathOrFileSystem</span><span class="s3">)</span>

    <span class="s1">bogusFileMessage </span><span class="s3">= </span><span class="s5">&quot;layercontents.plist in not in the correct format.&quot;</span>
    <span class="s4"># file isn't in the right format</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">list</span><span class="s3">):</span>
        <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFileMessage</span>
    <span class="s4"># work through each entry</span>
    <span class="s1">usedLayerNames </span><span class="s3">= </span><span class="s1">set</span><span class="s3">()</span>
    <span class="s1">usedDirectories </span><span class="s3">= </span><span class="s1">set</span><span class="s3">()</span>
    <span class="s1">contents </span><span class="s3">= {}</span>
    <span class="s2">for </span><span class="s1">entry </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
        <span class="s4"># layer entry in the incorrect format</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">entry</span><span class="s3">, </span><span class="s1">list</span><span class="s3">):</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFileMessage</span>
        <span class="s2">if not </span><span class="s1">len</span><span class="s3">(</span><span class="s1">entry</span><span class="s3">) == </span><span class="s6">2</span><span class="s3">:</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFileMessage</span>
        <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">entry</span><span class="s3">:</span>
            <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">i</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
                <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFileMessage</span>
        <span class="s1">layerName</span><span class="s3">, </span><span class="s1">directoryName </span><span class="s3">= </span><span class="s1">entry</span>
        <span class="s4"># check directory naming</span>
        <span class="s2">if </span><span class="s1">directoryName </span><span class="s3">!= </span><span class="s5">&quot;glyphs&quot;</span><span class="s3">:</span>
            <span class="s2">if not </span><span class="s1">directoryName</span><span class="s3">.</span><span class="s1">startswith</span><span class="s3">(</span><span class="s5">&quot;glyphs.&quot;</span><span class="s3">):</span>
                <span class="s2">return </span><span class="s3">(</span>
                    <span class="s2">False</span><span class="s3">,</span>
                    <span class="s5">&quot;Invalid directory name (%s) in layercontents.plist.&quot;</span>
                    <span class="s3">% </span><span class="s1">directoryName</span><span class="s3">,</span>
                <span class="s3">)</span>
        <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">layerName</span><span class="s3">) == </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s5">&quot;Empty layer name in layercontents.plist.&quot;</span>
        <span class="s4"># directory doesn't exist</span>
        <span class="s2">if not </span><span class="s1">fileSystem</span><span class="s3">.</span><span class="s1">exists</span><span class="s3">(</span><span class="s1">directoryName</span><span class="s3">):</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s5">&quot;A glyphset does not exist at %s.&quot; </span><span class="s3">% </span><span class="s1">directoryName</span>
        <span class="s4"># default layer name</span>
        <span class="s2">if </span><span class="s1">layerName </span><span class="s3">== </span><span class="s5">&quot;public.default&quot; </span><span class="s2">and </span><span class="s1">directoryName </span><span class="s3">!= </span><span class="s5">&quot;glyphs&quot;</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s3">(</span>
                <span class="s2">False</span><span class="s3">,</span>
                <span class="s5">&quot;The name public.default is being used by a layer that is not the default.&quot;</span><span class="s3">,</span>
            <span class="s3">)</span>
        <span class="s4"># check usage</span>
        <span class="s2">if </span><span class="s1">layerName </span><span class="s2">in </span><span class="s1">usedLayerNames</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s3">(</span>
                <span class="s2">False</span><span class="s3">,</span>
                <span class="s5">&quot;The layer name %s is used by more than one layer.&quot; </span><span class="s3">% </span><span class="s1">layerName</span><span class="s3">,</span>
            <span class="s3">)</span>
        <span class="s1">usedLayerNames</span><span class="s3">.</span><span class="s1">add</span><span class="s3">(</span><span class="s1">layerName</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">directoryName </span><span class="s2">in </span><span class="s1">usedDirectories</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s3">(</span>
                <span class="s2">False</span><span class="s3">,</span>
                <span class="s5">&quot;The directory %s is used by more than one layer.&quot; </span><span class="s3">% </span><span class="s1">directoryName</span><span class="s3">,</span>
            <span class="s3">)</span>
        <span class="s1">usedDirectories</span><span class="s3">.</span><span class="s1">add</span><span class="s3">(</span><span class="s1">directoryName</span><span class="s3">)</span>
        <span class="s4"># store</span>
        <span class="s1">contents</span><span class="s3">[</span><span class="s1">layerName</span><span class="s3">] = </span><span class="s1">directoryName</span>
    <span class="s4"># missing default layer</span>
    <span class="s1">foundDefault </span><span class="s3">= </span><span class="s5">&quot;glyphs&quot; </span><span class="s2">in </span><span class="s1">contents</span><span class="s3">.</span><span class="s1">values</span><span class="s3">()</span>
    <span class="s2">if not </span><span class="s1">foundDefault</span><span class="s3">:</span>
        <span class="s2">return False</span><span class="s3">, </span><span class="s5">&quot;The required default glyph set is not in the UFO.&quot;</span>
    <span class="s2">return True</span><span class="s3">, </span><span class="s2">None</span>


<span class="s4"># ------------</span>
<span class="s4"># groups.plist</span>
<span class="s4"># ------------</span>


<span class="s2">def </span><span class="s1">groupsValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Check the validity of the groups. 
    Version 3+ (though it's backwards compatible with UFO 1 and UFO 2). 
 
    &gt;&gt;&gt; groups = {&quot;A&quot; : [&quot;A&quot;, &quot;A&quot;], &quot;A2&quot; : [&quot;A&quot;]} 
    &gt;&gt;&gt; groupsValidator(groups) 
    (True, None) 
 
    &gt;&gt;&gt; groups = {&quot;&quot; : [&quot;A&quot;]} 
    &gt;&gt;&gt; valid, msg = groupsValidator(groups) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg) 
    A group has an empty name. 
 
    &gt;&gt;&gt; groups = {&quot;public.awesome&quot; : [&quot;A&quot;]} 
    &gt;&gt;&gt; groupsValidator(groups) 
    (True, None) 
 
    &gt;&gt;&gt; groups = {&quot;public.kern1.&quot; : [&quot;A&quot;]} 
    &gt;&gt;&gt; valid, msg = groupsValidator(groups) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg) 
    The group data contains a kerning group with an incomplete name. 
    &gt;&gt;&gt; groups = {&quot;public.kern2.&quot; : [&quot;A&quot;]} 
    &gt;&gt;&gt; valid, msg = groupsValidator(groups) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg) 
    The group data contains a kerning group with an incomplete name. 
 
    &gt;&gt;&gt; groups = {&quot;public.kern1.A&quot; : [&quot;A&quot;], &quot;public.kern2.A&quot; : [&quot;A&quot;]} 
    &gt;&gt;&gt; groupsValidator(groups) 
    (True, None) 
 
    &gt;&gt;&gt; groups = {&quot;public.kern1.A1&quot; : [&quot;A&quot;], &quot;public.kern1.A2&quot; : [&quot;A&quot;]} 
    &gt;&gt;&gt; valid, msg = groupsValidator(groups) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg) 
    The glyph &quot;A&quot; occurs in too many kerning groups. 
    &quot;&quot;&quot;</span>
    <span class="s1">bogusFormatMessage </span><span class="s3">= </span><span class="s5">&quot;The group data is not in the correct format.&quot;</span>
    <span class="s2">if not </span><span class="s1">isDictEnough</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
        <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFormatMessage</span>
    <span class="s1">firstSideMapping </span><span class="s3">= {}</span>
    <span class="s1">secondSideMapping </span><span class="s3">= {}</span>
    <span class="s2">for </span><span class="s1">groupName</span><span class="s3">, </span><span class="s1">glyphList </span><span class="s2">in </span><span class="s1">value</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">groupName</span><span class="s3">, (</span><span class="s1">str</span><span class="s3">)):</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFormatMessage</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">glyphList</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFormatMessage</span>
        <span class="s2">if not </span><span class="s1">groupName</span><span class="s3">:</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s5">&quot;A group has an empty name.&quot;</span>
        <span class="s2">if </span><span class="s1">groupName</span><span class="s3">.</span><span class="s1">startswith</span><span class="s3">(</span><span class="s5">&quot;public.&quot;</span><span class="s3">):</span>
            <span class="s2">if not </span><span class="s1">groupName</span><span class="s3">.</span><span class="s1">startswith</span><span class="s3">(</span><span class="s5">&quot;public.kern1.&quot;</span><span class="s3">) </span><span class="s2">and not </span><span class="s1">groupName</span><span class="s3">.</span><span class="s1">startswith</span><span class="s3">(</span>
                <span class="s5">&quot;public.kern2.&quot;</span>
            <span class="s3">):</span>
                <span class="s4"># unknown public.* name. silently skip.</span>
                <span class="s2">continue</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s5">&quot;public.kernN.&quot;</span><span class="s3">) == </span><span class="s1">len</span><span class="s3">(</span><span class="s1">groupName</span><span class="s3">):</span>
                    <span class="s2">return </span><span class="s3">(</span>
                        <span class="s2">False</span><span class="s3">,</span>
                        <span class="s5">&quot;The group data contains a kerning group with an incomplete name.&quot;</span><span class="s3">,</span>
                    <span class="s3">)</span>
            <span class="s2">if </span><span class="s1">groupName</span><span class="s3">.</span><span class="s1">startswith</span><span class="s3">(</span><span class="s5">&quot;public.kern1.&quot;</span><span class="s3">):</span>
                <span class="s1">d </span><span class="s3">= </span><span class="s1">firstSideMapping</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s1">d </span><span class="s3">= </span><span class="s1">secondSideMapping</span>
            <span class="s2">for </span><span class="s1">glyphName </span><span class="s2">in </span><span class="s1">glyphList</span><span class="s3">:</span>
                <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">glyphName</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
                    <span class="s2">return </span><span class="s3">(</span>
                        <span class="s2">False</span><span class="s3">,</span>
                        <span class="s5">&quot;The group data %s contains an invalid member.&quot; </span><span class="s3">% </span><span class="s1">groupName</span><span class="s3">,</span>
                    <span class="s3">)</span>
                <span class="s2">if </span><span class="s1">glyphName </span><span class="s2">in </span><span class="s1">d</span><span class="s3">:</span>
                    <span class="s2">return </span><span class="s3">(</span>
                        <span class="s2">False</span><span class="s3">,</span>
                        <span class="s5">'The glyph &quot;%s&quot; occurs in too many kerning groups.' </span><span class="s3">% </span><span class="s1">glyphName</span><span class="s3">,</span>
                    <span class="s3">)</span>
                <span class="s1">d</span><span class="s3">[</span><span class="s1">glyphName</span><span class="s3">] = </span><span class="s1">groupName</span>
    <span class="s2">return True</span><span class="s3">, </span><span class="s2">None</span>


<span class="s4"># -------------</span>
<span class="s4"># kerning.plist</span>
<span class="s4"># -------------</span>


<span class="s2">def </span><span class="s1">kerningValidator</span><span class="s3">(</span><span class="s1">data</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Check the validity of the kerning data structure. 
    Version 3+ (though it's backwards compatible with UFO 1 and UFO 2). 
 
    &gt;&gt;&gt; kerning = {&quot;A&quot; : {&quot;B&quot; : 100}} 
    &gt;&gt;&gt; kerningValidator(kerning) 
    (True, None) 
 
    &gt;&gt;&gt; kerning = {&quot;A&quot; : [&quot;B&quot;]} 
    &gt;&gt;&gt; valid, msg = kerningValidator(kerning) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg) 
    The kerning data is not in the correct format. 
 
    &gt;&gt;&gt; kerning = {&quot;A&quot; : {&quot;B&quot; : &quot;100&quot;}} 
    &gt;&gt;&gt; valid, msg = kerningValidator(kerning) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg) 
    The kerning data is not in the correct format. 
    &quot;&quot;&quot;</span>
    <span class="s1">bogusFormatMessage </span><span class="s3">= </span><span class="s5">&quot;The kerning data is not in the correct format.&quot;</span>
    <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">Mapping</span><span class="s3">):</span>
        <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFormatMessage</span>
    <span class="s2">for </span><span class="s1">first</span><span class="s3">, </span><span class="s1">secondDict </span><span class="s2">in </span><span class="s1">data</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">first</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFormatMessage</span>
        <span class="s2">elif not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">secondDict</span><span class="s3">, </span><span class="s1">Mapping</span><span class="s3">):</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFormatMessage</span>
        <span class="s2">for </span><span class="s1">second</span><span class="s3">, </span><span class="s1">value </span><span class="s2">in </span><span class="s1">secondDict</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
            <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">second</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
                <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFormatMessage</span>
            <span class="s2">elif not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, </span><span class="s1">numberTypes</span><span class="s3">):</span>
                <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusFormatMessage</span>
    <span class="s2">return True</span><span class="s3">, </span><span class="s2">None</span>


<span class="s4"># -------------</span>
<span class="s4"># lib.plist/lib</span>
<span class="s4"># -------------</span>

<span class="s1">_bogusLibFormatMessage </span><span class="s3">= </span><span class="s5">&quot;The lib data is not in the correct format: %s&quot;</span>


<span class="s2">def </span><span class="s1">fontLibValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Check the validity of the lib. 
    Version 3+ (though it's backwards compatible with UFO 1 and UFO 2). 
 
    &gt;&gt;&gt; lib = {&quot;foo&quot; : &quot;bar&quot;} 
    &gt;&gt;&gt; fontLibValidator(lib) 
    (True, None) 
 
    &gt;&gt;&gt; lib = {&quot;public.awesome&quot; : &quot;hello&quot;} 
    &gt;&gt;&gt; fontLibValidator(lib) 
    (True, None) 
 
    &gt;&gt;&gt; lib = {&quot;public.glyphOrder&quot; : [&quot;A&quot;, &quot;C&quot;, &quot;B&quot;]} 
    &gt;&gt;&gt; fontLibValidator(lib) 
    (True, None) 
 
    &gt;&gt;&gt; lib = &quot;hello&quot; 
    &gt;&gt;&gt; valid, msg = fontLibValidator(lib) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg)  # doctest: +ELLIPSIS 
    The lib data is not in the correct format: expected a dictionary, ... 
 
    &gt;&gt;&gt; lib = {1: &quot;hello&quot;} 
    &gt;&gt;&gt; valid, msg = fontLibValidator(lib) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg) 
    The lib key is not properly formatted: expected str, found int: 1 
 
    &gt;&gt;&gt; lib = {&quot;public.glyphOrder&quot; : &quot;hello&quot;} 
    &gt;&gt;&gt; valid, msg = fontLibValidator(lib) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg)  # doctest: +ELLIPSIS 
    public.glyphOrder is not properly formatted: expected list or tuple,... 
 
    &gt;&gt;&gt; lib = {&quot;public.glyphOrder&quot; : [&quot;A&quot;, 1, &quot;B&quot;]} 
    &gt;&gt;&gt; valid, msg = fontLibValidator(lib) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg)  # doctest: +ELLIPSIS 
    public.glyphOrder is not properly formatted: expected str,... 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isDictEnough</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
        <span class="s1">reason </span><span class="s3">= </span><span class="s5">&quot;expected a dictionary, found %s&quot; </span><span class="s3">% </span><span class="s1">type</span><span class="s3">(</span><span class="s1">value</span><span class="s3">).</span><span class="s1">__name__</span>
        <span class="s2">return False</span><span class="s3">, </span><span class="s1">_bogusLibFormatMessage </span><span class="s3">% </span><span class="s1">reason</span>
    <span class="s2">for </span><span class="s1">key</span><span class="s3">, </span><span class="s1">value </span><span class="s2">in </span><span class="s1">value</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">key</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
            <span class="s2">return False</span><span class="s3">, (</span>
                <span class="s5">&quot;The lib key is not properly formatted: expected str, found %s: %r&quot;</span>
                <span class="s3">% (</span><span class="s1">type</span><span class="s3">(</span><span class="s1">key</span><span class="s3">).</span><span class="s1">__name__</span><span class="s3">, </span><span class="s1">key</span><span class="s3">)</span>
            <span class="s3">)</span>
        <span class="s4"># public.glyphOrder</span>
        <span class="s2">if </span><span class="s1">key </span><span class="s3">== </span><span class="s5">&quot;public.glyphOrder&quot;</span><span class="s3">:</span>
            <span class="s1">bogusGlyphOrderMessage </span><span class="s3">= </span><span class="s5">&quot;public.glyphOrder is not properly formatted: %s&quot;</span>
            <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">value</span><span class="s3">, (</span><span class="s1">list</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)):</span>
                <span class="s1">reason </span><span class="s3">= </span><span class="s5">&quot;expected list or tuple, found %s&quot; </span><span class="s3">% </span><span class="s1">type</span><span class="s3">(</span><span class="s1">value</span><span class="s3">).</span><span class="s1">__name__</span>
                <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusGlyphOrderMessage </span><span class="s3">% </span><span class="s1">reason</span>
            <span class="s2">for </span><span class="s1">glyphName </span><span class="s2">in </span><span class="s1">value</span><span class="s3">:</span>
                <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">glyphName</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
                    <span class="s1">reason </span><span class="s3">= </span><span class="s5">&quot;expected str, found %s&quot; </span><span class="s3">% </span><span class="s1">type</span><span class="s3">(</span><span class="s1">glyphName</span><span class="s3">).</span><span class="s1">__name__</span>
                    <span class="s2">return False</span><span class="s3">, </span><span class="s1">bogusGlyphOrderMessage </span><span class="s3">% </span><span class="s1">reason</span>
    <span class="s2">return True</span><span class="s3">, </span><span class="s2">None</span>


<span class="s4"># --------</span>
<span class="s4"># GLIF lib</span>
<span class="s4"># --------</span>


<span class="s2">def </span><span class="s1">glyphLibValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Check the validity of the lib. 
    Version 3+ (though it's backwards compatible with UFO 1 and UFO 2). 
 
    &gt;&gt;&gt; lib = {&quot;foo&quot; : &quot;bar&quot;} 
    &gt;&gt;&gt; glyphLibValidator(lib) 
    (True, None) 
 
    &gt;&gt;&gt; lib = {&quot;public.awesome&quot; : &quot;hello&quot;} 
    &gt;&gt;&gt; glyphLibValidator(lib) 
    (True, None) 
 
    &gt;&gt;&gt; lib = {&quot;public.markColor&quot; : &quot;1,0,0,0.5&quot;} 
    &gt;&gt;&gt; glyphLibValidator(lib) 
    (True, None) 
 
    &gt;&gt;&gt; lib = {&quot;public.markColor&quot; : 1} 
    &gt;&gt;&gt; valid, msg = glyphLibValidator(lib) 
    &gt;&gt;&gt; valid 
    False 
    &gt;&gt;&gt; print(msg) 
    public.markColor is not properly formatted. 
    &quot;&quot;&quot;</span>
    <span class="s2">if not </span><span class="s1">isDictEnough</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
        <span class="s1">reason </span><span class="s3">= </span><span class="s5">&quot;expected a dictionary, found %s&quot; </span><span class="s3">% </span><span class="s1">type</span><span class="s3">(</span><span class="s1">value</span><span class="s3">).</span><span class="s1">__name__</span>
        <span class="s2">return False</span><span class="s3">, </span><span class="s1">_bogusLibFormatMessage </span><span class="s3">% </span><span class="s1">reason</span>
    <span class="s2">for </span><span class="s1">key</span><span class="s3">, </span><span class="s1">value </span><span class="s2">in </span><span class="s1">value</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
        <span class="s2">if not </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">key</span><span class="s3">, </span><span class="s1">str</span><span class="s3">):</span>
            <span class="s1">reason </span><span class="s3">= </span><span class="s5">&quot;key (%s) should be a string&quot; </span><span class="s3">% </span><span class="s1">key</span>
            <span class="s2">return False</span><span class="s3">, </span><span class="s1">_bogusLibFormatMessage </span><span class="s3">% </span><span class="s1">reason</span>
        <span class="s4"># public.markColor</span>
        <span class="s2">if </span><span class="s1">key </span><span class="s3">== </span><span class="s5">&quot;public.markColor&quot;</span><span class="s3">:</span>
            <span class="s2">if not </span><span class="s1">colorValidator</span><span class="s3">(</span><span class="s1">value</span><span class="s3">):</span>
                <span class="s2">return False</span><span class="s3">, </span><span class="s5">&quot;public.markColor is not properly formatted.&quot;</span>
    <span class="s2">return True</span><span class="s3">, </span><span class="s2">None</span>


<span class="s2">if </span><span class="s1">__name__ </span><span class="s3">== </span><span class="s5">&quot;__main__&quot;</span><span class="s3">:</span>
    <span class="s2">import </span><span class="s1">doctest</span>

    <span class="s1">doctest</span><span class="s3">.</span><span class="s1">testmod</span><span class="s3">()</span>
</pre>
</body>
</html>