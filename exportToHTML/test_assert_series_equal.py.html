<html>
<head>
<title>test_assert_series_equal.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #5f826b; font-style: italic;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
.s6 { color: #a5c261;}
.s7 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_assert_series_equal.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">Categorical</span><span class="s2">,</span>
    <span class="s1">DataFrame</span><span class="s2">,</span>
    <span class="s1">Series</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">_testing </span><span class="s0">as </span><span class="s1">tm</span>


<span class="s0">def </span><span class="s1">_assert_series_equal_both</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Check that two Series equal. 
 
    This check is performed commutatively. 
 
    Parameters 
    ---------- 
    a : Series 
        The first Series to compare. 
    b : Series 
        The second Series to compare. 
    kwargs : dict 
        The arguments passed to `tm.assert_series_equal`. 
    &quot;&quot;&quot;</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">b</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">_assert_not_series_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Check that two Series are not equal. 
 
    Parameters 
    ---------- 
    a : Series 
        The first Series to compare. 
    b : Series 
        The second Series to compare. 
    kwargs : dict 
        The arguments passed to `tm.assert_series_equal`. 
    &quot;&quot;&quot;</span>
    <span class="s0">try</span><span class="s2">:</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;The two Series were equal when they shouldn't have been&quot;</span>

        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">fail</span><span class="s2">(</span><span class="s1">msg</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">)</span>
    <span class="s0">except </span><span class="s1">AssertionError</span><span class="s2">:</span>
        <span class="s0">pass</span>


<span class="s0">def </span><span class="s1">_assert_not_series_equal_both</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Check that two Series are not equal. 
 
    This check is performed commutatively. 
 
    Parameters 
    ---------- 
    a : Series 
        The first Series to compare. 
    b : Series 
        The second Series to compare. 
    kwargs : dict 
        The arguments passed to `tm.assert_series_equal`. 
    &quot;&quot;&quot;</span>
    <span class="s1">_assert_not_series_equal</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>
    <span class="s1">_assert_not_series_equal</span><span class="s2">(</span><span class="s1">b</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;data&quot;</span><span class="s2">, [</span><span class="s1">range</span><span class="s2">(</span><span class="s5">3</span><span class="s2">), </span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;abc&quot;</span><span class="s2">), </span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;áàä&quot;</span><span class="s2">)])</span>
<span class="s0">def </span><span class="s1">test_series_equal</span><span class="s2">(</span><span class="s1">data</span><span class="s2">):</span>
    <span class="s1">_assert_series_equal_both</span><span class="s2">(</span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">), </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">))</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s4">&quot;data1,data2&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s5">3</span><span class="s2">), </span><span class="s1">range</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">4</span><span class="s2">)),</span>
        <span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;abc&quot;</span><span class="s2">), </span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;xyz&quot;</span><span class="s2">)),</span>
        <span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;áàä&quot;</span><span class="s2">), </span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;éèë&quot;</span><span class="s2">)),</span>
        <span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;áàä&quot;</span><span class="s2">), </span><span class="s1">list</span><span class="s2">(</span><span class="s6">b&quot;aaa&quot;</span><span class="s2">)),</span>
        <span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s5">3</span><span class="s2">), </span><span class="s1">range</span><span class="s2">(</span><span class="s5">4</span><span class="s2">)),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_series_not_equal_value_mismatch</span><span class="s2">(</span><span class="s1">data1</span><span class="s2">, </span><span class="s1">data2</span><span class="s2">):</span>
    <span class="s1">_assert_not_series_equal_both</span><span class="s2">(</span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data1</span><span class="s2">), </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data2</span><span class="s2">))</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s4">&quot;kwargs&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">{</span><span class="s4">&quot;dtype&quot;</span><span class="s2">: </span><span class="s4">&quot;float64&quot;</span><span class="s2">},  </span><span class="s7"># dtype mismatch</span>
        <span class="s2">{</span><span class="s4">&quot;index&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s2">]},  </span><span class="s7"># index mismatch</span>
        <span class="s2">{</span><span class="s4">&quot;name&quot;</span><span class="s2">: </span><span class="s4">&quot;foo&quot;</span><span class="s2">},  </span><span class="s7"># name mismatch</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_series_not_equal_metadata_mismatch</span><span class="s2">(</span><span class="s1">kwargs</span><span class="s2">):</span>
    <span class="s1">data </span><span class="s2">= </span><span class="s1">range</span><span class="s2">(</span><span class="s5">3</span><span class="s2">)</span>
    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>

    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>
    <span class="s1">_assert_not_series_equal_both</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;data1,data2&quot;</span><span class="s2">, [(</span><span class="s5">0.12345</span><span class="s2">, </span><span class="s5">0.12346</span><span class="s2">), (</span><span class="s5">0.1235</span><span class="s2">, </span><span class="s5">0.1236</span><span class="s2">)])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s4">&quot;float32&quot;</span><span class="s2">, </span><span class="s4">&quot;float64&quot;</span><span class="s2">, </span><span class="s4">&quot;Float32&quot;</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;decimals&quot;</span><span class="s2">, [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">10</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_less_precise</span><span class="s2">(</span><span class="s1">data1</span><span class="s2">, </span><span class="s1">data2</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">decimals</span><span class="s2">):</span>
    <span class="s1">rtol </span><span class="s2">= </span><span class="s5">10</span><span class="s2">**-</span><span class="s1">decimals</span>
    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">data1</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">data2</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>

    <span class="s0">if </span><span class="s1">decimals </span><span class="s0">in </span><span class="s2">(</span><span class="s5">5</span><span class="s2">, </span><span class="s5">10</span><span class="s2">) </span><span class="s0">or </span><span class="s2">(</span><span class="s1">decimals </span><span class="s2">&gt;= </span><span class="s5">3 </span><span class="s0">and </span><span class="s1">abs</span><span class="s2">(</span><span class="s1">data1 </span><span class="s2">- </span><span class="s1">data2</span><span class="s2">) &gt;= </span><span class="s5">0.0005</span><span class="s2">):</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;Series values are different&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">rtol</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">_assert_series_equal_both</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">rtol</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s4">&quot;s1,s2,msg&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s7"># Index</span>
        <span class="s2">(</span>
            <span class="s1">Series</span><span class="s2">([</span><span class="s4">&quot;l1&quot;</span><span class="s2">, </span><span class="s4">&quot;l2&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]),</span>
            <span class="s1">Series</span><span class="s2">([</span><span class="s4">&quot;l1&quot;</span><span class="s2">, </span><span class="s4">&quot;l2&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">]),</span>
            <span class="s4">&quot;Series</span><span class="s0">\\</span><span class="s4">.index are different&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
        <span class="s7"># MultiIndex</span>
        <span class="s2">(</span>
            <span class="s1">DataFrame</span><span class="s2">.</span><span class="s1">from_records</span><span class="s2">(</span>
                <span class="s2">{</span><span class="s4">&quot;a&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s4">&quot;b&quot;</span><span class="s2">: [</span><span class="s5">2.1</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">], </span><span class="s4">&quot;c&quot;</span><span class="s2">: [</span><span class="s4">&quot;l1&quot;</span><span class="s2">, </span><span class="s4">&quot;l2&quot;</span><span class="s2">]}, </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">]</span>
            <span class="s2">).</span><span class="s1">c</span><span class="s2">,</span>
            <span class="s1">DataFrame</span><span class="s2">.</span><span class="s1">from_records</span><span class="s2">(</span>
                <span class="s2">{</span><span class="s4">&quot;a&quot;</span><span class="s2">: [</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">], </span><span class="s4">&quot;b&quot;</span><span class="s2">: [</span><span class="s5">2.1</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">], </span><span class="s4">&quot;c&quot;</span><span class="s2">: [</span><span class="s4">&quot;l1&quot;</span><span class="s2">, </span><span class="s4">&quot;l2&quot;</span><span class="s2">]}, </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">]</span>
            <span class="s2">).</span><span class="s1">c</span><span class="s2">,</span>
            <span class="s4">&quot;MultiIndex level </span><span class="s0">\\</span><span class="s4">[0</span><span class="s0">\\</span><span class="s4">] are different&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_series_equal_index_dtype</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">msg</span><span class="s2">, </span><span class="s1">check_index_type</span><span class="s2">):</span>
    <span class="s1">kwargs </span><span class="s2">= {</span><span class="s4">&quot;check_index_type&quot;</span><span class="s2">: </span><span class="s1">check_index_type</span><span class="s2">}</span>

    <span class="s0">if </span><span class="s1">check_index_type</span><span class="s2">:</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;check_like&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_series_equal_order_mismatch</span><span class="s2">(</span><span class="s1">check_like</span><span class="s2">):</span>
    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">, </span><span class="s4">&quot;c&quot;</span><span class="s2">])</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">&quot;c&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s2">])</span>

    <span class="s0">if not </span><span class="s1">check_like</span><span class="s2">:  </span><span class="s7"># Do not ignore index ordering.</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;Series.index are different&quot;</span><span class="s2">):</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_like</span><span class="s2">=</span><span class="s1">check_like</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">_assert_series_equal_both</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_like</span><span class="s2">=</span><span class="s1">check_like</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;check_index&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_series_equal_index_mismatch</span><span class="s2">(</span><span class="s1">check_index</span><span class="s2">):</span>
    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">, </span><span class="s4">&quot;c&quot;</span><span class="s2">])</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">&quot;c&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s2">])</span>

    <span class="s0">if </span><span class="s1">check_index</span><span class="s2">:  </span><span class="s7"># Do not ignore index.</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;Series.index are different&quot;</span><span class="s2">):</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_index</span><span class="s2">=</span><span class="s1">check_index</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">_assert_series_equal_both</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_index</span><span class="s2">=</span><span class="s1">check_index</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_invalid_param_combination</span><span class="s2">():</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span>
        <span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;check_like must be False if check_index is False&quot;</span>
    <span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">check_like</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_equal_length_mismatch</span><span class="s2">(</span><span class="s1">rtol</span><span class="s2">):</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Series are different 
 
Series length are different 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  3, RangeIndex</span><span class="s0">\\</span><span class="s4">(start=0, stop=3, step=1</span><span class="s0">\\</span><span class="s4">) 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: 4, RangeIndex</span><span class="s0">\\</span><span class="s4">(start=0, stop=4, step=1</span><span class="s0">\\</span><span class="s4">)&quot;&quot;&quot;</span>

    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">])</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">rtol</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_equal_numeric_values_mismatch</span><span class="s2">(</span><span class="s1">rtol</span><span class="s2">):</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Series are different 
 
Series values are different </span><span class="s0">\\</span><span class="s4">(33</span><span class="s0">\\</span><span class="s4">.33333 %</span><span class="s0">\\</span><span class="s4">) 
</span><span class="s0">\\</span><span class="s4">[index</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[0, 1, 2</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  </span><span class="s0">\\</span><span class="s4">[1, 2, 3</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[1, 2, 4</span><span class="s0">\\</span><span class="s4">]&quot;&quot;&quot;</span>

    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s2">])</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">rtol</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_equal_categorical_values_mismatch</span><span class="s2">(</span><span class="s1">rtol</span><span class="s2">, </span><span class="s1">using_infer_string</span><span class="s2">):</span>
    <span class="s0">if </span><span class="s1">using_infer_string</span><span class="s2">:</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Series are different 
 
Series values are different </span><span class="s0">\\</span><span class="s4">(66</span><span class="s0">\\</span><span class="s4">.66667 %</span><span class="s0">\\</span><span class="s4">) 
</span><span class="s0">\\</span><span class="s4">[index</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[0, 1, 2</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  </span><span class="s0">\\</span><span class="s4">['a', 'b', 'c'</span><span class="s0">\\</span><span class="s4">] 
Categories </span><span class="s0">\\</span><span class="s4">(3, string</span><span class="s0">\\</span><span class="s4">): </span><span class="s0">\\</span><span class="s4">[a, b, c</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">['a', 'c', 'b'</span><span class="s0">\\</span><span class="s4">] 
Categories </span><span class="s0">\\</span><span class="s4">(3, string</span><span class="s0">\\</span><span class="s4">): </span><span class="s0">\\</span><span class="s4">[a, b, c</span><span class="s0">\\</span><span class="s4">]&quot;&quot;&quot;</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Series are different 
 
Series values are different </span><span class="s0">\\</span><span class="s4">(66</span><span class="s0">\\</span><span class="s4">.66667 %</span><span class="s0">\\</span><span class="s4">) 
</span><span class="s0">\\</span><span class="s4">[index</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[0, 1, 2</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  </span><span class="s0">\\</span><span class="s4">['a', 'b', 'c'</span><span class="s0">\\</span><span class="s4">] 
Categories </span><span class="s0">\\</span><span class="s4">(3, object</span><span class="s0">\\</span><span class="s4">): </span><span class="s0">\\</span><span class="s4">['a', 'b', 'c'</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">['a', 'c', 'b'</span><span class="s0">\\</span><span class="s4">] 
Categories </span><span class="s0">\\</span><span class="s4">(3, object</span><span class="s0">\\</span><span class="s4">): </span><span class="s0">\\</span><span class="s4">['a', 'b', 'c'</span><span class="s0">\\</span><span class="s4">]&quot;&quot;&quot;</span>

    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">Categorical</span><span class="s2">([</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">, </span><span class="s4">&quot;c&quot;</span><span class="s2">]))</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">Categorical</span><span class="s2">([</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;c&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">]))</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">rtol</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_equal_datetime_values_mismatch</span><span class="s2">(</span><span class="s1">rtol</span><span class="s2">):</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Series are different 
 
Series values are different </span><span class="s0">\\</span><span class="s4">(100.0 %</span><span class="s0">\\</span><span class="s4">) 
</span><span class="s0">\\</span><span class="s4">[index</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[0, 1, 2</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  </span><span class="s0">\\</span><span class="s4">[1514764800000000000, 1514851200000000000, 1514937600000000000</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[1549065600000000000, 1549152000000000000, 1549238400000000000</span><span class="s0">\\</span><span class="s4">]&quot;&quot;&quot;</span>

    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">date_range</span><span class="s2">(</span><span class="s4">&quot;2018-01-01&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">freq</span><span class="s2">=</span><span class="s4">&quot;D&quot;</span><span class="s2">))</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">date_range</span><span class="s2">(</span><span class="s4">&quot;2019-02-02&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">freq</span><span class="s2">=</span><span class="s4">&quot;D&quot;</span><span class="s2">))</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">rtol</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_equal_categorical_mismatch</span><span class="s2">(</span><span class="s1">check_categorical</span><span class="s2">, </span><span class="s1">using_infer_string</span><span class="s2">):</span>
    <span class="s0">if </span><span class="s1">using_infer_string</span><span class="s2">:</span>
        <span class="s1">dtype </span><span class="s2">= </span><span class="s4">&quot;string&quot;</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">dtype </span><span class="s2">= </span><span class="s4">&quot;object&quot;</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s4">f&quot;&quot;&quot;Attributes of Series are different</span>

<span class="s4">Attribute &quot;dtype&quot; are different</span>
<span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  CategoricalDtype</span><span class="s0">\\</span><span class="s4">(categories=</span><span class="s0">\\</span><span class="s4">['a', 'b'</span><span class="s0">\\</span><span class="s4">], ordered=False, </span><span class="s0">\ 
</span><span class="s4">categories_dtype=</span><span class="s0">{</span><span class="s1">dtype</span><span class="s0">}\\</span><span class="s4">)</span>
<span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: CategoricalDtype</span><span class="s0">\\</span><span class="s4">(categories=</span><span class="s0">\\</span><span class="s4">['a', 'b', 'c'</span><span class="s0">\\</span><span class="s4">], </span><span class="s0">\ 
</span><span class="s4">ordered=False, categories_dtype=</span><span class="s0">{</span><span class="s1">dtype</span><span class="s0">}\\</span><span class="s4">)&quot;&quot;&quot;</span>

    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">Categorical</span><span class="s2">([</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">]))</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">Categorical</span><span class="s2">([</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">], </span><span class="s1">categories</span><span class="s2">=</span><span class="s1">list</span><span class="s2">(</span><span class="s4">&quot;abc&quot;</span><span class="s2">)))</span>

    <span class="s0">if </span><span class="s1">check_categorical</span><span class="s2">:</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_categorical</span><span class="s2">=</span><span class="s1">check_categorical</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">_assert_series_equal_both</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_categorical</span><span class="s2">=</span><span class="s1">check_categorical</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_assert_series_equal_extension_dtype_mismatch</span><span class="s2">():</span>
    <span class="s7"># https://github.com/pandas-dev/pandas/issues/32747</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s4">&quot;Int64&quot;</span><span class="s2">))</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">left</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">int</span><span class="s2">)</span>

    <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Attributes of Series are different 
 
Attribute &quot;dtype&quot; are different 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  Int64 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: int[32|64]&quot;&quot;&quot;</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_assert_series_equal_interval_dtype_mismatch</span><span class="s2">():</span>
    <span class="s7"># https://github.com/pandas-dev/pandas/issues/32747</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Interval</span><span class="s2">(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">)], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s4">&quot;interval&quot;</span><span class="s2">)</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">left</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">)</span>

    <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Attributes of Series are different 
 
Attribute &quot;dtype&quot; are different 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  interval</span><span class="s0">\\</span><span class="s4">[int64, right</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: object&quot;&quot;&quot;</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_equal_series_type</span><span class="s2">():</span>
    <span class="s0">class </span><span class="s1">MySeries</span><span class="s2">(</span><span class="s1">Series</span><span class="s2">):</span>
        <span class="s0">pass</span>

    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>
    <span class="s1">s3 </span><span class="s2">= </span><span class="s1">MySeries</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">])</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_series_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_series_type</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s3</span><span class="s2">, </span><span class="s1">check_series_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s3</span><span class="s2">, </span><span class="s1">s1</span><span class="s2">, </span><span class="s1">check_series_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;Series classes are different&quot;</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s3</span><span class="s2">, </span><span class="s1">check_series_type</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;Series classes are different&quot;</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s3</span><span class="s2">, </span><span class="s1">s1</span><span class="s2">, </span><span class="s1">check_series_type</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_series_equal_exact_for_nonnumeric</span><span class="s2">():</span>
    <span class="s7"># https://github.com/pandas-dev/pandas/issues/35446</span>
    <span class="s1">s1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">])</span>
    <span class="s1">s2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">])</span>
    <span class="s1">s3 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">&quot;b&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s2">])</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s2</span><span class="s2">, </span><span class="s1">check_exact</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s2</span><span class="s2">, </span><span class="s1">s1</span><span class="s2">, </span><span class="s1">check_exact</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Series are different 
 
Series values are different </span><span class="s0">\\</span><span class="s4">(100</span><span class="s0">\\</span><span class="s4">.0 %</span><span class="s0">\\</span><span class="s4">) 
</span><span class="s0">\\</span><span class="s4">[index</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[0, 1</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  </span><span class="s0">\\</span><span class="s4">[a, b</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[b, a</span><span class="s0">\\</span><span class="s4">]&quot;&quot;&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s1</span><span class="s2">, </span><span class="s1">s3</span><span class="s2">, </span><span class="s1">check_exact</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s1">msg </span><span class="s2">= </span><span class="s4">&quot;&quot;&quot;Series are different 
 
Series values are different </span><span class="s0">\\</span><span class="s4">(100</span><span class="s0">\\</span><span class="s4">.0 %</span><span class="s0">\\</span><span class="s4">) 
</span><span class="s0">\\</span><span class="s4">[index</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[0, 1</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[left</span><span class="s0">\\</span><span class="s4">]:  </span><span class="s0">\\</span><span class="s4">[b, a</span><span class="s0">\\</span><span class="s4">] 
</span><span class="s0">\\</span><span class="s4">[right</span><span class="s0">\\</span><span class="s4">]: </span><span class="s0">\\</span><span class="s4">[a, b</span><span class="s0">\\</span><span class="s4">]&quot;&quot;&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s3</span><span class="s2">, </span><span class="s1">s1</span><span class="s2">, </span><span class="s1">check_exact</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_assert_series_equal_ignore_extension_dtype_mismatch</span><span class="s2">():</span>
    <span class="s7"># https://github.com/pandas-dev/pandas/issues/35715</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s4">&quot;Int64&quot;</span><span class="s2">)</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s4">&quot;Int32&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_assert_series_equal_ignore_extension_dtype_mismatch_cross_class</span><span class="s2">():</span>
    <span class="s7"># https://github.com/pandas-dev/pandas/issues/35715</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s4">&quot;Int64&quot;</span><span class="s2">)</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s4">&quot;int64&quot;</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_allows_duplicate_labels</span><span class="s2">():</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">])</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">]).</span><span class="s1">set_flags</span><span class="s2">(</span><span class="s1">allows_duplicate_labels</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">left</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">right</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_flags</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">right</span><span class="s2">, </span><span class="s1">left</span><span class="s2">, </span><span class="s1">check_flags</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;&lt;Flags&quot;</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;&lt;Flags&quot;</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_assert_series_equal_identical_na</span><span class="s2">(</span><span class="s1">nulls_fixture</span><span class="s2">):</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">nulls_fixture</span><span class="s2">])</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">, </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">())</span>

    <span class="s7"># while we're here do Index too</span>
    <span class="s1">idx </span><span class="s2">= </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_index_equal</span><span class="s2">(</span><span class="s1">idx</span><span class="s2">, </span><span class="s1">idx</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">(</span><span class="s1">deep</span><span class="s2">=</span><span class="s0">True</span><span class="s2">))</span>


<span class="s0">def </span><span class="s1">test_identical_nested_series_is_equal</span><span class="s2">():</span>
    <span class="s7"># GH#22400</span>
    <span class="s1">x </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span>
            <span class="s5">0</span><span class="s2">,</span>
            <span class="s5">0.0131142231938</span><span class="s2">,</span>
            <span class="s5">1.77774652865e-05</span><span class="s2">,</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">0.4722720840328748</span><span class="s2">, </span><span class="s5">0.4216929783681722</span><span class="s2">]),</span>
        <span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s1">y </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
        <span class="s2">[</span>
            <span class="s5">0</span><span class="s2">,</span>
            <span class="s5">0.0131142231938</span><span class="s2">,</span>
            <span class="s5">1.77774652865e-05</span><span class="s2">,</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">0.4722720840328748</span><span class="s2">, </span><span class="s5">0.4216929783681722</span><span class="s2">]),</span>
        <span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s7"># These two arrays should be equal, nesting could cause issue</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">check_exact</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s1">check_exact</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s4">&quot;datetime64&quot;</span><span class="s2">, </span><span class="s4">&quot;timedelta64&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_check_dtype_false_different_reso</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">):</span>
    <span class="s7"># GH 52449</span>
    <span class="s1">ser_s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1000213</span><span class="s2">, </span><span class="s5">2131232</span><span class="s2">, </span><span class="s5">21312331</span><span class="s2">]).</span><span class="s1">astype</span><span class="s2">(</span><span class="s4">f&quot;</span><span class="s0">{</span><span class="s1">dtype</span><span class="s0">}</span><span class="s4">[s]&quot;</span><span class="s2">)</span>
    <span class="s1">ser_ms </span><span class="s2">= </span><span class="s1">ser_s</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s4">f&quot;</span><span class="s0">{</span><span class="s1">dtype</span><span class="s0">}</span><span class="s4">[ms]&quot;</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;Attributes of Series are different&quot;</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">ser_s</span><span class="s2">, </span><span class="s1">ser_ms</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">ser_ms</span><span class="s2">, </span><span class="s1">ser_s</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s1">ser_ms </span><span class="s2">-= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]).</span><span class="s1">astype</span><span class="s2">(</span><span class="s4">f&quot;</span><span class="s0">{</span><span class="s1">dtype</span><span class="s0">}</span><span class="s4">[ms]&quot;</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;Series are different&quot;</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">ser_s</span><span class="s2">, </span><span class="s1">ser_ms</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;Series are different&quot;</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">ser_s</span><span class="s2">, </span><span class="s1">ser_ms</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s4">&quot;Int64&quot;</span><span class="s2">, </span><span class="s4">&quot;int64&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_large_unequal_ints</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">):</span>
    <span class="s7"># https://github.com/pandas-dev/pandas/issues/55882</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1577840521123000</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1577840521123543</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">AssertionError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s4">&quot;Series are different&quot;</span><span class="s2">):</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">None</span><span class="s2">, </span><span class="s1">object</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;check_exact&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s4">&quot;val&quot;</span><span class="s2">, [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">3.5</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_ea_and_numpy_no_dtype_check</span><span class="s2">(</span><span class="s1">val</span><span class="s2">, </span><span class="s1">check_exact</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
    <span class="s7"># GH#56651</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">val</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">val</span><span class="s2">]))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">check_exact</span><span class="s2">=</span><span class="s1">check_exact</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_assert_series_equal_int_tol</span><span class="s2">():</span>
    <span class="s7"># GH#56646</span>
    <span class="s1">left </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">81</span><span class="s2">, </span><span class="s5">18</span><span class="s2">, </span><span class="s5">121</span><span class="s2">, </span><span class="s5">38</span><span class="s2">, </span><span class="s5">74</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">81</span><span class="s2">, </span><span class="s5">81</span><span class="s2">, </span><span class="s5">146</span><span class="s2">, </span><span class="s5">81</span><span class="s2">, </span><span class="s5">81</span><span class="s2">, </span><span class="s5">170</span><span class="s2">, </span><span class="s5">74</span><span class="s2">, </span><span class="s5">74</span><span class="s2">])</span>
    <span class="s1">right </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">72</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">, </span><span class="s5">72</span><span class="s2">])</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s5">1.5</span><span class="s2">)</span>

    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">.</span><span class="s1">to_frame</span><span class="s2">(), </span><span class="s1">right</span><span class="s2">.</span><span class="s1">to_frame</span><span class="s2">(), </span><span class="s1">rtol</span><span class="s2">=</span><span class="s5">1.5</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_extension_array_equal</span><span class="s2">(</span>
        <span class="s1">left</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s4">&quot;Int64&quot;</span><span class="s2">).</span><span class="s1">values</span><span class="s2">, </span><span class="s1">right</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s4">&quot;Int64&quot;</span><span class="s2">).</span><span class="s1">values</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s5">1.5</span>
    <span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_assert_series_equal_index_exact_default</span><span class="s2">():</span>
    <span class="s7"># GH#57067</span>
    <span class="s1">ser1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s5">6</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">int</span><span class="s2">), [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0.2</span><span class="s2">, </span><span class="s5">0.4</span><span class="s2">, </span><span class="s5">0.6</span><span class="s2">, </span><span class="s5">0.8</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])</span>
    <span class="s1">ser2 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s5">6</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">int</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">6</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">ser1</span><span class="s2">, </span><span class="s1">ser2</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">ser1</span><span class="s2">.</span><span class="s1">to_frame</span><span class="s2">(), </span><span class="s1">ser2</span><span class="s2">.</span><span class="s1">to_frame</span><span class="s2">())</span>
</pre>
</body>
</html>