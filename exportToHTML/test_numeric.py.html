<html>
<head>
<title>test_numeric.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #2aacb8;}
.s5 { color: #6aab73;}
.s6 { color: #5f826b; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_numeric.py</font>
</center></td></tr></table>
<pre><span class="s0"># Arithmetic tests for DataFrame/Series/Index/Array classes that should</span>
<span class="s0"># behave identically.</span>
<span class="s0"># Specifically for numeric dtypes</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">annotations</span>

<span class="s2">from </span><span class="s1">collections </span><span class="s2">import </span><span class="s1">abc</span>
<span class="s2">from </span><span class="s1">datetime </span><span class="s2">import </span><span class="s1">timedelta</span>
<span class="s2">from </span><span class="s1">decimal </span><span class="s2">import </span><span class="s1">Decimal</span>
<span class="s2">import </span><span class="s1">operator</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">from </span><span class="s1">pandas </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">Index</span><span class="s3">,</span>
    <span class="s1">RangeIndex</span><span class="s3">,</span>
    <span class="s1">Series</span><span class="s3">,</span>
    <span class="s1">Timedelta</span><span class="s3">,</span>
    <span class="s1">TimedeltaIndex</span><span class="s3">,</span>
    <span class="s1">array</span><span class="s3">,</span>
    <span class="s1">date_range</span><span class="s3">,</span>
<span class="s3">)</span>
<span class="s2">import </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">_testing </span><span class="s2">as </span><span class="s1">tm</span>
<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">core </span><span class="s2">import </span><span class="s1">ops</span>
<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">core</span><span class="s3">.</span><span class="s1">computation </span><span class="s2">import </span><span class="s1">expressions </span><span class="s2">as </span><span class="s1">expr</span>
<span class="s2">from </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">tests</span><span class="s3">.</span><span class="s1">arithmetic</span><span class="s3">.</span><span class="s1">common </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">assert_invalid_addsub_type</span><span class="s3">,</span>
    <span class="s1">assert_invalid_comparison</span><span class="s3">,</span>
<span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">autouse</span><span class="s3">=</span><span class="s2">True</span><span class="s3">, </span><span class="s1">params</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1000000</span><span class="s3">], </span><span class="s1">ids</span><span class="s3">=[</span><span class="s5">&quot;numexpr&quot;</span><span class="s3">, </span><span class="s5">&quot;python&quot;</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">switch_numexpr_min_elements</span><span class="s3">(</span><span class="s1">request</span><span class="s3">, </span><span class="s1">monkeypatch</span><span class="s3">):</span>
    <span class="s2">with </span><span class="s1">monkeypatch</span><span class="s3">.</span><span class="s1">context</span><span class="s3">() </span><span class="s2">as </span><span class="s1">m</span><span class="s3">:</span>
        <span class="s1">m</span><span class="s3">.</span><span class="s1">setattr</span><span class="s3">(</span><span class="s1">expr</span><span class="s3">, </span><span class="s5">&quot;_MIN_ELEMENTS&quot;</span><span class="s3">, </span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span><span class="s3">)</span>
        <span class="s2">yield </span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span><span class="s1">params</span><span class="s3">=[</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">, </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">to_array</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">box_pandas_1d_array</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s6">&quot;&quot;&quot; 
    Fixture to test behavior for Index, Series and tm.to_array classes 
    &quot;&quot;&quot;</span>
    <span class="s2">return </span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span>
    <span class="s1">params</span><span class="s3">=[</span>
        <span class="s0"># TODO: add more  dtypes here</span>
        <span class="s1">Index</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;float64&quot;</span><span class="s3">)),</span>
        <span class="s1">Index</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;int64&quot;</span><span class="s3">)),</span>
        <span class="s1">Index</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;uint64&quot;</span><span class="s3">)),</span>
        <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">5</span><span class="s3">),</span>
    <span class="s3">],</span>
    <span class="s1">ids</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">type</span><span class="s3">(</span><span class="s1">x</span><span class="s3">).</span><span class="s1">__name__</span><span class="s3">,</span>
<span class="s3">)</span>
<span class="s2">def </span><span class="s1">numeric_idx</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s6">&quot;&quot;&quot; 
    Several types of numeric-dtypes Index objects 
    &quot;&quot;&quot;</span>
    <span class="s2">return </span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">fixture</span><span class="s3">(</span>
    <span class="s1">params</span><span class="s3">=[</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">, </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">to_array</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">, </span><span class="s1">list</span><span class="s3">], </span><span class="s1">ids</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x</span><span class="s3">.</span><span class="s1">__name__</span>
<span class="s3">)</span>
<span class="s2">def </span><span class="s1">box_1d_array</span><span class="s3">(</span><span class="s1">request</span><span class="s3">):</span>
    <span class="s6">&quot;&quot;&quot; 
    Fixture to test behavior for Index, Series, tm.to_array, numpy Array and list 
    classes 
    &quot;&quot;&quot;</span>
    <span class="s2">return </span><span class="s1">request</span><span class="s3">.</span><span class="s1">param</span>


<span class="s2">def </span><span class="s1">adjust_negative_zero</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
    <span class="s6">&quot;&quot;&quot; 
    Helper to adjust the expected result if we are dividing by -0.0 
    as opposed to 0.0 
    &quot;&quot;&quot;</span>
    <span class="s2">if </span><span class="s1">np</span><span class="s3">.</span><span class="s1">signbit</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">)).</span><span class="s1">any</span><span class="s3">():</span>
        <span class="s0"># All entries in the `zero` fixture should be either</span>
        <span class="s0">#  all-negative or no-negative.</span>
        <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">signbit</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">)).</span><span class="s1">all</span><span class="s3">()</span>

        <span class="s1">expected </span><span class="s3">*= -</span><span class="s4">1</span>

    <span class="s2">return </span><span class="s1">expected</span>


<span class="s2">def </span><span class="s1">compare_op</span><span class="s3">(</span><span class="s1">series</span><span class="s3">, </span><span class="s1">other</span><span class="s3">, </span><span class="s1">op</span><span class="s3">):</span>
    <span class="s1">left </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">series</span><span class="s3">) </span><span class="s2">if </span><span class="s1">op </span><span class="s2">in </span><span class="s3">(</span><span class="s1">ops</span><span class="s3">.</span><span class="s1">rpow</span><span class="s3">, </span><span class="s1">operator</span><span class="s3">.</span><span class="s1">pow</span><span class="s3">) </span><span class="s2">else </span><span class="s1">series</span>
    <span class="s1">right </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">other</span><span class="s3">) </span><span class="s2">if </span><span class="s1">op </span><span class="s2">in </span><span class="s3">(</span><span class="s1">ops</span><span class="s3">.</span><span class="s1">rpow</span><span class="s3">, </span><span class="s1">operator</span><span class="s3">.</span><span class="s1">pow</span><span class="s3">) </span><span class="s2">else </span><span class="s1">other</span>

    <span class="s1">cython_or_numpy </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">left</span><span class="s3">, </span><span class="s1">right</span><span class="s3">)</span>
    <span class="s1">python </span><span class="s3">= </span><span class="s1">left</span><span class="s3">.</span><span class="s1">combine</span><span class="s3">(</span><span class="s1">right</span><span class="s3">, </span><span class="s1">op</span><span class="s3">)</span>
    <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">other</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">) </span><span class="s2">and not </span><span class="s1">other</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">equals</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">index</span><span class="s3">):</span>
        <span class="s1">python</span><span class="s3">.</span><span class="s1">index </span><span class="s3">= </span><span class="s1">python</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">_with_freq</span><span class="s3">(</span><span class="s2">None</span><span class="s3">)</span>
    <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">cython_or_numpy</span><span class="s3">, </span><span class="s1">python</span><span class="s3">)</span>


<span class="s0"># TODO: remove this kludge once mypy stops giving false positives here</span>
<span class="s0"># List comprehension has incompatible type List[PandasObject]; expected List[RangeIndex]</span>
<span class="s0">#  See GH#29725</span>
<span class="s1">_ldtypes </span><span class="s3">= [</span><span class="s5">&quot;i1&quot;</span><span class="s3">, </span><span class="s5">&quot;i2&quot;</span><span class="s3">, </span><span class="s5">&quot;i4&quot;</span><span class="s3">, </span><span class="s5">&quot;i8&quot;</span><span class="s3">, </span><span class="s5">&quot;u1&quot;</span><span class="s3">, </span><span class="s5">&quot;u2&quot;</span><span class="s3">, </span><span class="s5">&quot;u4&quot;</span><span class="s3">, </span><span class="s5">&quot;u8&quot;</span><span class="s3">, </span><span class="s5">&quot;f2&quot;</span><span class="s3">, </span><span class="s5">&quot;f4&quot;</span><span class="s3">, </span><span class="s5">&quot;f8&quot;</span><span class="s3">]</span>
<span class="s1">lefts</span><span class="s3">: </span><span class="s1">list</span><span class="s3">[</span><span class="s1">Index </span><span class="s3">| </span><span class="s1">Series</span><span class="s3">] = [</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">10</span><span class="s3">, </span><span class="s4">40</span><span class="s3">, </span><span class="s4">10</span><span class="s3">)]</span>
<span class="s1">lefts</span><span class="s3">.</span><span class="s1">extend</span><span class="s3">([</span><span class="s1">Series</span><span class="s3">([</span><span class="s4">10</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">30</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">) </span><span class="s2">for </span><span class="s1">dtype </span><span class="s2">in </span><span class="s1">_ldtypes</span><span class="s3">])</span>
<span class="s1">lefts</span><span class="s3">.</span><span class="s1">extend</span><span class="s3">([</span><span class="s1">Index</span><span class="s3">([</span><span class="s4">10</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">30</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">) </span><span class="s2">for </span><span class="s1">dtype </span><span class="s2">in </span><span class="s1">_ldtypes </span><span class="s2">if </span><span class="s1">dtype </span><span class="s3">!= </span><span class="s5">&quot;f2&quot;</span><span class="s3">])</span>

<span class="s0"># ------------------------------------------------------------------</span>
<span class="s0"># Comparisons</span>


<span class="s2">class </span><span class="s1">TestNumericComparisons</span><span class="s3">:</span>
    <span class="s2">def </span><span class="s1">test_operator_series_comparison_zerorank</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#13006</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">(</span><span class="s4">0</span><span class="s3">) &gt; </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s4">0.0 </span><span class="s3">&gt; </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">])</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]) &lt; </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]) &lt; </span><span class="s4">0.0</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">])[</span><span class="s4">0</span><span class="s3">] &gt; </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s4">0.0 </span><span class="s3">&gt; </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">])</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_numeric_cmp_dt64_raises</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">, </span><span class="s1">fixed_now_ts</span><span class="s3">):</span>
        <span class="s0"># GH#8932, GH#22163</span>
        <span class="s1">ts </span><span class="s3">= </span><span class="s1">fixed_now_ts</span>
        <span class="s1">obj </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s4">5</span><span class="s3">))</span>
        <span class="s1">obj </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">obj</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">)</span>

        <span class="s1">assert_invalid_comparison</span><span class="s3">(</span><span class="s1">obj</span><span class="s3">, </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_compare_invalid</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#8058</span>
        <span class="s0"># ops testing</span>
        <span class="s1">a </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s4">5</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s4">0</span><span class="s3">)</span>
        <span class="s1">b </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s4">5</span><span class="s3">))</span>
        <span class="s1">b</span><span class="s3">.</span><span class="s1">name </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s5">&quot;2000-01-01&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">a </span><span class="s3">/ </span><span class="s1">b</span><span class="s3">, </span><span class="s4">1 </span><span class="s3">/ (</span><span class="s1">b </span><span class="s3">/ </span><span class="s1">a</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_numeric_cmp_string_numexpr_path</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">, </span><span class="s1">monkeypatch</span><span class="s3">):</span>
        <span class="s0"># GH#36377, GH#35700</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>
        <span class="s1">xbox </span><span class="s3">= </span><span class="s1">box </span><span class="s2">if </span><span class="s1">box </span><span class="s2">is not </span><span class="s1">Index </span><span class="s2">else </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ndarray</span>

        <span class="s1">obj </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s4">51</span><span class="s3">))</span>
        <span class="s1">obj </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">obj</span><span class="s3">, </span><span class="s1">box</span><span class="s3">, </span><span class="s1">transpose</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">monkeypatch</span><span class="s3">.</span><span class="s1">context</span><span class="s3">() </span><span class="s2">as </span><span class="s1">m</span><span class="s3">:</span>
            <span class="s1">m</span><span class="s3">.</span><span class="s1">setattr</span><span class="s3">(</span><span class="s1">expr</span><span class="s3">, </span><span class="s5">&quot;_MIN_ELEMENTS&quot;</span><span class="s3">, </span><span class="s4">50</span><span class="s3">)</span>
            <span class="s1">result </span><span class="s3">= </span><span class="s1">obj </span><span class="s3">== </span><span class="s5">&quot;a&quot;</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">zeros</span><span class="s3">(</span><span class="s4">51</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">bool</span><span class="s3">))</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">xbox</span><span class="s3">, </span><span class="s1">transpose</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s2">with </span><span class="s1">monkeypatch</span><span class="s3">.</span><span class="s1">context</span><span class="s3">() </span><span class="s2">as </span><span class="s1">m</span><span class="s3">:</span>
            <span class="s1">m</span><span class="s3">.</span><span class="s1">setattr</span><span class="s3">(</span><span class="s1">expr</span><span class="s3">, </span><span class="s5">&quot;_MIN_ELEMENTS&quot;</span><span class="s3">, </span><span class="s4">50</span><span class="s3">)</span>
            <span class="s1">result </span><span class="s3">= </span><span class="s1">obj </span><span class="s3">!= </span><span class="s5">&quot;a&quot;</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, ~</span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;Invalid comparison between dtype=float64 and str&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">obj </span><span class="s3">&lt; </span><span class="s5">&quot;a&quot;</span>


<span class="s0"># ------------------------------------------------------------------</span>
<span class="s0"># Numeric dtypes Arithmetic with Datetime/Timedelta Scalar</span>


<span class="s2">class </span><span class="s1">TestNumericArraylikeArithmeticWithDatetimeLike</span><span class="s3">:</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;box_cls&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">, </span><span class="s1">Index</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;left&quot;</span><span class="s3">, </span><span class="s1">lefts</span><span class="s3">, </span><span class="s1">ids</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">type</span><span class="s3">(</span><span class="s1">x</span><span class="s3">).</span><span class="s1">__name__ </span><span class="s3">+ </span><span class="s1">str</span><span class="s3">(</span><span class="s1">x</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">)</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_mul_td64arr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">left</span><span class="s3">, </span><span class="s1">box_cls</span><span class="s3">):</span>
        <span class="s0"># GH#22390</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;m8[s]&quot;</span><span class="s3">)</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">box_cls</span><span class="s3">(</span><span class="s1">right</span><span class="s3">)</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">TimedeltaIndex</span><span class="s3">([</span><span class="s5">&quot;10s&quot;</span><span class="s3">, </span><span class="s5">&quot;40s&quot;</span><span class="s3">, </span><span class="s5">&quot;90s&quot;</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">right</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">)</span>

        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">left</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">) </span><span class="s2">or </span><span class="s1">box_cls </span><span class="s2">is </span><span class="s1">Series</span><span class="s3">:</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s1">right</span><span class="s3">.</span><span class="s1">dtype</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">left </span><span class="s3">* </span><span class="s1">right</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">right </span><span class="s3">* </span><span class="s1">left</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;box_cls&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">, </span><span class="s1">Index</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;left&quot;</span><span class="s3">, </span><span class="s1">lefts</span><span class="s3">, </span><span class="s1">ids</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">type</span><span class="s3">(</span><span class="s1">x</span><span class="s3">).</span><span class="s1">__name__ </span><span class="s3">+ </span><span class="s1">str</span><span class="s3">(</span><span class="s1">x</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">)</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_div_td64arr</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">left</span><span class="s3">, </span><span class="s1">box_cls</span><span class="s3">):</span>
        <span class="s0"># GH#22390</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s4">10</span><span class="s3">, </span><span class="s4">40</span><span class="s3">, </span><span class="s4">90</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;m8[s]&quot;</span><span class="s3">)</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">box_cls</span><span class="s3">(</span><span class="s1">right</span><span class="s3">)</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">TimedeltaIndex</span><span class="s3">([</span><span class="s5">&quot;1s&quot;</span><span class="s3">, </span><span class="s5">&quot;2s&quot;</span><span class="s3">, </span><span class="s5">&quot;3s&quot;</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">right</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">left</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">) </span><span class="s2">or </span><span class="s1">box_cls </span><span class="s2">is </span><span class="s1">Series</span><span class="s3">:</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s1">right</span><span class="s3">.</span><span class="s1">dtype</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">right </span><span class="s3">/ </span><span class="s1">left</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">right </span><span class="s3">// </span><span class="s1">left</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s0"># (true_) needed for min-versions build 2022-12-26</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;ufunc '(true_)?divide' cannot use operands with types&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">left </span><span class="s3">/ </span><span class="s1">right</span>

        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;ufunc 'floor_divide' cannot use operands with types&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">left </span><span class="s3">// </span><span class="s1">right</span>

    <span class="s0"># TODO: also test Tick objects;</span>
    <span class="s0">#  see test_numeric_arr_rdiv_tdscalar for note on these failing</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;scalar_td&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s4">1</span><span class="s3">),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s4">1</span><span class="s3">).</span><span class="s1">to_timedelta64</span><span class="s3">(),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s4">1</span><span class="s3">).</span><span class="s1">to_pytimedelta</span><span class="s3">(),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s4">1</span><span class="s3">).</span><span class="s1">to_timedelta64</span><span class="s3">().</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;timedelta64[s]&quot;</span><span class="s3">),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s4">1</span><span class="s3">).</span><span class="s1">to_timedelta64</span><span class="s3">().</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;timedelta64[ms]&quot;</span><span class="s3">),</span>
        <span class="s3">],</span>
        <span class="s1">ids</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">type</span><span class="s3">(</span><span class="s1">x</span><span class="s3">).</span><span class="s1">__name__</span><span class="s3">,</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_numeric_arr_mul_tdscalar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">scalar_td</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s0"># GH#19333</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">TimedeltaIndex</span><span class="s3">([</span><span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s1">n</span><span class="s3">) </span><span class="s2">for </span><span class="s1">n </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s1">len</span><span class="s3">(</span><span class="s1">index</span><span class="s3">))])</span>
        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">scalar_td</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">timedelta64</span><span class="s3">):</span>
            <span class="s1">dtype </span><span class="s3">= </span><span class="s1">scalar_td</span><span class="s3">.</span><span class="s1">dtype</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s2">elif </span><span class="s1">type</span><span class="s3">(</span><span class="s1">scalar_td</span><span class="s3">) </span><span class="s2">is </span><span class="s1">timedelta</span><span class="s3">:</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;m8[us]&quot;</span><span class="s3">)</span>

        <span class="s1">index </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">index</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">index </span><span class="s3">* </span><span class="s1">scalar_td</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">commute </span><span class="s3">= </span><span class="s1">scalar_td </span><span class="s3">* </span><span class="s1">index</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">commute</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;scalar_td&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s4">1</span><span class="s3">),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s4">1</span><span class="s3">).</span><span class="s1">to_timedelta64</span><span class="s3">(),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">days</span><span class="s3">=</span><span class="s4">1</span><span class="s3">).</span><span class="s1">to_pytimedelta</span><span class="s3">(),</span>
        <span class="s3">],</span>
        <span class="s1">ids</span><span class="s3">=</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">type</span><span class="s3">(</span><span class="s1">x</span><span class="s3">).</span><span class="s1">__name__</span><span class="s3">,</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_numeric_arr_mul_tdscalar_numexpr_path</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">, </span><span class="s1">scalar_td</span><span class="s3">, </span><span class="s1">box_with_array</span>
    <span class="s3">):</span>
        <span class="s0"># GH#44772 for the float64 case</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>

        <span class="s1">arr_i8 </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">2 </span><span class="s3">* </span><span class="s4">10</span><span class="s3">**</span><span class="s4">4</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">copy</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">arr_i8</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">dtype</span><span class="s3">, </span><span class="s1">copy</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">obj </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">, </span><span class="s1">box</span><span class="s3">, </span><span class="s1">transpose</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">arr_i8</span><span class="s3">.</span><span class="s1">view</span><span class="s3">(</span><span class="s5">&quot;timedelta64[D]&quot;</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;timedelta64[ns]&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">type</span><span class="s3">(</span><span class="s1">scalar_td</span><span class="s3">) </span><span class="s2">is </span><span class="s1">timedelta</span><span class="s3">:</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;timedelta64[us]&quot;</span><span class="s3">)</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box</span><span class="s3">, </span><span class="s1">transpose</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">obj </span><span class="s3">* </span><span class="s1">scalar_td</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">scalar_td </span><span class="s3">* </span><span class="s1">obj</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_numeric_arr_rdiv_tdscalar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">three_days</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>

        <span class="s1">index </span><span class="s3">= </span><span class="s1">numeric_idx</span><span class="s3">[</span><span class="s4">1</span><span class="s3">:</span><span class="s4">3</span><span class="s3">]</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">TimedeltaIndex</span><span class="s3">([</span><span class="s5">&quot;3 Days&quot;</span><span class="s3">, </span><span class="s5">&quot;36 Hours&quot;</span><span class="s3">])</span>
        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">three_days</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">timedelta64</span><span class="s3">):</span>
            <span class="s1">dtype </span><span class="s3">= </span><span class="s1">three_days</span><span class="s3">.</span><span class="s1">dtype</span>
            <span class="s2">if </span><span class="s1">dtype </span><span class="s3">&lt; </span><span class="s1">np</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">(</span><span class="s5">&quot;m8[s]&quot;</span><span class="s3">):</span>
                <span class="s0"># i.e. resolution is lower -&gt; use lowest supported resolution</span>
                <span class="s1">dtype </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">(</span><span class="s5">&quot;m8[s]&quot;</span><span class="s3">)</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s2">elif </span><span class="s1">type</span><span class="s3">(</span><span class="s1">three_days</span><span class="s3">) </span><span class="s2">is </span><span class="s1">timedelta</span><span class="s3">:</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;m8[us]&quot;</span><span class="s3">)</span>
        <span class="s2">elif </span><span class="s1">isinstance</span><span class="s3">(</span>
            <span class="s1">three_days</span><span class="s3">,</span>
            <span class="s3">(</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">offsets</span><span class="s3">.</span><span class="s1">Day</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">offsets</span><span class="s3">.</span><span class="s1">Hour</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">offsets</span><span class="s3">.</span><span class="s1">Minute</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">offsets</span><span class="s3">.</span><span class="s1">Second</span><span class="s3">),</span>
        <span class="s3">):</span>
            <span class="s0"># closest reso is Second</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;m8[s]&quot;</span><span class="s3">)</span>

        <span class="s1">index </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">index</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">three_days </span><span class="s3">/ </span><span class="s1">index</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;cannot use operands with types dtype&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">index </span><span class="s3">/ </span><span class="s1">three_days</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;other&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">hours</span><span class="s3">=</span><span class="s4">31</span><span class="s3">),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">hours</span><span class="s3">=</span><span class="s4">31</span><span class="s3">).</span><span class="s1">to_pytimedelta</span><span class="s3">(),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">hours</span><span class="s3">=</span><span class="s4">31</span><span class="s3">).</span><span class="s1">to_timedelta64</span><span class="s3">(),</span>
            <span class="s1">Timedelta</span><span class="s3">(</span><span class="s1">hours</span><span class="s3">=</span><span class="s4">31</span><span class="s3">).</span><span class="s1">to_timedelta64</span><span class="s3">().</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;m8[h]&quot;</span><span class="s3">),</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">timedelta64</span><span class="s3">(</span><span class="s5">&quot;NaT&quot;</span><span class="s3">),</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">timedelta64</span><span class="s3">(</span><span class="s5">&quot;NaT&quot;</span><span class="s3">, </span><span class="s5">&quot;D&quot;</span><span class="s3">),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">offsets</span><span class="s3">.</span><span class="s1">Minute</span><span class="s3">(</span><span class="s4">3</span><span class="s3">),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">offsets</span><span class="s3">.</span><span class="s1">Second</span><span class="s3">(</span><span class="s4">0</span><span class="s3">),</span>
            <span class="s0"># GH#28080 numeric+datetimelike should raise; Timestamp used</span>
            <span class="s0">#  to raise NullFrequencyError but that behavior was removed in 1.0</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s5">&quot;2021-01-01&quot;</span><span class="s3">, </span><span class="s1">tz</span><span class="s3">=</span><span class="s5">&quot;Asia/Tokyo&quot;</span><span class="s3">),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s5">&quot;2021-01-01&quot;</span><span class="s3">),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s5">&quot;2021-01-01&quot;</span><span class="s3">).</span><span class="s1">to_pydatetime</span><span class="s3">(),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s5">&quot;2021-01-01&quot;</span><span class="s3">, </span><span class="s1">tz</span><span class="s3">=</span><span class="s5">&quot;UTC&quot;</span><span class="s3">).</span><span class="s1">to_pydatetime</span><span class="s3">(),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s5">&quot;2021-01-01&quot;</span><span class="s3">).</span><span class="s1">to_datetime64</span><span class="s3">(),</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">datetime64</span><span class="s3">(</span><span class="s5">&quot;NaT&quot;</span><span class="s3">, </span><span class="s5">&quot;ns&quot;</span><span class="s3">),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">NaT</span><span class="s3">,</span>
        <span class="s3">],</span>
        <span class="s1">ids</span><span class="s3">=</span><span class="s1">repr</span><span class="s3">,</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_add_sub_datetimedeltalike_invalid</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">, </span><span class="s1">other</span><span class="s3">, </span><span class="s1">box_with_array</span>
    <span class="s3">):</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>

        <span class="s1">left </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">numeric_idx</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;|&quot;</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span>
            <span class="s3">[</span>
                <span class="s5">&quot;unsupported operand type&quot;</span><span class="s3">,</span>
                <span class="s5">&quot;Addition/subtraction of integers and integer-arrays&quot;</span><span class="s3">,</span>
                <span class="s5">&quot;Instead of adding/subtracting&quot;</span><span class="s3">,</span>
                <span class="s5">&quot;cannot use operands with types dtype&quot;</span><span class="s3">,</span>
                <span class="s5">&quot;Concatenation operation is not implemented for NumPy arrays&quot;</span><span class="s3">,</span>
                <span class="s5">&quot;Cannot (add|subtract) NaT (to|from) ndarray&quot;</span><span class="s3">,</span>
                <span class="s0"># pd.array vs np.datetime64 case</span>
                <span class="s5">r&quot;operand type\(s\) all returned NotImplemented from __array_ufunc__&quot;</span><span class="s3">,</span>
                <span class="s5">&quot;can only perform ops with numeric values&quot;</span><span class="s3">,</span>
                <span class="s5">&quot;cannot subtract DatetimeArray from ndarray&quot;</span><span class="s3">,</span>
                <span class="s0"># pd.Timedelta(1) + Index([0, 1, 2])</span>
                <span class="s5">&quot;Cannot add or subtract Timedelta from integers&quot;</span><span class="s3">,</span>
            <span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s1">assert_invalid_addsub_type</span><span class="s3">(</span><span class="s1">left</span><span class="s3">, </span><span class="s1">other</span><span class="s3">, </span><span class="s1">msg</span><span class="s3">)</span>


<span class="s0"># ------------------------------------------------------------------</span>
<span class="s0"># Arithmetic</span>


<span class="s2">class </span><span class="s1">TestDivisionByZero</span><span class="s3">:</span>
    <span class="s2">def </span><span class="s1">test_div_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">zero</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s0"># We only adjust for Index, because Series does not yet apply</span>
        <span class="s0">#  the adjustment correctly.</span>
        <span class="s1">expected2 </span><span class="s3">= </span><span class="s1">adjust_negative_zero</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">/ </span><span class="s1">zero</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected2</span><span class="s3">)</span>
        <span class="s1">ser_compat </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;i8&quot;</span><span class="s3">) / </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;i8&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">ser_compat</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_floordiv_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">zero</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s0"># We only adjust for Index, because Series does not yet apply</span>
        <span class="s0">#  the adjustment correctly.</span>
        <span class="s1">expected2 </span><span class="s3">= </span><span class="s1">adjust_negative_zero</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">// </span><span class="s1">zero</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected2</span><span class="s3">)</span>
        <span class="s1">ser_compat </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;i8&quot;</span><span class="s3">) // </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;i8&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">ser_compat</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_mod_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">zero</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">% </span><span class="s1">zero</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">ser_compat </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;i8&quot;</span><span class="s3">) % </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;i8&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">ser_compat</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">result</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_divmod_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">zero</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>

        <span class="s1">exleft </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">exright </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">exleft </span><span class="s3">= </span><span class="s1">adjust_negative_zero</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">, </span><span class="s1">exleft</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">zero</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">0</span><span class="s3">], </span><span class="s1">exleft</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">1</span><span class="s3">], </span><span class="s1">exright</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;op&quot;</span><span class="s3">, [</span><span class="s1">operator</span><span class="s3">.</span><span class="s1">truediv</span><span class="s3">, </span><span class="s1">operator</span><span class="s3">.</span><span class="s1">floordiv</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_div_negative_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">zero</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">, </span><span class="s1">op</span><span class="s3">):</span>
        <span class="s0"># Check that -1 / -0.0 returns np.inf, not -np.inf</span>
        <span class="s2">if </span><span class="s1">numeric_idx</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s1">np</span><span class="s3">.</span><span class="s1">uint64</span><span class="s3">:</span>
            <span class="s1">pytest</span><span class="s3">.</span><span class="s1">skip</span><span class="s3">(</span><span class="s5">f&quot;Div by negative 0 not relevant for </span><span class="s2">{</span><span class="s1">numeric_idx</span><span class="s3">.</span><span class="s1">dtype</span><span class="s2">}</span><span class="s5">&quot;</span><span class="s3">)</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx </span><span class="s3">- </span><span class="s4">3</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([-</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, -</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, -</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">adjust_negative_zero</span><span class="s3">(</span><span class="s1">zero</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">zero</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s0"># ------------------------------------------------------------------</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype1&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">uint64</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_ser_div_ser</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">switch_numexpr_min_elements</span><span class="s3">,</span>
        <span class="s1">dtype1</span><span class="s3">,</span>
        <span class="s1">any_real_numpy_dtype</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s0"># no longer do integer div for any ops, but deal with the 0's</span>
        <span class="s1">dtype2 </span><span class="s3">= </span><span class="s1">any_real_numpy_dtype</span>

        <span class="s1">first </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">dtype1</span><span class="s3">)</span>
        <span class="s1">second </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;second&quot;</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">dtype2</span><span class="s3">)</span>

        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
                <span class="s1">first</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">) / </span><span class="s1">second</span><span class="s3">.</span><span class="s1">values</span><span class="s3">,</span>
                <span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;float64&quot;</span><span class="s3">,</span>
                <span class="s1">name</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
            <span class="s3">)</span>
        <span class="s1">expected</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s4">0</span><span class="s3">:</span><span class="s4">3</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span>
        <span class="s2">if </span><span class="s1">first</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s5">&quot;int64&quot; </span><span class="s2">and </span><span class="s1">second</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s5">&quot;float32&quot;</span><span class="s3">:</span>
            <span class="s0"># when using numexpr, the casting rules are slightly different</span>
            <span class="s0"># and int64/float32 combo results in float32 instead of float64</span>
            <span class="s2">if </span><span class="s1">expr</span><span class="s3">.</span><span class="s1">USE_NUMEXPR </span><span class="s2">and </span><span class="s1">switch_numexpr_min_elements </span><span class="s3">== </span><span class="s4">0</span><span class="s3">:</span>
                <span class="s1">expected </span><span class="s3">= </span><span class="s1">expected</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float32&quot;</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">first </span><span class="s3">/ </span><span class="s1">second</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">assert not </span><span class="s1">result</span><span class="s3">.</span><span class="s1">equals</span><span class="s3">(</span><span class="s1">second </span><span class="s3">/ </span><span class="s1">first</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype1&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">uint64</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_ser_divmod_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">dtype1</span><span class="s3">, </span><span class="s1">any_real_numpy_dtype</span><span class="s3">):</span>
        <span class="s0"># GH#26987</span>
        <span class="s1">dtype2 </span><span class="s3">= </span><span class="s1">any_real_numpy_dtype</span>
        <span class="s1">left </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">]).</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">dtype1</span><span class="s3">)</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">2</span><span class="s3">]).</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">dtype2</span><span class="s3">)</span>

        <span class="s0"># GH#27321 pandas convention is to set 1 // 0 to np.inf, as opposed</span>
        <span class="s0">#  to numpy which sets to np.nan; patch `expected[0]` below</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">left </span><span class="s3">// </span><span class="s1">right</span><span class="s3">, </span><span class="s1">left </span><span class="s3">% </span><span class="s1">right</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">list</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">expected</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">0</span><span class="s3">].</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">expected</span><span class="s3">[</span><span class="s4">0</span><span class="s3">][</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">left</span><span class="s3">, </span><span class="s1">right</span><span class="s3">)</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">0</span><span class="s3">], </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">0</span><span class="s3">])</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">1</span><span class="s3">], </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">1</span><span class="s3">])</span>

        <span class="s0"># rdivmod case</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">left</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s1">right</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">0</span><span class="s3">], </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">0</span><span class="s3">])</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">1</span><span class="s3">], </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">1</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_ser_divmod_inf</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">left </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">])</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">])</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">left </span><span class="s3">// </span><span class="s1">right</span><span class="s3">, </span><span class="s1">left </span><span class="s3">% </span><span class="s1">right</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">left</span><span class="s3">, </span><span class="s1">right</span><span class="s3">)</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">0</span><span class="s3">], </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">0</span><span class="s3">])</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">1</span><span class="s3">], </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">1</span><span class="s3">])</span>

        <span class="s0"># rdivmod case</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">left</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s1">right</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">0</span><span class="s3">], </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">0</span><span class="s3">])</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">1</span><span class="s3">], </span><span class="s1">expected</span><span class="s3">[</span><span class="s4">1</span><span class="s3">])</span>

    <span class="s2">def </span><span class="s1">test_rdiv_zero_compat</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#8674</span>
        <span class="s1">zero_array </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s4">0</span><span class="s3">] * </span><span class="s4">5</span><span class="s3">)</span>
        <span class="s1">data </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s4">5</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0.0</span><span class="s3">] * </span><span class="s4">5</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">zero_array </span><span class="s3">/ </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">zero_array</span><span class="s3">) / </span><span class="s1">data</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">zero_array</span><span class="s3">) / </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_div_zero_inf_signs</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#9144, inf signing</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([-</span><span class="s4">1</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([-</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">/ </span><span class="s4">0</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_rdiv_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#9144</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([-</span><span class="s4">1</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">0.0</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s4">0 </span><span class="s3">/ </span><span class="s1">ser</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_floordiv_div</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#9144</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([-</span><span class="s4">1</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">// </span><span class="s4">0</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([-</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_div_zero_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># integer div, but deal with the 0's (GH#9144)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s5">&quot;second&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]})</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">df </span><span class="s3">/ </span><span class="s1">df</span>

        <span class="s1">first </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">])</span>
        <span class="s1">second </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">1</span><span class="s3">])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: </span><span class="s1">first</span><span class="s3">, </span><span class="s5">&quot;second&quot;</span><span class="s3">: </span><span class="s1">second</span><span class="s3">})</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_div_zero_array</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># integer div, but deal with the 0's (GH#9144)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s5">&quot;second&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]})</span>

        <span class="s1">first </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">])</span>
        <span class="s1">second </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">1</span><span class="s3">])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: </span><span class="s1">first</span><span class="s3">, </span><span class="s5">&quot;second&quot;</span><span class="s3">: </span><span class="s1">second</span><span class="s3">})</span>

        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">arr </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float&quot;</span><span class="s3">) / </span><span class="s1">df</span><span class="s3">.</span><span class="s1">values</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_div_zero_int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># integer div, but deal with the 0's (GH#9144)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s5">&quot;second&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]})</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">df </span><span class="s3">/ </span><span class="s4">0</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">)</span>
        <span class="s1">expected</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s4">0</span><span class="s3">:</span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s0"># numpy has a slightly different (wrong) treatment</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">arr </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float64&quot;</span><span class="s3">) / </span><span class="s4">0</span>
        <span class="s1">result2 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result2</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_div_zero_series_does_not_commute</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># integer div, but deal with the 0's (GH#9144)</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s4">10</span><span class="s3">, </span><span class="s4">5</span><span class="s3">)))</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">df</span><span class="s3">[</span><span class="s4">0</span><span class="s3">]</span>
        <span class="s1">res </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">/ </span><span class="s1">df</span>
        <span class="s1">res2 </span><span class="s3">= </span><span class="s1">df </span><span class="s3">/ </span><span class="s1">ser</span>
        <span class="s2">assert not </span><span class="s1">res</span><span class="s3">.</span><span class="s1">fillna</span><span class="s3">(</span><span class="s4">0</span><span class="s3">).</span><span class="s1">equals</span><span class="s3">(</span><span class="s1">res2</span><span class="s3">.</span><span class="s1">fillna</span><span class="s3">(</span><span class="s4">0</span><span class="s3">))</span>

    <span class="s0"># ------------------------------------------------------------------</span>
    <span class="s0"># Mod By Zero</span>

    <span class="s2">def </span><span class="s1">test_df_mod_zero_df</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">using_array_manager</span><span class="s3">):</span>
        <span class="s0"># GH#3590, modulo as ints</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s5">&quot;second&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]})</span>
        <span class="s0"># this is technically wrong, as the integer portion is coerced to float</span>
        <span class="s1">first </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">])</span>
        <span class="s2">if not </span><span class="s1">using_array_manager</span><span class="s3">:</span>
            <span class="s0"># INFO(ArrayManager) BlockManager doesn't preserve dtype per column</span>
            <span class="s0"># while ArrayManager performs op column-wisedoes and thus preserves</span>
            <span class="s0"># dtype if possible</span>
            <span class="s1">first </span><span class="s3">= </span><span class="s1">first</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>
        <span class="s1">second </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">0</span><span class="s3">])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: </span><span class="s1">first</span><span class="s3">, </span><span class="s5">&quot;second&quot;</span><span class="s3">: </span><span class="s1">second</span><span class="s3">})</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">df </span><span class="s3">% </span><span class="s1">df</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s0"># GH#38939 If we dont pass copy=False, df is consolidated and</span>
        <span class="s0">#  result[&quot;first&quot;] is float64 instead of int64</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s5">&quot;second&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]}, </span><span class="s1">copy</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">first </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;int64&quot;</span><span class="s3">)</span>
        <span class="s1">second </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">0</span><span class="s3">])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: </span><span class="s1">first</span><span class="s3">, </span><span class="s5">&quot;second&quot;</span><span class="s3">: </span><span class="s1">second</span><span class="s3">})</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">df </span><span class="s3">% </span><span class="s1">df</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_mod_zero_array</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#3590, modulo as ints</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s5">&quot;second&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]})</span>

        <span class="s0"># this is technically wrong, as the integer portion is coerced to float</span>
        <span class="s0"># ###</span>
        <span class="s1">first </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>
        <span class="s1">second </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">0</span><span class="s3">])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: </span><span class="s1">first</span><span class="s3">, </span><span class="s5">&quot;second&quot;</span><span class="s3">: </span><span class="s1">second</span><span class="s3">})</span>

        <span class="s0"># numpy has a slightly different (wrong) treatment</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">arr </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">values </span><span class="s3">% </span><span class="s1">df</span><span class="s3">.</span><span class="s1">values</span>
        <span class="s1">result2 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>
        <span class="s1">result2</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s4">0</span><span class="s3">:</span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result2</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_mod_zero_int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#3590, modulo as ints</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s5">&quot;second&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]})</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">df </span><span class="s3">% </span><span class="s4">0</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s0"># numpy has a slightly different (wrong) treatment</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">arr </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float64&quot;</span><span class="s3">) % </span><span class="s4">0</span>
        <span class="s1">result2 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result2</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_df_mod_zero_series_does_not_commute</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#3590, modulo as ints</span>
        <span class="s0"># not commutative with series</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s4">10</span><span class="s3">, </span><span class="s4">5</span><span class="s3">)))</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">df</span><span class="s3">[</span><span class="s4">0</span><span class="s3">]</span>
        <span class="s1">res </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">% </span><span class="s1">df</span>
        <span class="s1">res2 </span><span class="s3">= </span><span class="s1">df </span><span class="s3">% </span><span class="s1">ser</span>
        <span class="s2">assert not </span><span class="s1">res</span><span class="s3">.</span><span class="s1">fillna</span><span class="s3">(</span><span class="s4">0</span><span class="s3">).</span><span class="s1">equals</span><span class="s3">(</span><span class="s1">res2</span><span class="s3">.</span><span class="s1">fillna</span><span class="s3">(</span><span class="s4">0</span><span class="s3">))</span>


<span class="s2">class </span><span class="s1">TestMultiplicationDivision</span><span class="s3">:</span>
    <span class="s0"># __mul__, __rmul__, __div__, __rdiv__, __floordiv__, __rfloordiv__</span>
    <span class="s0"># for non-timestamp/timedelta/period dtypes</span>

    <span class="s2">def </span><span class="s1">test_divide_decimal</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s0"># resolves issue GH#9787</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">Decimal</span><span class="s3">(</span><span class="s4">10</span><span class="s3">)])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">Decimal</span><span class="s3">(</span><span class="s4">5</span><span class="s3">)])</span>

        <span class="s1">ser </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">ser</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">/ </span><span class="s1">Decimal</span><span class="s3">(</span><span class="s4">2</span><span class="s3">)</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">// </span><span class="s1">Decimal</span><span class="s3">(</span><span class="s4">2</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_div_equiv_binop</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># Test Series.div as well as Series.__div__</span>
        <span class="s0"># float/integer issue</span>
        <span class="s0"># GH#7785</span>
        <span class="s1">first </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">0</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">)</span>
        <span class="s1">second </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([-</span><span class="s4">0.01</span><span class="s3">, -</span><span class="s4">0.02</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;second&quot;</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([-</span><span class="s4">0.01</span><span class="s3">, -</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">])</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">second</span><span class="s3">.</span><span class="s1">div</span><span class="s3">(</span><span class="s1">first</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">check_names</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">second </span><span class="s3">/ </span><span class="s1">first</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_div_int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">/ </span><span class="s4">1</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">idx</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">/ </span><span class="s4">2</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values </span><span class="s3">/ </span><span class="s4">2</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;op&quot;</span><span class="s3">, [</span><span class="s1">operator</span><span class="s3">.</span><span class="s1">mul</span><span class="s3">, </span><span class="s1">ops</span><span class="s3">.</span><span class="s1">rmul</span><span class="s3">, </span><span class="s1">operator</span><span class="s3">.</span><span class="s1">floordiv</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_mul_int_identity</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">op</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s4">1</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_mul_int_array</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">didx </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s1">idx</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;int64&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">idx </span><span class="s3">* </span><span class="s4">5</span><span class="s3">)</span>

        <span class="s1">arr_dtype </span><span class="s3">= </span><span class="s5">&quot;uint64&quot; </span><span class="s2">if </span><span class="s1">idx</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s1">np</span><span class="s3">.</span><span class="s1">uint64 </span><span class="s2">else </span><span class="s5">&quot;int64&quot;</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">arr_dtype</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">didx</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_mul_int_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">didx </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s1">idx</span>

        <span class="s1">arr_dtype </span><span class="s3">= </span><span class="s5">&quot;uint64&quot; </span><span class="s2">if </span><span class="s1">idx</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s1">np</span><span class="s3">.</span><span class="s1">uint64 </span><span class="s2">else </span><span class="s5">&quot;int64&quot;</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">arr_dtype</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">didx</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_mul_float_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">rng5 </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">rng5 </span><span class="s3">+ </span><span class="s4">0.1</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">rng5 </span><span class="s3">* (</span><span class="s1">rng5 </span><span class="s3">+ </span><span class="s4">0.1</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_mul_index</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s1">idx</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">**</span><span class="s4">2</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_mul_datelike_raises</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;cannot perform __rmul__ with this index type&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">idx </span><span class="s3">* </span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;20130101&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">5</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_mul_size_mismatch_raises</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;operands could not be broadcast together&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">idx </span><span class="s3">* </span><span class="s1">idx</span><span class="s3">[</span><span class="s4">0</span><span class="s3">:</span><span class="s4">3</span><span class="s3">]</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">idx </span><span class="s3">* </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">])</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;op&quot;</span><span class="s3">, [</span><span class="s1">operator</span><span class="s3">.</span><span class="s1">pow</span><span class="s3">, </span><span class="s1">ops</span><span class="s3">.</span><span class="s1">rpow</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_pow_float</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">op</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s0"># test power calculations both ways, GH#14973</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">op</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">))</span>

        <span class="s1">idx </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_modulo</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s0"># GH#9244</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values </span><span class="s3">% </span><span class="s4">2</span><span class="s3">)</span>

        <span class="s1">idx </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">% </span><span class="s4">2</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_divmod_scalar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">div</span><span class="s3">, </span><span class="s1">mod </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">div</span><span class="s3">), </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">mod</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">r</span><span class="s3">, </span><span class="s1">e </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">r</span><span class="s3">, </span><span class="s1">e</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_divmod_ndarray</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">other </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">) * </span><span class="s4">2</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">div</span><span class="s3">, </span><span class="s1">mod </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">div</span><span class="s3">), </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">mod</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">r</span><span class="s3">, </span><span class="s1">e </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">r</span><span class="s3">, </span><span class="s1">e</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_divmod_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">numeric_idx</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">numeric_idx</span>
        <span class="s1">other </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">.</span><span class="s1">dtype</span><span class="s3">) * </span><span class="s4">2</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">other</span><span class="s3">))</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">div</span><span class="s3">, </span><span class="s1">mod </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">div</span><span class="s3">), </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">mod</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">r</span><span class="s3">, </span><span class="s1">e </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">r</span><span class="s3">, </span><span class="s1">e</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;other&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">7</span><span class="s3">, -</span><span class="s4">23</span><span class="s3">, </span><span class="s4">2.718</span><span class="s3">, -</span><span class="s4">3.14</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_ops_np_scalar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">other</span><span class="s3">):</span>
        <span class="s1">vals </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s4">5</span><span class="s3">, </span><span class="s4">3</span><span class="s3">))</span>
        <span class="s1">f </span><span class="s3">= </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">x</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCDE&quot;</span><span class="s3">), </span><span class="s1">columns</span><span class="s3">=[</span><span class="s5">&quot;jim&quot;</span><span class="s3">, </span><span class="s5">&quot;joe&quot;</span><span class="s3">, </span><span class="s5">&quot;jolie&quot;</span><span class="s3">]</span>
        <span class="s3">)</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">f</span><span class="s3">(</span><span class="s1">vals</span><span class="s3">)</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">df </span><span class="s3">/ </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">other</span><span class="s3">), </span><span class="s1">f</span><span class="s3">(</span><span class="s1">vals </span><span class="s3">/ </span><span class="s1">other</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">other</span><span class="s3">) * </span><span class="s1">df</span><span class="s3">, </span><span class="s1">f</span><span class="s3">(</span><span class="s1">vals </span><span class="s3">* </span><span class="s1">other</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">df </span><span class="s3">+ </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">other</span><span class="s3">), </span><span class="s1">f</span><span class="s3">(</span><span class="s1">vals </span><span class="s3">+ </span><span class="s1">other</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">other</span><span class="s3">) - </span><span class="s1">df</span><span class="s3">, </span><span class="s1">f</span><span class="s3">(</span><span class="s1">other </span><span class="s3">- </span><span class="s1">vals</span><span class="s3">))</span>

    <span class="s0"># TODO: This came from series.test.test_operators, needs cleanup</span>
    <span class="s2">def </span><span class="s1">test_operators_frame</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># rpow does not work with DataFrame</span>
        <span class="s1">ts </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;ts&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">ts</span><span class="s3">.</span><span class="s1">name </span><span class="s3">= </span><span class="s5">&quot;ts&quot;</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;A&quot;</span><span class="s3">: </span><span class="s1">ts</span><span class="s3">})</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">ts </span><span class="s3">+ </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">ts </span><span class="s3">+ </span><span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;A&quot;</span><span class="s3">], </span><span class="s1">check_names</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">ts</span><span class="s3">**</span><span class="s1">ts</span><span class="s3">, </span><span class="s1">ts </span><span class="s3">** </span><span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;A&quot;</span><span class="s3">], </span><span class="s1">check_names</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">ts </span><span class="s3">&lt; </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">ts </span><span class="s3">&lt; </span><span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;A&quot;</span><span class="s3">], </span><span class="s1">check_names</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">ts </span><span class="s3">/ </span><span class="s1">ts</span><span class="s3">, </span><span class="s1">ts </span><span class="s3">/ </span><span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;A&quot;</span><span class="s3">], </span><span class="s1">check_names</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

    <span class="s0"># TODO: this came from tests.series.test_analytics, needs cleanup and</span>
    <span class="s0">#  de-duplication with test_modulo above</span>
    <span class="s2">def </span><span class="s1">test_modulo2</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s0"># GH#3590, modulo as ints</span>
            <span class="s1">p </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;first&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">8</span><span class="s3">], </span><span class="s5">&quot;second&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]})</span>
            <span class="s1">result </span><span class="s3">= </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;first&quot;</span><span class="s3">] % </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;second&quot;</span><span class="s3">]</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;first&quot;</span><span class="s3">].</span><span class="s1">values </span><span class="s3">% </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;second&quot;</span><span class="s3">].</span><span class="s1">values</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>
            <span class="s1">expected</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[</span><span class="s4">0</span><span class="s3">:</span><span class="s4">3</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;first&quot;</span><span class="s3">] % </span><span class="s4">0</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">p</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;first&quot;</span><span class="s3">)</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

            <span class="s1">p </span><span class="s3">= </span><span class="s1">p</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>
            <span class="s1">result </span><span class="s3">= </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;first&quot;</span><span class="s3">] % </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;second&quot;</span><span class="s3">]</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;first&quot;</span><span class="s3">].</span><span class="s1">values </span><span class="s3">% </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;second&quot;</span><span class="s3">].</span><span class="s1">values</span><span class="s3">)</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

            <span class="s1">p </span><span class="s3">= </span><span class="s1">p</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>
            <span class="s1">result </span><span class="s3">= </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;first&quot;</span><span class="s3">] % </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;second&quot;</span><span class="s3">]</span>
            <span class="s1">result2 </span><span class="s3">= </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;second&quot;</span><span class="s3">] % </span><span class="s1">p</span><span class="s3">[</span><span class="s5">&quot;first&quot;</span><span class="s3">]</span>
            <span class="s2">assert not </span><span class="s1">result</span><span class="s3">.</span><span class="s1">equals</span><span class="s3">(</span><span class="s1">result2</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_modulo_zero_int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># GH#9144</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">])</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s1">s </span><span class="s3">% </span><span class="s4">0</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

            <span class="s1">result </span><span class="s3">= </span><span class="s4">0 </span><span class="s3">% </span><span class="s1">s</span>
            <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">0.0</span><span class="s3">])</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestAdditionSubtraction</span><span class="s3">:</span>
    <span class="s0"># __add__, __sub__, __radd__, __rsub__, __iadd__, __isub__</span>
    <span class="s0"># for non-timestamp/timedelta/period dtypes</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;first, second, expected&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span>
                <span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABC&quot;</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">),</span>
                <span class="s1">Series</span><span class="s3">([</span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABD&quot;</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">),</span>
                <span class="s1">Series</span><span class="s3">([</span><span class="s4">3.0</span><span class="s3">, </span><span class="s4">4.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">),</span>
            <span class="s3">),</span>
            <span class="s3">(</span>
                <span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABC&quot;</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">),</span>
                <span class="s1">Series</span><span class="s3">([</span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">),</span>
                <span class="s1">Series</span><span class="s3">([</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">),</span>
            <span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_add_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">first</span><span class="s3">, </span><span class="s1">second</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
        <span class="s0"># GH#1134</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">first </span><span class="s3">+ </span><span class="s1">second</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">second </span><span class="s3">+ </span><span class="s1">first</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;first, second, expected&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s3">(</span>
                <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;x&quot;</span><span class="s3">: [</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABC&quot;</span><span class="s3">)),</span>
                <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;x&quot;</span><span class="s3">: [</span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">]}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABD&quot;</span><span class="s3">)),</span>
                <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;x&quot;</span><span class="s3">: [</span><span class="s4">3.0</span><span class="s3">, </span><span class="s4">4.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">]}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s3">)),</span>
            <span class="s3">),</span>
            <span class="s3">(</span>
                <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;x&quot;</span><span class="s3">: [</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">]}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABC&quot;</span><span class="s3">)),</span>
                <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;x&quot;</span><span class="s3">: [</span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">2</span><span class="s3">]}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s3">)),</span>
                <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;x&quot;</span><span class="s3">: [</span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">]}, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s3">)),</span>
            <span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_add_frames</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">first</span><span class="s3">, </span><span class="s1">second</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
        <span class="s0"># GH#1134</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">first </span><span class="s3">+ </span><span class="s1">second</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">second </span><span class="s3">+ </span><span class="s1">first</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s0"># TODO: This came from series.test.test_operators, needs cleanup</span>
    <span class="s2">def </span><span class="s1">test_series_frame_radd_bug</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">fixed_now_ts</span><span class="s3">):</span>
        <span class="s0"># GH#353</span>
        <span class="s1">vals </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">str</span><span class="s3">(</span><span class="s1">i</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s4">5</span><span class="s3">)])</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s5">&quot;foo_&quot; </span><span class="s3">+ </span><span class="s1">vals</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">vals</span><span class="s3">.</span><span class="s1">map</span><span class="s3">(</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s5">&quot;foo_&quot; </span><span class="s3">+ </span><span class="s1">x</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">frame </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;vals&quot;</span><span class="s3">: </span><span class="s1">vals</span><span class="s3">})</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s5">&quot;foo_&quot; </span><span class="s3">+ </span><span class="s1">frame</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;vals&quot;</span><span class="s3">: </span><span class="s1">vals</span><span class="s3">.</span><span class="s1">map</span><span class="s3">(</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s5">&quot;foo_&quot; </span><span class="s3">+ </span><span class="s1">x</span><span class="s3">)})</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">ts </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;ts&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>

        <span class="s0"># really raise this time</span>
        <span class="s1">fix_now </span><span class="s3">= </span><span class="s1">fixed_now_ts</span><span class="s3">.</span><span class="s1">to_pydatetime</span><span class="s3">()</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;|&quot;</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span>
            <span class="s3">[</span>
                <span class="s5">&quot;unsupported operand type&quot;</span><span class="s3">,</span>
                <span class="s0"># wrong error message, see https://github.com/numpy/numpy/issues/18832</span>
                <span class="s5">&quot;Concatenation operation&quot;</span><span class="s3">,</span>
            <span class="s3">]</span>
        <span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">fix_now </span><span class="s3">+ </span><span class="s1">ts</span>

        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">ts </span><span class="s3">+ </span><span class="s1">fix_now</span>

    <span class="s0"># TODO: This came from series.test.test_operators, needs cleanup</span>
    <span class="s2">def </span><span class="s1">test_datetime64_with_index</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># arithmetic integer ops with an index</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s4">5</span><span class="s3">))</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">- </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">to_series</span><span class="s3">()</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">- </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">index</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s0"># GH#4629</span>
        <span class="s0"># arithmetic datetime64 ops with an index</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;20130101&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">5</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;20130101&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">5</span><span class="s3">),</span>
        <span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">- </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">to_series</span><span class="s3">()</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">- </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">index</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">msg </span><span class="s3">= </span><span class="s5">&quot;cannot subtract PeriodArray from DatetimeArray&quot;</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s0"># GH#18850</span>
            <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">- </span><span class="s1">ser</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">to_period</span><span class="s3">()</span>

        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s4">5</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;20130101&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">5</span><span class="s3">),</span>
        <span class="s3">)</span>
        <span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;date&quot;</span><span class="s3">] = </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s5">&quot;20130102&quot;</span><span class="s3">)</span>
        <span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;expected&quot;</span><span class="s3">] = </span><span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;date&quot;</span><span class="s3">] - </span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">to_series</span><span class="s3">()</span>
        <span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;result&quot;</span><span class="s3">] = </span><span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;date&quot;</span><span class="s3">] - </span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;result&quot;</span><span class="s3">], </span><span class="s1">df</span><span class="s3">[</span><span class="s5">&quot;expected&quot;</span><span class="s3">], </span><span class="s1">check_names</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

    <span class="s0"># TODO: taken from tests.frame.test_operators, needs cleanup</span>
    <span class="s2">def </span><span class="s1">test_frame_operators</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">float_frame</span><span class="s3">):</span>
        <span class="s1">frame </span><span class="s3">= </span><span class="s1">float_frame</span>

        <span class="s1">garbage </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">random</span><span class="s3">(</span><span class="s4">4</span><span class="s3">)</span>
        <span class="s1">colSeries </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">garbage</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">frame</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">))</span>

        <span class="s1">idSum </span><span class="s3">= </span><span class="s1">frame </span><span class="s3">+ </span><span class="s1">frame</span>
        <span class="s1">seriesSum </span><span class="s3">= </span><span class="s1">frame </span><span class="s3">+ </span><span class="s1">colSeries</span>

        <span class="s2">for </span><span class="s1">col</span><span class="s3">, </span><span class="s1">series </span><span class="s2">in </span><span class="s1">idSum</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
            <span class="s2">for </span><span class="s1">idx</span><span class="s3">, </span><span class="s1">val </span><span class="s2">in </span><span class="s1">series</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
                <span class="s1">origVal </span><span class="s3">= </span><span class="s1">frame</span><span class="s3">[</span><span class="s1">col</span><span class="s3">][</span><span class="s1">idx</span><span class="s3">] * </span><span class="s4">2</span>
                <span class="s2">if not </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">val</span><span class="s3">):</span>
                    <span class="s2">assert </span><span class="s1">val </span><span class="s3">== </span><span class="s1">origVal</span>
                <span class="s2">else</span><span class="s3">:</span>
                    <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">origVal</span><span class="s3">)</span>

        <span class="s2">for </span><span class="s1">col</span><span class="s3">, </span><span class="s1">series </span><span class="s2">in </span><span class="s1">seriesSum</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
            <span class="s2">for </span><span class="s1">idx</span><span class="s3">, </span><span class="s1">val </span><span class="s2">in </span><span class="s1">series</span><span class="s3">.</span><span class="s1">items</span><span class="s3">():</span>
                <span class="s1">origVal </span><span class="s3">= </span><span class="s1">frame</span><span class="s3">[</span><span class="s1">col</span><span class="s3">][</span><span class="s1">idx</span><span class="s3">] + </span><span class="s1">colSeries</span><span class="s3">[</span><span class="s1">col</span><span class="s3">]</span>
                <span class="s2">if not </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">val</span><span class="s3">):</span>
                    <span class="s2">assert </span><span class="s1">val </span><span class="s3">== </span><span class="s1">origVal</span>
                <span class="s2">else</span><span class="s3">:</span>
                    <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">origVal</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_frame_operators_col_align</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">float_frame</span><span class="s3">):</span>
        <span class="s1">frame2 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">float_frame</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=[</span><span class="s5">&quot;D&quot;</span><span class="s3">, </span><span class="s5">&quot;C&quot;</span><span class="s3">, </span><span class="s5">&quot;B&quot;</span><span class="s3">, </span><span class="s5">&quot;A&quot;</span><span class="s3">])</span>
        <span class="s1">added </span><span class="s3">= </span><span class="s1">frame2 </span><span class="s3">+ </span><span class="s1">frame2</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">frame2 </span><span class="s3">* </span><span class="s4">2</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">added</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_frame_operators_none_to_nan</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;a&quot;</span><span class="s3">: [</span><span class="s5">&quot;a&quot;</span><span class="s3">, </span><span class="s2">None</span><span class="s3">, </span><span class="s5">&quot;b&quot;</span><span class="s3">]})</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">df </span><span class="s3">+ </span><span class="s1">df</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;a&quot;</span><span class="s3">: [</span><span class="s5">&quot;aa&quot;</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s5">&quot;bb&quot;</span><span class="s3">]}))</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype&quot;</span><span class="s3">, (</span><span class="s5">&quot;float&quot;</span><span class="s3">, </span><span class="s5">&quot;int64&quot;</span><span class="s3">))</span>
    <span class="s2">def </span><span class="s1">test_frame_operators_empty_like</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">):</span>
        <span class="s0"># Test for issue #10181</span>
        <span class="s1">frames </span><span class="s3">= [</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">=[</span><span class="s5">&quot;A&quot;</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">),</span>
            <span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">index</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">),</span>
        <span class="s3">]</span>
        <span class="s2">for </span><span class="s1">df </span><span class="s2">in </span><span class="s1">frames</span><span class="s3">:</span>
            <span class="s2">assert </span><span class="s3">(</span><span class="s1">df </span><span class="s3">+ </span><span class="s1">df</span><span class="s3">).</span><span class="s1">equals</span><span class="s3">(</span><span class="s1">df</span><span class="s3">)</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">df </span><span class="s3">+ </span><span class="s1">df</span><span class="s3">, </span><span class="s1">df</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;func&quot;</span><span class="s3">,</span>
        <span class="s3">[</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x </span><span class="s3">* </span><span class="s4">2</span><span class="s3">, </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x</span><span class="s3">[::</span><span class="s4">2</span><span class="s3">], </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s4">5</span><span class="s3">],</span>
        <span class="s1">ids</span><span class="s3">=[</span><span class="s5">&quot;multiply&quot;</span><span class="s3">, </span><span class="s5">&quot;slice&quot;</span><span class="s3">, </span><span class="s5">&quot;constant&quot;</span><span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_series_operators_arithmetic</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">all_arithmetic_functions</span><span class="s3">, </span><span class="s1">func</span><span class="s3">):</span>
        <span class="s1">op </span><span class="s3">= </span><span class="s1">all_arithmetic_functions</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;ts&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">other </span><span class="s3">= </span><span class="s1">func</span><span class="s3">(</span><span class="s1">series</span><span class="s3">)</span>
        <span class="s1">compare_op</span><span class="s3">(</span><span class="s1">series</span><span class="s3">, </span><span class="s1">other</span><span class="s3">, </span><span class="s1">op</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;func&quot;</span><span class="s3">, [</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x </span><span class="s3">+ </span><span class="s4">1</span><span class="s3">, </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s4">5</span><span class="s3">], </span><span class="s1">ids</span><span class="s3">=[</span><span class="s5">&quot;add&quot;</span><span class="s3">, </span><span class="s5">&quot;constant&quot;</span><span class="s3">]</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_series_operators_compare</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">comparison_op</span><span class="s3">, </span><span class="s1">func</span><span class="s3">):</span>
        <span class="s1">op </span><span class="s3">= </span><span class="s1">comparison_op</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;ts&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">other </span><span class="s3">= </span><span class="s1">func</span><span class="s3">(</span><span class="s1">series</span><span class="s3">)</span>
        <span class="s1">compare_op</span><span class="s3">(</span><span class="s1">series</span><span class="s3">, </span><span class="s1">other</span><span class="s3">, </span><span class="s1">op</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;func&quot;</span><span class="s3">,</span>
        <span class="s3">[</span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x </span><span class="s3">* </span><span class="s4">2</span><span class="s3">, </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">x</span><span class="s3">[::</span><span class="s4">2</span><span class="s3">], </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s4">5</span><span class="s3">],</span>
        <span class="s1">ids</span><span class="s3">=[</span><span class="s5">&quot;multiply&quot;</span><span class="s3">, </span><span class="s5">&quot;slice&quot;</span><span class="s3">, </span><span class="s5">&quot;constant&quot;</span><span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_divmod</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">func</span><span class="s3">):</span>
        <span class="s1">series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;ts&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">other </span><span class="s3">= </span><span class="s1">func</span><span class="s3">(</span><span class="s1">series</span><span class="s3">)</span>
        <span class="s1">results </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">series</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">other</span><span class="s3">, </span><span class="s1">abc</span><span class="s3">.</span><span class="s1">Iterable</span><span class="s3">) </span><span class="s2">and </span><span class="s1">len</span><span class="s3">(</span><span class="s1">series</span><span class="s3">) != </span><span class="s1">len</span><span class="s3">(</span><span class="s1">other</span><span class="s3">):</span>
            <span class="s0"># if the lengths don't match, this is the test where we use</span>
            <span class="s0"># `tser[::2]`. Pad every other value in `other_np` with nan.</span>
            <span class="s1">other_np </span><span class="s3">= []</span>
            <span class="s2">for </span><span class="s1">n </span><span class="s2">in </span><span class="s1">other</span><span class="s3">:</span>
                <span class="s1">other_np</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">n</span><span class="s3">)</span>
                <span class="s1">other_np</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">other_np </span><span class="s3">= </span><span class="s1">other</span>
        <span class="s1">other_np </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">asarray</span><span class="s3">(</span><span class="s1">other_np</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">np</span><span class="s3">.</span><span class="s1">errstate</span><span class="s3">(</span><span class="s1">all</span><span class="s3">=</span><span class="s5">&quot;ignore&quot;</span><span class="s3">):</span>
            <span class="s1">expecteds </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">series</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">asarray</span><span class="s3">(</span><span class="s1">other_np</span><span class="s3">))</span>

        <span class="s2">for </span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected </span><span class="s2">in </span><span class="s1">zip</span><span class="s3">(</span><span class="s1">results</span><span class="s3">, </span><span class="s1">expecteds</span><span class="s3">):</span>
            <span class="s0"># check the values, name, and index separately</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">asarray</span><span class="s3">(</span><span class="s1">result</span><span class="s3">), </span><span class="s1">expected</span><span class="s3">)</span>

            <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">name </span><span class="s3">== </span><span class="s1">series</span><span class="s3">.</span><span class="s1">name</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">series</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">_with_freq</span><span class="s3">(</span><span class="s2">None</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_series_divmod_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># Check that divmod uses pandas convention for division by zero,</span>
        <span class="s0">#  which does not match numpy.</span>
        <span class="s0"># pandas convention has</span>
        <span class="s0">#  1/0 == np.inf</span>
        <span class="s0">#  -1/0 == -np.inf</span>
        <span class="s0">#  1/-0.0 == -np.inf</span>
        <span class="s0">#  -1/-0.0 == np.inf</span>
        <span class="s1">tser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">1</span><span class="s3">, </span><span class="s4">11</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s5">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;ts&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>
        <span class="s1">other </span><span class="s3">= </span><span class="s1">tser </span><span class="s3">* </span><span class="s4">0</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">divmod</span><span class="s3">(</span><span class="s1">tser</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s1">exp1 </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">] * </span><span class="s1">len</span><span class="s3">(</span><span class="s1">tser</span><span class="s3">), </span><span class="s1">index</span><span class="s3">=</span><span class="s1">tser</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;ts&quot;</span><span class="s3">)</span>
        <span class="s1">exp2 </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">] * </span><span class="s1">len</span><span class="s3">(</span><span class="s1">tser</span><span class="s3">), </span><span class="s1">index</span><span class="s3">=</span><span class="s1">tser</span><span class="s3">.</span><span class="s1">index</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;ts&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">0</span><span class="s3">], </span><span class="s1">exp1</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">1</span><span class="s3">], </span><span class="s1">exp2</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestUFuncCompat</span><span class="s3">:</span>
    <span class="s0"># TODO: add more dtypes</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;holder&quot;</span><span class="s3">, [</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">RangeIndex</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">uint64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_ufunc_compat</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">holder</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">):</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">Series </span><span class="s2">if </span><span class="s1">holder </span><span class="s2">is </span><span class="s1">Series </span><span class="s2">else </span><span class="s1">Index</span>

        <span class="s2">if </span><span class="s1">holder </span><span class="s2">is </span><span class="s1">RangeIndex</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">dtype </span><span class="s3">!= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">:</span>
                <span class="s1">pytest</span><span class="s3">.</span><span class="s1">skip</span><span class="s3">(</span><span class="s5">f&quot;dtype </span><span class="s2">{</span><span class="s1">dtype</span><span class="s2">} </span><span class="s5">not relevant for RangeIndex&quot;</span><span class="s3">)</span>
            <span class="s1">idx </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;foo&quot;</span><span class="s3">)</span>
        <span class="s2">else</span><span class="s3">:</span>
            <span class="s1">idx </span><span class="s3">= </span><span class="s1">holder</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;foo&quot;</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">sin</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">box</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">sin</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">)), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;foo&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s0"># TODO: add more dtypes</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;holder&quot;</span><span class="s3">, [</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">uint64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_ufunc_coercions</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">holder</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">):</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">holder</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">Series </span><span class="s2">if </span><span class="s1">holder </span><span class="s2">is </span><span class="s1">Series </span><span class="s2">else </span><span class="s1">Index</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">sqrt</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s5">&quot;f8&quot; </span><span class="s2">and </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">sqrt</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">5</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)), </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">exp</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">exp</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">divide</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s5">&quot;f8&quot; </span><span class="s2">and </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">0.5</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.5</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">, </span><span class="s4">2.5</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">exp</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">exp</span><span class="s3">)</span>

        <span class="s0"># _evaluate_numeric_binop</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">+ </span><span class="s4">2.0</span>
        <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s5">&quot;f8&quot; </span><span class="s2">and </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">3.0</span><span class="s3">, </span><span class="s4">4.0</span><span class="s3">, </span><span class="s4">5.0</span><span class="s3">, </span><span class="s4">6.0</span><span class="s3">, </span><span class="s4">7.0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">exp</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">exp</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">- </span><span class="s4">2.0</span>
        <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s5">&quot;f8&quot; </span><span class="s2">and </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([-</span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">0.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">, </span><span class="s4">3.0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">exp</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">exp</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s4">1.0</span>
        <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s5">&quot;f8&quot; </span><span class="s2">and </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">, </span><span class="s4">3.0</span><span class="s3">, </span><span class="s4">4.0</span><span class="s3">, </span><span class="s4">5.0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">exp</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">exp</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">/ </span><span class="s4">2.0</span>
        <span class="s2">assert </span><span class="s1">result</span><span class="s3">.</span><span class="s1">dtype </span><span class="s3">== </span><span class="s5">&quot;f8&quot; </span><span class="s2">and </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">0.5</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.5</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">, </span><span class="s4">2.5</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">exp </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">exp</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">exp</span><span class="s3">)</span>

    <span class="s0"># TODO: add more dtypes</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;holder&quot;</span><span class="s3">, [</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">Series</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">uint64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_ufunc_multiple_return_values</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">holder</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">):</span>
        <span class="s1">obj </span><span class="s3">= </span><span class="s1">holder</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">Series </span><span class="s2">if </span><span class="s1">holder </span><span class="s2">is </span><span class="s1">Series </span><span class="s2">else </span><span class="s1">Index</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">modf</span><span class="s3">(</span><span class="s1">obj</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">tuple</span><span class="s3">)</span>
        <span class="s1">exp1 </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">0.0</span><span class="s3">, </span><span class="s4">0.0</span><span class="s3">, </span><span class="s4">0.0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">exp2 </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">2.0</span><span class="s3">, </span><span class="s4">3.0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">0</span><span class="s3">], </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">exp1</span><span class="s3">, </span><span class="s1">box</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">[</span><span class="s4">1</span><span class="s3">], </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">exp2</span><span class="s3">, </span><span class="s1">box</span><span class="s3">))</span>

    <span class="s2">def </span><span class="s1">test_ufunc_at</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">np</span><span class="s3">.</span><span class="s1">add</span><span class="s3">.</span><span class="s1">at</span><span class="s3">(</span><span class="s1">s</span><span class="s3">, [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">2</span><span class="s3">], </span><span class="s4">10</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">10</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">12</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">name</span><span class="s3">=</span><span class="s5">&quot;x&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">s</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestObjectDtypeEquivalence</span><span class="s3">:</span>
    <span class="s0"># Tests that arithmetic operations match operations executed elementwise</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype&quot;</span><span class="s3">, [</span><span class="s2">None</span><span class="s3">, </span><span class="s1">object</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_numarr_with_dtype_add_nan</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">)</span>

        <span class="s1">ser </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">ser</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan </span><span class="s3">+ </span><span class="s1">ser</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">+ </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype&quot;</span><span class="s3">, [</span><span class="s2">None</span><span class="s3">, </span><span class="s1">object</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_numarr_with_dtype_add_int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s1">box </span><span class="s3">= </span><span class="s1">box_with_array</span>
        <span class="s1">ser </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">)</span>

        <span class="s1">ser </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">ser</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s4">1 </span><span class="s3">+ </span><span class="s1">ser</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">ser </span><span class="s3">+ </span><span class="s4">1</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s0"># TODO: moved from tests.series.test_operators; needs cleanup</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;op&quot;</span><span class="s3">,</span>
        <span class="s3">[</span><span class="s1">operator</span><span class="s3">.</span><span class="s1">add</span><span class="s3">, </span><span class="s1">operator</span><span class="s3">.</span><span class="s1">sub</span><span class="s3">, </span><span class="s1">operator</span><span class="s3">.</span><span class="s1">mul</span><span class="s3">, </span><span class="s1">operator</span><span class="s3">.</span><span class="s1">truediv</span><span class="s3">, </span><span class="s1">operator</span><span class="s3">.</span><span class="s1">floordiv</span><span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_operators_reverse_object</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">op</span><span class="s3">):</span>
        <span class="s0"># GH#56</span>
        <span class="s1">arr </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s1">dtype</span><span class="s3">=</span><span class="s1">object</span><span class="s3">,</span>
        <span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s4">1.0</span><span class="s3">, </span><span class="s1">arr</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s4">1.0</span><span class="s3">, </span><span class="s1">arr</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">float</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">.</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">float</span><span class="s3">), </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestNumericArithmeticUnsorted</span><span class="s3">:</span>
    <span class="s0"># Tests in this class have been moved from type-specific test modules</span>
    <span class="s0">#  but not yet sorted, parametrized, and de-duplicated</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;op&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">add</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">sub</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">mul</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">floordiv</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">truediv</span><span class="s3">,</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;idx1&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">1</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">2</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(-</span><span class="s4">10</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">2</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, -</span><span class="s4">5</span><span class="s3">, -</span><span class="s4">1</span><span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;idx2&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">1</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">2</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(-</span><span class="s4">10</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">2</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, -</span><span class="s4">5</span><span class="s3">, -</span><span class="s4">1</span><span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_binops_index</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">op</span><span class="s3">, </span><span class="s1">idx1</span><span class="s3">, </span><span class="s1">idx2</span><span class="s3">):</span>
        <span class="s1">idx1 </span><span class="s3">= </span><span class="s1">idx1</span><span class="s3">.</span><span class="s1">_rename</span><span class="s3">(</span><span class="s5">&quot;foo&quot;</span><span class="s3">)</span>
        <span class="s1">idx2 </span><span class="s3">= </span><span class="s1">idx2</span><span class="s3">.</span><span class="s1">_rename</span><span class="s3">(</span><span class="s5">&quot;bar&quot;</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">idx1</span><span class="s3">, </span><span class="s1">idx2</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx1</span><span class="s3">.</span><span class="s1">to_numpy</span><span class="s3">()), </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx2</span><span class="s3">.</span><span class="s1">to_numpy</span><span class="s3">()))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s5">&quot;equiv&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;op&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">add</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">sub</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">mul</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">floordiv</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">truediv</span><span class="s3">,</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;idx&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">1</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">2</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(-</span><span class="s4">10</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">2</span><span class="s3">),</span>
            <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">5</span><span class="s3">, -</span><span class="s4">5</span><span class="s3">, -</span><span class="s4">1</span><span class="s3">),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;scalar&quot;</span><span class="s3">, [-</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_binops_index_scalar</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">op</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">, </span><span class="s1">scalar</span><span class="s3">):</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">scalar</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">to_numpy</span><span class="s3">()), </span><span class="s1">scalar</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s5">&quot;equiv&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;idx1&quot;</span><span class="s3">, [</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">1</span><span class="s3">), </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;idx2&quot;</span><span class="s3">, [</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">1</span><span class="s3">), </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)])</span>
    <span class="s2">def </span><span class="s1">test_binops_index_pow</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">idx1</span><span class="s3">, </span><span class="s1">idx2</span><span class="s3">):</span>
        <span class="s0"># numpy does not allow powers of negative integers so test separately</span>
        <span class="s0"># https://github.com/numpy/numpy/pull/8127</span>
        <span class="s1">idx1 </span><span class="s3">= </span><span class="s1">idx1</span><span class="s3">.</span><span class="s1">_rename</span><span class="s3">(</span><span class="s5">&quot;foo&quot;</span><span class="s3">)</span>
        <span class="s1">idx2 </span><span class="s3">= </span><span class="s1">idx2</span><span class="s3">.</span><span class="s1">_rename</span><span class="s3">(</span><span class="s5">&quot;bar&quot;</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">pow</span><span class="s3">(</span><span class="s1">idx1</span><span class="s3">, </span><span class="s1">idx2</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pow</span><span class="s3">(</span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx1</span><span class="s3">.</span><span class="s1">to_numpy</span><span class="s3">()), </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx2</span><span class="s3">.</span><span class="s1">to_numpy</span><span class="s3">()))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s5">&quot;equiv&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;idx&quot;</span><span class="s3">, [</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">1</span><span class="s3">), </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;scalar&quot;</span><span class="s3">, [</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_binops_index_scalar_pow</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">, </span><span class="s1">scalar</span><span class="s3">):</span>
        <span class="s0"># numpy does not allow powers of negative integers so test separately</span>
        <span class="s0"># https://github.com/numpy/numpy/pull/8127</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">pow</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">, </span><span class="s1">scalar</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">pow</span><span class="s3">(</span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">to_numpy</span><span class="s3">()), </span><span class="s1">scalar</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s5">&quot;equiv&quot;</span><span class="s3">)</span>

    <span class="s0"># TODO: divmod?</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;op&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">add</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">sub</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">mul</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">floordiv</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">truediv</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">pow</span><span class="s3">,</span>
            <span class="s1">operator</span><span class="s3">.</span><span class="s1">mod</span><span class="s3">,</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_arithmetic_with_frame_or_series</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">op</span><span class="s3">):</span>
        <span class="s0"># check that we return NotImplemented when operating with Series</span>
        <span class="s0"># or DataFrame</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">5</span><span class="s3">)</span>
        <span class="s1">other </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s4">5</span><span class="s3">))</span>

        <span class="s1">expected </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">Series</span><span class="s3">(</span><span class="s1">index</span><span class="s3">), </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">index</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">other </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s4">2</span><span class="s3">, </span><span class="s4">5</span><span class="s3">)))</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">([</span><span class="s1">index</span><span class="s3">, </span><span class="s1">index</span><span class="s3">]), </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">op</span><span class="s3">(</span><span class="s1">index</span><span class="s3">, </span><span class="s1">other</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_numeric_compat2</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0"># validate that we are handling the RangeIndex overrides to numeric ops</span>
        <span class="s0"># and returning RangeIndex where possible</span>

        <span class="s1">idx </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s4">2</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">20</span><span class="s3">, </span><span class="s4">4</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">+ </span><span class="s4">2</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">2</span><span class="s3">, </span><span class="s4">12</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">- </span><span class="s4">2</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(-</span><span class="s4">2</span><span class="s3">, </span><span class="s4">8</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">/ </span><span class="s4">2</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">5</span><span class="s3">, </span><span class="s4">1</span><span class="s3">).</span><span class="s1">astype</span><span class="s3">(</span><span class="s5">&quot;float64&quot;</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">/ </span><span class="s4">4</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">2</span><span class="s3">) / </span><span class="s4">4</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">// </span><span class="s4">1</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">idx</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s0"># __mul__</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx </span><span class="s3">* </span><span class="s1">idx</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values </span><span class="s3">* </span><span class="s1">idx</span><span class="s3">.</span><span class="s1">values</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s0"># __pow__</span>
        <span class="s1">idx </span><span class="s3">= </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1000</span><span class="s3">, </span><span class="s4">2</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">idx</span><span class="s3">**</span><span class="s4">2</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">idx</span><span class="s3">.</span><span class="s1">_values</span><span class="s3">) ** </span><span class="s4">2</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">Index</span><span class="s3">(</span><span class="s1">result</span><span class="s3">.</span><span class="s1">values</span><span class="s3">), </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
        <span class="s5">&quot;idx, div, expected&quot;</span><span class="s3">,</span>
        <span class="s3">[</span>
            <span class="s0"># TODO: add more dtypes</span>
            <span class="s3">(</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1000</span><span class="s3">, </span><span class="s4">2</span><span class="s3">), </span><span class="s4">2</span><span class="s3">, </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">500</span><span class="s3">, </span><span class="s4">1</span><span class="s3">)),</span>
            <span class="s3">(</span><span class="s1">RangeIndex</span><span class="s3">(-</span><span class="s4">99</span><span class="s3">, -</span><span class="s4">201</span><span class="s3">, -</span><span class="s4">3</span><span class="s3">), -</span><span class="s4">3</span><span class="s3">, </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">33</span><span class="s3">, </span><span class="s4">67</span><span class="s3">, </span><span class="s4">1</span><span class="s3">)),</span>
            <span class="s3">(</span>
                <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1000</span><span class="s3">, </span><span class="s4">1</span><span class="s3">),</span>
                <span class="s4">2</span><span class="s3">,</span>
                <span class="s1">Index</span><span class="s3">(</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1000</span><span class="s3">, </span><span class="s4">1</span><span class="s3">).</span><span class="s1">_values</span><span class="s3">) // </span><span class="s4">2</span><span class="s3">,</span>
            <span class="s3">),</span>
            <span class="s3">(</span>
                <span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">100</span><span class="s3">, </span><span class="s4">1</span><span class="s3">),</span>
                <span class="s4">2.0</span><span class="s3">,</span>
                <span class="s1">Index</span><span class="s3">(</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">100</span><span class="s3">, </span><span class="s4">1</span><span class="s3">).</span><span class="s1">_values</span><span class="s3">) // </span><span class="s4">2.0</span><span class="s3">,</span>
            <span class="s3">),</span>
            <span class="s3">(</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">), </span><span class="s4">50</span><span class="s3">, </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)),</span>
            <span class="s3">(</span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">2</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">2</span><span class="s3">), </span><span class="s4">3</span><span class="s3">, </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">)),</span>
            <span class="s3">(</span><span class="s1">RangeIndex</span><span class="s3">(-</span><span class="s4">5</span><span class="s3">, -</span><span class="s4">10</span><span class="s3">, -</span><span class="s4">6</span><span class="s3">), </span><span class="s4">4</span><span class="s3">, </span><span class="s1">RangeIndex</span><span class="s3">(-</span><span class="s4">2</span><span class="s3">, -</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">)),</span>
            <span class="s3">(</span><span class="s1">RangeIndex</span><span class="s3">(-</span><span class="s4">100</span><span class="s3">, -</span><span class="s4">200</span><span class="s3">, </span><span class="s4">3</span><span class="s3">), </span><span class="s4">2</span><span class="s3">, </span><span class="s1">RangeIndex</span><span class="s3">(</span><span class="s4">0</span><span class="s3">)),</span>
        <span class="s3">],</span>
    <span class="s3">)</span>
    <span class="s2">def </span><span class="s1">test_numeric_compat2_floordiv</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">idx</span><span class="s3">, </span><span class="s1">div</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">):</span>
        <span class="s0"># __floordiv__</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">idx </span><span class="s3">// </span><span class="s1">div</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">, </span><span class="s1">exact</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;dtype&quot;</span><span class="s3">, [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;delta&quot;</span><span class="s3">, [</span><span class="s4">1</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, -</span><span class="s4">1</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_addsub_arithmetic</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">, </span><span class="s1">delta</span><span class="s3">):</span>
        <span class="s0"># GH#8142</span>
        <span class="s1">delta </span><span class="s3">= </span><span class="s1">dtype</span><span class="s3">(</span><span class="s1">delta</span><span class="s3">)</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">10</span><span class="s3">, </span><span class="s4">11</span><span class="s3">, </span><span class="s4">12</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">index </span><span class="s3">+ </span><span class="s1">delta</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">index</span><span class="s3">.</span><span class="s1">values </span><span class="s3">+ </span><span class="s1">delta</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s0"># this subtraction used to fail</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">index </span><span class="s3">- </span><span class="s1">delta</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">(</span><span class="s1">index</span><span class="s3">.</span><span class="s1">values </span><span class="s3">- </span><span class="s1">delta</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">dtype</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">index </span><span class="s3">+ </span><span class="s1">index</span><span class="s3">, </span><span class="s4">2 </span><span class="s3">* </span><span class="s1">index</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_index_equal</span><span class="s3">(</span><span class="s1">index </span><span class="s3">- </span><span class="s1">index</span><span class="s3">, </span><span class="s4">0 </span><span class="s3">* </span><span class="s1">index</span><span class="s3">)</span>
        <span class="s2">assert not </span><span class="s3">(</span><span class="s1">index </span><span class="s3">- </span><span class="s1">index</span><span class="s3">).</span><span class="s1">empty</span>

    <span class="s2">def </span><span class="s1">test_pow_nan_with_zero</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">):</span>
        <span class="s1">left </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">])</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">, </span><span class="s4">0</span><span class="s3">])</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">Index</span><span class="s3">([</span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">])</span>

        <span class="s1">left </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">left</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">)</span>
        <span class="s1">right </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">right</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">box_expected</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">, </span><span class="s1">box_with_array</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">left</span><span class="s3">**</span><span class="s1">right</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">test_fill_value_inf_masking</span><span class="s3">():</span>
    <span class="s0"># GH #27464 make sure we mask 0/1 with Inf and not NaN</span>
    <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;A&quot;</span><span class="s3">: [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">], </span><span class="s5">&quot;B&quot;</span><span class="s3">: [</span><span class="s4">1.1</span><span class="s3">, </span><span class="s2">None</span><span class="s3">, </span><span class="s4">1.1</span><span class="s3">]})</span>

    <span class="s1">other </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span><span class="s5">&quot;A&quot;</span><span class="s3">: [</span><span class="s4">1.1</span><span class="s3">, </span><span class="s4">1.2</span><span class="s3">, </span><span class="s4">1.3</span><span class="s3">]}, </span><span class="s1">index</span><span class="s3">=[</span><span class="s4">0</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">])</span>

    <span class="s1">result </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">rfloordiv</span><span class="s3">(</span><span class="s1">other</span><span class="s3">, </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s4">1</span><span class="s3">)</span>

    <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span>
        <span class="s3">{</span><span class="s5">&quot;A&quot;</span><span class="s3">: [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">inf</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">0.0</span><span class="s3">, </span><span class="s4">1.0</span><span class="s3">], </span><span class="s5">&quot;B&quot;</span><span class="s3">: [</span><span class="s4">0.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">0.0</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">]}</span>
    <span class="s3">)</span>
    <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">test_dataframe_div_silenced</span><span class="s3">():</span>
    <span class="s0"># GH#26793</span>
    <span class="s1">pdf1 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span>
        <span class="s3">{</span>
            <span class="s5">&quot;A&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">10</span><span class="s3">),</span>
            <span class="s5">&quot;B&quot;</span><span class="s3">: [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">] * </span><span class="s4">2</span><span class="s3">,</span>
            <span class="s5">&quot;C&quot;</span><span class="s3">: [</span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span><span class="s3">] * </span><span class="s4">10</span><span class="s3">,</span>
            <span class="s5">&quot;D&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s4">10</span><span class="s3">),</span>
        <span class="s3">},</span>
        <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;abcdefghij&quot;</span><span class="s3">),</span>
        <span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s3">),</span>
    <span class="s3">)</span>
    <span class="s1">pdf2 </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span>
        <span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">((</span><span class="s4">10</span><span class="s3">, </span><span class="s4">4</span><span class="s3">)),</span>
        <span class="s1">index</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;abcdefghjk&quot;</span><span class="s3">),</span>
        <span class="s1">columns</span><span class="s3">=</span><span class="s1">list</span><span class="s3">(</span><span class="s5">&quot;ABCX&quot;</span><span class="s3">),</span>
    <span class="s3">)</span>
    <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s2">None</span><span class="s3">):</span>
        <span class="s1">pdf1</span><span class="s3">.</span><span class="s1">div</span><span class="s3">(</span><span class="s1">pdf2</span><span class="s3">, </span><span class="s1">fill_value</span><span class="s3">=</span><span class="s4">0</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span>
    <span class="s5">&quot;data, expected_data&quot;</span><span class="s3">,</span>
    <span class="s3">[([</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">], [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">4</span><span class="s3">])],</span>
<span class="s3">)</span>
<span class="s2">def </span><span class="s1">test_integer_array_add_list_like</span><span class="s3">(</span>
    <span class="s1">box_pandas_1d_array</span><span class="s3">, </span><span class="s1">box_1d_array</span><span class="s3">, </span><span class="s1">data</span><span class="s3">, </span><span class="s1">expected_data</span>
<span class="s3">):</span>
    <span class="s0"># GH22606 Verify operators with IntegerArray and list-likes</span>
    <span class="s1">arr </span><span class="s3">= </span><span class="s1">array</span><span class="s3">(</span><span class="s1">data</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;Int64&quot;</span><span class="s3">)</span>
    <span class="s1">container </span><span class="s3">= </span><span class="s1">box_pandas_1d_array</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">)</span>
    <span class="s1">left </span><span class="s3">= </span><span class="s1">container </span><span class="s3">+ </span><span class="s1">box_1d_array</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
    <span class="s1">right </span><span class="s3">= </span><span class="s1">box_1d_array</span><span class="s3">(</span><span class="s1">data</span><span class="s3">) + </span><span class="s1">container</span>

    <span class="s2">if </span><span class="s1">Series </span><span class="s2">in </span><span class="s3">[</span><span class="s1">box_1d_array</span><span class="s3">, </span><span class="s1">box_pandas_1d_array</span><span class="s3">]:</span>
        <span class="s1">cls </span><span class="s3">= </span><span class="s1">Series</span>
    <span class="s2">elif </span><span class="s1">Index </span><span class="s2">in </span><span class="s3">[</span><span class="s1">box_1d_array</span><span class="s3">, </span><span class="s1">box_pandas_1d_array</span><span class="s3">]:</span>
        <span class="s1">cls </span><span class="s3">= </span><span class="s1">Index</span>
    <span class="s2">else</span><span class="s3">:</span>
        <span class="s1">cls </span><span class="s3">= </span><span class="s1">array</span>

    <span class="s1">expected </span><span class="s3">= </span><span class="s1">cls</span><span class="s3">(</span><span class="s1">expected_data</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;Int64&quot;</span><span class="s3">)</span>

    <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">left</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
    <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_equal</span><span class="s3">(</span><span class="s1">right</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">test_sub_multiindex_swapped_levels</span><span class="s3">():</span>
    <span class="s0"># GH 9952</span>
    <span class="s1">df </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span>
        <span class="s3">{</span><span class="s5">&quot;a&quot;</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">random</span><span class="s3">.</span><span class="s1">default_rng</span><span class="s3">(</span><span class="s4">2</span><span class="s3">).</span><span class="s1">standard_normal</span><span class="s3">(</span><span class="s4">6</span><span class="s3">)},</span>
        <span class="s1">index</span><span class="s3">=</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">MultiIndex</span><span class="s3">.</span><span class="s1">from_product</span><span class="s3">(</span>
            <span class="s3">[[</span><span class="s5">&quot;a&quot;</span><span class="s3">, </span><span class="s5">&quot;b&quot;</span><span class="s3">], [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">]], </span><span class="s1">names</span><span class="s3">=[</span><span class="s5">&quot;levA&quot;</span><span class="s3">, </span><span class="s5">&quot;levB&quot;</span><span class="s3">]</span>
        <span class="s3">),</span>
    <span class="s3">)</span>
    <span class="s1">df2 </span><span class="s3">= </span><span class="s1">df</span><span class="s3">.</span><span class="s1">copy</span><span class="s3">()</span>
    <span class="s1">df2</span><span class="s3">.</span><span class="s1">index </span><span class="s3">= </span><span class="s1">df2</span><span class="s3">.</span><span class="s1">index</span><span class="s3">.</span><span class="s1">swaplevel</span><span class="s3">(</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">)</span>
    <span class="s1">result </span><span class="s3">= </span><span class="s1">df </span><span class="s3">- </span><span class="s1">df2</span>
    <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">([</span><span class="s4">0.0</span><span class="s3">] * </span><span class="s4">6</span><span class="s3">, </span><span class="s1">columns</span><span class="s3">=[</span><span class="s5">&quot;a&quot;</span><span class="s3">], </span><span class="s1">index</span><span class="s3">=</span><span class="s1">df</span><span class="s3">.</span><span class="s1">index</span><span class="s3">)</span>
    <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;power&quot;</span><span class="s3">, [</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">5</span><span class="s3">])</span>
<span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s5">&quot;string_size&quot;</span><span class="s3">, [</span><span class="s4">0</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">5</span><span class="s3">])</span>
<span class="s2">def </span><span class="s1">test_empty_str_comparison</span><span class="s3">(</span><span class="s1">power</span><span class="s3">, </span><span class="s1">string_size</span><span class="s3">):</span>
    <span class="s0"># GH 37348</span>
    <span class="s1">a </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s4">10</span><span class="s3">**</span><span class="s1">power</span><span class="s3">))</span>
    <span class="s1">right </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">a</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">int64</span><span class="s3">)</span>
    <span class="s1">left </span><span class="s3">= </span><span class="s5">&quot; &quot; </span><span class="s3">* </span><span class="s1">string_size</span>

    <span class="s1">result </span><span class="s3">= </span><span class="s1">right </span><span class="s3">== </span><span class="s1">left</span>
    <span class="s1">expected </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">zeros</span><span class="s3">(</span><span class="s1">right</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">bool</span><span class="s3">))</span>
    <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_frame_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">test_series_add_sub_with_UInt64</span><span class="s3">():</span>
    <span class="s0"># GH 22023</span>
    <span class="s1">series1 </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">])</span>
    <span class="s1">series2 </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;UInt64&quot;</span><span class="s3">)</span>

    <span class="s1">result </span><span class="s3">= </span><span class="s1">series1 </span><span class="s3">+ </span><span class="s1">series2</span>
    <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s4">3</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">6</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;Float64&quot;</span><span class="s3">)</span>
    <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s1">result </span><span class="s3">= </span><span class="s1">series1 </span><span class="s3">- </span><span class="s1">series2</span>
    <span class="s1">expected </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([-</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">0</span><span class="s3">], </span><span class="s1">dtype</span><span class="s3">=</span><span class="s5">&quot;Float64&quot;</span><span class="s3">)</span>
    <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_series_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
</pre>
</body>
</html>