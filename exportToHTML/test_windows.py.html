<html>
<head>
<title>test_windows.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #5f826b; font-style: italic;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_windows.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">array</span>
<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">testing </span><span class="s0">import </span><span class="s2">(</span><span class="s1">assert_array_almost_equal</span><span class="s2">, </span><span class="s1">assert_array_equal</span><span class="s2">,</span>
                           <span class="s1">assert_allclose</span><span class="s2">,</span>
                           <span class="s1">assert_equal</span><span class="s2">, </span><span class="s1">assert_</span><span class="s2">, </span><span class="s1">assert_array_less</span><span class="s2">,</span>
                           <span class="s1">suppress_warnings</span><span class="s2">)</span>
<span class="s0">from </span><span class="s1">pytest </span><span class="s0">import </span><span class="s1">raises </span><span class="s0">as </span><span class="s1">assert_raises</span>

<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">fft </span><span class="s0">import </span><span class="s1">fft</span>
<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">signal </span><span class="s0">import </span><span class="s1">windows</span><span class="s2">, </span><span class="s1">get_window</span><span class="s2">, </span><span class="s1">resample</span>


<span class="s1">window_funcs </span><span class="s2">= [</span>
    <span class="s2">(</span><span class="s3">'boxcar'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'triang'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'parzen'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'bohman'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'blackman'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'nuttall'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'blackmanharris'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'flattop'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'bartlett'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'barthann'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'hamming'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'kaiser'</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">,)),</span>
    <span class="s2">(</span><span class="s3">'dpss'</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">,)),</span>
    <span class="s2">(</span><span class="s3">'gaussian'</span><span class="s2">, (</span><span class="s4">0.5</span><span class="s2">,)),</span>
    <span class="s2">(</span><span class="s3">'general_gaussian'</span><span class="s2">, (</span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)),</span>
    <span class="s2">(</span><span class="s3">'chebwin'</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">,)),</span>
    <span class="s2">(</span><span class="s3">'cosine'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'hann'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'exponential'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'taylor'</span><span class="s2">, ()),</span>
    <span class="s2">(</span><span class="s3">'tukey'</span><span class="s2">, (</span><span class="s4">0.5</span><span class="s2">,)),</span>
    <span class="s2">(</span><span class="s3">'lanczos'</span><span class="s2">, ()),</span>
    <span class="s2">]</span>


<span class="s0">class </span><span class="s1">TestBartHann</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">barthann</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.35857354213752</span><span class="s2">, </span><span class="s4">0.8794264578624801</span><span class="s2">,</span>
                         <span class="s4">0.8794264578624801</span><span class="s2">, </span><span class="s4">0.3585735421375199</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                        <span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">barthann</span><span class="s2">(</span><span class="s4">7</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.27</span><span class="s2">, </span><span class="s4">0.73</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.73</span><span class="s2">, </span><span class="s4">0.27</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                        <span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">barthann</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.27</span><span class="s2">, </span><span class="s4">0.73</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.73</span><span class="s2">, </span><span class="s4">0.27</span><span class="s2">],</span>
                        <span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestBartlett</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">bartlett</span><span class="s2">(</span><span class="s4">6</span><span class="s2">), [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.8</span><span class="s2">, </span><span class="s4">0.8</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">bartlett</span><span class="s2">(</span><span class="s4">7</span><span class="s2">), [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">bartlett</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">/</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">3</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestBlackman</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">blackman</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.13</span><span class="s2">, </span><span class="s4">0.63</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.63</span><span class="s2">, </span><span class="s4">0.13</span><span class="s2">], </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-14</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">blackman</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.09045342435412804</span><span class="s2">, </span><span class="s4">0.4591829575459636</span><span class="s2">,</span>
                         <span class="s4">0.9203636180999081</span><span class="s2">, </span><span class="s4">0.9203636180999081</span><span class="s2">,</span>
                         <span class="s4">0.4591829575459636</span><span class="s2">, </span><span class="s4">0.09045342435412804</span><span class="s2">], </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-8</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">blackman</span><span class="s2">(</span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.2007701432625305</span><span class="s2">, </span><span class="s4">0.8492298567374694</span><span class="s2">,</span>
                         <span class="s4">0.8492298567374694</span><span class="s2">, </span><span class="s4">0.2007701432625305</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                        <span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-14</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">blackman</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.13</span><span class="s2">, </span><span class="s4">0.63</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.63</span><span class="s2">, </span><span class="s4">0.13</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-14</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestBlackmanHarris</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">blackmanharris</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">6.0e-05</span><span class="s2">, </span><span class="s4">0.055645</span><span class="s2">, </span><span class="s4">0.520575</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.520575</span><span class="s2">, </span><span class="s4">0.055645</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">blackmanharris</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">6.0e-05</span><span class="s2">, </span><span class="s4">0.03339172347815117</span><span class="s2">, </span><span class="s4">0.332833504298565</span><span class="s2">,</span>
                         <span class="s4">0.8893697722232837</span><span class="s2">, </span><span class="s4">0.8893697722232838</span><span class="s2">,</span>
                         <span class="s4">0.3328335042985652</span><span class="s2">, </span><span class="s4">0.03339172347815122</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">blackmanharris</span><span class="s2">(</span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">6.0e-05</span><span class="s2">, </span><span class="s4">0.1030114893456638</span><span class="s2">, </span><span class="s4">0.7938335106543362</span><span class="s2">,</span>
                         <span class="s4">0.7938335106543364</span><span class="s2">, </span><span class="s4">0.1030114893456638</span><span class="s2">, </span><span class="s4">6.0e-05</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">blackmanharris</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">6.0e-05</span><span class="s2">, </span><span class="s4">0.055645</span><span class="s2">, </span><span class="s4">0.520575</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.520575</span><span class="s2">, </span><span class="s4">0.055645</span><span class="s2">,</span>
                         <span class="s4">6.0e-05</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestTaylor</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_normalized</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5">&quot;&quot;&quot;Tests windows of small length that are normalized to 1. See the 
        documentation for the Taylor window for more information on 
        normalization. 
        &quot;&quot;&quot;</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">taylor</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">15</span><span class="s2">), </span><span class="s4">1.0</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span>
            <span class="s1">windows</span><span class="s2">.</span><span class="s1">taylor</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">15</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.75803341</span><span class="s2">, </span><span class="s4">0.90757699</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.90757699</span><span class="s2">, </span><span class="s4">0.75803341</span><span class="s2">])</span>
        <span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span>
            <span class="s1">windows</span><span class="s2">.</span><span class="s1">taylor</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">15</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
                <span class="s4">0.7504082</span><span class="s2">, </span><span class="s4">0.86624416</span><span class="s2">, </span><span class="s4">0.98208011</span><span class="s2">, </span><span class="s4">0.98208011</span><span class="s2">, </span><span class="s4">0.86624416</span><span class="s2">,</span>
                <span class="s4">0.7504082</span>
            <span class="s2">])</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_non_normalized</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5">&quot;&quot;&quot;Test windows of small length that are not normalized to 1. See 
        the documentation for the Taylor window for more information on 
        normalization. 
        &quot;&quot;&quot;</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span>
            <span class="s1">windows</span><span class="s2">.</span><span class="s1">taylor</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s1">norm</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
                <span class="s4">0.87508054</span><span class="s2">, </span><span class="s4">1.04771499</span><span class="s2">, </span><span class="s4">1.15440894</span><span class="s2">, </span><span class="s4">1.04771499</span><span class="s2">, </span><span class="s4">0.87508054</span>
            <span class="s2">])</span>
        <span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span>
            <span class="s1">windows</span><span class="s2">.</span><span class="s1">taylor</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s1">norm</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
                <span class="s4">0.86627793</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.13372207</span><span class="s2">, </span><span class="s4">1.13372207</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.86627793</span>
            <span class="s2">])</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_correctness</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5">&quot;&quot;&quot;This test ensures the correctness of the implemented Taylor 
        Windowing function. A Taylor Window of 1024 points is created, its FFT 
        is taken, and the Peak Sidelobe Level (PSLL) and 3dB and 18dB bandwidth 
        are found and checked. 
 
        A publication from Sandia National Laboratories was used as reference 
        for the correctness values [1]_. 
 
        References 
        ----- 
        .. [1] Armin Doerry, &quot;Catalog of Window Taper Functions for 
               Sidelobe Control&quot;, 2017. 
               https://www.researchgate.net/profile/Armin_Doerry/publication/316281181_Catalog_of_Window_Taper_Functions_for_Sidelobe_Control/links/58f92cb2a6fdccb121c9d54d/Catalog-of-Window-Taper-Functions-for-Sidelobe-Control.pdf 
        &quot;&quot;&quot;</span>
        <span class="s1">M_win </span><span class="s2">= </span><span class="s4">1024</span>
        <span class="s1">N_fft </span><span class="s2">= </span><span class="s4">131072</span>
        <span class="s6"># Set norm=False for correctness as the values obtained from the</span>
        <span class="s6"># scientific publication do not normalize the values. Normalizing</span>
        <span class="s6"># changes the sidelobe level from the desired value.</span>
        <span class="s1">w </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">taylor</span><span class="s2">(</span><span class="s1">M_win</span><span class="s2">, </span><span class="s1">nbar</span><span class="s2">=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">sll</span><span class="s2">=</span><span class="s4">35</span><span class="s2">, </span><span class="s1">norm</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">f </span><span class="s2">= </span><span class="s1">fft</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">N_fft</span><span class="s2">)</span>
        <span class="s1">spec </span><span class="s2">= </span><span class="s4">20 </span><span class="s2">* </span><span class="s1">np</span><span class="s2">.</span><span class="s1">log10</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">abs</span><span class="s2">(</span><span class="s1">f </span><span class="s2">/ </span><span class="s1">np</span><span class="s2">.</span><span class="s1">amax</span><span class="s2">(</span><span class="s1">f</span><span class="s2">)))</span>

        <span class="s1">first_zero </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">argmax</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">diff</span><span class="s2">(</span><span class="s1">spec</span><span class="s2">) &gt; </span><span class="s4">0</span><span class="s2">)</span>

        <span class="s1">PSLL </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">amax</span><span class="s2">(</span><span class="s1">spec</span><span class="s2">[</span><span class="s1">first_zero</span><span class="s2">:-</span><span class="s1">first_zero</span><span class="s2">])</span>

        <span class="s1">BW_3dB </span><span class="s2">= </span><span class="s4">2</span><span class="s2">*</span><span class="s1">np</span><span class="s2">.</span><span class="s1">argmax</span><span class="s2">(</span><span class="s1">spec </span><span class="s2">&lt;= -</span><span class="s4">3.0102999566398121</span><span class="s2">) / </span><span class="s1">N_fft </span><span class="s2">* </span><span class="s1">M_win</span>
        <span class="s1">BW_18dB </span><span class="s2">= </span><span class="s4">2</span><span class="s2">*</span><span class="s1">np</span><span class="s2">.</span><span class="s1">argmax</span><span class="s2">(</span><span class="s1">spec </span><span class="s2">&lt;= -</span><span class="s4">18.061799739838872</span><span class="s2">) / </span><span class="s1">N_fft </span><span class="s2">* </span><span class="s1">M_win</span>

        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">PSLL</span><span class="s2">, -</span><span class="s4">35.1672</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">BW_3dB</span><span class="s2">, </span><span class="s4">1.1822</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">0.1</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">BW_18dB</span><span class="s2">, </span><span class="s4">2.6112</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">0.1</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestBohman</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">bohman</span><span class="s2">(</span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.1791238937062839</span><span class="s2">, </span><span class="s4">0.8343114522576858</span><span class="s2">,</span>
                         <span class="s4">0.8343114522576858</span><span class="s2">, </span><span class="s4">0.1791238937062838</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">bohman</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.1089977810442293</span><span class="s2">, </span><span class="s4">0.6089977810442293</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">,</span>
                         <span class="s4">0.6089977810442295</span><span class="s2">, </span><span class="s4">0.1089977810442293</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">bohman</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.1089977810442293</span><span class="s2">, </span><span class="s4">0.6089977810442293</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">,</span>
                         <span class="s4">0.6089977810442295</span><span class="s2">, </span><span class="s4">0.1089977810442293</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestBoxcar</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">boxcar</span><span class="s2">(</span><span class="s4">6</span><span class="s2">), [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">boxcar</span><span class="s2">(</span><span class="s4">7</span><span class="s2">), [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">boxcar</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">False</span><span class="s2">), [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>


<span class="s1">cheb_odd_true </span><span class="s2">= </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.200938</span><span class="s2">, </span><span class="s4">0.107729</span><span class="s2">, </span><span class="s4">0.134941</span><span class="s2">, </span><span class="s4">0.165348</span><span class="s2">,</span>
                       <span class="s4">0.198891</span><span class="s2">, </span><span class="s4">0.235450</span><span class="s2">, </span><span class="s4">0.274846</span><span class="s2">, </span><span class="s4">0.316836</span><span class="s2">,</span>
                       <span class="s4">0.361119</span><span class="s2">, </span><span class="s4">0.407338</span><span class="s2">, </span><span class="s4">0.455079</span><span class="s2">, </span><span class="s4">0.503883</span><span class="s2">,</span>
                       <span class="s4">0.553248</span><span class="s2">, </span><span class="s4">0.602637</span><span class="s2">, </span><span class="s4">0.651489</span><span class="s2">, </span><span class="s4">0.699227</span><span class="s2">,</span>
                       <span class="s4">0.745266</span><span class="s2">, </span><span class="s4">0.789028</span><span class="s2">, </span><span class="s4">0.829947</span><span class="s2">, </span><span class="s4">0.867485</span><span class="s2">,</span>
                       <span class="s4">0.901138</span><span class="s2">, </span><span class="s4">0.930448</span><span class="s2">, </span><span class="s4">0.955010</span><span class="s2">, </span><span class="s4">0.974482</span><span class="s2">,</span>
                       <span class="s4">0.988591</span><span class="s2">, </span><span class="s4">0.997138</span><span class="s2">, </span><span class="s4">1.000000</span><span class="s2">, </span><span class="s4">0.997138</span><span class="s2">,</span>
                       <span class="s4">0.988591</span><span class="s2">, </span><span class="s4">0.974482</span><span class="s2">, </span><span class="s4">0.955010</span><span class="s2">, </span><span class="s4">0.930448</span><span class="s2">,</span>
                       <span class="s4">0.901138</span><span class="s2">, </span><span class="s4">0.867485</span><span class="s2">, </span><span class="s4">0.829947</span><span class="s2">, </span><span class="s4">0.789028</span><span class="s2">,</span>
                       <span class="s4">0.745266</span><span class="s2">, </span><span class="s4">0.699227</span><span class="s2">, </span><span class="s4">0.651489</span><span class="s2">, </span><span class="s4">0.602637</span><span class="s2">,</span>
                       <span class="s4">0.553248</span><span class="s2">, </span><span class="s4">0.503883</span><span class="s2">, </span><span class="s4">0.455079</span><span class="s2">, </span><span class="s4">0.407338</span><span class="s2">,</span>
                       <span class="s4">0.361119</span><span class="s2">, </span><span class="s4">0.316836</span><span class="s2">, </span><span class="s4">0.274846</span><span class="s2">, </span><span class="s4">0.235450</span><span class="s2">,</span>
                       <span class="s4">0.198891</span><span class="s2">, </span><span class="s4">0.165348</span><span class="s2">, </span><span class="s4">0.134941</span><span class="s2">, </span><span class="s4">0.107729</span><span class="s2">,</span>
                       <span class="s4">0.200938</span><span class="s2">])</span>

<span class="s1">cheb_even_true </span><span class="s2">= </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.203894</span><span class="s2">, </span><span class="s4">0.107279</span><span class="s2">, </span><span class="s4">0.133904</span><span class="s2">,</span>
                        <span class="s4">0.163608</span><span class="s2">, </span><span class="s4">0.196338</span><span class="s2">, </span><span class="s4">0.231986</span><span class="s2">,</span>
                        <span class="s4">0.270385</span><span class="s2">, </span><span class="s4">0.311313</span><span class="s2">, </span><span class="s4">0.354493</span><span class="s2">,</span>
                        <span class="s4">0.399594</span><span class="s2">, </span><span class="s4">0.446233</span><span class="s2">, </span><span class="s4">0.493983</span><span class="s2">,</span>
                        <span class="s4">0.542378</span><span class="s2">, </span><span class="s4">0.590916</span><span class="s2">, </span><span class="s4">0.639071</span><span class="s2">,</span>
                        <span class="s4">0.686302</span><span class="s2">, </span><span class="s4">0.732055</span><span class="s2">, </span><span class="s4">0.775783</span><span class="s2">,</span>
                        <span class="s4">0.816944</span><span class="s2">, </span><span class="s4">0.855021</span><span class="s2">, </span><span class="s4">0.889525</span><span class="s2">,</span>
                        <span class="s4">0.920006</span><span class="s2">, </span><span class="s4">0.946060</span><span class="s2">, </span><span class="s4">0.967339</span><span class="s2">,</span>
                        <span class="s4">0.983557</span><span class="s2">, </span><span class="s4">0.994494</span><span class="s2">, </span><span class="s4">1.000000</span><span class="s2">,</span>
                        <span class="s4">1.000000</span><span class="s2">, </span><span class="s4">0.994494</span><span class="s2">, </span><span class="s4">0.983557</span><span class="s2">,</span>
                        <span class="s4">0.967339</span><span class="s2">, </span><span class="s4">0.946060</span><span class="s2">, </span><span class="s4">0.920006</span><span class="s2">,</span>
                        <span class="s4">0.889525</span><span class="s2">, </span><span class="s4">0.855021</span><span class="s2">, </span><span class="s4">0.816944</span><span class="s2">,</span>
                        <span class="s4">0.775783</span><span class="s2">, </span><span class="s4">0.732055</span><span class="s2">, </span><span class="s4">0.686302</span><span class="s2">,</span>
                        <span class="s4">0.639071</span><span class="s2">, </span><span class="s4">0.590916</span><span class="s2">, </span><span class="s4">0.542378</span><span class="s2">,</span>
                        <span class="s4">0.493983</span><span class="s2">, </span><span class="s4">0.446233</span><span class="s2">, </span><span class="s4">0.399594</span><span class="s2">,</span>
                        <span class="s4">0.354493</span><span class="s2">, </span><span class="s4">0.311313</span><span class="s2">, </span><span class="s4">0.270385</span><span class="s2">,</span>
                        <span class="s4">0.231986</span><span class="s2">, </span><span class="s4">0.196338</span><span class="s2">, </span><span class="s4">0.163608</span><span class="s2">,</span>
                        <span class="s4">0.133904</span><span class="s2">, </span><span class="s4">0.107279</span><span class="s2">, </span><span class="s4">0.203894</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestChebWin</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s3">&quot;This window is not suitable&quot;</span><span class="s2">)</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">100</span><span class="s2">),</span>
                            <span class="s2">[</span><span class="s4">0.1046401879356917</span><span class="s2">, </span><span class="s4">0.5075781475823447</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">,</span>
                             <span class="s4">0.5075781475823447</span><span class="s2">, </span><span class="s4">0.1046401879356917</span><span class="s2">])</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">100</span><span class="s2">),</span>
                            <span class="s2">[</span><span class="s4">0.05650405062850233</span><span class="s2">, </span><span class="s4">0.316608530648474</span><span class="s2">,</span>
                             <span class="s4">0.7601208123539079</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.7601208123539079</span><span class="s2">,</span>
                             <span class="s4">0.316608530648474</span><span class="s2">, </span><span class="s4">0.05650405062850233</span><span class="s2">])</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">10</span><span class="s2">),</span>
                            <span class="s2">[</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.6071201674458373</span><span class="s2">, </span><span class="s4">0.6808391469897297</span><span class="s2">,</span>
                             <span class="s4">0.6808391469897297</span><span class="s2">, </span><span class="s4">0.6071201674458373</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">])</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">10</span><span class="s2">),</span>
                            <span class="s2">[</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.5190521247588651</span><span class="s2">, </span><span class="s4">0.5864059018130382</span><span class="s2">,</span>
                             <span class="s4">0.6101519801307441</span><span class="s2">, </span><span class="s4">0.5864059018130382</span><span class="s2">,</span>
                             <span class="s4">0.5190521247588651</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">])</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                            <span class="s2">[</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.5190521247588651</span><span class="s2">, </span><span class="s4">0.5864059018130382</span><span class="s2">,</span>
                             <span class="s4">0.6101519801307441</span><span class="s2">, </span><span class="s4">0.5864059018130382</span><span class="s2">,</span>
                             <span class="s4">0.5190521247588651</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_cheb_odd_high_attenuation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s3">&quot;This window is not suitable&quot;</span><span class="s2">)</span>
            <span class="s1">cheb_odd </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">53</span><span class="s2">, </span><span class="s1">at</span><span class="s2">=-</span><span class="s4">40</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">cheb_odd</span><span class="s2">, </span><span class="s1">cheb_odd_true</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_cheb_even_high_attenuation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s3">&quot;This window is not suitable&quot;</span><span class="s2">)</span>
            <span class="s1">cheb_even </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">54</span><span class="s2">, </span><span class="s1">at</span><span class="s2">=</span><span class="s4">40</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">cheb_even</span><span class="s2">, </span><span class="s1">cheb_even_true</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_cheb_odd_low_attenuation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">cheb_odd_low_at_true </span><span class="s2">= </span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.000000</span><span class="s2">, </span><span class="s4">0.519052</span><span class="s2">, </span><span class="s4">0.586405</span><span class="s2">,</span>
                                      <span class="s4">0.610151</span><span class="s2">, </span><span class="s4">0.586405</span><span class="s2">, </span><span class="s4">0.519052</span><span class="s2">,</span>
                                      <span class="s4">1.000000</span><span class="s2">])</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s3">&quot;This window is not suitable&quot;</span><span class="s2">)</span>
            <span class="s1">cheb_odd </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">at</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">cheb_odd</span><span class="s2">, </span><span class="s1">cheb_odd_low_at_true</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_cheb_even_low_attenuation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">cheb_even_low_at_true </span><span class="s2">= </span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.000000</span><span class="s2">, </span><span class="s4">0.451924</span><span class="s2">, </span><span class="s4">0.51027</span><span class="s2">,</span>
                                       <span class="s4">0.541338</span><span class="s2">, </span><span class="s4">0.541338</span><span class="s2">, </span><span class="s4">0.51027</span><span class="s2">,</span>
                                       <span class="s4">0.451924</span><span class="s2">, </span><span class="s4">1.000000</span><span class="s2">])</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s3">&quot;This window is not suitable&quot;</span><span class="s2">)</span>
            <span class="s1">cheb_even </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">chebwin</span><span class="s2">(</span><span class="s4">8</span><span class="s2">, </span><span class="s1">at</span><span class="s2">=-</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">cheb_even</span><span class="s2">, </span><span class="s1">cheb_even_low_at_true</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>


<span class="s1">exponential_data </span><span class="s2">= {</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s0">False</span><span class="s2">):</span>
        <span class="s1">array</span><span class="s2">([</span><span class="s4">4.53999297624848542e-05</span><span class="s2">,</span>
               <span class="s4">6.73794699908546700e-03</span><span class="s2">, </span><span class="s4">1.00000000000000000e+00</span><span class="s2">,</span>
               <span class="s4">6.73794699908546700e-03</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.00055308437014783</span><span class="s2">, </span><span class="s4">0.0820849986238988</span><span class="s2">,</span>
                                 <span class="s4">0.0820849986238988</span><span class="s2">, </span><span class="s4">0.00055308437014783</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">False</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.1353352832366127</span><span class="s2">, </span><span class="s4">0.36787944117144233</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">,</span>
                                  <span class="s4">0.36787944117144233</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.22313016014842982</span><span class="s2">, </span><span class="s4">0.60653065971263342</span><span class="s2">,</span>
                                 <span class="s4">0.60653065971263342</span><span class="s2">, </span><span class="s4">0.22313016014842982</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s0">False</span><span class="s2">):</span>
        <span class="s1">array</span><span class="s2">([</span><span class="s4">4.53999297624848542e-05</span><span class="s2">, </span><span class="s4">6.73794699908546700e-03</span><span class="s2">,</span>
               <span class="s4">1.00000000000000000e+00</span><span class="s2">, </span><span class="s4">6.73794699908546700e-03</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s0">None</span><span class="s2">,</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">False</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.1353352832366127</span><span class="s2">, </span><span class="s4">0.36787944117144233</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">,</span>
                               <span class="s4">0.36787944117144233</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s0">None</span><span class="s2">,</span>
    <span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s0">True</span><span class="s2">):</span>
        <span class="s1">array</span><span class="s2">([</span><span class="s4">4.53999297624848542e-05</span><span class="s2">,</span>
               <span class="s4">6.73794699908546700e-03</span><span class="s2">, </span><span class="s4">1.00000000000000000e+00</span><span class="s2">,</span>
               <span class="s4">6.73794699908546700e-03</span><span class="s2">, </span><span class="s4">4.53999297624848542e-05</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.1353352832366127</span><span class="s2">, </span><span class="s4">0.36787944117144233</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">,</span>
                                 <span class="s4">0.36787944117144233</span><span class="s2">, </span><span class="s4">0.1353352832366127</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s0">None</span><span class="s2">,</span>
    <span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s0">None</span>
<span class="s2">}</span>


<span class="s0">def </span><span class="s1">test_exponential</span><span class="s2">():</span>
    <span class="s0">for </span><span class="s1">k</span><span class="s2">, </span><span class="s1">v </span><span class="s0">in </span><span class="s1">exponential_data</span><span class="s2">.</span><span class="s1">items</span><span class="s2">():</span>
        <span class="s0">if </span><span class="s1">v </span><span class="s0">is None</span><span class="s2">:</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">, *</span><span class="s1">k</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">win </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(*</span><span class="s1">k</span><span class="s2">)</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">win</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-14</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestFlatTop</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">flattop</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[-</span><span class="s4">0.000421051</span><span class="s2">, -</span><span class="s4">0.051263156</span><span class="s2">, </span><span class="s4">0.19821053</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">,</span>
                         <span class="s4">0.19821053</span><span class="s2">, -</span><span class="s4">0.051263156</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">flattop</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[-</span><span class="s4">0.000421051</span><span class="s2">, -</span><span class="s4">0.03684078115492348</span><span class="s2">,</span>
                         <span class="s4">0.01070371671615342</span><span class="s2">, </span><span class="s4">0.7808739149387698</span><span class="s2">,</span>
                         <span class="s4">0.7808739149387698</span><span class="s2">, </span><span class="s4">0.01070371671615342</span><span class="s2">,</span>
                         <span class="s2">-</span><span class="s4">0.03684078115492348</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">flattop</span><span class="s2">(</span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[-</span><span class="s4">0.000421051</span><span class="s2">, -</span><span class="s4">0.0677142520762119</span><span class="s2">, </span><span class="s4">0.6068721525762117</span><span class="s2">,</span>
                         <span class="s4">0.6068721525762117</span><span class="s2">, -</span><span class="s4">0.0677142520762119</span><span class="s2">,</span>
                         <span class="s2">-</span><span class="s4">0.000421051</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">flattop</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[-</span><span class="s4">0.000421051</span><span class="s2">, -</span><span class="s4">0.051263156</span><span class="s2">, </span><span class="s4">0.19821053</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">,</span>
                         <span class="s4">0.19821053</span><span class="s2">, -</span><span class="s4">0.051263156</span><span class="s2">, -</span><span class="s4">0.000421051</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestGaussian</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">gaussian</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.04393693362340742</span><span class="s2">, </span><span class="s4">0.3246524673583497</span><span class="s2">,</span>
                         <span class="s4">0.8824969025845955</span><span class="s2">, </span><span class="s4">0.8824969025845955</span><span class="s2">,</span>
                         <span class="s4">0.3246524673583497</span><span class="s2">, </span><span class="s4">0.04393693362340742</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">gaussian</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">1.2</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.04393693362340742</span><span class="s2">, </span><span class="s4">0.2493522087772962</span><span class="s2">,</span>
                         <span class="s4">0.7066482778577162</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.7066482778577162</span><span class="s2">,</span>
                         <span class="s4">0.2493522087772962</span><span class="s2">, </span><span class="s4">0.04393693362340742</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">gaussian</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">3</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.6065306597126334</span><span class="s2">, </span><span class="s4">0.8007374029168081</span><span class="s2">,</span>
                         <span class="s4">0.9459594689067654</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.9459594689067654</span><span class="s2">,</span>
                         <span class="s4">0.8007374029168081</span><span class="s2">, </span><span class="s4">0.6065306597126334</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">gaussian</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.6065306597126334</span><span class="s2">, </span><span class="s4">0.8007374029168081</span><span class="s2">,</span>
                         <span class="s4">0.9459594689067654</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.9459594689067654</span><span class="s2">,</span>
                         <span class="s4">0.8007374029168081</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestGeneralCosine</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">general_cosine</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, [</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">]),</span>
                        <span class="s2">[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">general_cosine</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, [</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">], </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestGeneralHamming</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">general_hamming</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">general_hamming</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.6727457514</span><span class="s2">, </span><span class="s4">0.9522542486</span><span class="s2">,</span>
                         <span class="s4">0.9522542486</span><span class="s2">, </span><span class="s4">0.6727457514</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">general_hamming</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.6727457514</span><span class="s2">, </span><span class="s4">0.9522542486</span><span class="s2">,</span>
                        <span class="s4">0.9522542486</span><span class="s2">, </span><span class="s4">0.6727457514</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestHamming</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hamming</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.08</span><span class="s2">, </span><span class="s4">0.31</span><span class="s2">, </span><span class="s4">0.77</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.77</span><span class="s2">, </span><span class="s4">0.31</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hamming</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.08</span><span class="s2">, </span><span class="s4">0.2531946911449826</span><span class="s2">, </span><span class="s4">0.6423596296199047</span><span class="s2">,</span>
                         <span class="s4">0.9544456792351128</span><span class="s2">, </span><span class="s4">0.9544456792351128</span><span class="s2">,</span>
                         <span class="s4">0.6423596296199047</span><span class="s2">, </span><span class="s4">0.2531946911449826</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hamming</span><span class="s2">(</span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.08</span><span class="s2">, </span><span class="s4">0.3978521825875242</span><span class="s2">, </span><span class="s4">0.9121478174124757</span><span class="s2">,</span>
                         <span class="s4">0.9121478174124757</span><span class="s2">, </span><span class="s4">0.3978521825875242</span><span class="s2">, </span><span class="s4">0.08</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hamming</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.08</span><span class="s2">, </span><span class="s4">0.31</span><span class="s2">, </span><span class="s4">0.77</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.77</span><span class="s2">, </span><span class="s4">0.31</span><span class="s2">, </span><span class="s4">0.08</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestHann</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hann</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">],</span>
                        <span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hann</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.1882550990706332</span><span class="s2">, </span><span class="s4">0.6112604669781572</span><span class="s2">,</span>
                         <span class="s4">0.9504844339512095</span><span class="s2">, </span><span class="s4">0.9504844339512095</span><span class="s2">,</span>
                         <span class="s4">0.6112604669781572</span><span class="s2">, </span><span class="s4">0.1882550990706332</span><span class="s2">],</span>
                        <span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hann</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.3454915028125263</span><span class="s2">, </span><span class="s4">0.9045084971874737</span><span class="s2">,</span>
                         <span class="s4">0.9045084971874737</span><span class="s2">, </span><span class="s4">0.3454915028125263</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                        <span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hann</span><span class="s2">(</span><span class="s4">7</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                        <span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestKaiser</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.9403061933191572</span><span class="s2">, </span><span class="s4">0.9782962393705389</span><span class="s2">,</span>
                         <span class="s4">0.9975765035372042</span><span class="s2">, </span><span class="s4">0.9975765035372042</span><span class="s2">,</span>
                         <span class="s4">0.9782962393705389</span><span class="s2">, </span><span class="s4">0.9403061933191572</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.9403061933191572</span><span class="s2">, </span><span class="s4">0.9732402256999829</span><span class="s2">,</span>
                         <span class="s4">0.9932754654413773</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.9932754654413773</span><span class="s2">,</span>
                         <span class="s4">0.9732402256999829</span><span class="s2">, </span><span class="s4">0.9403061933191572</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">2.7</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.2603047507678832</span><span class="s2">, </span><span class="s4">0.6648106293528054</span><span class="s2">,</span>
                         <span class="s4">0.9582099802511439</span><span class="s2">, </span><span class="s4">0.9582099802511439</span><span class="s2">,</span>
                         <span class="s4">0.6648106293528054</span><span class="s2">, </span><span class="s4">0.2603047507678832</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">2.7</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.2603047507678832</span><span class="s2">, </span><span class="s4">0.5985765418119844</span><span class="s2">,</span>
                         <span class="s4">0.8868495172060835</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.8868495172060835</span><span class="s2">,</span>
                         <span class="s4">0.5985765418119844</span><span class="s2">, </span><span class="s4">0.2603047507678832</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">2.7</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.2603047507678832</span><span class="s2">, </span><span class="s4">0.5985765418119844</span><span class="s2">,</span>
                         <span class="s4">0.8868495172060835</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.8868495172060835</span><span class="s2">,</span>
                         <span class="s4">0.5985765418119844</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestKaiserBesselDerived</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">M </span><span class="s2">= </span><span class="s4">100</span>
        <span class="s1">w </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser_bessel_derived</span><span class="s2">(</span><span class="s1">M</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">=</span><span class="s4">4.0</span><span class="s2">)</span>
        <span class="s1">w2 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'kaiser bessel derived'</span><span class="s2">, </span><span class="s4">4.0</span><span class="s2">),</span>
                                <span class="s1">M</span><span class="s2">, </span><span class="s1">fftbins</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">w2</span><span class="s2">)</span>

        <span class="s6"># Test for Princen-Bradley condition</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">[:</span><span class="s1">M </span><span class="s2">// </span><span class="s4">2</span><span class="s2">] ** </span><span class="s4">2 </span><span class="s2">+ </span><span class="s1">w</span><span class="s2">[-</span><span class="s1">M </span><span class="s2">// </span><span class="s4">2</span><span class="s2">:] ** </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">)</span>

        <span class="s6"># Test actual values from other implementations</span>
        <span class="s6"># M = 2:  sqrt(2) / 2</span>
        <span class="s6"># M = 4:  0.518562710536, 0.855039598640</span>
        <span class="s6"># M = 6:  0.436168993154, 0.707106781187, 0.899864772847</span>
        <span class="s6"># Ref:https://github.com/scipy/scipy/pull/4747#issuecomment-172849418</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser_bessel_derived</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi </span><span class="s2">/ </span><span class="s4">2</span><span class="s2">)[:</span><span class="s4">1</span><span class="s2">],</span>
                        <span class="s1">np</span><span class="s2">.</span><span class="s1">sqrt</span><span class="s2">(</span><span class="s4">2</span><span class="s2">) / </span><span class="s4">2</span><span class="s2">)</span>

        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser_bessel_derived</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi </span><span class="s2">/ </span><span class="s4">2</span><span class="s2">)[:</span><span class="s4">2</span><span class="s2">],</span>
                        <span class="s2">[</span><span class="s4">0.518562710536</span><span class="s2">, </span><span class="s4">0.855039598640</span><span class="s2">])</span>

        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser_bessel_derived</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi </span><span class="s2">/ </span><span class="s4">2</span><span class="s2">)[:</span><span class="s4">3</span><span class="s2">],</span>
                        <span class="s2">[</span><span class="s4">0.436168993154</span><span class="s2">, </span><span class="s4">0.707106781187</span><span class="s2">, </span><span class="s4">0.899864772847</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">M </span><span class="s2">= </span><span class="s4">100</span>
        <span class="s6"># Assert ValueError for odd window length</span>
        <span class="s1">msg </span><span class="s2">= (</span><span class="s3">&quot;Kaiser-Bessel Derived windows are only defined for even &quot;</span>
               <span class="s3">&quot;number of points&quot;</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser_bessel_derived</span><span class="s2">(</span><span class="s1">M </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">=</span><span class="s4">4.</span><span class="s2">)</span>

        <span class="s6"># Assert ValueError for non-symmetric setting</span>
        <span class="s1">msg </span><span class="s2">= (</span><span class="s3">&quot;Kaiser-Bessel Derived windows are only defined for &quot;</span>
               <span class="s3">&quot;symmetric shapes&quot;</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser_bessel_derived</span><span class="s2">(</span><span class="s1">M </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">=</span><span class="s4">4.</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestNuttall</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">nuttall</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.0003628</span><span class="s2">, </span><span class="s4">0.0613345</span><span class="s2">, </span><span class="s4">0.5292298</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.5292298</span><span class="s2">,</span>
                         <span class="s4">0.0613345</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">nuttall</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.0003628</span><span class="s2">, </span><span class="s4">0.03777576895352025</span><span class="s2">, </span><span class="s4">0.3427276199688195</span><span class="s2">,</span>
                         <span class="s4">0.8918518610776603</span><span class="s2">, </span><span class="s4">0.8918518610776603</span><span class="s2">,</span>
                         <span class="s4">0.3427276199688196</span><span class="s2">, </span><span class="s4">0.0377757689535203</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">nuttall</span><span class="s2">(</span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.0003628</span><span class="s2">, </span><span class="s4">0.1105152530498718</span><span class="s2">, </span><span class="s4">0.7982580969501282</span><span class="s2">,</span>
                         <span class="s4">0.7982580969501283</span><span class="s2">, </span><span class="s4">0.1105152530498719</span><span class="s2">, </span><span class="s4">0.0003628</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">nuttall</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.0003628</span><span class="s2">, </span><span class="s4">0.0613345</span><span class="s2">, </span><span class="s4">0.5292298</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.5292298</span><span class="s2">,</span>
                         <span class="s4">0.0613345</span><span class="s2">, </span><span class="s4">0.0003628</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestParzen</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">parzen</span><span class="s2">(</span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.009259259259259254</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.8611111111111112</span><span class="s2">,</span>
                         <span class="s4">0.8611111111111112</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.009259259259259254</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">parzen</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.00583090379008747</span><span class="s2">, </span><span class="s4">0.1574344023323616</span><span class="s2">,</span>
                         <span class="s4">0.6501457725947521</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.6501457725947521</span><span class="s2">,</span>
                         <span class="s4">0.1574344023323616</span><span class="s2">, </span><span class="s4">0.00583090379008747</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">parzen</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.00583090379008747</span><span class="s2">, </span><span class="s4">0.1574344023323616</span><span class="s2">,</span>
                         <span class="s4">0.6501457725947521</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.6501457725947521</span><span class="s2">,</span>
                         <span class="s4">0.1574344023323616</span><span class="s2">])</span>


<span class="s0">class </span><span class="s1">TestTriang</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>

        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">triang</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">1</span><span class="s2">/</span><span class="s4">6</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">/</span><span class="s4">6</span><span class="s2">, </span><span class="s4">5</span><span class="s2">/</span><span class="s4">6</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">6</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">triang</span><span class="s2">(</span><span class="s4">7</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">1</span><span class="s2">/</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">/</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">/</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">4</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">triang</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">1</span><span class="s2">/</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">/</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">/</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">/</span><span class="s4">2</span><span class="s2">])</span>


<span class="s1">tukey_data </span><span class="s2">= {</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.84312081893436686</span><span class="s2">,</span>
                           <span class="s4">0.84312081893436686</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">, </span><span class="s0">False</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.58682408883346526</span><span class="s2">,</span>
                            <span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.58682408883346526</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">False</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">0.8</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.69134171618254492</span><span class="s2">,</span>
                           <span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.69134171618254492</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">]),</span>
    <span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s0">True</span><span class="s2">): </span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">]),</span>

    <span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">0</span><span class="s2">): [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">0</span><span class="s2">): [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">.25</span><span class="s2">): [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">.25</span><span class="s2">): [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">6</span><span class="s2">,): [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.9045084971874737</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.9045084971874735</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">7</span><span class="s2">,): [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">.75</span><span class="s2">): [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.5522642316338269</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.5522642316338267</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">.75</span><span class="s2">): [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.4131759111665348</span><span class="s2">, </span><span class="s4">0.9698463103929542</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">,</span>
               <span class="s4">0.9698463103929542</span><span class="s2">, </span><span class="s4">0.4131759111665347</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">1</span><span class="s2">): [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.3454915028125263</span><span class="s2">, </span><span class="s4">0.9045084971874737</span><span class="s2">, </span><span class="s4">0.9045084971874737</span><span class="s2">,</span>
             <span class="s4">0.3454915028125263</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
    <span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">1</span><span class="s2">): [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.75</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
<span class="s2">}</span>


<span class="s0">class </span><span class="s1">TestTukey</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Test against hardcoded data</span>
        <span class="s0">for </span><span class="s1">k</span><span class="s2">, </span><span class="s1">v </span><span class="s0">in </span><span class="s1">tukey_data</span><span class="s2">.</span><span class="s1">items</span><span class="s2">():</span>
            <span class="s0">if </span><span class="s1">v </span><span class="s0">is None</span><span class="s2">:</span>
                <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">tukey</span><span class="s2">, *</span><span class="s1">k</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">win </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">tukey</span><span class="s2">(*</span><span class="s1">k</span><span class="s2">)</span>
                <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">win</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_extremes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Test extremes of alpha correspond to boxcar and hann</span>
        <span class="s1">tuk0 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">tukey</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">box0 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">boxcar</span><span class="s2">(</span><span class="s4">100</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">tuk0</span><span class="s2">, </span><span class="s1">box0</span><span class="s2">)</span>

        <span class="s1">tuk1 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">tukey</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">han1 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">hann</span><span class="s2">(</span><span class="s4">100</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">tuk1</span><span class="s2">, </span><span class="s1">han1</span><span class="s2">)</span>


<span class="s1">dpss_data </span><span class="s2">= {</span>
    <span class="s6"># All values from MATLAB:</span>
    <span class="s6"># * taper[1] of (3, 1.4, 3) sign-flipped</span>
    <span class="s6"># * taper[3] of (5, 1.5, 5) sign-flipped</span>
    <span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">): ([[</span><span class="s4">0.497943898</span><span class="s2">, </span><span class="s4">0.502047681</span><span class="s2">, </span><span class="s4">0.502047681</span><span class="s2">, </span><span class="s4">0.497943898</span><span class="s2">], [</span><span class="s4">0.670487993</span><span class="s2">, </span><span class="s4">0.224601537</span><span class="s2">, -</span><span class="s4">0.224601537</span><span class="s2">, -</span><span class="s4">0.670487993</span><span class="s2">]], [</span><span class="s4">0.197961815</span><span class="s2">, </span><span class="s4">0.002035474</span><span class="s2">]),  </span><span class="s6"># noqa: E501</span>
    <span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1.4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">): ([[</span><span class="s4">0.410233151</span><span class="s2">, </span><span class="s4">0.814504464</span><span class="s2">, </span><span class="s4">0.410233151</span><span class="s2">], [</span><span class="s4">0.707106781</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, -</span><span class="s4">0.707106781</span><span class="s2">], [</span><span class="s4">0.575941629</span><span class="s2">, -</span><span class="s4">0.580157287</span><span class="s2">, </span><span class="s4">0.575941629</span><span class="s2">]], [</span><span class="s4">0.999998093</span><span class="s2">, </span><span class="s4">0.998067480</span><span class="s2">, </span><span class="s4">0.801934426</span><span class="s2">]),  </span><span class="s6"># noqa: E501</span>
    <span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">5</span><span class="s2">): ([[</span><span class="s4">0.1745071052</span><span class="s2">, </span><span class="s4">0.4956749177</span><span class="s2">, </span><span class="s4">0.669109327</span><span class="s2">, </span><span class="s4">0.495674917</span><span class="s2">, </span><span class="s4">0.174507105</span><span class="s2">], [</span><span class="s4">0.4399493348</span><span class="s2">, </span><span class="s4">0.553574369</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, -</span><span class="s4">0.553574369</span><span class="s2">, -</span><span class="s4">0.439949334</span><span class="s2">], [</span><span class="s4">0.631452756</span><span class="s2">, </span><span class="s4">0.073280238</span><span class="s2">, -</span><span class="s4">0.437943884</span><span class="s2">, </span><span class="s4">0.073280238</span><span class="s2">, </span><span class="s4">0.631452756</span><span class="s2">], [</span><span class="s4">0.553574369</span><span class="s2">, -</span><span class="s4">0.439949334</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.439949334</span><span class="s2">, -</span><span class="s4">0.553574369</span><span class="s2">], [</span><span class="s4">0.266110290</span><span class="s2">, -</span><span class="s4">0.498935248</span><span class="s2">, </span><span class="s4">0.600414741</span><span class="s2">, -</span><span class="s4">0.498935248</span><span class="s2">, </span><span class="s4">0.266110290147157</span><span class="s2">]], [</span><span class="s4">0.999728571</span><span class="s2">, </span><span class="s4">0.983706916</span><span class="s2">, </span><span class="s4">0.768457889</span><span class="s2">, </span><span class="s4">0.234159338</span><span class="s2">, </span><span class="s4">0.013947282907567</span><span class="s2">]),  </span><span class="s6"># noqa: E501</span>
    <span class="s2">(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">4</span><span class="s2">): ([[</span><span class="s4">0.0030914414</span><span class="s2">, </span><span class="s4">0.0041266922</span><span class="s2">, </span><span class="s4">0.005315076</span><span class="s2">, </span><span class="s4">0.006665149</span><span class="s2">, </span><span class="s4">0.008184854</span><span class="s2">, </span><span class="s4">0.0098814158</span><span class="s2">, </span><span class="s4">0.011761239</span><span class="s2">, </span><span class="s4">0.013829809</span><span class="s2">, </span><span class="s4">0.016091597</span><span class="s2">, </span><span class="s4">0.018549973</span><span class="s2">, </span><span class="s4">0.02120712</span><span class="s2">, </span><span class="s4">0.02406396</span><span class="s2">, </span><span class="s4">0.027120092</span><span class="s2">, </span><span class="s4">0.030373728</span><span class="s2">, </span><span class="s4">0.033821651</span><span class="s2">, </span><span class="s4">0.037459181</span><span class="s2">, </span><span class="s4">0.041280145</span><span class="s2">, </span><span class="s4">0.045276872</span><span class="s2">, </span><span class="s4">0.049440192</span><span class="s2">, </span><span class="s4">0.053759447</span><span class="s2">, </span><span class="s4">0.058222524</span><span class="s2">, </span><span class="s4">0.062815894</span><span class="s2">, </span><span class="s4">0.067524661</span><span class="s2">, </span><span class="s4">0.072332638</span><span class="s2">, </span><span class="s4">0.077222418</span><span class="s2">, </span><span class="s4">0.082175473</span><span class="s2">, </span><span class="s4">0.087172252</span><span class="s2">, </span><span class="s4">0.092192299</span><span class="s2">, </span><span class="s4">0.097214376</span><span class="s2">, </span><span class="s4">0.1022166</span><span class="s2">, </span><span class="s4">0.10717657</span><span class="s2">, </span><span class="s4">0.11207154</span><span class="s2">, </span><span class="s4">0.11687856</span><span class="s2">, </span><span class="s4">0.12157463</span><span class="s2">, </span><span class="s4">0.12613686</span><span class="s2">, </span><span class="s4">0.13054266</span><span class="s2">, </span><span class="s4">0.13476986</span><span class="s2">, </span><span class="s4">0.13879691</span><span class="s2">, </span><span class="s4">0.14260302</span><span class="s2">, </span><span class="s4">0.14616832</span><span class="s2">, </span><span class="s4">0.14947401</span><span class="s2">, </span><span class="s4">0.1525025</span><span class="s2">, </span><span class="s4">0.15523755</span><span class="s2">, </span><span class="s4">0.15766438</span><span class="s2">, </span><span class="s4">0.15976981</span><span class="s2">, </span><span class="s4">0.16154233</span><span class="s2">, </span><span class="s4">0.16297223</span><span class="s2">, </span><span class="s4">0.16405162</span><span class="s2">, </span><span class="s4">0.16477455</span><span class="s2">, </span><span class="s4">0.16513702</span><span class="s2">, </span><span class="s4">0.16513702</span><span class="s2">, </span><span class="s4">0.16477455</span><span class="s2">, </span><span class="s4">0.16405162</span><span class="s2">, </span><span class="s4">0.16297223</span><span class="s2">, </span><span class="s4">0.16154233</span><span class="s2">, </span><span class="s4">0.15976981</span><span class="s2">, </span><span class="s4">0.15766438</span><span class="s2">, </span><span class="s4">0.15523755</span><span class="s2">, </span><span class="s4">0.1525025</span><span class="s2">, </span><span class="s4">0.14947401</span><span class="s2">, </span><span class="s4">0.14616832</span><span class="s2">, </span><span class="s4">0.14260302</span><span class="s2">, </span><span class="s4">0.13879691</span><span class="s2">, </span><span class="s4">0.13476986</span><span class="s2">, </span><span class="s4">0.13054266</span><span class="s2">, </span><span class="s4">0.12613686</span><span class="s2">, </span><span class="s4">0.12157463</span><span class="s2">, </span><span class="s4">0.11687856</span><span class="s2">, </span><span class="s4">0.11207154</span><span class="s2">, </span><span class="s4">0.10717657</span><span class="s2">, </span><span class="s4">0.1022166</span><span class="s2">, </span><span class="s4">0.097214376</span><span class="s2">, </span><span class="s4">0.092192299</span><span class="s2">, </span><span class="s4">0.087172252</span><span class="s2">, </span><span class="s4">0.082175473</span><span class="s2">, </span><span class="s4">0.077222418</span><span class="s2">, </span><span class="s4">0.072332638</span><span class="s2">, </span><span class="s4">0.067524661</span><span class="s2">, </span><span class="s4">0.062815894</span><span class="s2">, </span><span class="s4">0.058222524</span><span class="s2">, </span><span class="s4">0.053759447</span><span class="s2">, </span><span class="s4">0.049440192</span><span class="s2">, </span><span class="s4">0.045276872</span><span class="s2">, </span><span class="s4">0.041280145</span><span class="s2">, </span><span class="s4">0.037459181</span><span class="s2">, </span><span class="s4">0.033821651</span><span class="s2">, </span><span class="s4">0.030373728</span><span class="s2">, </span><span class="s4">0.027120092</span><span class="s2">, </span><span class="s4">0.02406396</span><span class="s2">, </span><span class="s4">0.02120712</span><span class="s2">, </span><span class="s4">0.018549973</span><span class="s2">, </span><span class="s4">0.016091597</span><span class="s2">, </span><span class="s4">0.013829809</span><span class="s2">, </span><span class="s4">0.011761239</span><span class="s2">, </span><span class="s4">0.0098814158</span><span class="s2">, </span><span class="s4">0.008184854</span><span class="s2">, </span><span class="s4">0.006665149</span><span class="s2">, </span><span class="s4">0.005315076</span><span class="s2">, </span><span class="s4">0.0041266922</span><span class="s2">, </span><span class="s4">0.0030914414</span><span class="s2">], [</span><span class="s4">0.018064449</span><span class="s2">, </span><span class="s4">0.022040342</span><span class="s2">, </span><span class="s4">0.026325013</span><span class="s2">, </span><span class="s4">0.030905288</span><span class="s2">, </span><span class="s4">0.035764398</span><span class="s2">, </span><span class="s4">0.040881982</span><span class="s2">, </span><span class="s4">0.046234148</span><span class="s2">, </span><span class="s4">0.051793558</span><span class="s2">, </span><span class="s4">0.057529559</span><span class="s2">, </span><span class="s4">0.063408356</span><span class="s2">, </span><span class="s4">0.069393216</span><span class="s2">, </span><span class="s4">0.075444716</span><span class="s2">, </span><span class="s4">0.081521022</span><span class="s2">, </span><span class="s4">0.087578202</span><span class="s2">, </span><span class="s4">0.093570567</span><span class="s2">, </span><span class="s4">0.099451049</span><span class="s2">, </span><span class="s4">0.10517159</span><span class="s2">, </span><span class="s4">0.11068356</span><span class="s2">, </span><span class="s4">0.11593818</span><span class="s2">, </span><span class="s4">0.12088699</span><span class="s2">, </span><span class="s4">0.12548227</span><span class="s2">, </span><span class="s4">0.12967752</span><span class="s2">, </span><span class="s4">0.1334279</span><span class="s2">, </span><span class="s4">0.13669069</span><span class="s2">, </span><span class="s4">0.13942569</span><span class="s2">, </span><span class="s4">0.1415957</span><span class="s2">, </span><span class="s4">0.14316686</span><span class="s2">, </span><span class="s4">0.14410905</span><span class="s2">, </span><span class="s4">0.14439626</span><span class="s2">, </span><span class="s4">0.14400686</span><span class="s2">, </span><span class="s4">0.14292389</span><span class="s2">, </span><span class="s4">0.1411353</span><span class="s2">, </span><span class="s4">0.13863416</span><span class="s2">, </span><span class="s4">0.13541876</span><span class="s2">, </span><span class="s4">0.13149274</span><span class="s2">, </span><span class="s4">0.12686516</span><span class="s2">, </span><span class="s4">0.12155045</span><span class="s2">, </span><span class="s4">0.1155684</span><span class="s2">, </span><span class="s4">0.10894403</span><span class="s2">, </span><span class="s4">0.10170748</span><span class="s2">, </span><span class="s4">0.093893752</span><span class="s2">, </span><span class="s4">0.08554251</span><span class="s2">, </span><span class="s4">0.076697768</span><span class="s2">, </span><span class="s4">0.067407559</span><span class="s2">, </span><span class="s4">0.057723559</span><span class="s2">, </span><span class="s4">0.04770068</span><span class="s2">, </span><span class="s4">0.037396627</span><span class="s2">, </span><span class="s4">0.026871428</span><span class="s2">, </span><span class="s4">0.016186944</span><span class="s2">, </span><span class="s4">0.0054063557</span><span class="s2">, -</span><span class="s4">0.0054063557</span><span class="s2">, -</span><span class="s4">0.016186944</span><span class="s2">, -</span><span class="s4">0.026871428</span><span class="s2">, -</span><span class="s4">0.037396627</span><span class="s2">, -</span><span class="s4">0.04770068</span><span class="s2">, -</span><span class="s4">0.057723559</span><span class="s2">, -</span><span class="s4">0.067407559</span><span class="s2">, -</span><span class="s4">0.076697768</span><span class="s2">, -</span><span class="s4">0.08554251</span><span class="s2">, -</span><span class="s4">0.093893752</span><span class="s2">, -</span><span class="s4">0.10170748</span><span class="s2">, -</span><span class="s4">0.10894403</span><span class="s2">, -</span><span class="s4">0.1155684</span><span class="s2">, -</span><span class="s4">0.12155045</span><span class="s2">, -</span><span class="s4">0.12686516</span><span class="s2">, -</span><span class="s4">0.13149274</span><span class="s2">, -</span><span class="s4">0.13541876</span><span class="s2">, -</span><span class="s4">0.13863416</span><span class="s2">, -</span><span class="s4">0.1411353</span><span class="s2">, -</span><span class="s4">0.14292389</span><span class="s2">, -</span><span class="s4">0.14400686</span><span class="s2">, -</span><span class="s4">0.14439626</span><span class="s2">, -</span><span class="s4">0.14410905</span><span class="s2">, -</span><span class="s4">0.14316686</span><span class="s2">, -</span><span class="s4">0.1415957</span><span class="s2">, -</span><span class="s4">0.13942569</span><span class="s2">, -</span><span class="s4">0.13669069</span><span class="s2">, -</span><span class="s4">0.1334279</span><span class="s2">, -</span><span class="s4">0.12967752</span><span class="s2">, -</span><span class="s4">0.12548227</span><span class="s2">, -</span><span class="s4">0.12088699</span><span class="s2">, -</span><span class="s4">0.11593818</span><span class="s2">, -</span><span class="s4">0.11068356</span><span class="s2">, -</span><span class="s4">0.10517159</span><span class="s2">, -</span><span class="s4">0.099451049</span><span class="s2">, -</span><span class="s4">0.093570567</span><span class="s2">, -</span><span class="s4">0.087578202</span><span class="s2">, -</span><span class="s4">0.081521022</span><span class="s2">, -</span><span class="s4">0.075444716</span><span class="s2">, -</span><span class="s4">0.069393216</span><span class="s2">, -</span><span class="s4">0.063408356</span><span class="s2">, -</span><span class="s4">0.057529559</span><span class="s2">, -</span><span class="s4">0.051793558</span><span class="s2">, -</span><span class="s4">0.046234148</span><span class="s2">, -</span><span class="s4">0.040881982</span><span class="s2">, -</span><span class="s4">0.035764398</span><span class="s2">, -</span><span class="s4">0.030905288</span><span class="s2">, -</span><span class="s4">0.026325013</span><span class="s2">, -</span><span class="s4">0.022040342</span><span class="s2">, -</span><span class="s4">0.018064449</span><span class="s2">], [</span><span class="s4">0.064817553</span><span class="s2">, </span><span class="s4">0.072567801</span><span class="s2">, </span><span class="s4">0.080292992</span><span class="s2">, </span><span class="s4">0.087918235</span><span class="s2">, </span><span class="s4">0.095367076</span><span class="s2">, </span><span class="s4">0.10256232</span><span class="s2">, </span><span class="s4">0.10942687</span><span class="s2">, </span><span class="s4">0.1158846</span><span class="s2">, </span><span class="s4">0.12186124</span><span class="s2">, </span><span class="s4">0.12728523</span><span class="s2">, </span><span class="s4">0.13208858</span><span class="s2">, </span><span class="s4">0.13620771</span><span class="s2">, </span><span class="s4">0.13958427</span><span class="s2">, </span><span class="s4">0.14216587</span><span class="s2">, </span><span class="s4">0.14390678</span><span class="s2">, </span><span class="s4">0.14476863</span><span class="s2">, </span><span class="s4">0.1447209</span><span class="s2">, </span><span class="s4">0.14374148</span><span class="s2">, </span><span class="s4">0.14181704</span><span class="s2">, </span><span class="s4">0.13894336</span><span class="s2">, </span><span class="s4">0.13512554</span><span class="s2">, </span><span class="s4">0.13037812</span><span class="s2">, </span><span class="s4">0.1247251</span><span class="s2">, </span><span class="s4">0.11819984</span><span class="s2">, </span><span class="s4">0.11084487</span><span class="s2">, </span><span class="s4">0.10271159</span><span class="s2">, </span><span class="s4">0.093859853</span><span class="s2">, </span><span class="s4">0.084357497</span><span class="s2">, </span><span class="s4">0.074279719</span><span class="s2">, </span><span class="s4">0.063708406</span><span class="s2">, </span><span class="s4">0.052731374</span><span class="s2">, </span><span class="s4">0.041441525</span><span class="s2">, </span><span class="s4">0.029935953</span><span class="s2">, </span><span class="s4">0.018314987</span><span class="s2">, </span><span class="s4">0.0066811877</span><span class="s2">, -</span><span class="s4">0.0048616765</span><span class="s2">, -</span><span class="s4">0.016209689</span><span class="s2">, -</span><span class="s4">0.027259848</span><span class="s2">, -</span><span class="s4">0.037911124</span><span class="s2">, -</span><span class="s4">0.048065512</span><span class="s2">, -</span><span class="s4">0.05762905</span><span class="s2">, -</span><span class="s4">0.066512804</span><span class="s2">, -</span><span class="s4">0.0746338</span><span class="s2">, -</span><span class="s4">0.081915903</span><span class="s2">, -</span><span class="s4">0.088290621</span><span class="s2">, -</span><span class="s4">0.09369783</span><span class="s2">, -</span><span class="s4">0.098086416</span><span class="s2">, -</span><span class="s4">0.10141482</span><span class="s2">, -</span><span class="s4">0.10365146</span><span class="s2">, -</span><span class="s4">0.10477512</span><span class="s2">, -</span><span class="s4">0.10477512</span><span class="s2">, -</span><span class="s4">0.10365146</span><span class="s2">, -</span><span class="s4">0.10141482</span><span class="s2">, -</span><span class="s4">0.098086416</span><span class="s2">, -</span><span class="s4">0.09369783</span><span class="s2">, -</span><span class="s4">0.088290621</span><span class="s2">, -</span><span class="s4">0.081915903</span><span class="s2">, -</span><span class="s4">0.0746338</span><span class="s2">, -</span><span class="s4">0.066512804</span><span class="s2">, -</span><span class="s4">0.05762905</span><span class="s2">, -</span><span class="s4">0.048065512</span><span class="s2">, -</span><span class="s4">0.037911124</span><span class="s2">, -</span><span class="s4">0.027259848</span><span class="s2">, -</span><span class="s4">0.016209689</span><span class="s2">, -</span><span class="s4">0.0048616765</span><span class="s2">, </span><span class="s4">0.0066811877</span><span class="s2">, </span><span class="s4">0.018314987</span><span class="s2">, </span><span class="s4">0.029935953</span><span class="s2">, </span><span class="s4">0.041441525</span><span class="s2">, </span><span class="s4">0.052731374</span><span class="s2">, </span><span class="s4">0.063708406</span><span class="s2">, </span><span class="s4">0.074279719</span><span class="s2">, </span><span class="s4">0.084357497</span><span class="s2">, </span><span class="s4">0.093859853</span><span class="s2">, </span><span class="s4">0.10271159</span><span class="s2">, </span><span class="s4">0.11084487</span><span class="s2">, </span><span class="s4">0.11819984</span><span class="s2">, </span><span class="s4">0.1247251</span><span class="s2">, </span><span class="s4">0.13037812</span><span class="s2">, </span><span class="s4">0.13512554</span><span class="s2">, </span><span class="s4">0.13894336</span><span class="s2">, </span><span class="s4">0.14181704</span><span class="s2">, </span><span class="s4">0.14374148</span><span class="s2">, </span><span class="s4">0.1447209</span><span class="s2">, </span><span class="s4">0.14476863</span><span class="s2">, </span><span class="s4">0.14390678</span><span class="s2">, </span><span class="s4">0.14216587</span><span class="s2">, </span><span class="s4">0.13958427</span><span class="s2">, </span><span class="s4">0.13620771</span><span class="s2">, </span><span class="s4">0.13208858</span><span class="s2">, </span><span class="s4">0.12728523</span><span class="s2">, </span><span class="s4">0.12186124</span><span class="s2">, </span><span class="s4">0.1158846</span><span class="s2">, </span><span class="s4">0.10942687</span><span class="s2">, </span><span class="s4">0.10256232</span><span class="s2">, </span><span class="s4">0.095367076</span><span class="s2">, </span><span class="s4">0.087918235</span><span class="s2">, </span><span class="s4">0.080292992</span><span class="s2">, </span><span class="s4">0.072567801</span><span class="s2">, </span><span class="s4">0.064817553</span><span class="s2">], [</span><span class="s4">0.14985551</span><span class="s2">, </span><span class="s4">0.15512305</span><span class="s2">, </span><span class="s4">0.15931467</span><span class="s2">, </span><span class="s4">0.16236806</span><span class="s2">, </span><span class="s4">0.16423291</span><span class="s2">, </span><span class="s4">0.16487165</span><span class="s2">, </span><span class="s4">0.16426009</span><span class="s2">, </span><span class="s4">0.1623879</span><span class="s2">, </span><span class="s4">0.1592589</span><span class="s2">, </span><span class="s4">0.15489114</span><span class="s2">, </span><span class="s4">0.14931693</span><span class="s2">, </span><span class="s4">0.14258255</span><span class="s2">, </span><span class="s4">0.13474785</span><span class="s2">, </span><span class="s4">0.1258857</span><span class="s2">, </span><span class="s4">0.11608124</span><span class="s2">, </span><span class="s4">0.10543095</span><span class="s2">, </span><span class="s4">0.094041635</span><span class="s2">, </span><span class="s4">0.082029213</span><span class="s2">, </span><span class="s4">0.069517411</span><span class="s2">, </span><span class="s4">0.056636348</span><span class="s2">, </span><span class="s4">0.043521028</span><span class="s2">, </span><span class="s4">0.030309756</span><span class="s2">, </span><span class="s4">0.017142511</span><span class="s2">, </span><span class="s4">0.0041592774</span><span class="s2">, -</span><span class="s4">0.0085016282</span><span class="s2">, -</span><span class="s4">0.020705223</span><span class="s2">, -</span><span class="s4">0.032321494</span><span class="s2">, -</span><span class="s4">0.043226982</span><span class="s2">, -</span><span class="s4">0.053306291</span><span class="s2">, -</span><span class="s4">0.062453515</span><span class="s2">, -</span><span class="s4">0.070573544</span><span class="s2">, -</span><span class="s4">0.077583253</span><span class="s2">, -</span><span class="s4">0.083412547</span><span class="s2">, -</span><span class="s4">0.088005244</span><span class="s2">, -</span><span class="s4">0.091319802</span><span class="s2">, -</span><span class="s4">0.093329861</span><span class="s2">, -</span><span class="s4">0.094024602</span><span class="s2">, -</span><span class="s4">0.093408915</span><span class="s2">, -</span><span class="s4">0.091503383</span><span class="s2">, -</span><span class="s4">0.08834406</span><span class="s2">, -</span><span class="s4">0.08398207</span><span class="s2">, -</span><span class="s4">0.078483012</span><span class="s2">, -</span><span class="s4">0.071926192</span><span class="s2">, -</span><span class="s4">0.064403681</span><span class="s2">, -</span><span class="s4">0.056019215</span><span class="s2">, -</span><span class="s4">0.046886954</span><span class="s2">, -</span><span class="s4">0.037130106</span><span class="s2">, -</span><span class="s4">0.026879442</span><span class="s2">, -</span><span class="s4">0.016271713</span><span class="s2">, -</span><span class="s4">0.005448</span><span class="s2">, </span><span class="s4">0.005448</span><span class="s2">, </span><span class="s4">0.016271713</span><span class="s2">, </span><span class="s4">0.026879442</span><span class="s2">, </span><span class="s4">0.037130106</span><span class="s2">, </span><span class="s4">0.046886954</span><span class="s2">, </span><span class="s4">0.056019215</span><span class="s2">, </span><span class="s4">0.064403681</span><span class="s2">, </span><span class="s4">0.071926192</span><span class="s2">, </span><span class="s4">0.078483012</span><span class="s2">, </span><span class="s4">0.08398207</span><span class="s2">, </span><span class="s4">0.08834406</span><span class="s2">, </span><span class="s4">0.091503383</span><span class="s2">, </span><span class="s4">0.093408915</span><span class="s2">, </span><span class="s4">0.094024602</span><span class="s2">, </span><span class="s4">0.093329861</span><span class="s2">, </span><span class="s4">0.091319802</span><span class="s2">, </span><span class="s4">0.088005244</span><span class="s2">, </span><span class="s4">0.083412547</span><span class="s2">, </span><span class="s4">0.077583253</span><span class="s2">, </span><span class="s4">0.070573544</span><span class="s2">, </span><span class="s4">0.062453515</span><span class="s2">, </span><span class="s4">0.053306291</span><span class="s2">, </span><span class="s4">0.043226982</span><span class="s2">, </span><span class="s4">0.032321494</span><span class="s2">, </span><span class="s4">0.020705223</span><span class="s2">, </span><span class="s4">0.0085016282</span><span class="s2">, -</span><span class="s4">0.0041592774</span><span class="s2">, -</span><span class="s4">0.017142511</span><span class="s2">, -</span><span class="s4">0.030309756</span><span class="s2">, -</span><span class="s4">0.043521028</span><span class="s2">, -</span><span class="s4">0.056636348</span><span class="s2">, -</span><span class="s4">0.069517411</span><span class="s2">, -</span><span class="s4">0.082029213</span><span class="s2">, -</span><span class="s4">0.094041635</span><span class="s2">, -</span><span class="s4">0.10543095</span><span class="s2">, -</span><span class="s4">0.11608124</span><span class="s2">, -</span><span class="s4">0.1258857</span><span class="s2">, -</span><span class="s4">0.13474785</span><span class="s2">, -</span><span class="s4">0.14258255</span><span class="s2">, -</span><span class="s4">0.14931693</span><span class="s2">, -</span><span class="s4">0.15489114</span><span class="s2">, -</span><span class="s4">0.1592589</span><span class="s2">, -</span><span class="s4">0.1623879</span><span class="s2">, -</span><span class="s4">0.16426009</span><span class="s2">, -</span><span class="s4">0.16487165</span><span class="s2">, -</span><span class="s4">0.16423291</span><span class="s2">, -</span><span class="s4">0.16236806</span><span class="s2">, -</span><span class="s4">0.15931467</span><span class="s2">, -</span><span class="s4">0.15512305</span><span class="s2">, -</span><span class="s4">0.14985551</span><span class="s2">]], [</span><span class="s4">0.999943140</span><span class="s2">, </span><span class="s4">0.997571533</span><span class="s2">, </span><span class="s4">0.959465463</span><span class="s2">, </span><span class="s4">0.721862496</span><span class="s2">]),  </span><span class="s6"># noqa: E501</span>
<span class="s2">}</span>


<span class="s0">class </span><span class="s1">TestDPSS</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Test against hardcoded data</span>
        <span class="s0">for </span><span class="s1">k</span><span class="s2">, </span><span class="s1">v </span><span class="s0">in </span><span class="s1">dpss_data</span><span class="s2">.</span><span class="s1">items</span><span class="s2">():</span>
            <span class="s1">win</span><span class="s2">, </span><span class="s1">ratios </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">(*</span><span class="s1">k</span><span class="s2">, </span><span class="s1">return_ratios</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">win</span><span class="s2">, </span><span class="s1">v</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-7</span><span class="s2">, </span><span class="s1">err_msg</span><span class="s2">=</span><span class="s1">k</span><span class="s2">)</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">ratios</span><span class="s2">, </span><span class="s1">v</span><span class="s2">[</span><span class="s4">1</span><span class="s2">], </span><span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-7</span><span class="s2">, </span><span class="s1">err_msg</span><span class="s2">=</span><span class="s1">k</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_unity</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Test unity value handling (gh-2221)</span>
        <span class="s0">for </span><span class="s1">M </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">21</span><span class="s2">):</span>
            <span class="s6"># corrected w/approximation (default)</span>
            <span class="s1">win </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">(</span><span class="s1">M</span><span class="s2">, </span><span class="s1">M </span><span class="s2">/ </span><span class="s4">2.1</span><span class="s2">)</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">M </span><span class="s2">% </span><span class="s4">2  </span><span class="s6"># one for odd, none for even</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isclose</span><span class="s2">(</span><span class="s1">win</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">).</span><span class="s1">sum</span><span class="s2">(), </span><span class="s1">expected</span><span class="s2">,</span>
                         <span class="s1">err_msg</span><span class="s2">=</span><span class="s3">f'</span><span class="s0">{</span><span class="s1">win</span><span class="s0">}</span><span class="s3">'</span><span class="s2">)</span>
            <span class="s6"># corrected w/subsample delay (slower)</span>
            <span class="s1">win_sub </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">(</span><span class="s1">M</span><span class="s2">, </span><span class="s1">M </span><span class="s2">/ </span><span class="s4">2.1</span><span class="s2">, </span><span class="s1">norm</span><span class="s2">=</span><span class="s3">'subsample'</span><span class="s2">)</span>
            <span class="s0">if </span><span class="s1">M </span><span class="s2">&gt; </span><span class="s4">2</span><span class="s2">:</span>
                <span class="s6"># @M=2 the subsample doesn't do anything</span>
                <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isclose</span><span class="s2">(</span><span class="s1">win_sub</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">).</span><span class="s1">sum</span><span class="s2">(), </span><span class="s1">expected</span><span class="s2">,</span>
                             <span class="s1">err_msg</span><span class="s2">=</span><span class="s3">f'</span><span class="s0">{</span><span class="s1">win_sub</span><span class="s0">}</span><span class="s3">'</span><span class="s2">)</span>
                <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">win</span><span class="s2">, </span><span class="s1">win_sub</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s4">0.03</span><span class="s2">)  </span><span class="s6"># within 3%</span>
            <span class="s6"># not the same, l2-norm</span>
            <span class="s1">win_2 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">(</span><span class="s1">M</span><span class="s2">, </span><span class="s1">M </span><span class="s2">/ </span><span class="s4">2.1</span><span class="s2">, </span><span class="s1">norm</span><span class="s2">=</span><span class="s4">2</span><span class="s2">)</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">M </span><span class="s2">== </span><span class="s4">1 </span><span class="s0">else </span><span class="s4">0</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isclose</span><span class="s2">(</span><span class="s1">win_2</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">).</span><span class="s1">sum</span><span class="s2">(), </span><span class="s1">expected</span><span class="s2">,</span>
                         <span class="s1">err_msg</span><span class="s2">=</span><span class="s3">f'</span><span class="s0">{</span><span class="s1">win_2</span><span class="s0">}</span><span class="s3">'</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_extremes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Test extremes of alpha</span>
        <span class="s1">lam </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">(</span><span class="s4">31</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s1">return_ratios</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">lam</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">)</span>
        <span class="s1">lam </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">(</span><span class="s4">31</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s1">return_ratios</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">lam</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">)</span>
        <span class="s1">lam </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">(</span><span class="s4">31</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s1">return_ratios</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)[</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">lam</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_degenerate</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Test failures</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">)  </span><span class="s6"># Bad Kmax</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">, -</span><span class="s4">5</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">1.1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)  </span><span class="s6"># NW must be &lt; N/2.</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)  </span><span class="s6"># NW must be pos</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)  </span><span class="s6"># negative M</span>


<span class="s0">class </span><span class="s1">TestLanczos</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Analytical results:</span>
        <span class="s6"># sinc(x) = sinc(-x)</span>
        <span class="s6"># sinc(pi) = 0, sinc(0) = 1</span>
        <span class="s6"># Hand computation on WolframAlpha:</span>
        <span class="s6"># sinc(2 pi / 3) = 0.413496672</span>
        <span class="s6"># sinc(pi / 3) = 0.826993343</span>
        <span class="s6"># sinc(3 pi / 5) = 0.504551152</span>
        <span class="s6"># sinc(pi / 5) = 0.935489284</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">lanczos</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.</span><span class="s2">, </span><span class="s4">0.413496672</span><span class="s2">,</span>
                         <span class="s4">0.826993343</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.826993343</span><span class="s2">,</span>
                         <span class="s4">0.413496672</span><span class="s2">],</span>
                        <span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-9</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">lanczos</span><span class="s2">(</span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.</span><span class="s2">, </span><span class="s4">0.504551152</span><span class="s2">,</span>
                         <span class="s4">0.935489284</span><span class="s2">, </span><span class="s4">0.935489284</span><span class="s2">,</span>
                         <span class="s4">0.504551152</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">],</span>
                        <span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-9</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">lanczos</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.</span><span class="s2">, </span><span class="s4">0.413496672</span><span class="s2">,</span>
                         <span class="s4">0.826993343</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.826993343</span><span class="s2">,</span>
                         <span class="s4">0.413496672</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">],</span>
                        <span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-9</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_array_size</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">11</span><span class="s2">]:</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">lanczos</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)), </span><span class="s1">n</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">lanczos</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)), </span><span class="s1">n</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestGetWindow</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_boxcar</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">w </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">(</span><span class="s3">'boxcar'</span><span class="s2">, </span><span class="s4">12</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones_like</span><span class="s2">(</span><span class="s1">w</span><span class="s2">))</span>

        <span class="s6"># window is a tuple of len 1</span>
        <span class="s1">w </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'boxcar'</span><span class="s2">,), </span><span class="s4">16</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones_like</span><span class="s2">(</span><span class="s1">w</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_cheb_odd</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s3">&quot;This window is not suitable&quot;</span><span class="s2">)</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'chebwin'</span><span class="s2">, -</span><span class="s4">40</span><span class="s2">), </span><span class="s4">53</span><span class="s2">, </span><span class="s1">fftbins</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">cheb_odd_true</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_cheb_even</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s3">&quot;This window is not suitable&quot;</span><span class="s2">)</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'chebwin'</span><span class="s2">, </span><span class="s4">40</span><span class="s2">), </span><span class="s4">54</span><span class="s2">, </span><span class="s1">fftbins</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">cheb_even_true</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dpss</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">win1 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'dpss'</span><span class="s2">, </span><span class="s4">3</span><span class="s2">), </span><span class="s4">64</span><span class="s2">, </span><span class="s1">fftbins</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">win2 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">dpss</span><span class="s2">(</span><span class="s4">64</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">win1</span><span class="s2">, </span><span class="s1">win2</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_kaiser_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">win1 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">(</span><span class="s4">7.2</span><span class="s2">, </span><span class="s4">64</span><span class="s2">)</span>
        <span class="s1">win2 </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">kaiser</span><span class="s2">(</span><span class="s4">64</span><span class="s2">, </span><span class="s4">7.2</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">win1</span><span class="s2">, </span><span class="s1">win2</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_inputs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Window is not a float, tuple, or string</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">, </span><span class="s1">set</span><span class="s2">(</span><span class="s3">'hann'</span><span class="s2">), </span><span class="s4">8</span><span class="s2">)</span>

        <span class="s6"># Unknown window type error</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">, </span><span class="s3">'broken'</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_array_as_window</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># github issue 3603</span>
        <span class="s1">osfactor </span><span class="s2">= </span><span class="s4">128</span>
        <span class="s1">sig </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">128</span><span class="s2">)</span>

        <span class="s1">win </span><span class="s2">= </span><span class="s1">windows</span><span class="s2">.</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'kaiser'</span><span class="s2">, </span><span class="s4">8.0</span><span class="s2">), </span><span class="s1">osfactor </span><span class="s2">// </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">'must have the same length'</span><span class="s2">):</span>
            <span class="s1">resample</span><span class="s2">(</span><span class="s1">sig</span><span class="s2">, </span><span class="s1">len</span><span class="s2">(</span><span class="s1">sig</span><span class="s2">) * </span><span class="s1">osfactor</span><span class="s2">, </span><span class="s1">window</span><span class="s2">=</span><span class="s1">win</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_general_cosine</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'general_cosine'</span><span class="s2">, [</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">]), </span><span class="s4">4</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'general_cosine'</span><span class="s2">, [</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">]), </span><span class="s4">4</span><span class="s2">,</span>
                                   <span class="s1">fftbins</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.55</span><span class="s2">, </span><span class="s4">0.55</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_general_hamming</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'general_hamming'</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">), </span><span class="s4">5</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.6072949</span><span class="s2">, </span><span class="s4">0.9427051</span><span class="s2">, </span><span class="s4">0.9427051</span><span class="s2">, </span><span class="s4">0.6072949</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">get_window</span><span class="s2">((</span><span class="s3">'general_hamming'</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">), </span><span class="s4">5</span><span class="s2">, </span><span class="s1">fftbins</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_lanczos</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">get_window</span><span class="s2">(</span><span class="s3">'lanczos'</span><span class="s2">, </span><span class="s4">6</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.</span><span class="s2">, </span><span class="s4">0.413496672</span><span class="s2">, </span><span class="s4">0.826993343</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.826993343</span><span class="s2">,</span>
                         <span class="s4">0.413496672</span><span class="s2">], </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-9</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">get_window</span><span class="s2">(</span><span class="s3">'lanczos'</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s1">fftbins</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
                        <span class="s2">[</span><span class="s4">0.</span><span class="s2">, </span><span class="s4">0.504551152</span><span class="s2">, </span><span class="s4">0.935489284</span><span class="s2">, </span><span class="s4">0.935489284</span><span class="s2">,</span>
                         <span class="s4">0.504551152</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">], </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-9</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">get_window</span><span class="s2">(</span><span class="s3">'lanczos'</span><span class="s2">, </span><span class="s4">6</span><span class="s2">), </span><span class="s1">get_window</span><span class="s2">(</span><span class="s3">'sinc'</span><span class="s2">, </span><span class="s4">6</span><span class="s2">))</span>


<span class="s0">def </span><span class="s1">test_windowfunc_basics</span><span class="s2">():</span>
    <span class="s0">for </span><span class="s1">window_name</span><span class="s2">, </span><span class="s1">params </span><span class="s0">in </span><span class="s1">window_funcs</span><span class="s2">:</span>
        <span class="s1">window </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">windows</span><span class="s2">, </span><span class="s1">window_name</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">sup</span><span class="s2">.</span><span class="s1">filter</span><span class="s2">(</span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s3">&quot;This window is not suitable&quot;</span><span class="s2">)</span>
            <span class="s6"># Check symmetry for odd and even lengths</span>
            <span class="s1">w1 </span><span class="s2">= </span><span class="s1">window</span><span class="s2">(</span><span class="s4">8</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
            <span class="s1">w2 </span><span class="s2">= </span><span class="s1">window</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
            <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">w1</span><span class="s2">[:-</span><span class="s4">1</span><span class="s2">], </span><span class="s1">w2</span><span class="s2">)</span>

            <span class="s1">w1 </span><span class="s2">= </span><span class="s1">window</span><span class="s2">(</span><span class="s4">9</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
            <span class="s1">w2 </span><span class="s2">= </span><span class="s1">window</span><span class="s2">(</span><span class="s4">8</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
            <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">w1</span><span class="s2">[:-</span><span class="s4">1</span><span class="s2">], </span><span class="s1">w2</span><span class="s2">)</span>

            <span class="s6"># Check that functions run and output lengths are correct</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)), </span><span class="s4">6</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)), </span><span class="s4">6</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)), </span><span class="s4">7</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">7</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)), </span><span class="s4">7</span><span class="s2">)</span>

            <span class="s6"># Check invalid lengths</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">window</span><span class="s2">, </span><span class="s4">5.5</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">window</span><span class="s2">, -</span><span class="s4">7</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">)</span>

            <span class="s6"># Check degenerate cases</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">), [])</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">), [])</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">), [</span><span class="s4">1</span><span class="s2">])</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">), [</span><span class="s4">1</span><span class="s2">])</span>

            <span class="s6"># Check dtype</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">dtype </span><span class="s2">== </span><span class="s3">'float'</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">).</span><span class="s1">dtype </span><span class="s2">== </span><span class="s3">'float'</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">dtype </span><span class="s2">== </span><span class="s3">'float'</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">).</span><span class="s1">dtype </span><span class="s2">== </span><span class="s3">'float'</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">dtype </span><span class="s2">== </span><span class="s3">'float'</span><span class="s2">)</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">).</span><span class="s1">dtype </span><span class="s2">== </span><span class="s3">'float'</span><span class="s2">)</span>

            <span class="s6"># Check normalization</span>
            <span class="s1">assert_array_less</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">), </span><span class="s4">1.01</span><span class="s2">)</span>
            <span class="s1">assert_array_less</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">), </span><span class="s4">1.01</span><span class="s2">)</span>
            <span class="s1">assert_array_less</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">9</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">True</span><span class="s2">), </span><span class="s4">1.01</span><span class="s2">)</span>
            <span class="s1">assert_array_less</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">9</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">), </span><span class="s4">1.01</span><span class="s2">)</span>

            <span class="s6"># Check that DFT-even spectrum is purely real for odd and even</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">fft</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)).</span><span class="s1">imag</span><span class="s2">,</span>
                            <span class="s4">0</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-14</span><span class="s2">)</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">fft</span><span class="s2">(</span><span class="s1">window</span><span class="s2">(</span><span class="s4">11</span><span class="s2">, *</span><span class="s1">params</span><span class="s2">, </span><span class="s1">sym</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)).</span><span class="s1">imag</span><span class="s2">,</span>
                            <span class="s4">0</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">1e-14</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_needs_params</span><span class="s2">():</span>
    <span class="s0">for </span><span class="s1">winstr </span><span class="s0">in </span><span class="s2">[</span><span class="s3">'kaiser'</span><span class="s2">, </span><span class="s3">'ksr'</span><span class="s2">, </span><span class="s3">'kaiser_bessel_derived'</span><span class="s2">, </span><span class="s3">'kbd'</span><span class="s2">,</span>
                   <span class="s3">'gaussian'</span><span class="s2">, </span><span class="s3">'gauss'</span><span class="s2">, </span><span class="s3">'gss'</span><span class="s2">,</span>
                   <span class="s3">'general gaussian'</span><span class="s2">, </span><span class="s3">'general_gaussian'</span><span class="s2">,</span>
                   <span class="s3">'general gauss'</span><span class="s2">, </span><span class="s3">'general_gauss'</span><span class="s2">, </span><span class="s3">'ggs'</span><span class="s2">,</span>
                   <span class="s3">'dss'</span><span class="s2">, </span><span class="s3">'dpss'</span><span class="s2">, </span><span class="s3">'general cosine'</span><span class="s2">, </span><span class="s3">'general_cosine'</span><span class="s2">,</span>
                   <span class="s3">'chebwin'</span><span class="s2">, </span><span class="s3">'cheb'</span><span class="s2">, </span><span class="s3">'general hamming'</span><span class="s2">, </span><span class="s3">'general_hamming'</span><span class="s2">,</span>
                   <span class="s2">]:</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">get_window</span><span class="s2">, </span><span class="s1">winstr</span><span class="s2">, </span><span class="s4">7</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_not_needs_params</span><span class="s2">():</span>
    <span class="s0">for </span><span class="s1">winstr </span><span class="s0">in </span><span class="s2">[</span><span class="s3">'barthann'</span><span class="s2">,</span>
                   <span class="s3">'bartlett'</span><span class="s2">,</span>
                   <span class="s3">'blackman'</span><span class="s2">,</span>
                   <span class="s3">'blackmanharris'</span><span class="s2">,</span>
                   <span class="s3">'bohman'</span><span class="s2">,</span>
                   <span class="s3">'boxcar'</span><span class="s2">,</span>
                   <span class="s3">'cosine'</span><span class="s2">,</span>
                   <span class="s3">'flattop'</span><span class="s2">,</span>
                   <span class="s3">'hamming'</span><span class="s2">,</span>
                   <span class="s3">'nuttall'</span><span class="s2">,</span>
                   <span class="s3">'parzen'</span><span class="s2">,</span>
                   <span class="s3">'taylor'</span><span class="s2">,</span>
                   <span class="s3">'exponential'</span><span class="s2">,</span>
                   <span class="s3">'poisson'</span><span class="s2">,</span>
                   <span class="s3">'tukey'</span><span class="s2">,</span>
                   <span class="s3">'tuk'</span><span class="s2">,</span>
                   <span class="s3">'triangle'</span><span class="s2">,</span>
                   <span class="s3">'lanczos'</span><span class="s2">,</span>
                   <span class="s3">'sinc'</span><span class="s2">,</span>
                   <span class="s2">]:</span>
        <span class="s1">win </span><span class="s2">= </span><span class="s1">get_window</span><span class="s2">(</span><span class="s1">winstr</span><span class="s2">, </span><span class="s4">7</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">win</span><span class="s2">), </span><span class="s4">7</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_symmetric</span><span class="s2">():</span>

    <span class="s0">for </span><span class="s1">win </span><span class="s0">in </span><span class="s2">[</span><span class="s1">windows</span><span class="s2">.</span><span class="s1">lanczos</span><span class="s2">]:</span>
        <span class="s6"># Even sampling points</span>
        <span class="s1">w </span><span class="s2">= </span><span class="s1">win</span><span class="s2">(</span><span class="s4">4096</span><span class="s2">)</span>
        <span class="s1">error </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">max</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">abs</span><span class="s2">(</span><span class="s1">w</span><span class="s2">-</span><span class="s1">np</span><span class="s2">.</span><span class="s1">flip</span><span class="s2">(</span><span class="s1">w</span><span class="s2">)))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">error</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">)</span>

        <span class="s6"># Odd sampling points</span>
        <span class="s1">w </span><span class="s2">= </span><span class="s1">win</span><span class="s2">(</span><span class="s4">4097</span><span class="s2">)</span>
        <span class="s1">error </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">max</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">abs</span><span class="s2">(</span><span class="s1">w</span><span class="s2">-</span><span class="s1">np</span><span class="s2">.</span><span class="s1">flip</span><span class="s2">(</span><span class="s1">w</span><span class="s2">)))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">error</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">)</span>
</pre>
</body>
</html>