<html>
<head>
<title>test_interpolate.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #5f826b; font-style: italic;}
.s5 { color: #2aacb8;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_interpolate.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">_test_decorators </span><span class="s0">as </span><span class="s1">td</span>

<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">Index</span><span class="s2">,</span>
    <span class="s1">MultiIndex</span><span class="s2">,</span>
    <span class="s1">Series</span><span class="s2">,</span>
    <span class="s1">date_range</span><span class="s2">,</span>
    <span class="s1">isna</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">_testing </span><span class="s0">as </span><span class="s1">tm</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span><span class="s2">(</span>
    <span class="s1">params</span><span class="s2">=[</span>
        <span class="s3">&quot;linear&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;index&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;values&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;nearest&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;slinear&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;zero&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;quadratic&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;cubic&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;barycentric&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;krogh&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;polynomial&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;spline&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;piecewise_polynomial&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;from_derivatives&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;pchip&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;akima&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;cubicspline&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">nontemporal_method</span><span class="s2">(</span><span class="s1">request</span><span class="s2">):</span>
    <span class="s4">&quot;&quot;&quot;Fixture that returns an (method name, required kwargs) pair. 
 
    This fixture does not include method 'time' as a parameterization; that 
    method requires a Series with a DatetimeIndex, and is generally tested 
    separately from these non-temporal methods. 
    &quot;&quot;&quot;</span>
    <span class="s1">method </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">param</span>
    <span class="s1">kwargs </span><span class="s2">= {</span><span class="s3">&quot;order&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">} </span><span class="s0">if </span><span class="s1">method </span><span class="s0">in </span><span class="s2">(</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s3">&quot;polynomial&quot;</span><span class="s2">) </span><span class="s0">else </span><span class="s2">{}</span>
    <span class="s0">return </span><span class="s1">method</span><span class="s2">, </span><span class="s1">kwargs</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span><span class="s2">(</span>
    <span class="s1">params</span><span class="s2">=[</span>
        <span class="s3">&quot;linear&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;slinear&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;zero&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;quadratic&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;cubic&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;barycentric&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;krogh&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;polynomial&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;spline&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;piecewise_polynomial&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;from_derivatives&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;pchip&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;akima&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;cubicspline&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">interp_methods_ind</span><span class="s2">(</span><span class="s1">request</span><span class="s2">):</span>
    <span class="s4">&quot;&quot;&quot;Fixture that returns a (method name, required kwargs) pair to 
    be tested for various Index types. 
 
    This fixture does not include methods - 'time', 'index', 'nearest', 
    'values' as a parameterization 
    &quot;&quot;&quot;</span>
    <span class="s1">method </span><span class="s2">= </span><span class="s1">request</span><span class="s2">.</span><span class="s1">param</span>
    <span class="s1">kwargs </span><span class="s2">= {</span><span class="s3">&quot;order&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">} </span><span class="s0">if </span><span class="s1">method </span><span class="s0">in </span><span class="s2">(</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s3">&quot;polynomial&quot;</span><span class="s2">) </span><span class="s0">else </span><span class="s2">{}</span>
    <span class="s0">return </span><span class="s1">method</span><span class="s2">, </span><span class="s1">kwargs</span>


<span class="s0">class </span><span class="s1">TestSeriesInterpolateData</span><span class="s2">:</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span><span class="s1">reason</span><span class="s2">=</span><span class="s3">&quot;EA.fillna does not handle 'linear' method&quot;</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_interpolate_period_values</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">orig </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">date_range</span><span class="s2">(</span><span class="s3">&quot;2012-01-01&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">5</span><span class="s2">))</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">ser</span><span class="s2">[</span><span class="s5">2</span><span class="s2">] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span>

        <span class="s6"># period cast</span>
        <span class="s1">ser_per </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">dt</span><span class="s2">.</span><span class="s1">to_period</span><span class="s2">(</span><span class="s3">&quot;D&quot;</span><span class="s2">)</span>
        <span class="s1">res_per </span><span class="s2">= </span><span class="s1">ser_per</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">()</span>
        <span class="s1">expected_per </span><span class="s2">= </span><span class="s1">orig</span><span class="s2">.</span><span class="s1">dt</span><span class="s2">.</span><span class="s1">to_period</span><span class="s2">(</span><span class="s3">&quot;D&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">res_per</span><span class="s2">, </span><span class="s1">expected_per</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datetime_series</span><span class="s2">):</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">datetime_series</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">float</span><span class="s2">), </span><span class="s1">datetime_series</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>

        <span class="s1">ts_copy </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">ts_copy</span><span class="s2">[</span><span class="s5">5</span><span class="s2">:</span><span class="s5">10</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span>

        <span class="s1">linear_interp </span><span class="s2">= </span><span class="s1">ts_copy</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">linear_interp</span><span class="s2">, </span><span class="s1">ts</span><span class="s2">)</span>

        <span class="s1">ord_ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s1">d</span><span class="s2">.</span><span class="s1">toordinal</span><span class="s2">() </span><span class="s0">for </span><span class="s1">d </span><span class="s0">in </span><span class="s1">datetime_series</span><span class="s2">.</span><span class="s1">index</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">datetime_series</span><span class="s2">.</span><span class="s1">index</span>
        <span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">float</span><span class="s2">)</span>

        <span class="s1">ord_ts_copy </span><span class="s2">= </span><span class="s1">ord_ts</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">ord_ts_copy</span><span class="s2">[</span><span class="s5">5</span><span class="s2">:</span><span class="s5">10</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span>

        <span class="s1">time_interp </span><span class="s2">= </span><span class="s1">ord_ts_copy</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;time&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">time_interp</span><span class="s2">, </span><span class="s1">ord_ts</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_time_raises_for_non_timeseries</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># When method='time' is used on a non-TimeSeries that contains a null</span>
        <span class="s6"># value, a ValueError should be raised.</span>
        <span class="s1">non_ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;time-weighted interpolation only works on Series.* with a DatetimeIndex&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">non_ts</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;time&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_cubicspline</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">11</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">13</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">11.00</span><span class="s2">, </span><span class="s5">11.25</span><span class="s2">, </span><span class="s5">11.50</span><span class="s2">, </span><span class="s5">11.75</span><span class="s2">, </span><span class="s5">12.00</span><span class="s2">, </span><span class="s5">12.25</span><span class="s2">, </span><span class="s5">12.50</span><span class="s2">, </span><span class="s5">12.75</span><span class="s2">, </span><span class="s5">13.00</span><span class="s2">],</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">]),</span>
        <span class="s2">)</span>
        <span class="s6"># interpolate at new_index</span>
        <span class="s1">new_index </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">union</span><span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">])).</span><span class="s1">astype</span><span class="s2">(</span>
            <span class="s1">float</span>
        <span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">new_index</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;cubicspline&quot;</span><span class="s2">).</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">1</span><span class="s2">:</span><span class="s5">3</span><span class="s2">]</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_pchip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">sort</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s5">100</span><span class="s2">)))</span>

        <span class="s6"># interpolate at new_index</span>
        <span class="s1">new_index </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">union</span><span class="s2">(</span>
            <span class="s1">Index</span><span class="s2">([</span><span class="s5">49.25</span><span class="s2">, </span><span class="s5">49.5</span><span class="s2">, </span><span class="s5">49.75</span><span class="s2">, </span><span class="s5">50.25</span><span class="s2">, </span><span class="s5">50.5</span><span class="s2">, </span><span class="s5">50.75</span><span class="s2">])</span>
        <span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">float</span><span class="s2">)</span>
        <span class="s1">interp_s </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">new_index</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;pchip&quot;</span><span class="s2">)</span>
        <span class="s6"># does not blow up, GH5977</span>
        <span class="s1">interp_s</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">49</span><span class="s2">:</span><span class="s5">51</span><span class="s2">]</span>

    <span class="s0">def </span><span class="s1">test_interpolate_akima</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">11</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">13</span><span class="s2">])</span>

        <span class="s6"># interpolate at new_index where `der` is zero</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">11.00</span><span class="s2">, </span><span class="s5">11.25</span><span class="s2">, </span><span class="s5">11.50</span><span class="s2">, </span><span class="s5">11.75</span><span class="s2">, </span><span class="s5">12.00</span><span class="s2">, </span><span class="s5">12.25</span><span class="s2">, </span><span class="s5">12.50</span><span class="s2">, </span><span class="s5">12.75</span><span class="s2">, </span><span class="s5">13.00</span><span class="s2">],</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">]),</span>
        <span class="s2">)</span>
        <span class="s1">new_index </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">union</span><span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">])).</span><span class="s1">astype</span><span class="s2">(</span>
            <span class="s1">float</span>
        <span class="s2">)</span>
        <span class="s1">interp_s </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">new_index</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;akima&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">interp_s</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">1</span><span class="s2">:</span><span class="s5">3</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s6"># interpolate at new_index where `der` is a non-zero int</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">11.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">12.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">13.0</span><span class="s2">],</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">]),</span>
        <span class="s2">)</span>
        <span class="s1">new_index </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">union</span><span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">])).</span><span class="s1">astype</span><span class="s2">(</span>
            <span class="s1">float</span>
        <span class="s2">)</span>
        <span class="s1">interp_s </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">new_index</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;akima&quot;</span><span class="s2">, </span><span class="s1">der</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">interp_s</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">1</span><span class="s2">:</span><span class="s5">3</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_piecewise_polynomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">11</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">13</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">11.00</span><span class="s2">, </span><span class="s5">11.25</span><span class="s2">, </span><span class="s5">11.50</span><span class="s2">, </span><span class="s5">11.75</span><span class="s2">, </span><span class="s5">12.00</span><span class="s2">, </span><span class="s5">12.25</span><span class="s2">, </span><span class="s5">12.50</span><span class="s2">, </span><span class="s5">12.75</span><span class="s2">, </span><span class="s5">13.00</span><span class="s2">],</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">]),</span>
        <span class="s2">)</span>
        <span class="s6"># interpolate at new_index</span>
        <span class="s1">new_index </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">union</span><span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">])).</span><span class="s1">astype</span><span class="s2">(</span>
            <span class="s1">float</span>
        <span class="s2">)</span>
        <span class="s1">interp_s </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">new_index</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;piecewise_polynomial&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">interp_s</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">1</span><span class="s2">:</span><span class="s5">3</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_from_derivatives</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">10</span><span class="s2">, </span><span class="s5">11</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">13</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">11.00</span><span class="s2">, </span><span class="s5">11.25</span><span class="s2">, </span><span class="s5">11.50</span><span class="s2">, </span><span class="s5">11.75</span><span class="s2">, </span><span class="s5">12.00</span><span class="s2">, </span><span class="s5">12.25</span><span class="s2">, </span><span class="s5">12.50</span><span class="s2">, </span><span class="s5">12.75</span><span class="s2">, </span><span class="s5">13.00</span><span class="s2">],</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">]),</span>
        <span class="s2">)</span>
        <span class="s6"># interpolate at new_index</span>
        <span class="s1">new_index </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">union</span><span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">1.25</span><span class="s2">, </span><span class="s5">1.5</span><span class="s2">, </span><span class="s5">1.75</span><span class="s2">, </span><span class="s5">2.25</span><span class="s2">, </span><span class="s5">2.5</span><span class="s2">, </span><span class="s5">2.75</span><span class="s2">])).</span><span class="s1">astype</span><span class="s2">(</span>
            <span class="s1">float</span>
        <span class="s2">)</span>
        <span class="s1">interp_s </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">new_index</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;from_derivatives&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">interp_s</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">1</span><span class="s2">:</span><span class="s5">3</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;kwargs&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">{},</span>
            <span class="s1">pytest</span><span class="s2">.</span><span class="s1">param</span><span class="s2">(</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;polynomial&quot;</span><span class="s2">, </span><span class="s3">&quot;order&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">}, </span><span class="s1">marks</span><span class="s2">=</span><span class="s1">td</span><span class="s2">.</span><span class="s1">skip_if_no</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
            <span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_interpolate_corners</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">kwargs</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(**</span><span class="s1">kwargs</span><span class="s2">), </span><span class="s1">s</span><span class="s2">)</span>

        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">()</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(**</span><span class="s1">kwargs</span><span class="s2">), </span><span class="s1">s</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_index_values</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">sort</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">random</span><span class="s2">(</span><span class="s5">30</span><span class="s2">)))</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[::</span><span class="s5">3</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s5">10</span><span class="s2">)</span>

        <span class="s1">vals </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">values</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">float</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;index&quot;</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">bad </span><span class="s2">= </span><span class="s1">isna</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>
        <span class="s1">good </span><span class="s2">= ~</span><span class="s1">bad</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">interp</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">[</span><span class="s1">bad</span><span class="s2">], </span><span class="s1">vals</span><span class="s2">[</span><span class="s1">good</span><span class="s2">], </span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">[</span><span class="s1">good</span><span class="s2">]), </span><span class="s1">index</span><span class="s2">=</span><span class="s1">s</span><span class="s2">.</span><span class="s1">index</span><span class="s2">[</span><span class="s1">bad</span><span class="s2">]</span>
        <span class="s2">)</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">[</span><span class="s1">bad</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s6"># 'values' is synonymous with 'index' for the method kwarg</span>
        <span class="s1">other_result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;values&quot;</span><span class="s2">)</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">other_result</span><span class="s2">, </span><span class="s1">result</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">other_result</span><span class="s2">[</span><span class="s1">bad</span><span class="s2">], </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_non_ts</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">11</span><span class="s2">])</span>
        <span class="s1">msg </span><span class="s2">= (</span>
            <span class="s3">&quot;time-weighted interpolation only works on Series or DataFrames &quot;</span>
            <span class="s3">&quot;with a DatetimeIndex&quot;</span>
        <span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;time&quot;</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;kwargs&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">{},</span>
            <span class="s1">pytest</span><span class="s2">.</span><span class="s1">param</span><span class="s2">(</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;polynomial&quot;</span><span class="s2">, </span><span class="s3">&quot;order&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">}, </span><span class="s1">marks</span><span class="s2">=</span><span class="s1">td</span><span class="s2">.</span><span class="s1">skip_if_no</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
            <span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_nan_interpolate</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">kwargs</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(**</span><span class="s1">kwargs</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_nan_irregular_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">4</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">9</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">9</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_nan_str_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">list</span><span class="s2">(</span><span class="s3">&quot;abcd&quot;</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">list</span><span class="s2">(</span><span class="s3">&quot;abcd&quot;</span><span class="s2">))</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_quad</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">sq </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">16</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">sq</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;quadratic&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">16.0</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_scipy_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">25</span><span class="s2">])</span>
        <span class="s6"># slinear</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">7.5</span><span class="s2">, </span><span class="s5">12.0</span><span class="s2">, </span><span class="s5">18.5</span><span class="s2">, </span><span class="s5">25.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;slinear&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;The 'downcast' keyword in Series.interpolate is deprecated&quot;</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;slinear&quot;</span><span class="s2">, </span><span class="s1">downcast</span><span class="s2">=</span><span class="s3">&quot;infer&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s6"># nearest</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">25</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;nearest&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s3">&quot;float&quot;</span><span class="s2">))</span>

        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;nearest&quot;</span><span class="s2">, </span><span class="s1">downcast</span><span class="s2">=</span><span class="s3">&quot;infer&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s6"># zero</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">25</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;zero&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s3">&quot;float&quot;</span><span class="s2">))</span>

        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;zero&quot;</span><span class="s2">, </span><span class="s1">downcast</span><span class="s2">=</span><span class="s3">&quot;infer&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s6"># quadratic</span>
        <span class="s6"># GH #15662.</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">6.823529</span><span class="s2">, </span><span class="s5">12.0</span><span class="s2">, </span><span class="s5">18.058824</span><span class="s2">, </span><span class="s5">25.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;quadratic&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;quadratic&quot;</span><span class="s2">, </span><span class="s1">downcast</span><span class="s2">=</span><span class="s3">&quot;infer&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s6"># cubic</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">6.8</span><span class="s2">, </span><span class="s5">12.0</span><span class="s2">, </span><span class="s5">18.2</span><span class="s2">, </span><span class="s5">25.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;cubic&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_limit</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">11</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">2</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;limit&quot;</span><span class="s2">, [-</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_interpolate_invalid_nonpositive_limit</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">nontemporal_method</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">):</span>
        <span class="s6"># GH 9217: make sure limit is greater than zero.</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">4</span><span class="s2">])</span>
        <span class="s1">method</span><span class="s2">, </span><span class="s1">kwargs </span><span class="s2">= </span><span class="s1">nontemporal_method</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;Limit must be greater than 0&quot;</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">limit</span><span class="s2">=</span><span class="s1">limit</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_invalid_float_limit</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">nontemporal_method</span><span class="s2">):</span>
        <span class="s6"># GH 9217: make sure limit is an integer.</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">4</span><span class="s2">])</span>
        <span class="s1">method</span><span class="s2">, </span><span class="s1">kwargs </span><span class="s2">= </span><span class="s1">nontemporal_method</span>
        <span class="s1">limit </span><span class="s2">= </span><span class="s5">2.0</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;Limit must be an integer&quot;</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">limit</span><span class="s2">=</span><span class="s1">limit</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;invalid_method&quot;</span><span class="s2">, [</span><span class="s0">None</span><span class="s2">, </span><span class="s3">&quot;nonexistent_method&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_interp_invalid_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">invalid_method</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">25</span><span class="s2">])</span>

        <span class="s1">msg </span><span class="s2">= </span><span class="s3">f&quot;method must be one of.* Got '</span><span class="s0">{</span><span class="s1">invalid_method</span><span class="s0">}</span><span class="s3">' instead&quot;</span>
        <span class="s0">if </span><span class="s1">invalid_method </span><span class="s0">is None</span><span class="s2">:</span>
            <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;'method' should be a string, not None&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s1">invalid_method</span><span class="s2">)</span>

        <span class="s6"># When an invalid method and invalid limit (such as -1) are</span>
        <span class="s6"># provided, the error message reflects the invalid method.</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s1">invalid_method</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=-</span><span class="s5">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_invalid_method_and_value</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># GH#36624</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">25</span><span class="s2">])</span>

        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;'fill_value' is not a valid keyword for Series.interpolate&quot;</span>
        <span class="s1">msg2 </span><span class="s2">= </span><span class="s3">&quot;Series.interpolate with method=pad&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg2</span><span class="s2">):</span>
                <span class="s1">ser</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">fill_value</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;pad&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_limit_forward</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">11</span><span class="s2">])</span>

        <span class="s6"># Provide 'forward' (the default) explicitly here.</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">])</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;forward&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;FORWARD&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_unlimited</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># these test are for issue #16282 default Limit=None is unlimited</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;both&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;forward&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;backward&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_limit_bad_direction</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">11</span><span class="s2">])</span>

        <span class="s1">msg </span><span class="s2">= (</span>
            <span class="s3">r&quot;Invalid limit_direction: expecting one of \['forward', &quot;</span>
            <span class="s3">r&quot;'backward', 'both'\], got 'abc'&quot;</span>
        <span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;abc&quot;</span><span class="s2">)</span>

        <span class="s6"># raises an error even if no limit is specified.</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;abc&quot;</span><span class="s2">)</span>

    <span class="s6"># limit_area introduced GH #16284</span>
    <span class="s0">def </span><span class="s1">test_interp_limit_area</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># These tests are for issue #9218 -- fill NaNs in both directions.</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">6.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_area</span><span class="s2">=</span><span class="s3">&quot;inside&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]</span>
        <span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_area</span><span class="s2">=</span><span class="s3">&quot;inside&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">6.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span>
            <span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_area</span><span class="s2">=</span><span class="s3">&quot;inside&quot;</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;both&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span>
        <span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_area</span><span class="s2">=</span><span class="s3">&quot;outside&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]</span>
        <span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_area</span><span class="s2">=</span><span class="s3">&quot;outside&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span>
            <span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_area</span><span class="s2">=</span><span class="s3">&quot;outside&quot;</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;both&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span>
        <span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span>
            <span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_area</span><span class="s2">=</span><span class="s3">&quot;outside&quot;</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;backward&quot;</span>
        <span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s6"># raises an error even if limit type is wrong.</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">r&quot;Invalid limit_area: expecting one of \['inside', 'outside'\], got abc&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit_area</span><span class="s2">=</span><span class="s3">&quot;abc&quot;</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;method, limit_direction, expected&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span><span class="s3">&quot;pad&quot;</span><span class="s2">, </span><span class="s3">&quot;backward&quot;</span><span class="s2">, </span><span class="s3">&quot;forward&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">&quot;ffill&quot;</span><span class="s2">, </span><span class="s3">&quot;backward&quot;</span><span class="s2">, </span><span class="s3">&quot;forward&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">&quot;backfill&quot;</span><span class="s2">, </span><span class="s3">&quot;forward&quot;</span><span class="s2">, </span><span class="s3">&quot;backward&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">&quot;bfill&quot;</span><span class="s2">, </span><span class="s3">&quot;forward&quot;</span><span class="s2">, </span><span class="s3">&quot;backward&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">&quot;pad&quot;</span><span class="s2">, </span><span class="s3">&quot;both&quot;</span><span class="s2">, </span><span class="s3">&quot;forward&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">&quot;ffill&quot;</span><span class="s2">, </span><span class="s3">&quot;both&quot;</span><span class="s2">, </span><span class="s3">&quot;forward&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">&quot;backfill&quot;</span><span class="s2">, </span><span class="s3">&quot;both&quot;</span><span class="s2">, </span><span class="s3">&quot;backward&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s3">&quot;bfill&quot;</span><span class="s2">, </span><span class="s3">&quot;both&quot;</span><span class="s2">, </span><span class="s3">&quot;backward&quot;</span><span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_interp_limit_direction_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">method</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s6"># https://github.com/pandas-dev/pandas/pull/34746</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>

        <span class="s1">msg </span><span class="s2">= </span><span class="s3">f&quot;`limit_direction` must be '</span><span class="s0">{</span><span class="s1">expected</span><span class="s0">}</span><span class="s3">' for method `</span><span class="s0">{</span><span class="s1">method</span><span class="s0">}</span><span class="s3">`&quot;</span>
        <span class="s1">msg2 </span><span class="s2">= </span><span class="s3">&quot;Series.interpolate with method=&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg2</span><span class="s2">):</span>
                <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s1">limit_direction</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;data, expected_data, kwargs&quot;</span><span class="s2">,</span>
        <span class="s2">(</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;pad&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;inside&quot;</span><span class="s2">},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;pad&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;inside&quot;</span><span class="s2">, </span><span class="s3">&quot;limit&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;pad&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;outside&quot;</span><span class="s2">},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;pad&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;outside&quot;</span><span class="s2">, </span><span class="s3">&quot;limit&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;pad&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;outside&quot;</span><span class="s2">, </span><span class="s3">&quot;limit&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s1">range</span><span class="s2">(</span><span class="s5">5</span><span class="s2">),</span>
                <span class="s1">range</span><span class="s2">(</span><span class="s5">5</span><span class="s2">),</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;pad&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;outside&quot;</span><span class="s2">, </span><span class="s3">&quot;limit&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">},</span>
            <span class="s2">),</span>
        <span class="s2">),</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_interp_limit_area_with_pad</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">data</span><span class="s2">, </span><span class="s1">expected_data</span><span class="s2">, </span><span class="s1">kwargs</span><span class="s2">):</span>
        <span class="s6"># GH26796</span>

        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected_data</span><span class="s2">)</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Series.interpolate with method=pad&quot;</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(**</span><span class="s1">kwargs</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;data, expected_data, kwargs&quot;</span><span class="s2">,</span>
        <span class="s2">(</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;bfill&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;inside&quot;</span><span class="s2">},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;bfill&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;inside&quot;</span><span class="s2">, </span><span class="s3">&quot;limit&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;bfill&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;outside&quot;</span><span class="s2">},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">],</span>
                <span class="s2">{</span><span class="s3">&quot;method&quot;</span><span class="s2">: </span><span class="s3">&quot;bfill&quot;</span><span class="s2">, </span><span class="s3">&quot;limit_area&quot;</span><span class="s2">: </span><span class="s3">&quot;outside&quot;</span><span class="s2">, </span><span class="s3">&quot;limit&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">},</span>
            <span class="s2">),</span>
        <span class="s2">),</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_interp_limit_area_with_backfill</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">data</span><span class="s2">, </span><span class="s1">expected_data</span><span class="s2">, </span><span class="s1">kwargs</span><span class="s2">):</span>
        <span class="s6"># GH26796</span>

        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">expected_data</span><span class="s2">)</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Series.interpolate with method=bfill&quot;</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(**</span><span class="s1">kwargs</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_limit_direction</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># These tests are for issue #9218 -- fill NaNs in both directions.</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">11</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;backward&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;both&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s6"># Check that this works on a longer series of nans.</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">6.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">10.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">, </span><span class="s5">12.0</span><span class="s2">, </span><span class="s5">12.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;both&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">6.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">10.0</span><span class="s2">, </span><span class="s5">11.0</span><span class="s2">, </span><span class="s5">12.0</span><span class="s2">, </span><span class="s5">12.0</span><span class="s2">]</span>
        <span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;both&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_limit_to_ends</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># These test are for issue #10420 -- flow back to beginning.</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;backward&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">, </span><span class="s5">9.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;both&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_limit_before_ends</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># These test are for issue #11115 -- limit ends properly.</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;forward&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;backward&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;linear&quot;</span><span class="s2">, </span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">limit_direction</span><span class="s2">=</span><span class="s3">&quot;both&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_all_good</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;polynomial&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>

        <span class="s6"># non-scipy</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">()</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;check_scipy&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">param</span><span class="s2">(</span><span class="s0">True</span><span class="s2">, </span><span class="s1">marks</span><span class="s2">=</span><span class="s1">td</span><span class="s2">.</span><span class="s1">skip_if_no</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">))]</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_interp_multiIndex</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">check_scipy</span><span class="s2">):</span>
        <span class="s1">idx </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_tuples</span><span class="s2">([(</span><span class="s5">0</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">), (</span><span class="s5">1</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">), (</span><span class="s5">2</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">)])</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">idx</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">expected</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s5">2</span><span class="s2">] = </span><span class="s5">2</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">()</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Only `method=linear` interpolation is supported on MultiIndexes&quot;</span>
        <span class="s0">if </span><span class="s1">check_scipy</span><span class="s2">:</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
                <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;polynomial&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_nonmono_raise</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;krogh interpolation requires that the index be monotonic&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;krogh&quot;</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;method&quot;</span><span class="s2">, [</span><span class="s3">&quot;nearest&quot;</span><span class="s2">, </span><span class="s3">&quot;pad&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_interp_datetime64</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">method</span><span class="s2">, </span><span class="s1">tz_naive_fixture</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">date_range</span><span class="s2">(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">tz</span><span class="s2">=</span><span class="s1">tz_naive_fixture</span><span class="s2">)</span>
        <span class="s2">)</span>
        <span class="s1">warn </span><span class="s2">= </span><span class="s0">None if </span><span class="s1">method </span><span class="s2">== </span><span class="s3">&quot;nearest&quot; </span><span class="s0">else </span><span class="s1">FutureWarning</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Series.interpolate with method=pad is deprecated&quot;</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">warn</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">warn </span><span class="s0">is not None</span><span class="s2">:</span>
            <span class="s6"># check the &quot;use ffill instead&quot; is equivalent</span>
            <span class="s1">alt </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">ffill</span><span class="s2">()</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">alt</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">],</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">date_range</span><span class="s2">(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">tz</span><span class="s2">=</span><span class="s1">tz_naive_fixture</span><span class="s2">),</span>
        <span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_pad_datetime64tz_values</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># GH#27628 missing.interpolate_2d should handle datetimetz values</span>
        <span class="s1">dti </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s3">&quot;2015-04-05&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">tz</span><span class="s2">=</span><span class="s3">&quot;US/Central&quot;</span><span class="s2">)</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dti</span><span class="s2">)</span>
        <span class="s1">ser</span><span class="s2">[</span><span class="s5">1</span><span class="s2">] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span>

        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Series.interpolate with method=pad is deprecated&quot;</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;pad&quot;</span><span class="s2">)</span>
        <span class="s6"># check the &quot;use ffill instead&quot; is equivalent</span>
        <span class="s1">alt </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">ffill</span><span class="s2">()</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">alt</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">dti</span><span class="s2">)</span>
        <span class="s1">expected</span><span class="s2">[</span><span class="s5">1</span><span class="s2">] = </span><span class="s1">expected</span><span class="s2">[</span><span class="s5">0</span><span class="s2">]</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_limit_no_nans</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># GH 7173</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">limit</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">s</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;method&quot;</span><span class="s2">, [</span><span class="s3">&quot;polynomial&quot;</span><span class="s2">, </span><span class="s3">&quot;spline&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_no_order</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">method</span><span class="s2">):</span>
        <span class="s6"># see GH-10633, GH-24014</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;You must specify the order of the spline or polynomial&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;order&quot;</span><span class="s2">, [-</span><span class="s5">1</span><span class="s2">, -</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_interpolate_spline_invalid_order</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">order</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;order needs to be specified and greater than 0&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s1">order</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_spline</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">6.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_spline_extrapolate</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">6</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result3 </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">ext</span><span class="s2">=</span><span class="s5">3</span><span class="s2">)</span>
        <span class="s1">expected3 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">6.0</span><span class="s2">, </span><span class="s5">6.0</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result3</span><span class="s2">, </span><span class="s1">expected3</span><span class="s2">)</span>

        <span class="s1">result1 </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">ext</span><span class="s2">=</span><span class="s5">0</span><span class="s2">)</span>
        <span class="s1">expected1 </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">, </span><span class="s5">4.0</span><span class="s2">, </span><span class="s5">5.0</span><span class="s2">, </span><span class="s5">6.0</span><span class="s2">, </span><span class="s5">7.0</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result1</span><span class="s2">, </span><span class="s1">expected1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_spline_smooth</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5.1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">7</span><span class="s2">])</span>
        <span class="s0">assert </span><span class="s2">(</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">3</span><span class="s2">, </span><span class="s1">s</span><span class="s2">=</span><span class="s5">0</span><span class="s2">)[</span><span class="s5">5</span><span class="s2">]</span>
            <span class="s2">!= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">3</span><span class="s2">)[</span><span class="s5">5</span><span class="s2">]</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_spline_interpolation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># Explicit cast to float to avoid implicit cast when setting np.nan</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">10</span><span class="s2">) ** </span><span class="s5">2</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;float&quot;</span><span class="s2">)</span>
        <span class="s1">s</span><span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">integers</span><span class="s2">(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">3</span><span class="s2">)] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span>
        <span class="s1">result1 </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
        <span class="s1">expected1 </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;spline&quot;</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result1</span><span class="s2">, </span><span class="s1">expected1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interp_timedelta64</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># GH 6424</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">to_timedelta</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;time&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">to_timedelta</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]))</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s6"># test for non uniform spacing</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">to_timedelta</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s2">]))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;time&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">1.666667</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">to_timedelta</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s2">]))</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_interpolate_method_values</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># GH#1646</span>
        <span class="s1">rng </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s3">&quot;1/20/2000&quot;</span><span class="s2">, </span><span class="s1">freq</span><span class="s2">=</span><span class="s3">&quot;D&quot;</span><span class="s2">)</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">rng</span><span class="s2">)), </span><span class="s1">index</span><span class="s2">=</span><span class="s1">rng</span><span class="s2">)</span>

        <span class="s1">ts</span><span class="s2">[::</span><span class="s5">2</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;values&quot;</span><span class="s2">)</span>
        <span class="s1">exp </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">()</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">exp</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_interpolate_intraday</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># #1698</span>
        <span class="s1">index </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s3">&quot;1/1/2012&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">freq</span><span class="s2">=</span><span class="s3">&quot;12D&quot;</span><span class="s2">)</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">24</span><span class="s2">, </span><span class="s5">36</span><span class="s2">], </span><span class="s1">index</span><span class="s2">)</span>
        <span class="s1">new_index </span><span class="s2">= </span><span class="s1">index</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">index </span><span class="s2">+ </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">DateOffset</span><span class="s2">(</span><span class="s1">days</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)).</span><span class="s1">sort_values</span><span class="s2">()</span>

        <span class="s1">exp </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">new_index</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;time&quot;</span><span class="s2">)</span>

        <span class="s1">index </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s3">&quot;1/1/2012&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">freq</span><span class="s2">=</span><span class="s3">&quot;12h&quot;</span><span class="s2">)</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s5">24</span><span class="s2">, </span><span class="s5">36</span><span class="s2">], </span><span class="s1">index</span><span class="s2">)</span>
        <span class="s1">new_index </span><span class="s2">= </span><span class="s1">index</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">index </span><span class="s2">+ </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">DateOffset</span><span class="s2">(</span><span class="s1">hours</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)).</span><span class="s1">sort_values</span><span class="s2">()</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">new_index</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;time&quot;</span><span class="s2">)</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_numpy_array_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">exp</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;ind&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">],</span>
            <span class="s1">pd</span><span class="s2">.</span><span class="s1">period_range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">=</span><span class="s3">&quot;2019-01-01&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">4</span><span class="s2">),</span>
            <span class="s1">pd</span><span class="s2">.</span><span class="s1">interval_range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">end</span><span class="s2">=</span><span class="s5">4</span><span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_interp_non_timedelta_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">interp_methods_ind</span><span class="s2">, </span><span class="s1">ind</span><span class="s2">):</span>
        <span class="s6"># gh 21662</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">DataFrame</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">ind</span><span class="s2">)</span>

        <span class="s1">method</span><span class="s2">, </span><span class="s1">kwargs </span><span class="s2">= </span><span class="s1">interp_methods_ind</span>
        <span class="s0">if </span><span class="s1">method </span><span class="s2">== </span><span class="s3">&quot;pchip&quot;</span><span class="s2">:</span>
            <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">method </span><span class="s2">== </span><span class="s3">&quot;linear&quot;</span><span class="s2">:</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">[</span><span class="s5">0</span><span class="s2">].</span><span class="s1">interpolate</span><span class="s2">(**</span><span class="s1">kwargs</span><span class="s2">)</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">ind</span><span class="s2">)</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">expected_error </span><span class="s2">= (</span>
                <span class="s3">&quot;Index column must be numeric or datetime type when &quot;</span>
                <span class="s3">f&quot;using </span><span class="s0">{</span><span class="s1">method</span><span class="s0">} </span><span class="s3">method other than linear. &quot;</span>
                <span class="s3">&quot;Try setting a numeric or datetime index column before &quot;</span>
                <span class="s3">&quot;interpolating.&quot;</span>
            <span class="s2">)</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">expected_error</span><span class="s2">):</span>
                <span class="s1">df</span><span class="s2">[</span><span class="s5">0</span><span class="s2">].</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_timedelta_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">request</span><span class="s2">, </span><span class="s1">interp_methods_ind</span><span class="s2">):</span>
        <span class="s4">&quot;&quot;&quot; 
        Tests for non numerical index types  - object, period, timedelta 
        Note that all methods except time, index, nearest and values 
        are tested here. 
        &quot;&quot;&quot;</span>
        <span class="s6"># gh 21662</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">ind </span><span class="s2">= </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">timedelta_range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">=</span><span class="s5">1</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">4</span><span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">DataFrame</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">ind</span><span class="s2">)</span>

        <span class="s1">method</span><span class="s2">, </span><span class="s1">kwargs </span><span class="s2">= </span><span class="s1">interp_methods_ind</span>

        <span class="s0">if </span><span class="s1">method </span><span class="s0">in </span><span class="s2">{</span><span class="s3">&quot;cubic&quot;</span><span class="s2">, </span><span class="s3">&quot;zero&quot;</span><span class="s2">}:</span>
            <span class="s1">request</span><span class="s2">.</span><span class="s1">applymarker</span><span class="s2">(</span>
                <span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span>
                    <span class="s1">reason</span><span class="s2">=</span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">method</span><span class="s0">} </span><span class="s3">interpolation is not supported for TimedeltaIndex&quot;</span>
                <span class="s2">)</span>
            <span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">[</span><span class="s5">0</span><span class="s2">].</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">0.0</span><span class="s2">, </span><span class="s5">1.0</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s5">0</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">ind</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;ascending, expected_values&quot;</span><span class="s2">,</span>
        <span class="s2">[(</span><span class="s0">True</span><span class="s2">, [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">10</span><span class="s2">]), (</span><span class="s0">False</span><span class="s2">, [</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_interpolate_unsorted_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">ascending</span><span class="s2">, </span><span class="s1">expected_values</span><span class="s2">):</span>
        <span class="s6"># GH 21037</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">=[</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">10</span><span class="s2">, </span><span class="s5">9</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">sort_index</span><span class="s2">(</span><span class="s1">ascending</span><span class="s2">=</span><span class="s1">ascending</span><span class="s2">).</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;index&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">=</span><span class="s1">expected_values</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">expected_values</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">float</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_asfreq_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">msg2 </span><span class="s2">= </span><span class="s3">&quot;Series.interpolate with object dtype&quot;</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Invalid fill method&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg2</span><span class="s2">):</span>
                <span class="s1">ser</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;asfreq&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_interpolate_fill_value</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s6"># GH#54920</span>
        <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s3">&quot;scipy&quot;</span><span class="s2">)</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">interpolate</span><span class="s2">(</span><span class="s1">method</span><span class="s2">=</span><span class="s3">&quot;nearest&quot;</span><span class="s2">, </span><span class="s1">fill_value</span><span class="s2">=</span><span class="s5">0</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
</pre>
</body>
</html>