<html>
<head>
<title>getlimits.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #cf8e6d;}
.s5 { color: #2aacb8;}
.s6 { color: #7a7e85;}
.s7 { color: #a5c261;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
getlimits.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Machine limits for Float32 and Float64 and (long double) if available... 
 
&quot;&quot;&quot;</span>
<span class="s1">__all__ </span><span class="s2">= [</span><span class="s3">'finfo'</span><span class="s2">, </span><span class="s3">'iinfo'</span><span class="s2">]</span>

<span class="s4">import </span><span class="s1">warnings</span>

<span class="s4">from </span><span class="s2">..</span><span class="s1">_utils </span><span class="s4">import </span><span class="s1">set_module</span>
<span class="s4">from </span><span class="s2">.</span><span class="s1">_machar </span><span class="s4">import </span><span class="s1">MachAr</span>
<span class="s4">from </span><span class="s2">. </span><span class="s4">import </span><span class="s1">numeric</span>
<span class="s4">from </span><span class="s2">. </span><span class="s4">import </span><span class="s1">numerictypes </span><span class="s4">as </span><span class="s1">ntypes</span>
<span class="s4">from </span><span class="s2">.</span><span class="s1">numeric </span><span class="s4">import </span><span class="s1">array</span><span class="s2">, </span><span class="s1">inf</span><span class="s2">, </span><span class="s1">nan</span>
<span class="s4">from </span><span class="s2">.</span><span class="s1">umath </span><span class="s4">import </span><span class="s1">log10</span><span class="s2">, </span><span class="s1">exp2</span><span class="s2">, </span><span class="s1">nextafter</span><span class="s2">, </span><span class="s1">isnan</span>


<span class="s4">def </span><span class="s1">_fr0</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
    <span class="s0">&quot;&quot;&quot;fix rank-0 --&gt; rank-1&quot;&quot;&quot;</span>
    <span class="s4">if </span><span class="s1">a</span><span class="s2">.</span><span class="s1">ndim </span><span class="s2">== </span><span class="s5">0</span><span class="s2">:</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">a</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">a</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">= (</span><span class="s5">1</span><span class="s2">,)</span>
    <span class="s4">return </span><span class="s1">a</span>


<span class="s4">def </span><span class="s1">_fr1</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
    <span class="s0">&quot;&quot;&quot;fix rank &gt; 0 --&gt; rank-0&quot;&quot;&quot;</span>
    <span class="s4">if </span><span class="s1">a</span><span class="s2">.</span><span class="s1">size </span><span class="s2">== </span><span class="s5">1</span><span class="s2">:</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">a</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">a</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">= ()</span>
    <span class="s4">return </span><span class="s1">a</span>


<span class="s4">class </span><span class="s1">MachArLike</span><span class="s2">:</span>
    <span class="s0">&quot;&quot;&quot; Object to simulate MachAr instance &quot;&quot;&quot;</span>
    <span class="s4">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">ftype</span><span class="s2">, *, </span><span class="s1">eps</span><span class="s2">, </span><span class="s1">epsneg</span><span class="s2">, </span><span class="s1">huge</span><span class="s2">, </span><span class="s1">tiny</span><span class="s2">,</span>
                 <span class="s1">ibeta</span><span class="s2">, </span><span class="s1">smallest_subnormal</span><span class="s2">=</span><span class="s4">None</span><span class="s2">, **</span><span class="s1">kwargs</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">params </span><span class="s2">= </span><span class="s1">_MACHAR_PARAMS</span><span class="s2">[</span><span class="s1">ftype</span><span class="s2">]</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">ftype </span><span class="s2">= </span><span class="s1">ftype</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">title </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">params</span><span class="s2">[</span><span class="s3">'title'</span><span class="s2">]</span>
        <span class="s6"># Parameter types same as for discovered MachAr object.</span>
        <span class="s4">if not </span><span class="s1">smallest_subnormal</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">_smallest_subnormal </span><span class="s2">= </span><span class="s1">nextafter</span><span class="s2">(</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">ftype</span><span class="s2">(</span><span class="s5">0</span><span class="s2">), </span><span class="s1">self</span><span class="s2">.</span><span class="s1">ftype</span><span class="s2">(</span><span class="s5">1</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">self</span><span class="s2">.</span><span class="s1">ftype</span><span class="s2">)</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">_smallest_subnormal </span><span class="s2">= </span><span class="s1">smallest_subnormal</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">epsilon </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">eps </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_float</span><span class="s2">(</span><span class="s1">eps</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">epsneg </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_float</span><span class="s2">(</span><span class="s1">epsneg</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">xmax </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">huge </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_float</span><span class="s2">(</span><span class="s1">huge</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">xmin </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_float</span><span class="s2">(</span><span class="s1">tiny</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">smallest_normal </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tiny </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_float</span><span class="s2">(</span><span class="s1">tiny</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">ibeta </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">params</span><span class="s2">[</span><span class="s3">'itype'</span><span class="s2">](</span><span class="s1">ibeta</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">__dict__</span><span class="s2">.</span><span class="s1">update</span><span class="s2">(</span><span class="s1">kwargs</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">precision </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(-</span><span class="s1">log10</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">eps</span><span class="s2">))</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">resolution </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_float</span><span class="s2">(</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">_float_conv</span><span class="s2">(</span><span class="s5">10</span><span class="s2">) ** (-</span><span class="s1">self</span><span class="s2">.</span><span class="s1">precision</span><span class="s2">))</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_eps </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">eps</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_epsneg </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">epsneg</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_xmin </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">xmin</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_xmax </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">xmax</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_resolution </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">resolution</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_smallest_normal </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">xmin</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">property</span>
    <span class="s4">def </span><span class="s1">smallest_subnormal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Return the value for the smallest subnormal. 
 
        Returns 
        ------- 
        smallest_subnormal : float 
            value for the smallest subnormal. 
 
        Warns 
        ----- 
        UserWarning 
            If the calculated value for the smallest subnormal is zero. 
        &quot;&quot;&quot;</span>
        <span class="s6"># Check that the calculated value is not zero, in case it raises a</span>
        <span class="s6"># warning.</span>
        <span class="s1">value </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_smallest_subnormal</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">ftype</span><span class="s2">(</span><span class="s5">0</span><span class="s2">) == </span><span class="s1">value</span><span class="s2">:</span>
            <span class="s1">warnings</span><span class="s2">.</span><span class="s1">warn</span><span class="s2">(</span>
                <span class="s3">'The value of the smallest subnormal for {} type '</span>
                <span class="s3">'is zero.'</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">ftype</span><span class="s2">), </span><span class="s1">UserWarning</span><span class="s2">, </span><span class="s1">stacklevel</span><span class="s2">=</span><span class="s5">2</span><span class="s2">)</span>

        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_float</span><span class="s2">(</span><span class="s1">value</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">property</span>
    <span class="s4">def </span><span class="s1">_str_smallest_subnormal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Return the string representation of the smallest subnormal.&quot;&quot;&quot;</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_to_str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">smallest_subnormal</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">_float_to_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">value</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Converts float to float. 
 
        Parameters 
        ---------- 
        value : float 
            value to be converted. 
        &quot;&quot;&quot;</span>
        <span class="s4">return </span><span class="s1">_fr1</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">_float_conv</span><span class="s2">(</span><span class="s1">value</span><span class="s2">))</span>

    <span class="s4">def </span><span class="s1">_float_conv</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">value</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Converts float to conv. 
 
        Parameters 
        ---------- 
        value : float 
            value to be converted. 
        &quot;&quot;&quot;</span>
        <span class="s4">return </span><span class="s1">array</span><span class="s2">([</span><span class="s1">value</span><span class="s2">], </span><span class="s1">self</span><span class="s2">.</span><span class="s1">ftype</span><span class="s2">)</span>

    <span class="s4">def </span><span class="s1">_float_to_str</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">value</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Converts float to str. 
 
        Parameters 
        ---------- 
        value : float 
            value to be converted. 
        &quot;&quot;&quot;</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">params</span><span class="s2">[</span><span class="s3">'fmt'</span><span class="s2">] % </span><span class="s1">array</span><span class="s2">(</span><span class="s1">_fr0</span><span class="s2">(</span><span class="s1">value</span><span class="s2">)[</span><span class="s5">0</span><span class="s2">], </span><span class="s1">self</span><span class="s2">.</span><span class="s1">ftype</span><span class="s2">)</span>


<span class="s1">_convert_to_float </span><span class="s2">= {</span>
    <span class="s1">ntypes</span><span class="s2">.</span><span class="s1">csingle</span><span class="s2">: </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">single</span><span class="s2">,</span>
    <span class="s1">ntypes</span><span class="s2">.</span><span class="s1">complex128</span><span class="s2">: </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">,</span>
    <span class="s1">ntypes</span><span class="s2">.</span><span class="s1">clongdouble</span><span class="s2">: </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">longdouble</span>
    <span class="s2">}</span>

<span class="s6"># Parameters for creating MachAr / MachAr-like objects</span>
<span class="s1">_title_fmt </span><span class="s2">= </span><span class="s3">'numpy {} precision floating point number'</span>
<span class="s1">_MACHAR_PARAMS </span><span class="s2">= {</span>
    <span class="s1">ntypes</span><span class="s2">.</span><span class="s1">double</span><span class="s2">: </span><span class="s1">dict</span><span class="s2">(</span>
        <span class="s1">itype </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">,</span>
        <span class="s1">fmt </span><span class="s2">= </span><span class="s3">'%24.16e'</span><span class="s2">,</span>
        <span class="s1">title </span><span class="s2">= </span><span class="s1">_title_fmt</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s3">'double'</span><span class="s2">)),</span>
    <span class="s1">ntypes</span><span class="s2">.</span><span class="s1">single</span><span class="s2">: </span><span class="s1">dict</span><span class="s2">(</span>
        <span class="s1">itype </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">,</span>
        <span class="s1">fmt </span><span class="s2">= </span><span class="s3">'%15.7e'</span><span class="s2">,</span>
        <span class="s1">title </span><span class="s2">= </span><span class="s1">_title_fmt</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s3">'single'</span><span class="s2">)),</span>
    <span class="s1">ntypes</span><span class="s2">.</span><span class="s1">longdouble</span><span class="s2">: </span><span class="s1">dict</span><span class="s2">(</span>
        <span class="s1">itype </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">longlong</span><span class="s2">,</span>
        <span class="s1">fmt </span><span class="s2">= </span><span class="s3">'%s'</span><span class="s2">,</span>
        <span class="s1">title </span><span class="s2">= </span><span class="s1">_title_fmt</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s3">'long double'</span><span class="s2">)),</span>
    <span class="s1">ntypes</span><span class="s2">.</span><span class="s1">half</span><span class="s2">: </span><span class="s1">dict</span><span class="s2">(</span>
        <span class="s1">itype </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">int16</span><span class="s2">,</span>
        <span class="s1">fmt </span><span class="s2">= </span><span class="s3">'%12.5e'</span><span class="s2">,</span>
        <span class="s1">title </span><span class="s2">= </span><span class="s1">_title_fmt</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s3">'half'</span><span class="s2">))}</span>

<span class="s6"># Key to identify the floating point type.  Key is result of</span>
<span class="s6">#</span>
<span class="s6">#    ftype = np.longdouble        # or float64, float32, etc.</span>
<span class="s6">#    v = (ftype(-1.0) / ftype(10.0))</span>
<span class="s6">#    v.view(v.dtype.newbyteorder('&lt;')).tobytes()</span>
<span class="s6">#</span>
<span class="s6"># Uses division to work around deficiencies in strtold on some platforms.</span>
<span class="s6"># See:</span>
<span class="s6"># https://perl5.git.perl.org/perl.git/blob/3118d7d684b56cbeb702af874f4326683c45f045:/Configure</span>

<span class="s1">_KNOWN_TYPES </span><span class="s2">= {}</span>
<span class="s4">def </span><span class="s1">_register_type</span><span class="s2">(</span><span class="s1">machar</span><span class="s2">, </span><span class="s1">bytepat</span><span class="s2">):</span>
    <span class="s1">_KNOWN_TYPES</span><span class="s2">[</span><span class="s1">bytepat</span><span class="s2">] = </span><span class="s1">machar</span>


<span class="s1">_float_ma </span><span class="s2">= {}</span>


<span class="s4">def </span><span class="s1">_register_known_types</span><span class="s2">():</span>
    <span class="s6"># Known parameters for float16</span>
    <span class="s6"># See docstring of MachAr class for description of parameters.</span>
    <span class="s1">f16 </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">float16</span>
    <span class="s1">float16_ma </span><span class="s2">= </span><span class="s1">MachArLike</span><span class="s2">(</span><span class="s1">f16</span><span class="s2">,</span>
                            <span class="s1">machep</span><span class="s2">=-</span><span class="s5">10</span><span class="s2">,</span>
                            <span class="s1">negep</span><span class="s2">=-</span><span class="s5">11</span><span class="s2">,</span>
                            <span class="s1">minexp</span><span class="s2">=-</span><span class="s5">14</span><span class="s2">,</span>
                            <span class="s1">maxexp</span><span class="s2">=</span><span class="s5">16</span><span class="s2">,</span>
                            <span class="s1">it</span><span class="s2">=</span><span class="s5">10</span><span class="s2">,</span>
                            <span class="s1">iexp</span><span class="s2">=</span><span class="s5">5</span><span class="s2">,</span>
                            <span class="s1">ibeta</span><span class="s2">=</span><span class="s5">2</span><span class="s2">,</span>
                            <span class="s1">irnd</span><span class="s2">=</span><span class="s5">5</span><span class="s2">,</span>
                            <span class="s1">ngrd</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
                            <span class="s1">eps</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">f16</span><span class="s2">(-</span><span class="s5">10</span><span class="s2">)),</span>
                            <span class="s1">epsneg</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">f16</span><span class="s2">(-</span><span class="s5">11</span><span class="s2">)),</span>
                            <span class="s1">huge</span><span class="s2">=</span><span class="s1">f16</span><span class="s2">(</span><span class="s5">65504</span><span class="s2">),</span>
                            <span class="s1">tiny</span><span class="s2">=</span><span class="s1">f16</span><span class="s2">(</span><span class="s5">2 </span><span class="s2">** -</span><span class="s5">14</span><span class="s2">))</span>
    <span class="s1">_register_type</span><span class="s2">(</span><span class="s1">float16_ma</span><span class="s2">, </span><span class="s7">b'f</span><span class="s4">\xae</span><span class="s7">'</span><span class="s2">)</span>
    <span class="s1">_float_ma</span><span class="s2">[</span><span class="s5">16</span><span class="s2">] = </span><span class="s1">float16_ma</span>

    <span class="s6"># Known parameters for float32</span>
    <span class="s1">f32 </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">float32</span>
    <span class="s1">float32_ma </span><span class="s2">= </span><span class="s1">MachArLike</span><span class="s2">(</span><span class="s1">f32</span><span class="s2">,</span>
                            <span class="s1">machep</span><span class="s2">=-</span><span class="s5">23</span><span class="s2">,</span>
                            <span class="s1">negep</span><span class="s2">=-</span><span class="s5">24</span><span class="s2">,</span>
                            <span class="s1">minexp</span><span class="s2">=-</span><span class="s5">126</span><span class="s2">,</span>
                            <span class="s1">maxexp</span><span class="s2">=</span><span class="s5">128</span><span class="s2">,</span>
                            <span class="s1">it</span><span class="s2">=</span><span class="s5">23</span><span class="s2">,</span>
                            <span class="s1">iexp</span><span class="s2">=</span><span class="s5">8</span><span class="s2">,</span>
                            <span class="s1">ibeta</span><span class="s2">=</span><span class="s5">2</span><span class="s2">,</span>
                            <span class="s1">irnd</span><span class="s2">=</span><span class="s5">5</span><span class="s2">,</span>
                            <span class="s1">ngrd</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
                            <span class="s1">eps</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">f32</span><span class="s2">(-</span><span class="s5">23</span><span class="s2">)),</span>
                            <span class="s1">epsneg</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">f32</span><span class="s2">(-</span><span class="s5">24</span><span class="s2">)),</span>
                            <span class="s1">huge</span><span class="s2">=</span><span class="s1">f32</span><span class="s2">((</span><span class="s5">1 </span><span class="s2">- </span><span class="s5">2 </span><span class="s2">** -</span><span class="s5">24</span><span class="s2">) * </span><span class="s5">2</span><span class="s2">**</span><span class="s5">128</span><span class="s2">),</span>
                            <span class="s1">tiny</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">f32</span><span class="s2">(-</span><span class="s5">126</span><span class="s2">)))</span>
    <span class="s1">_register_type</span><span class="s2">(</span><span class="s1">float32_ma</span><span class="s2">, </span><span class="s7">b'</span><span class="s4">\xcd\xcc\xcc\xbd</span><span class="s7">'</span><span class="s2">)</span>
    <span class="s1">_float_ma</span><span class="s2">[</span><span class="s5">32</span><span class="s2">] = </span><span class="s1">float32_ma</span>

    <span class="s6"># Known parameters for float64</span>
    <span class="s1">f64 </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">float64</span>
    <span class="s1">epsneg_f64 </span><span class="s2">= </span><span class="s5">2.0 </span><span class="s2">** -</span><span class="s5">53.0</span>
    <span class="s1">tiny_f64 </span><span class="s2">= </span><span class="s5">2.0 </span><span class="s2">** -</span><span class="s5">1022.0</span>
    <span class="s1">float64_ma </span><span class="s2">= </span><span class="s1">MachArLike</span><span class="s2">(</span><span class="s1">f64</span><span class="s2">,</span>
                            <span class="s1">machep</span><span class="s2">=-</span><span class="s5">52</span><span class="s2">,</span>
                            <span class="s1">negep</span><span class="s2">=-</span><span class="s5">53</span><span class="s2">,</span>
                            <span class="s1">minexp</span><span class="s2">=-</span><span class="s5">1022</span><span class="s2">,</span>
                            <span class="s1">maxexp</span><span class="s2">=</span><span class="s5">1024</span><span class="s2">,</span>
                            <span class="s1">it</span><span class="s2">=</span><span class="s5">52</span><span class="s2">,</span>
                            <span class="s1">iexp</span><span class="s2">=</span><span class="s5">11</span><span class="s2">,</span>
                            <span class="s1">ibeta</span><span class="s2">=</span><span class="s5">2</span><span class="s2">,</span>
                            <span class="s1">irnd</span><span class="s2">=</span><span class="s5">5</span><span class="s2">,</span>
                            <span class="s1">ngrd</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
                            <span class="s1">eps</span><span class="s2">=</span><span class="s5">2.0 </span><span class="s2">** -</span><span class="s5">52.0</span><span class="s2">,</span>
                            <span class="s1">epsneg</span><span class="s2">=</span><span class="s1">epsneg_f64</span><span class="s2">,</span>
                            <span class="s1">huge</span><span class="s2">=(</span><span class="s5">1.0 </span><span class="s2">- </span><span class="s1">epsneg_f64</span><span class="s2">) / </span><span class="s1">tiny_f64 </span><span class="s2">* </span><span class="s1">f64</span><span class="s2">(</span><span class="s5">4</span><span class="s2">),</span>
                            <span class="s1">tiny</span><span class="s2">=</span><span class="s1">tiny_f64</span><span class="s2">)</span>
    <span class="s1">_register_type</span><span class="s2">(</span><span class="s1">float64_ma</span><span class="s2">, </span><span class="s7">b'</span><span class="s4">\x9a\x99\x99\x99\x99\x99\xb9\xbf</span><span class="s7">'</span><span class="s2">)</span>
    <span class="s1">_float_ma</span><span class="s2">[</span><span class="s5">64</span><span class="s2">] = </span><span class="s1">float64_ma</span>

    <span class="s6"># Known parameters for IEEE 754 128-bit binary float</span>
    <span class="s1">ld </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">longdouble</span>
    <span class="s1">epsneg_f128 </span><span class="s2">= </span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(-</span><span class="s5">113</span><span class="s2">))</span>
    <span class="s1">tiny_f128 </span><span class="s2">= </span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(-</span><span class="s5">16382</span><span class="s2">))</span>
    <span class="s6"># Ignore runtime error when this is not f128</span>
    <span class="s4">with </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">all</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">):</span>
        <span class="s1">huge_f128 </span><span class="s2">= (</span><span class="s1">ld</span><span class="s2">(</span><span class="s5">1</span><span class="s2">) - </span><span class="s1">epsneg_f128</span><span class="s2">) / </span><span class="s1">tiny_f128 </span><span class="s2">* </span><span class="s1">ld</span><span class="s2">(</span><span class="s5">4</span><span class="s2">)</span>
    <span class="s1">float128_ma </span><span class="s2">= </span><span class="s1">MachArLike</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">,</span>
                             <span class="s1">machep</span><span class="s2">=-</span><span class="s5">112</span><span class="s2">,</span>
                             <span class="s1">negep</span><span class="s2">=-</span><span class="s5">113</span><span class="s2">,</span>
                             <span class="s1">minexp</span><span class="s2">=-</span><span class="s5">16382</span><span class="s2">,</span>
                             <span class="s1">maxexp</span><span class="s2">=</span><span class="s5">16384</span><span class="s2">,</span>
                             <span class="s1">it</span><span class="s2">=</span><span class="s5">112</span><span class="s2">,</span>
                             <span class="s1">iexp</span><span class="s2">=</span><span class="s5">15</span><span class="s2">,</span>
                             <span class="s1">ibeta</span><span class="s2">=</span><span class="s5">2</span><span class="s2">,</span>
                             <span class="s1">irnd</span><span class="s2">=</span><span class="s5">5</span><span class="s2">,</span>
                             <span class="s1">ngrd</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
                             <span class="s1">eps</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(-</span><span class="s5">112</span><span class="s2">)),</span>
                             <span class="s1">epsneg</span><span class="s2">=</span><span class="s1">epsneg_f128</span><span class="s2">,</span>
                             <span class="s1">huge</span><span class="s2">=</span><span class="s1">huge_f128</span><span class="s2">,</span>
                             <span class="s1">tiny</span><span class="s2">=</span><span class="s1">tiny_f128</span><span class="s2">)</span>
    <span class="s6"># IEEE 754 128-bit binary float</span>
    <span class="s1">_register_type</span><span class="s2">(</span><span class="s1">float128_ma</span><span class="s2">,</span>
        <span class="s7">b'</span><span class="s4">\x9a\x99\x99\x99\x99\x99\x99\x99\x99\x99\x99\x99\x99\x99\xfb\xbf</span><span class="s7">'</span><span class="s2">)</span>
    <span class="s1">_float_ma</span><span class="s2">[</span><span class="s5">128</span><span class="s2">] = </span><span class="s1">float128_ma</span>

    <span class="s6"># Known parameters for float80 (Intel 80-bit extended precision)</span>
    <span class="s1">epsneg_f80 </span><span class="s2">= </span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(-</span><span class="s5">64</span><span class="s2">))</span>
    <span class="s1">tiny_f80 </span><span class="s2">= </span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(-</span><span class="s5">16382</span><span class="s2">))</span>
    <span class="s6"># Ignore runtime error when this is not f80</span>
    <span class="s4">with </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">all</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">):</span>
        <span class="s1">huge_f80 </span><span class="s2">= (</span><span class="s1">ld</span><span class="s2">(</span><span class="s5">1</span><span class="s2">) - </span><span class="s1">epsneg_f80</span><span class="s2">) / </span><span class="s1">tiny_f80 </span><span class="s2">* </span><span class="s1">ld</span><span class="s2">(</span><span class="s5">4</span><span class="s2">)</span>
    <span class="s1">float80_ma </span><span class="s2">= </span><span class="s1">MachArLike</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">,</span>
                            <span class="s1">machep</span><span class="s2">=-</span><span class="s5">63</span><span class="s2">,</span>
                            <span class="s1">negep</span><span class="s2">=-</span><span class="s5">64</span><span class="s2">,</span>
                            <span class="s1">minexp</span><span class="s2">=-</span><span class="s5">16382</span><span class="s2">,</span>
                            <span class="s1">maxexp</span><span class="s2">=</span><span class="s5">16384</span><span class="s2">,</span>
                            <span class="s1">it</span><span class="s2">=</span><span class="s5">63</span><span class="s2">,</span>
                            <span class="s1">iexp</span><span class="s2">=</span><span class="s5">15</span><span class="s2">,</span>
                            <span class="s1">ibeta</span><span class="s2">=</span><span class="s5">2</span><span class="s2">,</span>
                            <span class="s1">irnd</span><span class="s2">=</span><span class="s5">5</span><span class="s2">,</span>
                            <span class="s1">ngrd</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
                            <span class="s1">eps</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(-</span><span class="s5">63</span><span class="s2">)),</span>
                            <span class="s1">epsneg</span><span class="s2">=</span><span class="s1">epsneg_f80</span><span class="s2">,</span>
                            <span class="s1">huge</span><span class="s2">=</span><span class="s1">huge_f80</span><span class="s2">,</span>
                            <span class="s1">tiny</span><span class="s2">=</span><span class="s1">tiny_f80</span><span class="s2">)</span>
    <span class="s6"># float80, first 10 bytes containing actual storage</span>
    <span class="s1">_register_type</span><span class="s2">(</span><span class="s1">float80_ma</span><span class="s2">, </span><span class="s7">b'</span><span class="s4">\xcd\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xfb\xbf</span><span class="s7">'</span><span class="s2">)</span>
    <span class="s1">_float_ma</span><span class="s2">[</span><span class="s5">80</span><span class="s2">] = </span><span class="s1">float80_ma</span>

    <span class="s6"># Guessed / known parameters for double double; see:</span>
    <span class="s6"># https://en.wikipedia.org/wiki/Quadruple-precision_floating-point_format#Double-double_arithmetic</span>
    <span class="s6"># These numbers have the same exponent range as float64, but extended</span>
    <span class="s6"># number of digits in the significand.</span>
    <span class="s1">huge_dd </span><span class="s2">= </span><span class="s1">nextafter</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(</span><span class="s1">inf</span><span class="s2">), </span><span class="s1">ld</span><span class="s2">(</span><span class="s5">0</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">ld</span><span class="s2">)</span>
    <span class="s6"># As the smallest_normal in double double is so hard to calculate we set</span>
    <span class="s6"># it to NaN.</span>
    <span class="s1">smallest_normal_dd </span><span class="s2">= </span><span class="s1">nan</span>
    <span class="s6"># Leave the same value for the smallest subnormal as double</span>
    <span class="s1">smallest_subnormal_dd </span><span class="s2">= </span><span class="s1">ld</span><span class="s2">(</span><span class="s1">nextafter</span><span class="s2">(</span><span class="s5">0.</span><span class="s2">, </span><span class="s5">1.</span><span class="s2">))</span>
    <span class="s1">float_dd_ma </span><span class="s2">= </span><span class="s1">MachArLike</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">,</span>
                             <span class="s1">machep</span><span class="s2">=-</span><span class="s5">105</span><span class="s2">,</span>
                             <span class="s1">negep</span><span class="s2">=-</span><span class="s5">106</span><span class="s2">,</span>
                             <span class="s1">minexp</span><span class="s2">=-</span><span class="s5">1022</span><span class="s2">,</span>
                             <span class="s1">maxexp</span><span class="s2">=</span><span class="s5">1024</span><span class="s2">,</span>
                             <span class="s1">it</span><span class="s2">=</span><span class="s5">105</span><span class="s2">,</span>
                             <span class="s1">iexp</span><span class="s2">=</span><span class="s5">11</span><span class="s2">,</span>
                             <span class="s1">ibeta</span><span class="s2">=</span><span class="s5">2</span><span class="s2">,</span>
                             <span class="s1">irnd</span><span class="s2">=</span><span class="s5">5</span><span class="s2">,</span>
                             <span class="s1">ngrd</span><span class="s2">=</span><span class="s5">0</span><span class="s2">,</span>
                             <span class="s1">eps</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(-</span><span class="s5">105</span><span class="s2">)),</span>
                             <span class="s1">epsneg</span><span class="s2">=</span><span class="s1">exp2</span><span class="s2">(</span><span class="s1">ld</span><span class="s2">(-</span><span class="s5">106</span><span class="s2">)),</span>
                             <span class="s1">huge</span><span class="s2">=</span><span class="s1">huge_dd</span><span class="s2">,</span>
                             <span class="s1">tiny</span><span class="s2">=</span><span class="s1">smallest_normal_dd</span><span class="s2">,</span>
                             <span class="s1">smallest_subnormal</span><span class="s2">=</span><span class="s1">smallest_subnormal_dd</span><span class="s2">)</span>
    <span class="s6"># double double; low, high order (e.g. PPC 64)</span>
    <span class="s1">_register_type</span><span class="s2">(</span><span class="s1">float_dd_ma</span><span class="s2">,</span>
        <span class="s7">b'</span><span class="s4">\x9a\x99\x99\x99\x99\x99</span><span class="s7">Y&lt;</span><span class="s4">\x9a\x99\x99\x99\x99\x99\xb9\xbf</span><span class="s7">'</span><span class="s2">)</span>
    <span class="s6"># double double; high, low order (e.g. PPC 64 le)</span>
    <span class="s1">_register_type</span><span class="s2">(</span><span class="s1">float_dd_ma</span><span class="s2">,</span>
        <span class="s7">b'</span><span class="s4">\x9a\x99\x99\x99\x99\x99\xb9\xbf\x9a\x99\x99\x99\x99\x99</span><span class="s7">Y&lt;'</span><span class="s2">)</span>
    <span class="s1">_float_ma</span><span class="s2">[</span><span class="s3">'dd'</span><span class="s2">] = </span><span class="s1">float_dd_ma</span>


<span class="s4">def </span><span class="s1">_get_machar</span><span class="s2">(</span><span class="s1">ftype</span><span class="s2">):</span>
    <span class="s0">&quot;&quot;&quot; Get MachAr instance or MachAr-like instance 
 
    Get parameters for floating point type, by first trying signatures of 
    various known floating point types, then, if none match, attempting to 
    identify parameters by analysis. 
 
    Parameters 
    ---------- 
    ftype : class 
        Numpy floating point type class (e.g. ``np.float64``) 
 
    Returns 
    ------- 
    ma_like : instance of :class:`MachAr` or :class:`MachArLike` 
        Object giving floating point parameters for `ftype`. 
 
    Warns 
    ----- 
    UserWarning 
        If the binary signature of the float type is not in the dictionary of 
        known float types. 
    &quot;&quot;&quot;</span>
    <span class="s1">params </span><span class="s2">= </span><span class="s1">_MACHAR_PARAMS</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">ftype</span><span class="s2">)</span>
    <span class="s4">if </span><span class="s1">params </span><span class="s4">is None</span><span class="s2">:</span>
        <span class="s4">raise </span><span class="s1">ValueError</span><span class="s2">(</span><span class="s1">repr</span><span class="s2">(</span><span class="s1">ftype</span><span class="s2">))</span>
    <span class="s6"># Detect known / suspected types</span>
    <span class="s6"># ftype(-1.0) / ftype(10.0) is better than ftype('-0.1') because stold</span>
    <span class="s6"># may be deficient</span>
    <span class="s1">key </span><span class="s2">= (</span><span class="s1">ftype</span><span class="s2">(-</span><span class="s5">1.0</span><span class="s2">) / </span><span class="s1">ftype</span><span class="s2">(</span><span class="s5">10.</span><span class="s2">))</span>
    <span class="s1">key </span><span class="s2">= </span><span class="s1">key</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">key</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">newbyteorder</span><span class="s2">(</span><span class="s3">&quot;&lt;&quot;</span><span class="s2">)).</span><span class="s1">tobytes</span><span class="s2">()</span>
    <span class="s1">ma_like </span><span class="s2">= </span><span class="s4">None</span>
    <span class="s4">if </span><span class="s1">ftype </span><span class="s2">== </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">longdouble</span><span class="s2">:</span>
        <span class="s6"># Could be 80 bit == 10 byte extended precision, where last bytes can</span>
        <span class="s6"># be random garbage.</span>
        <span class="s6"># Comparing first 10 bytes to pattern first to avoid branching on the</span>
        <span class="s6"># random garbage.</span>
        <span class="s1">ma_like </span><span class="s2">= </span><span class="s1">_KNOWN_TYPES</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">key</span><span class="s2">[:</span><span class="s5">10</span><span class="s2">])</span>
    <span class="s4">if </span><span class="s1">ma_like </span><span class="s4">is None</span><span class="s2">:</span>
        <span class="s6"># see if the full key is known.</span>
        <span class="s1">ma_like </span><span class="s2">= </span><span class="s1">_KNOWN_TYPES</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">key</span><span class="s2">)</span>
    <span class="s4">if </span><span class="s1">ma_like </span><span class="s4">is None and </span><span class="s1">len</span><span class="s2">(</span><span class="s1">key</span><span class="s2">) == </span><span class="s5">16</span><span class="s2">:</span>
        <span class="s6"># machine limits could be f80 masquerading as np.float128,</span>
        <span class="s6"># find all keys with length 16 and make new dict, but make the keys</span>
        <span class="s6"># only 10 bytes long, the last bytes can be random garbage</span>
        <span class="s1">_kt </span><span class="s2">= {</span><span class="s1">k</span><span class="s2">[:</span><span class="s5">10</span><span class="s2">]: </span><span class="s1">v </span><span class="s4">for </span><span class="s1">k</span><span class="s2">, </span><span class="s1">v </span><span class="s4">in </span><span class="s1">_KNOWN_TYPES</span><span class="s2">.</span><span class="s1">items</span><span class="s2">() </span><span class="s4">if </span><span class="s1">len</span><span class="s2">(</span><span class="s1">k</span><span class="s2">) == </span><span class="s5">16</span><span class="s2">}</span>
        <span class="s1">ma_like </span><span class="s2">= </span><span class="s1">_kt</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">key</span><span class="s2">[:</span><span class="s5">10</span><span class="s2">])</span>
    <span class="s4">if </span><span class="s1">ma_like </span><span class="s4">is not None</span><span class="s2">:</span>
        <span class="s4">return </span><span class="s1">ma_like</span>
    <span class="s6"># Fall back to parameter discovery</span>
    <span class="s1">warnings</span><span class="s2">.</span><span class="s1">warn</span><span class="s2">(</span>
        <span class="s3">f'Signature </span><span class="s4">{</span><span class="s1">key</span><span class="s4">} </span><span class="s3">for </span><span class="s4">{</span><span class="s1">ftype</span><span class="s4">} </span><span class="s3">does not match any known type: '</span>
        <span class="s3">'falling back to type probe function.</span><span class="s4">\n</span><span class="s3">'</span>
        <span class="s3">'This warnings indicates broken support for the dtype!'</span><span class="s2">,</span>
        <span class="s1">UserWarning</span><span class="s2">, </span><span class="s1">stacklevel</span><span class="s2">=</span><span class="s5">2</span><span class="s2">)</span>
    <span class="s4">return </span><span class="s1">_discovered_machar</span><span class="s2">(</span><span class="s1">ftype</span><span class="s2">)</span>


<span class="s4">def </span><span class="s1">_discovered_machar</span><span class="s2">(</span><span class="s1">ftype</span><span class="s2">):</span>
    <span class="s0">&quot;&quot;&quot; Create MachAr instance with found information on float types 
 
    TODO: MachAr should be retired completely ideally.  We currently only 
          ever use it system with broken longdouble (valgrind, WSL). 
    &quot;&quot;&quot;</span>
    <span class="s1">params </span><span class="s2">= </span><span class="s1">_MACHAR_PARAMS</span><span class="s2">[</span><span class="s1">ftype</span><span class="s2">]</span>
    <span class="s4">return </span><span class="s1">MachAr</span><span class="s2">(</span><span class="s4">lambda </span><span class="s1">v</span><span class="s2">: </span><span class="s1">array</span><span class="s2">([</span><span class="s1">v</span><span class="s2">], </span><span class="s1">ftype</span><span class="s2">),</span>
                  <span class="s4">lambda </span><span class="s1">v</span><span class="s2">: </span><span class="s1">_fr0</span><span class="s2">(</span><span class="s1">v</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">params</span><span class="s2">[</span><span class="s3">'itype'</span><span class="s2">]))[</span><span class="s5">0</span><span class="s2">],</span>
                  <span class="s4">lambda </span><span class="s1">v</span><span class="s2">: </span><span class="s1">array</span><span class="s2">(</span><span class="s1">_fr0</span><span class="s2">(</span><span class="s1">v</span><span class="s2">)[</span><span class="s5">0</span><span class="s2">], </span><span class="s1">ftype</span><span class="s2">),</span>
                  <span class="s4">lambda </span><span class="s1">v</span><span class="s2">: </span><span class="s1">params</span><span class="s2">[</span><span class="s3">'fmt'</span><span class="s2">] % </span><span class="s1">array</span><span class="s2">(</span><span class="s1">_fr0</span><span class="s2">(</span><span class="s1">v</span><span class="s2">)[</span><span class="s5">0</span><span class="s2">], </span><span class="s1">ftype</span><span class="s2">),</span>
                  <span class="s1">params</span><span class="s2">[</span><span class="s3">'title'</span><span class="s2">])</span>


<span class="s2">@</span><span class="s1">set_module</span><span class="s2">(</span><span class="s3">'numpy'</span><span class="s2">)</span>
<span class="s4">class </span><span class="s1">finfo</span><span class="s2">:</span>
    <span class="s0">&quot;&quot;&quot; 
    finfo(dtype) 
 
    Machine limits for floating point types. 
 
    Attributes 
    ---------- 
    bits : int 
        The number of bits occupied by the type. 
    dtype : dtype 
        Returns the dtype for which `finfo` returns information. For complex 
        input, the returned dtype is the associated ``float*`` dtype for its 
        real and complex components. 
    eps : float 
        The difference between 1.0 and the next smallest representable float 
        larger than 1.0. For example, for 64-bit binary floats in the IEEE-754 
        standard, ``eps = 2**-52``, approximately 2.22e-16. 
    epsneg : float 
        The difference between 1.0 and the next smallest representable float 
        less than 1.0. For example, for 64-bit binary floats in the IEEE-754 
        standard, ``epsneg = 2**-53``, approximately 1.11e-16. 
    iexp : int 
        The number of bits in the exponent portion of the floating point 
        representation. 
    machep : int 
        The exponent that yields `eps`. 
    max : floating point number of the appropriate type 
        The largest representable number. 
    maxexp : int 
        The smallest positive power of the base (2) that causes overflow. 
    min : floating point number of the appropriate type 
        The smallest representable number, typically ``-max``. 
    minexp : int 
        The most negative power of the base (2) consistent with there 
        being no leading 0's in the mantissa. 
    negep : int 
        The exponent that yields `epsneg`. 
    nexp : int 
        The number of bits in the exponent including its sign and bias. 
    nmant : int 
        The number of bits in the mantissa. 
    precision : int 
        The approximate number of decimal digits to which this kind of 
        float is precise. 
    resolution : floating point number of the appropriate type 
        The approximate decimal resolution of this type, i.e., 
        ``10**-precision``. 
    tiny : float 
        An alias for `smallest_normal`, kept for backwards compatibility. 
    smallest_normal : float 
        The smallest positive floating point number with 1 as leading bit in 
        the mantissa following IEEE-754 (see Notes). 
    smallest_subnormal : float 
        The smallest positive floating point number with 0 as leading bit in 
        the mantissa following IEEE-754. 
 
    Parameters 
    ---------- 
    dtype : float, dtype, or instance 
        Kind of floating point or complex floating point 
        data-type about which to get information. 
 
    See Also 
    -------- 
    iinfo : The equivalent for integer data types. 
    spacing : The distance between a value and the nearest adjacent number 
    nextafter : The next floating point value after x1 towards x2 
 
    Notes 
    ----- 
    For developers of NumPy: do not instantiate this at the module level. 
    The initial calculation of these parameters is expensive and negatively 
    impacts import times.  These objects are cached, so calling ``finfo()`` 
    repeatedly inside your functions is not a problem. 
 
    Note that ``smallest_normal`` is not actually the smallest positive 
    representable value in a NumPy floating point type. As in the IEEE-754 
    standard [1]_, NumPy floating point types make use of subnormal numbers to 
    fill the gap between 0 and ``smallest_normal``. However, subnormal numbers 
    may have significantly reduced precision [2]_. 
 
    This function can also be used for complex data types as well. If used, 
    the output will be the same as the corresponding real float type 
    (e.g. numpy.finfo(numpy.csingle) is the same as numpy.finfo(numpy.single)). 
    However, the output is true for the real and imaginary components. 
 
    References 
    ---------- 
    .. [1] IEEE Standard for Floating-Point Arithmetic, IEEE Std 754-2008, 
           pp.1-70, 2008, https://doi.org/10.1109/IEEESTD.2008.4610935 
    .. [2] Wikipedia, &quot;Denormal Numbers&quot;, 
           https://en.wikipedia.org/wiki/Denormal_number 
 
    Examples 
    -------- 
    &gt;&gt;&gt; import numpy as np 
    &gt;&gt;&gt; np.finfo(np.float64).dtype 
    dtype('float64') 
    &gt;&gt;&gt; np.finfo(np.complex64).dtype 
    dtype('float32') 
 
    &quot;&quot;&quot;</span>

    <span class="s1">_finfo_cache </span><span class="s2">= {}</span>

    <span class="s4">def </span><span class="s1">__new__</span><span class="s2">(</span><span class="s1">cls</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
        <span class="s4">try</span><span class="s2">:</span>
            <span class="s1">obj </span><span class="s2">= </span><span class="s1">cls</span><span class="s2">.</span><span class="s1">_finfo_cache</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)  </span><span class="s6"># most common path</span>
            <span class="s4">if </span><span class="s1">obj </span><span class="s4">is not None</span><span class="s2">:</span>
                <span class="s4">return </span><span class="s1">obj</span>
        <span class="s4">except </span><span class="s1">TypeError</span><span class="s2">:</span>
            <span class="s4">pass</span>

        <span class="s4">if </span><span class="s1">dtype </span><span class="s4">is None</span><span class="s2">:</span>
            <span class="s6"># Deprecated in NumPy 1.25, 2023-01-16</span>
            <span class="s1">warnings</span><span class="s2">.</span><span class="s1">warn</span><span class="s2">(</span>
                <span class="s3">&quot;finfo() dtype cannot be None. This behavior will &quot;</span>
                <span class="s3">&quot;raise an error in the future. (Deprecated in NumPy 1.25)&quot;</span><span class="s2">,</span>
                <span class="s1">DeprecationWarning</span><span class="s2">,</span>
                <span class="s1">stacklevel</span><span class="s2">=</span><span class="s5">2</span>
            <span class="s2">)</span>

        <span class="s4">try</span><span class="s2">:</span>
            <span class="s1">dtype </span><span class="s2">= </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s4">except </span><span class="s1">TypeError</span><span class="s2">:</span>
            <span class="s6"># In case a float instance was given</span>
            <span class="s1">dtype </span><span class="s2">= </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">type</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">))</span>

        <span class="s1">obj </span><span class="s2">= </span><span class="s1">cls</span><span class="s2">.</span><span class="s1">_finfo_cache</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">obj </span><span class="s4">is not None</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">obj</span>
        <span class="s1">dtypes </span><span class="s2">= [</span><span class="s1">dtype</span><span class="s2">]</span>
        <span class="s1">newdtype </span><span class="s2">= </span><span class="s1">ntypes</span><span class="s2">.</span><span class="s1">obj2sctype</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">newdtype </span><span class="s4">is not </span><span class="s1">dtype</span><span class="s2">:</span>
            <span class="s1">dtypes</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">newdtype</span><span class="s2">)</span>
            <span class="s1">dtype </span><span class="s2">= </span><span class="s1">newdtype</span>
        <span class="s4">if not </span><span class="s1">issubclass</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">inexact</span><span class="s2">):</span>
            <span class="s4">raise </span><span class="s1">ValueError</span><span class="s2">(</span><span class="s3">&quot;data type %r not inexact&quot; </span><span class="s2">% (</span><span class="s1">dtype</span><span class="s2">))</span>
        <span class="s1">obj </span><span class="s2">= </span><span class="s1">cls</span><span class="s2">.</span><span class="s1">_finfo_cache</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">obj </span><span class="s4">is not None</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s1">obj</span>
        <span class="s4">if not </span><span class="s1">issubclass</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">floating</span><span class="s2">):</span>
            <span class="s1">newdtype </span><span class="s2">= </span><span class="s1">_convert_to_float</span><span class="s2">[</span><span class="s1">dtype</span><span class="s2">]</span>
            <span class="s4">if </span><span class="s1">newdtype </span><span class="s4">is not </span><span class="s1">dtype</span><span class="s2">:</span>
                <span class="s6"># dtype changed, for example from complex128 to float64</span>
                <span class="s1">dtypes</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s1">newdtype</span><span class="s2">)</span>
                <span class="s1">dtype </span><span class="s2">= </span><span class="s1">newdtype</span>

                <span class="s1">obj </span><span class="s2">= </span><span class="s1">cls</span><span class="s2">.</span><span class="s1">_finfo_cache</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">, </span><span class="s4">None</span><span class="s2">)</span>
                <span class="s4">if </span><span class="s1">obj </span><span class="s4">is not None</span><span class="s2">:</span>
                    <span class="s6"># the original dtype was not in the cache, but the new</span>
                    <span class="s6"># dtype is in the cache. we add the original dtypes to</span>
                    <span class="s6"># the cache and return the result</span>
                    <span class="s4">for </span><span class="s1">dt </span><span class="s4">in </span><span class="s1">dtypes</span><span class="s2">:</span>
                        <span class="s1">cls</span><span class="s2">.</span><span class="s1">_finfo_cache</span><span class="s2">[</span><span class="s1">dt</span><span class="s2">] = </span><span class="s1">obj</span>
                    <span class="s4">return </span><span class="s1">obj</span>
        <span class="s1">obj </span><span class="s2">= </span><span class="s1">object</span><span class="s2">.</span><span class="s1">__new__</span><span class="s2">(</span><span class="s1">cls</span><span class="s2">).</span><span class="s1">_init</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s4">for </span><span class="s1">dt </span><span class="s4">in </span><span class="s1">dtypes</span><span class="s2">:</span>
            <span class="s1">cls</span><span class="s2">.</span><span class="s1">_finfo_cache</span><span class="s2">[</span><span class="s1">dt</span><span class="s2">] = </span><span class="s1">obj</span>
        <span class="s4">return </span><span class="s1">obj</span>

    <span class="s4">def </span><span class="s1">_init</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">= </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s1">machar </span><span class="s2">= </span><span class="s1">_get_machar</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>

        <span class="s4">for </span><span class="s1">word </span><span class="s4">in </span><span class="s2">[</span><span class="s3">'precision'</span><span class="s2">, </span><span class="s3">'iexp'</span><span class="s2">,</span>
                     <span class="s3">'maxexp'</span><span class="s2">, </span><span class="s3">'minexp'</span><span class="s2">, </span><span class="s3">'negep'</span><span class="s2">,</span>
                     <span class="s3">'machep'</span><span class="s2">]:</span>
            <span class="s1">setattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">word</span><span class="s2">, </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">machar</span><span class="s2">, </span><span class="s1">word</span><span class="s2">))</span>
        <span class="s4">for </span><span class="s1">word </span><span class="s4">in </span><span class="s2">[</span><span class="s3">'resolution'</span><span class="s2">, </span><span class="s3">'epsneg'</span><span class="s2">, </span><span class="s3">'smallest_subnormal'</span><span class="s2">]:</span>
            <span class="s1">setattr</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">word</span><span class="s2">, </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">machar</span><span class="s2">, </span><span class="s1">word</span><span class="s2">).</span><span class="s1">flat</span><span class="s2">[</span><span class="s5">0</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">bits </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">itemsize </span><span class="s2">* </span><span class="s5">8</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">max </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">huge</span><span class="s2">.</span><span class="s1">flat</span><span class="s2">[</span><span class="s5">0</span><span class="s2">]</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">min </span><span class="s2">= -</span><span class="s1">self</span><span class="s2">.</span><span class="s1">max</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">eps </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">eps</span><span class="s2">.</span><span class="s1">flat</span><span class="s2">[</span><span class="s5">0</span><span class="s2">]</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">nexp </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">iexp</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">nmant </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">it</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_machar </span><span class="s2">= </span><span class="s1">machar</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_tiny </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">_str_xmin</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_max </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">_str_xmax</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_epsneg </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">_str_epsneg</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_eps </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">_str_eps</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_resolution </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">_str_resolution</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_smallest_normal </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">_str_smallest_normal</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">_str_smallest_subnormal </span><span class="s2">= </span><span class="s1">machar</span><span class="s2">.</span><span class="s1">_str_smallest_subnormal</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">()</span>
        <span class="s4">return </span><span class="s1">self</span>

    <span class="s4">def </span><span class="s1">__str__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">fmt </span><span class="s2">= (</span>
            <span class="s3">'Machine parameters for %(dtype)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'---------------------------------------------------------------</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'precision = %(precision)3s   resolution = %(_str_resolution)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'machep = %(machep)6s   eps =        %(_str_eps)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'negep =  %(negep)6s   epsneg =     %(_str_epsneg)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'minexp = %(minexp)6s   tiny =       %(_str_tiny)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'maxexp = %(maxexp)6s   max =        %(_str_max)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'nexp =   %(nexp)6s   min =        -max</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'smallest_normal = %(_str_smallest_normal)s   '</span>
            <span class="s3">'smallest_subnormal = %(_str_smallest_subnormal)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'---------------------------------------------------------------</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s2">)</span>
        <span class="s4">return </span><span class="s1">fmt </span><span class="s2">% </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__dict__</span>

    <span class="s4">def </span><span class="s1">__repr__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">c </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__class__</span><span class="s2">.</span><span class="s1">__name__</span>
        <span class="s1">d </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">__dict__</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">d</span><span class="s2">[</span><span class="s3">'klass'</span><span class="s2">] = </span><span class="s1">c</span>
        <span class="s4">return </span><span class="s2">((</span><span class="s3">&quot;%(klass)s(resolution=%(resolution)s, min=-%(_str_max)s,&quot;</span>
                 <span class="s3">&quot; max=%(_str_max)s, dtype=%(dtype)s)&quot;</span><span class="s2">) % </span><span class="s1">d</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">property</span>
    <span class="s4">def </span><span class="s1">smallest_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Return the value for the smallest normal. 
 
        Returns 
        ------- 
        smallest_normal : float 
            Value for the smallest normal. 
 
        Warns 
        ----- 
        UserWarning 
            If the calculated value for the smallest normal is requested for 
            double-double. 
        &quot;&quot;&quot;</span>
        <span class="s6"># This check is necessary because the value for smallest_normal is</span>
        <span class="s6"># platform dependent for longdouble types.</span>
        <span class="s4">if </span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">_machar</span><span class="s2">.</span><span class="s1">smallest_normal</span><span class="s2">.</span><span class="s1">flat</span><span class="s2">[</span><span class="s5">0</span><span class="s2">]):</span>
            <span class="s1">warnings</span><span class="s2">.</span><span class="s1">warn</span><span class="s2">(</span>
                <span class="s3">'The value of smallest normal is undefined for double double'</span><span class="s2">,</span>
                <span class="s1">UserWarning</span><span class="s2">, </span><span class="s1">stacklevel</span><span class="s2">=</span><span class="s5">2</span><span class="s2">)</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">_machar</span><span class="s2">.</span><span class="s1">smallest_normal</span><span class="s2">.</span><span class="s1">flat</span><span class="s2">[</span><span class="s5">0</span><span class="s2">]</span>

    <span class="s2">@</span><span class="s1">property</span>
    <span class="s4">def </span><span class="s1">tiny</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Return the value for tiny, alias of smallest_normal. 
 
        Returns 
        ------- 
        tiny : float 
            Value for the smallest normal, alias of smallest_normal. 
 
        Warns 
        ----- 
        UserWarning 
            If the calculated value for the smallest normal is requested for 
            double-double. 
        &quot;&quot;&quot;</span>
        <span class="s4">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">smallest_normal</span>


<span class="s2">@</span><span class="s1">set_module</span><span class="s2">(</span><span class="s3">'numpy'</span><span class="s2">)</span>
<span class="s4">class </span><span class="s1">iinfo</span><span class="s2">:</span>
    <span class="s0">&quot;&quot;&quot; 
    iinfo(type) 
 
    Machine limits for integer types. 
 
    Attributes 
    ---------- 
    bits : int 
        The number of bits occupied by the type. 
    dtype : dtype 
        Returns the dtype for which `iinfo` returns information. 
    min : int 
        The smallest integer expressible by the type. 
    max : int 
        The largest integer expressible by the type. 
 
    Parameters 
    ---------- 
    int_type : integer type, dtype, or instance 
        The kind of integer data type to get information about. 
 
    See Also 
    -------- 
    finfo : The equivalent for floating point data types. 
 
    Examples 
    -------- 
    With types: 
 
    &gt;&gt;&gt; import numpy as np 
    &gt;&gt;&gt; ii16 = np.iinfo(np.int16) 
    &gt;&gt;&gt; ii16.min 
    -32768 
    &gt;&gt;&gt; ii16.max 
    32767 
    &gt;&gt;&gt; ii32 = np.iinfo(np.int32) 
    &gt;&gt;&gt; ii32.min 
    -2147483648 
    &gt;&gt;&gt; ii32.max 
    2147483647 
 
    With instances: 
 
    &gt;&gt;&gt; ii32 = np.iinfo(np.int32(10)) 
    &gt;&gt;&gt; ii32.min 
    -2147483648 
    &gt;&gt;&gt; ii32.max 
    2147483647 
 
    &quot;&quot;&quot;</span>

    <span class="s1">_min_vals </span><span class="s2">= {}</span>
    <span class="s1">_max_vals </span><span class="s2">= {}</span>

    <span class="s4">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">int_type</span><span class="s2">):</span>
        <span class="s4">try</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">= </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">int_type</span><span class="s2">)</span>
        <span class="s4">except </span><span class="s1">TypeError</span><span class="s2">:</span>
            <span class="s1">self</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">= </span><span class="s1">numeric</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">type</span><span class="s2">(</span><span class="s1">int_type</span><span class="s2">))</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">kind </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">kind</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">bits </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">itemsize </span><span class="s2">* </span><span class="s5">8</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">key </span><span class="s2">= </span><span class="s3">&quot;%s%d&quot; </span><span class="s2">% (</span><span class="s1">self</span><span class="s2">.</span><span class="s1">kind</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">bits</span><span class="s2">)</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">kind </span><span class="s4">not in </span><span class="s3">'iu'</span><span class="s2">:</span>
            <span class="s4">raise </span><span class="s1">ValueError</span><span class="s2">(</span><span class="s3">&quot;Invalid integer data type %r.&quot; </span><span class="s2">% (</span><span class="s1">self</span><span class="s2">.</span><span class="s1">kind</span><span class="s2">,))</span>

    <span class="s2">@</span><span class="s1">property</span>
    <span class="s4">def </span><span class="s1">min</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Minimum value of given dtype.&quot;&quot;&quot;</span>
        <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">kind </span><span class="s2">== </span><span class="s3">'u'</span><span class="s2">:</span>
            <span class="s4">return </span><span class="s5">0</span>
        <span class="s4">else</span><span class="s2">:</span>
            <span class="s4">try</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">iinfo</span><span class="s2">.</span><span class="s1">_min_vals</span><span class="s2">[</span><span class="s1">self</span><span class="s2">.</span><span class="s1">key</span><span class="s2">]</span>
            <span class="s4">except </span><span class="s1">KeyError</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">int</span><span class="s2">(-(</span><span class="s5">1 </span><span class="s2">&lt;&lt; (</span><span class="s1">self</span><span class="s2">.</span><span class="s1">bits</span><span class="s2">-</span><span class="s5">1</span><span class="s2">)))</span>
                <span class="s1">iinfo</span><span class="s2">.</span><span class="s1">_min_vals</span><span class="s2">[</span><span class="s1">self</span><span class="s2">.</span><span class="s1">key</span><span class="s2">] = </span><span class="s1">val</span>
            <span class="s4">return </span><span class="s1">val</span>

    <span class="s2">@</span><span class="s1">property</span>
    <span class="s4">def </span><span class="s1">max</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;Maximum value of given dtype.&quot;&quot;&quot;</span>
        <span class="s4">try</span><span class="s2">:</span>
            <span class="s1">val </span><span class="s2">= </span><span class="s1">iinfo</span><span class="s2">.</span><span class="s1">_max_vals</span><span class="s2">[</span><span class="s1">self</span><span class="s2">.</span><span class="s1">key</span><span class="s2">]</span>
        <span class="s4">except </span><span class="s1">KeyError</span><span class="s2">:</span>
            <span class="s4">if </span><span class="s1">self</span><span class="s2">.</span><span class="s1">kind </span><span class="s2">== </span><span class="s3">'u'</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">int</span><span class="s2">((</span><span class="s5">1 </span><span class="s2">&lt;&lt; </span><span class="s1">self</span><span class="s2">.</span><span class="s1">bits</span><span class="s2">) - </span><span class="s5">1</span><span class="s2">)</span>
            <span class="s4">else</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">int</span><span class="s2">((</span><span class="s5">1 </span><span class="s2">&lt;&lt; (</span><span class="s1">self</span><span class="s2">.</span><span class="s1">bits</span><span class="s2">-</span><span class="s5">1</span><span class="s2">)) - </span><span class="s5">1</span><span class="s2">)</span>
            <span class="s1">iinfo</span><span class="s2">.</span><span class="s1">_max_vals</span><span class="s2">[</span><span class="s1">self</span><span class="s2">.</span><span class="s1">key</span><span class="s2">] = </span><span class="s1">val</span>
        <span class="s4">return </span><span class="s1">val</span>

    <span class="s4">def </span><span class="s1">__str__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">&quot;&quot;&quot;String representation.&quot;&quot;&quot;</span>
        <span class="s1">fmt </span><span class="s2">= (</span>
            <span class="s3">'Machine parameters for %(dtype)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'---------------------------------------------------------------</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'min = %(min)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'max = %(max)s</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s3">'---------------------------------------------------------------</span><span class="s4">\n</span><span class="s3">'</span>
            <span class="s2">)</span>
        <span class="s4">return </span><span class="s1">fmt </span><span class="s2">% {</span><span class="s3">'dtype'</span><span class="s2">: </span><span class="s1">self</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">, </span><span class="s3">'min'</span><span class="s2">: </span><span class="s1">self</span><span class="s2">.</span><span class="s1">min</span><span class="s2">, </span><span class="s3">'max'</span><span class="s2">: </span><span class="s1">self</span><span class="s2">.</span><span class="s1">max</span><span class="s2">}</span>

    <span class="s4">def </span><span class="s1">__repr__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s4">return </span><span class="s3">&quot;%s(min=%s, max=%s, dtype=%s)&quot; </span><span class="s2">% (</span><span class="s1">self</span><span class="s2">.</span><span class="s1">__class__</span><span class="s2">.</span><span class="s1">__name__</span><span class="s2">,</span>
                                    <span class="s1">self</span><span class="s2">.</span><span class="s1">min</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">max</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">)</span>
</pre>
</body>
</html>