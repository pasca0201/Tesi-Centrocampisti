<html>
<head>
<title>test_orthogonal.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #6aab73;}
.s5 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_orthogonal.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">array</span><span class="s2">, </span><span class="s1">sqrt</span>
<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">testing </span><span class="s0">import </span><span class="s2">(</span><span class="s1">assert_array_almost_equal</span><span class="s2">, </span><span class="s1">assert_equal</span><span class="s2">,</span>
                           <span class="s1">assert_almost_equal</span><span class="s2">, </span><span class="s1">assert_allclose</span><span class="s2">)</span>
<span class="s0">from </span><span class="s1">pytest </span><span class="s0">import </span><span class="s1">raises </span><span class="s0">as </span><span class="s1">assert_raises</span>

<span class="s0">from </span><span class="s1">scipy </span><span class="s0">import </span><span class="s1">integrate</span>
<span class="s0">import </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">special </span><span class="s0">as </span><span class="s1">sc</span>
<span class="s0">from </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">special </span><span class="s0">import </span><span class="s1">gamma</span>
<span class="s0">import </span><span class="s1">scipy</span><span class="s2">.</span><span class="s1">special</span><span class="s2">.</span><span class="s1">_orthogonal </span><span class="s0">as </span><span class="s1">orth</span>


<span class="s0">class </span><span class="s1">TestCheby</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_chebyc</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">C0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyc</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">C1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyc</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">all</span><span class="s2">=</span><span class="s4">'ignore'</span><span class="s2">):</span>
            <span class="s1">C2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyc</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
            <span class="s1">C3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyc</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
            <span class="s1">C4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyc</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
            <span class="s1">C5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyc</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>

        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">C0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">2</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">C1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">C2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">2</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">C3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">3</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">C4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">4</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">2</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">C5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">5</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">5</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chebys</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">S0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebys</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">S1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebys</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">S2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebys</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">S3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebys</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">S4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebys</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">S5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebys</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">S0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">S1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">S2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">S3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">2</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">S4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">3</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">S5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">4</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">3</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chebyt</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">T0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">T1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">T2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">T3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">T4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">T5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">T0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">T1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">T2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">2</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">T3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">4</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">3</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">T4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">8</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">8</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">T5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">16</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">20</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">5</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chebyu</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">U0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">U1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">U2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">U3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">U4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">U5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">U0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">U1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">2</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">U2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">4</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">U3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">8</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">4</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">U4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">16</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">12</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">U5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">32</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">32</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">6</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestGegenbauer</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">test_gegenbauer</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s3">5</span><span class="s2">*</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">() - </span><span class="s3">0.5</span>
        <span class="s0">if </span><span class="s1">np</span><span class="s2">.</span><span class="s1">any</span><span class="s2">(</span><span class="s1">a </span><span class="s2">== </span><span class="s3">0</span><span class="s2">):</span>
            <span class="s1">a </span><span class="s2">= -</span><span class="s3">0.2</span>
        <span class="s1">Ca0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">gegenbauer</span><span class="s2">(</span><span class="s3">0</span><span class="s2">,</span><span class="s1">a</span><span class="s2">)</span>
        <span class="s1">Ca1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">gegenbauer</span><span class="s2">(</span><span class="s3">1</span><span class="s2">,</span><span class="s1">a</span><span class="s2">)</span>
        <span class="s1">Ca2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">gegenbauer</span><span class="s2">(</span><span class="s3">2</span><span class="s2">,</span><span class="s1">a</span><span class="s2">)</span>
        <span class="s1">Ca3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">gegenbauer</span><span class="s2">(</span><span class="s3">3</span><span class="s2">,</span><span class="s1">a</span><span class="s2">)</span>
        <span class="s1">Ca4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">gegenbauer</span><span class="s2">(</span><span class="s3">4</span><span class="s2">,</span><span class="s1">a</span><span class="s2">)</span>
        <span class="s1">Ca5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">gegenbauer</span><span class="s2">(</span><span class="s3">5</span><span class="s2">,</span><span class="s1">a</span><span class="s2">)</span>

        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ca0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">array</span><span class="s2">([</span><span class="s3">1</span><span class="s2">]),</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ca1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">*</span><span class="s1">a</span><span class="s2">,</span><span class="s3">0</span><span class="s2">]),</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ca2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">array</span><span class="s2">([</span><span class="s3">2</span><span class="s2">*</span><span class="s1">a</span><span class="s2">*(</span><span class="s1">a</span><span class="s2">+</span><span class="s3">1</span><span class="s2">),</span><span class="s3">0</span><span class="s2">,-</span><span class="s1">a</span><span class="s2">]),</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ca3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">array</span><span class="s2">([</span><span class="s3">4</span><span class="s2">*</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">poch</span><span class="s2">(</span><span class="s1">a</span><span class="s2">,</span><span class="s3">3</span><span class="s2">),</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">6</span><span class="s2">*</span><span class="s1">a</span><span class="s2">*(</span><span class="s1">a</span><span class="s2">+</span><span class="s3">1</span><span class="s2">),</span>
                                               <span class="s3">0</span><span class="s2">])/</span><span class="s3">3.0</span><span class="s2">,</span><span class="s3">11</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ca4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">array</span><span class="s2">([</span><span class="s3">4</span><span class="s2">*</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">poch</span><span class="s2">(</span><span class="s1">a</span><span class="s2">,</span><span class="s3">4</span><span class="s2">),</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">12</span><span class="s2">*</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">poch</span><span class="s2">(</span><span class="s1">a</span><span class="s2">,</span><span class="s3">3</span><span class="s2">),</span>
                                               <span class="s3">0</span><span class="s2">,</span><span class="s3">3</span><span class="s2">*</span><span class="s1">a</span><span class="s2">*(</span><span class="s1">a</span><span class="s2">+</span><span class="s3">1</span><span class="s2">)])/</span><span class="s3">6.0</span><span class="s2">,</span><span class="s3">11</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ca5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">array</span><span class="s2">([</span><span class="s3">4</span><span class="s2">*</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">poch</span><span class="s2">(</span><span class="s1">a</span><span class="s2">,</span><span class="s3">5</span><span class="s2">),</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">20</span><span class="s2">*</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">poch</span><span class="s2">(</span><span class="s1">a</span><span class="s2">,</span><span class="s3">4</span><span class="s2">),</span>
                                               <span class="s3">0</span><span class="s2">,</span><span class="s3">15</span><span class="s2">*</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">poch</span><span class="s2">(</span><span class="s1">a</span><span class="s2">,</span><span class="s3">3</span><span class="s2">),</span><span class="s3">0</span><span class="s2">])/</span><span class="s3">15.0</span><span class="s2">,</span><span class="s3">11</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestHermite</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_hermite</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">H0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">H1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">H2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">H3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">H4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">H5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">1</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">2</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">4</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">2</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">8</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">12</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">16</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">48</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">12</span><span class="s2">],</span><span class="s3">12</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,[</span><span class="s3">32</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,-</span><span class="s3">160</span><span class="s2">,</span><span class="s3">0</span><span class="s2">,</span><span class="s3">120</span><span class="s2">,</span><span class="s3">0</span><span class="s2">],</span><span class="s3">12</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_hermitenorm</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># He_n(x) = 2**(-n/2) H_n(x/sqrt(2))</span>
        <span class="s1">psub </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">poly1d</span><span class="s2">([</span><span class="s3">1.0</span><span class="s2">/</span><span class="s1">sqrt</span><span class="s2">(</span><span class="s3">2</span><span class="s2">),</span><span class="s3">0</span><span class="s2">])</span>
        <span class="s1">H0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermitenorm</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">H1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermitenorm</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">H2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermitenorm</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">H3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermitenorm</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">H4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermitenorm</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">H5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermitenorm</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">he0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">he1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) / </span><span class="s1">sqrt</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">he2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) / </span><span class="s3">2.0</span>
        <span class="s1">he3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) / (</span><span class="s3">2</span><span class="s2">*</span><span class="s1">sqrt</span><span class="s2">(</span><span class="s3">2</span><span class="s2">))</span>
        <span class="s1">he4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) / </span><span class="s3">4.0</span>
        <span class="s1">he5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) / (</span><span class="s3">4.0</span><span class="s2">*</span><span class="s1">sqrt</span><span class="s2">(</span><span class="s3">2</span><span class="s2">))</span>

        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">he0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">he1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">he2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">he3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">he4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">H5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">he5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestShLegendre</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_sh_legendre</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># P*_n(x) = P_n(2x-1)</span>
        <span class="s1">psub </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">poly1d</span><span class="s2">([</span><span class="s3">2</span><span class="s2">,-</span><span class="s3">1</span><span class="s2">])</span>
        <span class="s1">Ps0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_legendre</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">Ps1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_legendre</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">Ps2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_legendre</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">Ps3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_legendre</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">Ps4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_legendre</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">Ps5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_legendre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">pse0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">legendre</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">pse1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">legendre</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">pse2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">legendre</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">pse3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">legendre</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">pse4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">legendre</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">pse5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">legendre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ps0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">pse0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ps1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">pse1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ps2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">pse2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ps3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">pse3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ps4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">pse4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">12</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ps5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">pse5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">12</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestShChebyt</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_sh_chebyt</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># T*_n(x) = T_n(2x-1)</span>
        <span class="s1">psub </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">poly1d</span><span class="s2">([</span><span class="s3">2</span><span class="s2">,-</span><span class="s3">1</span><span class="s2">])</span>
        <span class="s1">Ts0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyt</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">Ts1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyt</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">Ts2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyt</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">Ts3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyt</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">Ts4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyt</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">Ts5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">tse0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">tse1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">tse2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">tse3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">tse4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">tse5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ts0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">tse0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ts1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">tse1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ts2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">tse2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ts3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">tse3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ts4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">tse4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">12</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Ts5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">tse5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">12</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestShChebyu</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_sh_chebyu</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># U*_n(x) = U_n(2x-1)</span>
        <span class="s1">psub </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">poly1d</span><span class="s2">([</span><span class="s3">2</span><span class="s2">,-</span><span class="s3">1</span><span class="s2">])</span>
        <span class="s1">Us0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyu</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">Us1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyu</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
        <span class="s1">Us2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyu</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s1">Us3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyu</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)</span>
        <span class="s1">Us4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyu</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)</span>
        <span class="s1">Us5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)</span>
        <span class="s1">use0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">use1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">use2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">2</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">use3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">3</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">use4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">4</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">use5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Us0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">use0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Us1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">use1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Us2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">use2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Us3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">use3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Us4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">use4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">12</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">Us5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">use5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">11</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestShJacobi</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_sh_jacobi</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># G^(p,q)_n(x) = n! gamma(n+p)/gamma(2*n+p) * P^(p-q,q-1)_n(2*x-1)</span>
        <span class="s0">def </span><span class="s1">conv</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p</span><span class="s2">):</span>
            <span class="s0">return </span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">n </span><span class="s2">+ </span><span class="s3">1</span><span class="s2">) * </span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">n </span><span class="s2">+ </span><span class="s1">p</span><span class="s2">) / </span><span class="s1">gamma</span><span class="s2">(</span><span class="s3">2 </span><span class="s2">* </span><span class="s1">n </span><span class="s2">+ </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">psub </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">poly1d</span><span class="s2">([</span><span class="s3">2</span><span class="s2">,-</span><span class="s3">1</span><span class="s2">])</span>
        <span class="s1">q </span><span class="s2">= </span><span class="s3">4 </span><span class="s2">* </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">()</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">q</span><span class="s2">-</span><span class="s3">1 </span><span class="s2">+ </span><span class="s3">2</span><span class="s2">*</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">()</span>
        <span class="s5"># print(&quot;shifted jacobi p,q = &quot;, p, q)</span>
        <span class="s1">G0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_jacobi</span><span class="s2">(</span><span class="s3">0</span><span class="s2">,</span><span class="s1">p</span><span class="s2">,</span><span class="s1">q</span><span class="s2">)</span>
        <span class="s1">G1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_jacobi</span><span class="s2">(</span><span class="s3">1</span><span class="s2">,</span><span class="s1">p</span><span class="s2">,</span><span class="s1">q</span><span class="s2">)</span>
        <span class="s1">G2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_jacobi</span><span class="s2">(</span><span class="s3">2</span><span class="s2">,</span><span class="s1">p</span><span class="s2">,</span><span class="s1">q</span><span class="s2">)</span>
        <span class="s1">G3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_jacobi</span><span class="s2">(</span><span class="s3">3</span><span class="s2">,</span><span class="s1">p</span><span class="s2">,</span><span class="s1">q</span><span class="s2">)</span>
        <span class="s1">G4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_jacobi</span><span class="s2">(</span><span class="s3">4</span><span class="s2">,</span><span class="s1">p</span><span class="s2">,</span><span class="s1">q</span><span class="s2">)</span>
        <span class="s1">G5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_jacobi</span><span class="s2">(</span><span class="s3">5</span><span class="s2">,</span><span class="s1">p</span><span class="s2">,</span><span class="s1">q</span><span class="s2">)</span>
        <span class="s1">ge0 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">jacobi</span><span class="s2">(</span><span class="s3">0</span><span class="s2">,</span><span class="s1">p</span><span class="s2">-</span><span class="s1">q</span><span class="s2">,</span><span class="s1">q</span><span class="s2">-</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) * </span><span class="s1">conv</span><span class="s2">(</span><span class="s3">0</span><span class="s2">,</span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">ge1 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">jacobi</span><span class="s2">(</span><span class="s3">1</span><span class="s2">,</span><span class="s1">p</span><span class="s2">-</span><span class="s1">q</span><span class="s2">,</span><span class="s1">q</span><span class="s2">-</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) * </span><span class="s1">conv</span><span class="s2">(</span><span class="s3">1</span><span class="s2">,</span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">ge2 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">jacobi</span><span class="s2">(</span><span class="s3">2</span><span class="s2">,</span><span class="s1">p</span><span class="s2">-</span><span class="s1">q</span><span class="s2">,</span><span class="s1">q</span><span class="s2">-</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) * </span><span class="s1">conv</span><span class="s2">(</span><span class="s3">2</span><span class="s2">,</span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">ge3 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">jacobi</span><span class="s2">(</span><span class="s3">3</span><span class="s2">,</span><span class="s1">p</span><span class="s2">-</span><span class="s1">q</span><span class="s2">,</span><span class="s1">q</span><span class="s2">-</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) * </span><span class="s1">conv</span><span class="s2">(</span><span class="s3">3</span><span class="s2">,</span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">ge4 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">jacobi</span><span class="s2">(</span><span class="s3">4</span><span class="s2">,</span><span class="s1">p</span><span class="s2">-</span><span class="s1">q</span><span class="s2">,</span><span class="s1">q</span><span class="s2">-</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) * </span><span class="s1">conv</span><span class="s2">(</span><span class="s3">4</span><span class="s2">,</span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">ge5 </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">jacobi</span><span class="s2">(</span><span class="s3">5</span><span class="s2">,</span><span class="s1">p</span><span class="s2">-</span><span class="s1">q</span><span class="s2">,</span><span class="s1">q</span><span class="s2">-</span><span class="s3">1</span><span class="s2">)(</span><span class="s1">psub</span><span class="s2">) * </span><span class="s1">conv</span><span class="s2">(</span><span class="s3">5</span><span class="s2">,</span><span class="s1">p</span><span class="s2">)</span>

        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">G0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">ge0</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">G1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">ge1</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">G2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">ge2</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">G3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">ge3</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">G4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">ge4</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">G5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s1">ge5</span><span class="s2">.</span><span class="s1">c</span><span class="s2">,</span><span class="s3">13</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestCall</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_call</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">poly </span><span class="s2">= []</span>
        <span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s3">5</span><span class="s2">):</span>
            <span class="s1">poly</span><span class="s2">.</span><span class="s1">extend</span><span class="s2">([</span><span class="s1">x</span><span class="s2">.</span><span class="s1">strip</span><span class="s2">() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in</span>
                <span class="s2">(</span><span class="s4">&quot;&quot;&quot; 
                orth.jacobi(%(n)d,0.3,0.9) 
                orth.sh_jacobi(%(n)d,0.3,0.9) 
                orth.genlaguerre(%(n)d,0.3) 
                orth.laguerre(%(n)d) 
                orth.hermite(%(n)d) 
                orth.hermitenorm(%(n)d) 
                orth.gegenbauer(%(n)d,0.3) 
                orth.chebyt(%(n)d) 
                orth.chebyu(%(n)d) 
                orth.chebyc(%(n)d) 
                orth.chebys(%(n)d) 
                orth.sh_chebyt(%(n)d) 
                orth.sh_chebyu(%(n)d) 
                orth.legendre(%(n)d) 
                orth.sh_legendre(%(n)d) 
                &quot;&quot;&quot; </span><span class="s2">% </span><span class="s1">dict</span><span class="s2">(</span><span class="s1">n</span><span class="s2">=</span><span class="s1">n</span><span class="s2">)).</span><span class="s1">split</span><span class="s2">()</span>
            <span class="s2">])</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">all</span><span class="s2">=</span><span class="s4">'ignore'</span><span class="s2">):</span>
            <span class="s0">for </span><span class="s1">pstr </span><span class="s0">in </span><span class="s1">poly</span><span class="s2">:</span>
                <span class="s1">p </span><span class="s2">= </span><span class="s1">eval</span><span class="s2">(</span><span class="s1">pstr</span><span class="s2">)</span>
                <span class="s1">assert_almost_equal</span><span class="s2">(</span><span class="s1">p</span><span class="s2">(</span><span class="s3">0.315</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">poly1d</span><span class="s2">(</span><span class="s1">p</span><span class="s2">.</span><span class="s1">coef</span><span class="s2">)(</span><span class="s3">0.315</span><span class="s2">),</span>
                                    <span class="s1">err_msg</span><span class="s2">=</span><span class="s1">pstr</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestGenlaguerre</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_regression</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">orth</span><span class="s2">.</span><span class="s1">genlaguerre</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s1">monic</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)(</span><span class="s3">0</span><span class="s2">), </span><span class="s3">2.</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">orth</span><span class="s2">.</span><span class="s1">genlaguerre</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s1">monic</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)(</span><span class="s3">0</span><span class="s2">), -</span><span class="s3">2.</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">orth</span><span class="s2">.</span><span class="s1">genlaguerre</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s1">monic</span><span class="s2">=</span><span class="s0">False</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">poly1d</span><span class="s2">([-</span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">]))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">orth</span><span class="s2">.</span><span class="s1">genlaguerre</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s1">monic</span><span class="s2">=</span><span class="s0">True</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">poly1d</span><span class="s2">([</span><span class="s3">1</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">]))</span>


<span class="s0">def </span><span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">root_func</span><span class="s2">, </span><span class="s1">eval_func</span><span class="s2">, </span><span class="s1">weight_func</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">N</span><span class="s2">,</span>
                      <span class="s1">rtol</span><span class="s2">=</span><span class="s3">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">5e-14</span><span class="s2">):</span>
    <span class="s5"># this test is copied from numpy's TestGauss in test_hermite.py</span>
    <span class="s1">x</span><span class="s2">, </span><span class="s1">w</span><span class="s2">, </span><span class="s1">mu </span><span class="s2">= </span><span class="s1">root_func</span><span class="s2">(</span><span class="s1">N</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>

    <span class="s1">n </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">N</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s4">&quot;long&quot;</span><span class="s2">))</span>
    <span class="s1">v </span><span class="s2">= </span><span class="s1">eval_func</span><span class="s2">(</span><span class="s1">n</span><span class="s2">[:,</span><span class="s1">np</span><span class="s2">.</span><span class="s1">newaxis</span><span class="s2">], </span><span class="s1">x</span><span class="s2">)</span>
    <span class="s1">vv </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">dot</span><span class="s2">(</span><span class="s1">v</span><span class="s2">*</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">.</span><span class="s1">T</span><span class="s2">)</span>
    <span class="s1">vd </span><span class="s2">= </span><span class="s3">1 </span><span class="s2">/ </span><span class="s1">np</span><span class="s2">.</span><span class="s1">sqrt</span><span class="s2">(</span><span class="s1">vv</span><span class="s2">.</span><span class="s1">diagonal</span><span class="s2">())</span>
    <span class="s1">vv </span><span class="s2">= </span><span class="s1">vd</span><span class="s2">[:, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">newaxis</span><span class="s2">] * </span><span class="s1">vv </span><span class="s2">* </span><span class="s1">vd</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">vv</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">eye</span><span class="s2">(</span><span class="s1">N</span><span class="s2">), </span><span class="s1">rtol</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">)</span>

    <span class="s5"># check that the integral of 1 is correct</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">.</span><span class="s1">sum</span><span class="s2">(), </span><span class="s1">mu</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">)</span>

    <span class="s5"># compare the results of integrating a function with quad.</span>
    <span class="s0">def </span><span class="s1">f</span><span class="s2">(</span><span class="s1">x</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">x </span><span class="s2">** </span><span class="s3">3 </span><span class="s2">- </span><span class="s3">3 </span><span class="s2">* </span><span class="s1">x </span><span class="s2">** </span><span class="s3">2 </span><span class="s2">+ </span><span class="s1">x </span><span class="s2">- </span><span class="s3">2</span>
    <span class="s1">resI </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">f</span><span class="s2">(</span><span class="s1">x</span><span class="s2">)*</span><span class="s1">weight_func</span><span class="s2">(</span><span class="s1">x</span><span class="s2">), </span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">)</span>
    <span class="s1">resG </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">vdot</span><span class="s2">(</span><span class="s1">f</span><span class="s2">(</span><span class="s1">x</span><span class="s2">), </span><span class="s1">w</span><span class="s2">)</span>
    <span class="s1">rtol </span><span class="s2">= </span><span class="s3">1e-6 </span><span class="s0">if </span><span class="s3">1e-6 </span><span class="s2">&lt; </span><span class="s1">resI</span><span class="s2">[</span><span class="s3">1</span><span class="s2">] </span><span class="s0">else </span><span class="s1">resI</span><span class="s2">[</span><span class="s3">1</span><span class="s2">] * </span><span class="s3">10</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">resI</span><span class="s2">[</span><span class="s3">0</span><span class="s2">], </span><span class="s1">resG</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">rtol</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_jacobi</span><span class="s2">():</span>
    <span class="s0">def </span><span class="s1">rf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">: </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">ef</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">: </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_jacobi</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">wf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">x</span><span class="s2">: (</span><span class="s3">1 </span><span class="s2">- </span><span class="s1">x</span><span class="s2">) ** </span><span class="s1">a </span><span class="s2">* (</span><span class="s3">1 </span><span class="s2">+ </span><span class="s1">x</span><span class="s2">) ** </span><span class="s1">b</span>

    <span class="s1">vgq </span><span class="s2">= </span><span class="s1">verify_gauss_quad</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
        <span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.75</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
        <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1.5e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, -</span><span class="s3">0.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">2e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">2e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">2e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.9</span><span class="s2">, </span><span class="s3">2</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">3e-13</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1.1e-14</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">18.24</span><span class="s2">, </span><span class="s3">27.3</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
        <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">2e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, -</span><span class="s3">0.2</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
        <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">2e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">658.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">250</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">511.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-10</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">511.</span><span class="s2">, </span><span class="s3">512.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-10</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1000.</span><span class="s2">, </span><span class="s3">500.</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-10</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">2.25</span><span class="s2">, </span><span class="s3">68.9</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">,</span>
        <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>

    <span class="s5"># when alpha == beta == 0, P_n^{a,b}(x) == P_n(x)</span>
    <span class="s1">xj</span><span class="s2">, </span><span class="s1">wj </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s3">0.0</span><span class="s2">, </span><span class="s3">0.0</span><span class="s2">)</span>
    <span class="s1">xl</span><span class="s2">, </span><span class="s1">wl </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_legendre</span><span class="s2">(</span><span class="s3">6</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">xj</span><span class="s2">, </span><span class="s1">xl</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">wj</span><span class="s2">, </span><span class="s1">wl</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s5"># when alpha == beta != 0, P_n^{a,b}(x) == C_n^{alpha+0.5}(x)</span>
    <span class="s1">xj</span><span class="s2">, </span><span class="s1">wj </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s3">4.0</span><span class="s2">, </span><span class="s3">4.0</span><span class="s2">)</span>
    <span class="s1">xc</span><span class="s2">, </span><span class="s1">wc </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_gegenbauer</span><span class="s2">(</span><span class="s3">6</span><span class="s2">, </span><span class="s3">4.5</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">xj</span><span class="s2">, </span><span class="s1">xc</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">wj</span><span class="s2">, </span><span class="s1">wc</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">wf</span><span class="s2">(</span><span class="s3">2</span><span class="s2">,</span><span class="s3">3</span><span class="s2">), -</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_jacobi</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_sh_jacobi</span><span class="s2">():</span>
    <span class="s0">def </span><span class="s1">rf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">: </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_jacobi</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">ef</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">: </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_jacobi</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">wf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">x</span><span class="s2">: (</span><span class="s3">1.0 </span><span class="s2">- </span><span class="s1">x</span><span class="s2">) ** (</span><span class="s1">a </span><span class="s2">- </span><span class="s1">b</span><span class="s2">) * </span><span class="s1">x </span><span class="s2">** (</span><span class="s1">b </span><span class="s2">- </span><span class="s3">1.0</span><span class="s2">)</span>

    <span class="s1">vgq </span><span class="s2">= </span><span class="s1">verify_gauss_quad</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
        <span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.25</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
        <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">0.5</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1.5e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">, </span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">2e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s3">0.9</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">27.3</span><span class="s2">, </span><span class="s3">18.24</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
        <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">47.1</span><span class="s2">, </span><span class="s3">0.2</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-10</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">3.5e-14</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">2e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rf</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s1">ef</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s1">wf</span><span class="s2">(</span><span class="s3">68.9</span><span class="s2">, </span><span class="s3">2.25</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
        <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_jacobi</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_jacobi</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">wf</span><span class="s2">(</span><span class="s3">3</span><span class="s2">,</span><span class="s3">2</span><span class="s2">), </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_jacobi</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_jacobi</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_jacobi</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">1</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)    </span><span class="s5"># p - q &lt;= -1</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_jacobi</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">)   </span><span class="s5"># q &lt;= 0</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_jacobi</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">)  </span><span class="s5"># both</span>

<span class="s0">def </span><span class="s1">test_roots_hermite</span><span class="s2">():</span>
    <span class="s1">rootf </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermite</span>
    <span class="s1">evalf </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_hermite</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermite</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>

    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">, </span><span class="s1">evalf</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">, </span><span class="s1">evalf</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">, </span><span class="s1">evalf</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s5"># Golub-Welsch branch</span>
    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermite</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermite</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s5"># Asymptotic branch (switch over at n &gt;= 150)</span>
    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermite</span><span class="s2">(</span><span class="s3">200</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermite</span><span class="s2">(</span><span class="s3">200</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">sum</span><span class="s2">(</span><span class="s1">v</span><span class="s2">), </span><span class="s1">m</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermite</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermite</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_hermite_asy</span><span class="s2">():</span>
    <span class="s5"># Recursion for Hermite functions</span>
    <span class="s0">def </span><span class="s1">hermite_recursion</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">nodes</span><span class="s2">):</span>
        <span class="s1">H </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s1">n</span><span class="s2">, </span><span class="s1">nodes</span><span class="s2">.</span><span class="s1">size</span><span class="s2">))</span>
        <span class="s1">H</span><span class="s2">[</span><span class="s3">0</span><span class="s2">,:] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">**(-</span><span class="s3">0.25</span><span class="s2">) * </span><span class="s1">np</span><span class="s2">.</span><span class="s1">exp</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">*</span><span class="s1">nodes</span><span class="s2">**</span><span class="s3">2</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">n </span><span class="s2">&gt; </span><span class="s3">1</span><span class="s2">:</span>
            <span class="s1">H</span><span class="s2">[</span><span class="s3">1</span><span class="s2">,:] = </span><span class="s1">sqrt</span><span class="s2">(</span><span class="s3">2.0</span><span class="s2">) * </span><span class="s1">nodes </span><span class="s2">* </span><span class="s1">H</span><span class="s2">[</span><span class="s3">0</span><span class="s2">,:]</span>
            <span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s3">2</span><span class="s2">, </span><span class="s1">n</span><span class="s2">):</span>
                <span class="s1">H</span><span class="s2">[</span><span class="s1">k</span><span class="s2">,:] = </span><span class="s1">sqrt</span><span class="s2">(</span><span class="s3">2.0</span><span class="s2">/</span><span class="s1">k</span><span class="s2">) * </span><span class="s1">nodes </span><span class="s2">* </span><span class="s1">H</span><span class="s2">[</span><span class="s1">k</span><span class="s2">-</span><span class="s3">1</span><span class="s2">,:] - </span><span class="s1">sqrt</span><span class="s2">((</span><span class="s1">k</span><span class="s2">-</span><span class="s3">1.0</span><span class="s2">)/</span><span class="s1">k</span><span class="s2">) * </span><span class="s1">H</span><span class="s2">[</span><span class="s1">k</span><span class="s2">-</span><span class="s3">2</span><span class="s2">,:]</span>
        <span class="s0">return </span><span class="s1">H</span>

    <span class="s5"># This tests only the nodes</span>
    <span class="s0">def </span><span class="s1">test</span><span class="s2">(</span><span class="s1">N</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s3">1e-15</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-14</span><span class="s2">):</span>
        <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">_roots_hermite_asy</span><span class="s2">(</span><span class="s1">N</span><span class="s2">)</span>
        <span class="s1">H </span><span class="s2">= </span><span class="s1">hermite_recursion</span><span class="s2">(</span><span class="s1">N</span><span class="s2">+</span><span class="s3">1</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">H</span><span class="s2">[-</span><span class="s3">1</span><span class="s2">,:], </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s1">N</span><span class="s2">), </span><span class="s1">rtol</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">sum</span><span class="s2">(</span><span class="s1">w</span><span class="s2">), </span><span class="s1">sqrt</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">), </span><span class="s1">rtol</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">)</span>

    <span class="s1">test</span><span class="s2">(</span><span class="s3">150</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">151</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">300</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">301</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">500</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">501</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">999</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">1000</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">2000</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">test</span><span class="s2">(</span><span class="s3">5000</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_hermitenorm</span><span class="s2">():</span>
    <span class="s1">rootf </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermitenorm</span>
    <span class="s1">evalf </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_hermitenorm</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">hermitenorm</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>

    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">, </span><span class="s1">evalf</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">, </span><span class="s1">evalf</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">, </span><span class="s1">evalf</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermitenorm</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermitenorm</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermitenorm</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_hermitenorm</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_gegenbauer</span><span class="s2">():</span>
    <span class="s0">def </span><span class="s1">rootf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">: </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_gegenbauer</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">evalf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">: </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_gegenbauer</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">weightf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">x</span><span class="s2">: (</span><span class="s3">1 </span><span class="s2">- </span><span class="s1">x </span><span class="s2">** </span><span class="s3">2</span><span class="s2">) ** (</span><span class="s1">a </span><span class="s2">- </span><span class="s3">0.5</span><span class="s2">)</span>

    <span class="s1">vgq </span><span class="s2">= </span><span class="s1">verify_gauss_quad</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(-</span><span class="s3">0.25</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>

    <span class="s5"># Alpha=170 is where the approximation used in roots_gegenbauer changes</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">170</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1.25e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">170.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>

    <span class="s5"># Test for failures, e.g. overflows, resulting from large alphas</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">238</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-11</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">512.5</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-10</span><span class="s2">)</span>

    <span class="s5"># this is a special case that the old code supported.</span>
    <span class="s5"># when alpha = 0, the gegenbauer polynomial is uniformly 0. but it goes</span>
    <span class="s5"># to a scaled down copy of T_n(x) there.</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0</span><span class="s2">), </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0</span><span class="s2">), </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0</span><span class="s2">), </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0</span><span class="s2">), -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_gegenbauer</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_gegenbauer</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">2</span><span class="s2">), -</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_gegenbauer</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_gegenbauer</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_gegenbauer</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, -</span><span class="s3">.75</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_chebyt</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyt</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyt</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyt</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">,</span>
                      <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyt</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyt</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_chebyt_symmetry</span><span class="s2">():</span>
    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyt</span><span class="s2">(</span><span class="s3">21</span><span class="s2">)</span>
    <span class="s1">pos</span><span class="s2">, </span><span class="s1">neg </span><span class="s2">= </span><span class="s1">x</span><span class="s2">[:</span><span class="s3">10</span><span class="s2">], </span><span class="s1">x</span><span class="s2">[</span><span class="s3">11</span><span class="s2">:]</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">neg</span><span class="s2">, -</span><span class="s1">pos</span><span class="s2">[::-</span><span class="s3">1</span><span class="s2">])</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">[</span><span class="s3">10</span><span class="s2">], </span><span class="s3">0</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_chebyu</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyu</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyu</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyu</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyu</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyu</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyu</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyu</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyu</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_chebyc</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebyc</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyc</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyc</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">2.</span><span class="s2">, </span><span class="s3">2.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyc</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyc</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">2.</span><span class="s2">, </span><span class="s3">2.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyc</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebyc</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">2.</span><span class="s2">, </span><span class="s3">2.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">,</span>
                      <span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyc</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyc</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyc</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebyc</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_chebys</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">chebys</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebys</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebys</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">2.</span><span class="s2">, </span><span class="s3">2.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebys</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebys</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">2.</span><span class="s2">, </span><span class="s3">2.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebys</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_chebys</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">2.</span><span class="s2">, </span><span class="s3">2.</span><span class="s2">, </span><span class="s3">100</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebys</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebys</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">2</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebys</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_chebys</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_sh_chebyt</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyt</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyt</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyt</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_chebyt</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
                      <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyt</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyt</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyt</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_sh_chebyu</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyu</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_chebyu</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyu</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_chebyu</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">25</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyu</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_chebyu</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
                      <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyu</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyu</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_chebyu</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_legendre</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">legendre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_legendre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_legendre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_legendre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_legendre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
                      <span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_legendre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_legendre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
                      <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_legendre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_legendre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, -</span><span class="s3">1</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_legendre</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_legendre</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_sh_legendre</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">sh_legendre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_legendre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_legendre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_legendre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_legendre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
                      <span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_legendre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_sh_legendre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s3">1.</span><span class="s2">,</span>
                      <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_legendre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_legendre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">1</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_legendre</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_sh_legendre</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_laguerre</span><span class="s2">():</span>
    <span class="s1">weightf </span><span class="s2">= </span><span class="s1">orth</span><span class="s2">.</span><span class="s1">laguerre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">).</span><span class="s1">weight_func</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_laguerre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_laguerre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_laguerre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_laguerre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">,</span>
                      <span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">verify_gauss_quad</span><span class="s2">(</span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_laguerre</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_laguerre</span><span class="s2">, </span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">,</span>
                      <span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_laguerre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_laguerre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_laguerre</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_laguerre</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">)</span>

<span class="s0">def </span><span class="s1">test_roots_genlaguerre</span><span class="s2">():</span>
    <span class="s0">def </span><span class="s1">rootf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">: </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_genlaguerre</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">evalf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">n</span><span class="s2">, </span><span class="s1">x</span><span class="s2">: </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">eval_genlaguerre</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)</span>
    <span class="s0">def </span><span class="s1">weightf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">):</span>
        <span class="s0">return lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x </span><span class="s2">** </span><span class="s1">a </span><span class="s2">* </span><span class="s1">np</span><span class="s2">.</span><span class="s1">exp</span><span class="s2">(-</span><span class="s1">x</span><span class="s2">)</span>

    <span class="s1">vgq </span><span class="s2">= </span><span class="s1">verify_gauss_quad</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(-</span><span class="s3">0.5</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">0.1</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1.6e-13</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">1</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1.03e-13</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">10</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-12</span><span class="s2">)</span>

    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">5</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">25</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">1e-13</span><span class="s2">)</span>
    <span class="s1">vgq</span><span class="s2">(</span><span class="s1">rootf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">evalf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">50</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s3">100</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s3">1e-14</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s3">2e-13</span><span class="s2">)</span>

    <span class="s1">x</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_genlaguerre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">y</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s1">m </span><span class="s2">= </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_genlaguerre</span><span class="s2">(</span><span class="s3">5</span><span class="s2">, </span><span class="s3">2</span><span class="s2">, </span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">w</span><span class="s2">, </span><span class="s1">v</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">, </span><span class="s3">1e-14</span><span class="s2">)</span>

    <span class="s1">muI</span><span class="s2">, </span><span class="s1">muI_err </span><span class="s2">= </span><span class="s1">integrate</span><span class="s2">.</span><span class="s1">quad</span><span class="s2">(</span><span class="s1">weightf</span><span class="s2">(</span><span class="s3">2.</span><span class="s2">), </span><span class="s3">0.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">)</span>
    <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">m</span><span class="s2">, </span><span class="s1">muI</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s1">muI_err</span><span class="s2">)</span>

    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_genlaguerre</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_genlaguerre</span><span class="s2">, </span><span class="s3">3.3</span><span class="s2">, </span><span class="s3">2</span><span class="s2">)</span>
    <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">roots_genlaguerre</span><span class="s2">, </span><span class="s3">3</span><span class="s2">, -</span><span class="s3">1.1</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_gh_6721</span><span class="s2">():</span>
    <span class="s5"># Regression test for gh_6721. This should not raise.</span>
    <span class="s1">sc</span><span class="s2">.</span><span class="s1">chebyt</span><span class="s2">(</span><span class="s3">65</span><span class="s2">)(</span><span class="s3">0.2</span><span class="s2">)</span>
</pre>
</body>
</html>