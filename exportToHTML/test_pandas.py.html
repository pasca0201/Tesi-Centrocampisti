<html>
<head>
<title>test_pandas.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #7a7e85;}
.s4 { color: #2aacb8;}
.s5 { color: #6aab73;}
.s6 { color: #a5c261;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_pandas.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">datetime</span>
<span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">timedelta</span>
<span class="s0">from </span><span class="s1">decimal </span><span class="s0">import </span><span class="s1">Decimal</span>
<span class="s0">from </span><span class="s1">io </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">BytesIO</span><span class="s2">,</span>
    <span class="s1">StringIO</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">import </span><span class="s1">json</span>
<span class="s0">import </span><span class="s1">os</span>
<span class="s0">import </span><span class="s1">sys</span>
<span class="s0">import </span><span class="s1">time</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">_config </span><span class="s0">import </span><span class="s1">using_pyarrow_string_dtype</span>

<span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">compat </span><span class="s0">import </span><span class="s1">IS64</span>
<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">util</span><span class="s2">.</span><span class="s1">_test_decorators </span><span class="s0">as </span><span class="s1">td</span>

<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">NA</span><span class="s2">,</span>
    <span class="s1">DataFrame</span><span class="s2">,</span>
    <span class="s1">DatetimeIndex</span><span class="s2">,</span>
    <span class="s1">Index</span><span class="s2">,</span>
    <span class="s1">RangeIndex</span><span class="s2">,</span>
    <span class="s1">Series</span><span class="s2">,</span>
    <span class="s1">Timestamp</span><span class="s2">,</span>
    <span class="s1">date_range</span><span class="s2">,</span>
    <span class="s1">read_json</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">_testing </span><span class="s0">as </span><span class="s1">tm</span>
<span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">core</span><span class="s2">.</span><span class="s1">arrays </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">ArrowStringArray</span><span class="s2">,</span>
    <span class="s1">StringArray</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">core</span><span class="s2">.</span><span class="s1">arrays</span><span class="s2">.</span><span class="s1">string_arrow </span><span class="s0">import </span><span class="s1">ArrowStringArrayNumpySemantics</span>

<span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">io</span><span class="s2">.</span><span class="s1">json </span><span class="s0">import </span><span class="s1">ujson_dumps</span>


<span class="s0">def </span><span class="s1">test_literal_json_deprecation</span><span class="s2">():</span>
    <span class="s3"># PR 53409</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>

    <span class="s1">jsonl </span><span class="s2">= </span><span class="s5">&quot;&quot;&quot;{&quot;a&quot;: 1, &quot;b&quot;: 2} 
        {&quot;a&quot;: 3, &quot;b&quot;: 4} 
        {&quot;a&quot;: 5, &quot;b&quot;: 6} 
        {&quot;a&quot;: 7, &quot;b&quot;: 8}&quot;&quot;&quot;</span>

    <span class="s1">msg </span><span class="s2">= (</span>
        <span class="s5">&quot;Passing literal json to 'read_json' is deprecated and &quot;</span>
        <span class="s5">&quot;will be removed in a future version. To read from a &quot;</span>
        <span class="s5">&quot;literal string, wrap it in a 'StringIO' object.&quot;</span>
    <span class="s2">)</span>

    <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">jsonl</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">except </span><span class="s1">ValueError</span><span class="s2">:</span>
            <span class="s0">pass</span>

    <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">read_json</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(), </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s5">'{&quot;a&quot;: 1, &quot;b&quot;: 2}</span><span class="s0">\n</span><span class="s5">{&quot;b&quot;:2, &quot;a&quot; :1}</span><span class="s0">\n</span><span class="s5">'</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
                <span class="s5">'{&quot;a</span><span class="s0">\\\\</span><span class="s5">&quot;:&quot;foo</span><span class="s0">\\\\</span><span class="s5">&quot;,&quot;b&quot;:&quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">{&quot;a</span><span class="s0">\\\\</span><span class="s5">&quot;:&quot;foo</span><span class="s0">\\</span><span class="s5">&quot;&quot;,&quot;b&quot;:&quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">'</span><span class="s2">,</span>
                <span class="s1">lines</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
            <span class="s2">)</span>
        <span class="s0">except </span><span class="s1">ValueError</span><span class="s2">:</span>
            <span class="s0">pass</span>

    <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s5">'{&quot;a&quot;: 1, &quot;b&quot;: 2}</span><span class="s0">\n</span><span class="s5">{&quot;b&quot;:2, &quot;a&quot; :1}</span><span class="s0">\n</span><span class="s5">'</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">except </span><span class="s1">ValueError</span><span class="s2">:</span>
            <span class="s0">pass</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
    <span class="s0">if </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s5">&quot;values&quot;</span><span class="s2">):</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">reset_index</span><span class="s2">(</span><span class="s1">drop</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
    <span class="s0">if </span><span class="s1">orient </span><span class="s2">== </span><span class="s5">&quot;values&quot;</span><span class="s2">:</span>
        <span class="s1">expected</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">))</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestPandasContainer</span><span class="s2">:</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span>
    <span class="s0">def </span><span class="s1">categorical_frame</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= {</span>
            <span class="s1">c</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s1">i</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s4">30</span><span class="s2">)</span>
            <span class="s0">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">c </span><span class="s0">in </span><span class="s1">enumerate</span><span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s2">))</span>
        <span class="s2">}</span>
        <span class="s1">cat </span><span class="s2">= [</span><span class="s5">&quot;bah&quot;</span><span class="s2">] * </span><span class="s4">5 </span><span class="s2">+ [</span><span class="s5">&quot;bar&quot;</span><span class="s2">] * </span><span class="s4">5 </span><span class="s2">+ [</span><span class="s5">&quot;baz&quot;</span><span class="s2">] * </span><span class="s4">5 </span><span class="s2">+ [</span><span class="s5">&quot;foo&quot;</span><span class="s2">] * </span><span class="s4">15</span>
        <span class="s1">data</span><span class="s2">[</span><span class="s5">&quot;E&quot;</span><span class="s2">] = </span><span class="s1">list</span><span class="s2">(</span><span class="s1">reversed</span><span class="s2">(</span><span class="s1">cat</span><span class="s2">))</span>
        <span class="s1">data</span><span class="s2">[</span><span class="s5">&quot;sort&quot;</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">30</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;int64&quot;</span><span class="s2">)</span>
        <span class="s0">return </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">CategoricalIndex</span><span class="s2">(</span><span class="s1">cat</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s5">&quot;E&quot;</span><span class="s2">))</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span>
    <span class="s0">def </span><span class="s1">datetime_series</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># Same as usual datetime_series, but with index freq set to None,</span>
        <span class="s3">#  since that doesn't round-trip, see GH#33711</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s4">1.1 </span><span class="s2">* </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">),</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;2020-01-01&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">10</span><span class="s2">),</span>
            <span class="s1">name</span><span class="s2">=</span><span class="s5">&quot;ts&quot;</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">ser</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">_with_freq</span><span class="s2">(</span><span class="s0">None</span><span class="s2">)</span>
        <span class="s0">return </span><span class="s1">ser</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span>
    <span class="s0">def </span><span class="s1">datetime_frame</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># Same as usual datetime_frame, but with index freq set to None,</span>
        <span class="s3">#  since that doesn't round-trip, see GH#33711</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s4">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">((</span><span class="s4">30</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)),</span>
            <span class="s1">columns</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s5">&quot;ABCD&quot;</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">),</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;2000-01-01&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">30</span><span class="s2">, </span><span class="s1">freq</span><span class="s2">=</span><span class="s5">&quot;B&quot;</span><span class="s2">),</span>
        <span class="s2">)</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">_with_freq</span><span class="s2">(</span><span class="s0">None</span><span class="s2">)</span>
        <span class="s0">return </span><span class="s1">df</span>

    <span class="s0">def </span><span class="s1">test_frame_double_encoded_labels</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">[[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]],</span>
            <span class="s1">index</span><span class="s2">=[</span><span class="s5">'index &quot; 1'</span><span class="s2">, </span><span class="s5">&quot;index / 2&quot;</span><span class="s2">],</span>
            <span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a </span><span class="s0">\\ </span><span class="s5">b&quot;</span><span class="s2">, </span><span class="s5">&quot;y / z&quot;</span><span class="s2">],</span>
        <span class="s2">)</span>

        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s5">&quot;values&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_frame_non_unique_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;x&quot;</span><span class="s2">, </span><span class="s5">&quot;y&quot;</span><span class="s2">])</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>

        <span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_frame_non_unique_index_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;x&quot;</span><span class="s2">, </span><span class="s5">&quot;y&quot;</span><span class="s2">])</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">f&quot;DataFrame index must be unique for orient='</span><span class="s0">{</span><span class="s1">orient</span><span class="s0">}</span><span class="s5">'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s5">&quot;values&quot;</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;data&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">[[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]],</span>
            <span class="s2">[[</span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">2.5</span><span class="s2">], [</span><span class="s4">3.5</span><span class="s2">, </span><span class="s4">4.5</span><span class="s2">]],</span>
            <span class="s2">[[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.5</span><span class="s2">], [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4.5</span><span class="s2">]],</span>
            <span class="s2">[[</span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">), </span><span class="s4">3.5</span><span class="s2">], [</span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130102&quot;</span><span class="s2">), </span><span class="s4">4.5</span><span class="s2">]],</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_frame_non_unique_columns</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">data</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;x&quot;</span><span class="s2">, </span><span class="s5">&quot;x&quot;</span><span class="s2">])</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
            <span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)), </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_dates</span><span class="s2">=[</span><span class="s5">&quot;x&quot;</span><span class="s2">]</span>
        <span class="s2">)</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s2">== </span><span class="s5">&quot;values&quot;</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>
            <span class="s0">if </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[:, </span><span class="s4">0</span><span class="s2">].</span><span class="s1">dtype </span><span class="s2">== </span><span class="s5">&quot;datetime64[ns]&quot;</span><span class="s2">:</span>
                <span class="s3"># orient == &quot;values&quot; by default will write Timestamp objects out</span>
                <span class="s3"># in milliseconds; these are internally stored in nanosecond,</span>
                <span class="s3"># so divide to get where we need</span>
                <span class="s3"># TODO: a to_epoch method would also solve; see GH 14772</span>
                <span class="s1">expected</span><span class="s2">.</span><span class="s1">isetitem</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[:, </span><span class="s4">0</span><span class="s2">].</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">) // </span><span class="s4">1000000</span><span class="s2">)</span>
        <span class="s0">elif </span><span class="s1">orient </span><span class="s2">== </span><span class="s5">&quot;split&quot;</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= [</span><span class="s5">&quot;x&quot;</span><span class="s2">, </span><span class="s5">&quot;x.1&quot;</span><span class="s2">]</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_frame_non_unique_columns_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;x&quot;</span><span class="s2">, </span><span class="s5">&quot;x&quot;</span><span class="s2">])</span>

        <span class="s1">msg </span><span class="s2">= </span><span class="s5">f&quot;DataFrame columns must be unique for orient='</span><span class="s0">{</span><span class="s1">orient</span><span class="s0">}</span><span class="s5">'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_frame_default_orient</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">float_frame</span><span class="s2">):</span>
        <span class="s0">assert </span><span class="s1">float_frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">() == </span><span class="s1">float_frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;columns&quot;</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s1">float</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;convert_axes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_simple</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">float_frame</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">float_frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">float_frame</span>

        <span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;convert_axes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_intframe</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">int_frame</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">int_frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">int_frame</span>
        <span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">None</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">, </span><span class="s1">int</span><span class="s2">, </span><span class="s5">&quot;U3&quot;</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;convert_axes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_str_axes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s4">200</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)),</span>
            <span class="s1">columns</span><span class="s2">=[</span><span class="s1">str</span><span class="s2">(</span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">4</span><span class="s2">)],</span>
            <span class="s1">index</span><span class="s2">=[</span><span class="s1">str</span><span class="s2">(</span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">200</span><span class="s2">)],</span>
            <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">,</span>
        <span class="s2">)</span>

        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s0">if not </span><span class="s1">dtype</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>

        <span class="s3"># index columns, and records orients cannot fully preserve the string</span>
        <span class="s3"># dtype for axes as the index and column labels are used as keys in</span>
        <span class="s3"># JSON objects. JSON keys are by definition strings, so there's no way</span>
        <span class="s3"># to disambiguate whether those keys actually were strings or numeric</span>
        <span class="s3"># beforehand and numeric wins out.</span>
        <span class="s0">if </span><span class="s1">convert_axes </span><span class="s0">and </span><span class="s2">(</span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">)):</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s0">elif </span><span class="s1">orient </span><span class="s2">== </span><span class="s5">&quot;records&quot; </span><span class="s0">and </span><span class="s1">convert_axes</span><span class="s2">:</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s0">elif </span><span class="s1">convert_axes </span><span class="s0">and </span><span class="s1">orient </span><span class="s2">== </span><span class="s5">&quot;split&quot;</span><span class="s2">:</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>

        <span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;convert_axes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_categorical</span><span class="s2">(</span>
        <span class="s1">self</span><span class="s2">, </span><span class="s1">request</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">categorical_frame</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">using_infer_string</span>
    <span class="s2">):</span>
        <span class="s3"># TODO: create a better frame to test with and improve coverage</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">):</span>
            <span class="s1">request</span><span class="s2">.</span><span class="s1">applymarker</span><span class="s2">(</span>
                <span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span>
                    <span class="s1">reason</span><span class="s2">=</span><span class="s5">f&quot;Can't have duplicate index values for orient '</span><span class="s0">{</span><span class="s1">orient</span><span class="s0">}</span><span class="s5">')&quot;</span>
                <span class="s2">)</span>
            <span class="s2">)</span>

        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">categorical_frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">categorical_frame</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">expected</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span>
            <span class="s1">str </span><span class="s0">if not </span><span class="s1">using_infer_string </span><span class="s0">else </span><span class="s5">&quot;string[pyarrow_numpy]&quot;</span>
        <span class="s2">)  </span><span class="s3"># Categorical not preserved</span>
        <span class="s1">expected</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">name </span><span class="s2">= </span><span class="s0">None  </span><span class="s3"># index names aren't preserved in JSON</span>
        <span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;convert_axes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_empty</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">):</span>
        <span class="s1">empty_frame </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">()</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">empty_frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s2">== </span><span class="s5">&quot;split&quot;</span><span class="s2">:</span>
            <span class="s1">idx </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([], </span><span class="s1">dtype</span><span class="s2">=(</span><span class="s1">float </span><span class="s0">if </span><span class="s1">convert_axes </span><span class="s0">else </span><span class="s1">object</span><span class="s2">))</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s1">idx</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">idx</span><span class="s2">)</span>
        <span class="s0">elif </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">[</span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">]:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">()</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">empty_frame</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;convert_axes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_timestamp</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">):</span>
        <span class="s3"># TODO: improve coverage with date_format parameter</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">datetime_frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">datetime_frame</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>

        <span class="s0">if not </span><span class="s1">convert_axes</span><span class="s2">:  </span><span class="s3"># one off for ts handling</span>
            <span class="s3"># DTI gets converted to epoch values</span>
            <span class="s1">idx </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">) // </span><span class="s4">1000000</span>
            <span class="s0">if </span><span class="s1">orient </span><span class="s2">!= </span><span class="s5">&quot;split&quot;</span><span class="s2">:  </span><span class="s3"># TODO: handle consistently across orients</span>
                <span class="s1">idx </span><span class="s2">= </span><span class="s1">idx</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">str</span><span class="s2">)</span>

            <span class="s1">expected</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">idx</span>

        <span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;convert_axes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_mixed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">):</span>
        <span class="s1">index </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">, </span><span class="s5">&quot;e&quot;</span><span class="s2">])</span>
        <span class="s1">values </span><span class="s2">= {</span>
            <span class="s5">&quot;A&quot;</span><span class="s2">: [</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">, </span><span class="s4">3.0</span><span class="s2">, </span><span class="s4">4.0</span><span class="s2">],</span>
            <span class="s5">&quot;B&quot;</span><span class="s2">: [</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">],</span>
            <span class="s5">&quot;C&quot;</span><span class="s2">: [</span><span class="s5">&quot;foo1&quot;</span><span class="s2">, </span><span class="s5">&quot;foo2&quot;</span><span class="s2">, </span><span class="s5">&quot;foo3&quot;</span><span class="s2">, </span><span class="s5">&quot;foo4&quot;</span><span class="s2">, </span><span class="s5">&quot;foo5&quot;</span><span class="s2">],</span>
            <span class="s5">&quot;D&quot;</span><span class="s2">: [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">],</span>
        <span class="s2">}</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">=</span><span class="s1">values</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">)</span>

        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">assign</span><span class="s2">(**</span><span class="s1">expected</span><span class="s2">.</span><span class="s1">select_dtypes</span><span class="s2">(</span><span class="s5">&quot;number&quot;</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">))</span>

        <span class="s1">assert_json_roundtrip_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span>
        <span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;#50456 Column multiindex is stored and loaded differently&quot;</span><span class="s2">,</span>
        <span class="s1">raises</span><span class="s2">=</span><span class="s1">AssertionError</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;columns&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">[[</span><span class="s5">&quot;2022&quot;</span><span class="s2">, </span><span class="s5">&quot;2022&quot;</span><span class="s2">], [</span><span class="s5">&quot;JAN&quot;</span><span class="s2">, </span><span class="s5">&quot;FEB&quot;</span><span class="s2">]],</span>
            <span class="s2">[[</span><span class="s5">&quot;2022&quot;</span><span class="s2">, </span><span class="s5">&quot;2023&quot;</span><span class="s2">], [</span><span class="s5">&quot;JAN&quot;</span><span class="s2">, </span><span class="s5">&quot;JAN&quot;</span><span class="s2">]],</span>
            <span class="s2">[[</span><span class="s5">&quot;2022&quot;</span><span class="s2">, </span><span class="s5">&quot;2022&quot;</span><span class="s2">], [</span><span class="s5">&quot;JAN&quot;</span><span class="s2">, </span><span class="s5">&quot;JAN&quot;</span><span class="s2">]],</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_multiindex</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">[[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]],</span>
            <span class="s1">columns</span><span class="s2">=</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_arrays</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">),</span>
        <span class="s2">)</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;split&quot;</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;split&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">df</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;data,msg,orient&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span><span class="s5">'{&quot;key&quot;:b:a:d}'</span><span class="s2">, </span><span class="s5">&quot;Expected object or value&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">),</span>
            <span class="s3"># too few indices</span>
            <span class="s2">(</span>
                <span class="s5">'{&quot;columns&quot;:[&quot;A&quot;,&quot;B&quot;],'</span>
                <span class="s5">'&quot;index&quot;:[&quot;2&quot;,&quot;3&quot;],'</span>
                <span class="s5">'&quot;data&quot;:[[1.0,&quot;1&quot;],[2.0,&quot;2&quot;],[null,&quot;3&quot;]]}'</span><span class="s2">,</span>
                <span class="s5">&quot;|&quot;</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span>
                    <span class="s2">[</span>
                        <span class="s5">r&quot;Length of values \(3\) does not match length of index \(2\)&quot;</span><span class="s2">,</span>
                    <span class="s2">]</span>
                <span class="s2">),</span>
                <span class="s5">&quot;split&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s3"># too many columns</span>
            <span class="s2">(</span>
                <span class="s5">'{&quot;columns&quot;:[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;],'</span>
                <span class="s5">'&quot;index&quot;:[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;],'</span>
                <span class="s5">'&quot;data&quot;:[[1.0,&quot;1&quot;],[2.0,&quot;2&quot;],[null,&quot;3&quot;]]}'</span><span class="s2">,</span>
                <span class="s5">&quot;3 columns passed, passed data had 2 columns&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;split&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s3"># bad key</span>
            <span class="s2">(</span>
                <span class="s5">'{&quot;badkey&quot;:[&quot;A&quot;,&quot;B&quot;],'</span>
                <span class="s5">'&quot;index&quot;:[&quot;2&quot;,&quot;3&quot;],'</span>
                <span class="s5">'&quot;data&quot;:[[1.0,&quot;1&quot;],[2.0,&quot;2&quot;],[null,&quot;3&quot;]]}'</span><span class="s2">,</span>
                <span class="s5">r&quot;unexpected key\(s\): badkey&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;split&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_frame_from_json_bad_data_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">data</span><span class="s2">, </span><span class="s1">msg</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">data</span><span class="s2">), </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;convert_axes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_frame_from_json_missing_data</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
        <span class="s1">num_df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]])</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
            <span class="s1">StringIO</span><span class="s2">(</span><span class="s1">num_df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)),</span>
            <span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">,</span>
            <span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">,</span>
            <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>

        <span class="s1">obj_df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;1&quot;</span><span class="s2">, </span><span class="s5">&quot;2&quot;</span><span class="s2">], [</span><span class="s5">&quot;4&quot;</span><span class="s2">, </span><span class="s5">&quot;5&quot;</span><span class="s2">, </span><span class="s5">&quot;6&quot;</span><span class="s2">]])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
            <span class="s1">StringIO</span><span class="s2">(</span><span class="s1">obj_df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)),</span>
            <span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">,</span>
            <span class="s1">convert_axes</span><span class="s2">=</span><span class="s1">convert_axes</span><span class="s2">,</span>
            <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_frame_read_json_dtype_missing_value</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
        <span class="s3"># GH28501 Parse missing values using read_json with dtype=False</span>
        <span class="s3"># to NaN instead of None</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s5">&quot;[null]&quot;</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;inf&quot;</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_frame_infinity</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">inf</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
        <span class="s3"># infinities get mapped to nulls which get mapped to NaNs during</span>
        <span class="s3"># deserialisation</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]])</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">] = </span><span class="s1">inf</span>

        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">skipif</span><span class="s2">(</span><span class="s0">not </span><span class="s1">IS64</span><span class="s2">, </span><span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;not compliant on 32-bit, xref #15865&quot;</span><span class="s2">)</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;value,precision,expected_val&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span><span class="s4">0.95</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s4">1.95</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">),</span>
            <span class="s2">(-</span><span class="s4">1.95</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, -</span><span class="s4">2.0</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s4">0.995</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s4">0.9995</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s4">0.99999999999999944</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">1.0</span><span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_frame_to_json_float_precision</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">value</span><span class="s2">, </span><span class="s1">precision</span><span class="s2">, </span><span class="s1">expected_val</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([{</span><span class="s5">&quot;a_float&quot;</span><span class="s2">: </span><span class="s1">value</span><span class="s2">}])</span>
        <span class="s1">encoded </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">double_precision</span><span class="s2">=</span><span class="s1">precision</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">encoded </span><span class="s2">== </span><span class="s5">f'</span><span class="s0">{{</span><span class="s5">&quot;a_float&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:</span><span class="s0">{</span><span class="s1">expected_val</span><span class="s0">}}}}}</span><span class="s5">'</span>

    <span class="s0">def </span><span class="s1">test_frame_to_json_except</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;Invalid value 'garbage' for option 'orient'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;garbage&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_frame_empty</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;jim&quot;</span><span class="s2">, </span><span class="s5">&quot;joe&quot;</span><span class="s2">])</span>
        <span class="s0">assert not </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_is_mixed_type</span>

        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dict</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">dtypes</span><span class="s2">))</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">df</span><span class="s2">, </span><span class="s1">check_index_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_frame_empty_to_json</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH 7445</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;test&quot;</span><span class="s2">: []}, </span><span class="s1">index</span><span class="s2">=[])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;columns&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;test&quot;:{}}'</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s0">def </span><span class="s1">test_frame_empty_mixedtype</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># mixed type</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;jim&quot;</span><span class="s2">, </span><span class="s5">&quot;joe&quot;</span><span class="s2">])</span>
        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;joe&quot;</span><span class="s2">] = </span><span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;joe&quot;</span><span class="s2">].</span><span class="s1">astype</span><span class="s2">(</span><span class="s5">&quot;i8&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_is_mixed_type</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">data</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dict</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">dtypes</span><span class="s2">)),</span>
            <span class="s1">df</span><span class="s2">,</span>
            <span class="s1">check_index_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_frame_mixedtype_orient</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):  </span><span class="s3"># GH10289</span>
        <span class="s1">vals </span><span class="s2">= [</span>
            <span class="s2">[</span><span class="s4">10</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s5">&quot;foo&quot;</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.01</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s4">20</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">0.02</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s4">30</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s5">&quot;baz&quot;</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.03</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s4">40</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s5">&quot;qux&quot;</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.04</span><span class="s2">],</span>
        <span class="s2">]</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s1">vals</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">list</span><span class="s2">(</span><span class="s5">&quot;abcd&quot;</span><span class="s2">), </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;1st&quot;</span><span class="s2">, </span><span class="s5">&quot;2nd&quot;</span><span class="s2">, </span><span class="s5">&quot;3rd&quot;</span><span class="s2">, </span><span class="s5">&quot;4th&quot;</span><span class="s2">, </span><span class="s5">&quot;5th&quot;</span><span class="s2">]</span>
        <span class="s2">)</span>

        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_is_mixed_type</span>
        <span class="s1">right </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>

        <span class="s0">for </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">[</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">]:</span>
            <span class="s1">inp </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
            <span class="s1">left </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>

        <span class="s1">right</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">RangeIndex</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">df</span><span class="s2">))</span>
        <span class="s1">inp </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">))</span>
        <span class="s1">left </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>

        <span class="s1">right</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">RangeIndex</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">[</span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">inp </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;values&quot;</span><span class="s2">))</span>
        <span class="s1">left </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">inp</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;values&quot;</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_v12_compat</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
        <span class="s1">dti </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;2000-01-03&quot;</span><span class="s2">, </span><span class="s5">&quot;2000-01-07&quot;</span><span class="s2">)</span>
        <span class="s3"># freq doesn't roundtrip</span>
        <span class="s1">dti </span><span class="s2">= </span><span class="s1">DatetimeIndex</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">dti</span><span class="s2">), </span><span class="s1">freq</span><span class="s2">=</span><span class="s0">None</span><span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">[</span>
                <span class="s2">[</span><span class="s4">1.56808523</span><span class="s2">, </span><span class="s4">0.65727391</span><span class="s2">, </span><span class="s4">1.81021139</span><span class="s2">, -</span><span class="s4">0.17251653</span><span class="s2">],</span>
                <span class="s2">[-</span><span class="s4">0.2550111</span><span class="s2">, -</span><span class="s4">0.08072427</span><span class="s2">, -</span><span class="s4">0.03202878</span><span class="s2">, -</span><span class="s4">0.17581665</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s4">1.51493992</span><span class="s2">, </span><span class="s4">0.11805825</span><span class="s2">, </span><span class="s4">1.629455</span><span class="s2">, -</span><span class="s4">1.31506612</span><span class="s2">],</span>
                <span class="s2">[-</span><span class="s4">0.02765498</span><span class="s2">, </span><span class="s4">0.44679743</span><span class="s2">, </span><span class="s4">0.33192641</span><span class="s2">, -</span><span class="s4">0.27885413</span><span class="s2">],</span>
                <span class="s2">[</span><span class="s4">0.05951614</span><span class="s2">, -</span><span class="s4">2.69652057</span><span class="s2">, </span><span class="s4">1.28163262</span><span class="s2">, </span><span class="s4">0.34703478</span><span class="s2">],</span>
            <span class="s2">],</span>
            <span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;A&quot;</span><span class="s2">, </span><span class="s5">&quot;B&quot;</span><span class="s2">, </span><span class="s5">&quot;C&quot;</span><span class="s2">, </span><span class="s5">&quot;D&quot;</span><span class="s2">],</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">dti</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;date&quot;</span><span class="s2">] = </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;19920106 18:21:32.12&quot;</span><span class="s2">).</span><span class="s1">as_unit</span><span class="s2">(</span><span class="s5">&quot;ns&quot;</span><span class="s2">)</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">3</span><span class="s2">, </span><span class="s1">df</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">get_loc</span><span class="s2">(</span><span class="s5">&quot;date&quot;</span><span class="s2">)] = </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">)</span>
        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;modified&quot;</span><span class="s2">] = </span><span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;date&quot;</span><span class="s2">]</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s1">df</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">get_loc</span><span class="s2">(</span><span class="s5">&quot;modified&quot;</span><span class="s2">)] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span>

        <span class="s1">dirpath </span><span class="s2">= </span><span class="s1">datapath</span><span class="s2">(</span><span class="s5">&quot;io&quot;</span><span class="s2">, </span><span class="s5">&quot;json&quot;</span><span class="s2">, </span><span class="s5">&quot;data&quot;</span><span class="s2">)</span>
        <span class="s1">v12_json </span><span class="s2">= </span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s1">dirpath</span><span class="s2">, </span><span class="s5">&quot;tsframe_v012.json&quot;</span><span class="s2">)</span>
        <span class="s1">df_unser </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">v12_json</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">df_unser</span><span class="s2">)</span>

        <span class="s1">df_iso </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">drop</span><span class="s2">([</span><span class="s5">&quot;modified&quot;</span><span class="s2">], </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">v12_iso_json </span><span class="s2">= </span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s1">dirpath</span><span class="s2">, </span><span class="s5">&quot;tsframe_iso_v012.json&quot;</span><span class="s2">)</span>
        <span class="s1">df_unser_iso </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">v12_iso_json</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">df_iso</span><span class="s2">, </span><span class="s1">df_unser_iso</span><span class="s2">, </span><span class="s1">check_column_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_blocks_compat_GH9037</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">using_infer_string</span><span class="s2">):</span>
        <span class="s1">index </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;20000101&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">freq</span><span class="s2">=</span><span class="s5">&quot;h&quot;</span><span class="s2">)</span>
        <span class="s3"># freq doesn't round-trip</span>
        <span class="s1">index </span><span class="s2">= </span><span class="s1">DatetimeIndex</span><span class="s2">(</span><span class="s1">list</span><span class="s2">(</span><span class="s1">index</span><span class="s2">), </span><span class="s1">freq</span><span class="s2">=</span><span class="s0">None</span><span class="s2">)</span>

        <span class="s1">df_mixed </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span>
                <span class="s5">&quot;float_1&quot;</span><span class="s2">: [</span>
                    <span class="s2">-</span><span class="s4">0.92077639</span><span class="s2">,</span>
                    <span class="s4">0.77434435</span><span class="s2">,</span>
                    <span class="s4">1.25234727</span><span class="s2">,</span>
                    <span class="s4">0.61485564</span><span class="s2">,</span>
                    <span class="s2">-</span><span class="s4">0.60316077</span><span class="s2">,</span>
                    <span class="s4">0.24653374</span><span class="s2">,</span>
                    <span class="s4">0.28668979</span><span class="s2">,</span>
                    <span class="s2">-</span><span class="s4">2.51969012</span><span class="s2">,</span>
                    <span class="s4">0.95748401</span><span class="s2">,</span>
                    <span class="s2">-</span><span class="s4">1.02970536</span><span class="s2">,</span>
                <span class="s2">],</span>
                <span class="s5">&quot;int_1&quot;</span><span class="s2">: [</span>
                    <span class="s4">19680418</span><span class="s2">,</span>
                    <span class="s4">75337055</span><span class="s2">,</span>
                    <span class="s4">99973684</span><span class="s2">,</span>
                    <span class="s4">65103179</span><span class="s2">,</span>
                    <span class="s4">79373900</span><span class="s2">,</span>
                    <span class="s4">40314334</span><span class="s2">,</span>
                    <span class="s4">21290235</span><span class="s2">,</span>
                    <span class="s4">4991321</span><span class="s2">,</span>
                    <span class="s4">41903419</span><span class="s2">,</span>
                    <span class="s4">16008365</span><span class="s2">,</span>
                <span class="s2">],</span>
                <span class="s5">&quot;str_1&quot;</span><span class="s2">: [</span>
                    <span class="s5">&quot;78c608f1&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;64a99743&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;13d2ff52&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;ca7f4af2&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;97236474&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;bde7e214&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;1a6bde47&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;b1190be5&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;7a669144&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;8d64d068&quot;</span><span class="s2">,</span>
                <span class="s2">],</span>
                <span class="s5">&quot;float_2&quot;</span><span class="s2">: [</span>
                    <span class="s2">-</span><span class="s4">0.0428278</span><span class="s2">,</span>
                    <span class="s2">-</span><span class="s4">1.80872357</span><span class="s2">,</span>
                    <span class="s4">3.36042349</span><span class="s2">,</span>
                    <span class="s2">-</span><span class="s4">0.7573685</span><span class="s2">,</span>
                    <span class="s2">-</span><span class="s4">0.48217572</span><span class="s2">,</span>
                    <span class="s4">0.86229683</span><span class="s2">,</span>
                    <span class="s4">1.08935819</span><span class="s2">,</span>
                    <span class="s4">0.93898739</span><span class="s2">,</span>
                    <span class="s2">-</span><span class="s4">0.03030452</span><span class="s2">,</span>
                    <span class="s4">1.43366348</span><span class="s2">,</span>
                <span class="s2">],</span>
                <span class="s5">&quot;str_2&quot;</span><span class="s2">: [</span>
                    <span class="s5">&quot;14f04af9&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;d085da90&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;4bcfac83&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;81504caf&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;2ffef4a9&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;08e2f5c4&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;07e1af03&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;addbd4a7&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;1f6a09ba&quot;</span><span class="s2">,</span>
                    <span class="s5">&quot;4bfc4d87&quot;</span><span class="s2">,</span>
                <span class="s2">],</span>
                <span class="s5">&quot;int_2&quot;</span><span class="s2">: [</span>
                    <span class="s4">86967717</span><span class="s2">,</span>
                    <span class="s4">98098830</span><span class="s2">,</span>
                    <span class="s4">51927505</span><span class="s2">,</span>
                    <span class="s4">20372254</span><span class="s2">,</span>
                    <span class="s4">12601730</span><span class="s2">,</span>
                    <span class="s4">20884027</span><span class="s2">,</span>
                    <span class="s4">34193846</span><span class="s2">,</span>
                    <span class="s4">10561746</span><span class="s2">,</span>
                    <span class="s4">24867120</span><span class="s2">,</span>
                    <span class="s4">76131025</span><span class="s2">,</span>
                <span class="s2">],</span>
            <span class="s2">},</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">,</span>
        <span class="s2">)</span>

        <span class="s3"># JSON deserialisation always creates unicode strings</span>
        <span class="s1">df_mixed</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">df_mixed</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">str_ </span><span class="s0">if not </span><span class="s1">using_infer_string </span><span class="s0">else </span><span class="s5">&quot;string[pyarrow_numpy]&quot;</span>
        <span class="s2">)</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df_mixed</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;split&quot;</span><span class="s2">))</span>
        <span class="s1">df_roundtrip </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;split&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span>
            <span class="s1">df_mixed</span><span class="s2">,</span>
            <span class="s1">df_roundtrip</span><span class="s2">,</span>
            <span class="s1">check_index_type</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
            <span class="s1">check_column_type</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
            <span class="s1">by_blocks</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
            <span class="s1">check_exact</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_frame_nonprintable_bytes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH14256: failing column caused segfaults, if it is not the last one</span>

        <span class="s0">class </span><span class="s1">BinaryThing</span><span class="s2">:</span>
            <span class="s0">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">hexed</span><span class="s2">) </span><span class="s1">-&gt; </span><span class="s0">None</span><span class="s2">:</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">hexed </span><span class="s2">= </span><span class="s1">hexed</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">binary </span><span class="s2">= </span><span class="s1">bytes</span><span class="s2">.</span><span class="s1">fromhex</span><span class="s2">(</span><span class="s1">hexed</span><span class="s2">)</span>

            <span class="s0">def </span><span class="s1">__str__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">) </span><span class="s1">-&gt; str</span><span class="s2">:</span>
                <span class="s0">return </span><span class="s1">self</span><span class="s2">.</span><span class="s1">hexed</span>

        <span class="s1">hexed </span><span class="s2">= </span><span class="s5">&quot;574b4454ba8c5eb4f98a8f45&quot;</span>
        <span class="s1">binthing </span><span class="s2">= </span><span class="s1">BinaryThing</span><span class="s2">(</span><span class="s1">hexed</span><span class="s2">)</span>

        <span class="s3"># verify the proper conversion of printable content</span>
        <span class="s1">df_printable </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;A&quot;</span><span class="s2">: [</span><span class="s1">binthing</span><span class="s2">.</span><span class="s1">hexed</span><span class="s2">]})</span>
        <span class="s0">assert </span><span class="s1">df_printable</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">() == </span><span class="s5">f'</span><span class="s0">{{</span><span class="s5">&quot;A&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:&quot;</span><span class="s0">{</span><span class="s1">hexed</span><span class="s0">}</span><span class="s5">&quot;</span><span class="s0">}}}}</span><span class="s5">'</span>

        <span class="s3"># check if non-printable content throws appropriate Exception</span>
        <span class="s1">df_nonprintable </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;A&quot;</span><span class="s2">: [</span><span class="s1">binthing</span><span class="s2">]})</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;Unsupported UTF-8 sequence length when encoding string&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">df_nonprintable</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

        <span class="s3"># the same with multiple columns threw segfaults</span>
        <span class="s1">df_mixed </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;A&quot;</span><span class="s2">: [</span><span class="s1">binthing</span><span class="s2">], </span><span class="s5">&quot;B&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">]}, </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;A&quot;</span><span class="s2">, </span><span class="s5">&quot;B&quot;</span><span class="s2">])</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">df_mixed</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

        <span class="s3"># default_handler should resolve exceptions for non-string types</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df_nonprintable</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">default_handler</span><span class="s2">=</span><span class="s1">str</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">f'</span><span class="s0">{{</span><span class="s5">&quot;A&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:&quot;</span><span class="s0">{</span><span class="s1">hexed</span><span class="s0">}</span><span class="s5">&quot;</span><span class="s0">}}}}</span><span class="s5">'</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>
        <span class="s0">assert </span><span class="s2">(</span>
            <span class="s1">df_mixed</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">default_handler</span><span class="s2">=</span><span class="s1">str</span><span class="s2">)</span>
            <span class="s2">== </span><span class="s5">f'</span><span class="s0">{{</span><span class="s5">&quot;A&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:&quot;</span><span class="s0">{</span><span class="s1">hexed</span><span class="s0">}</span><span class="s5">&quot;</span><span class="s0">}}</span><span class="s5">,&quot;B&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:1</span><span class="s0">}}}}</span><span class="s5">'</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_label_overflow</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH14256: buffer length not checked when writing label</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;bar&quot; </span><span class="s2">* </span><span class="s4">100000</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">], </span><span class="s5">&quot;foo&quot;</span><span class="s2">: [</span><span class="s4">1337</span><span class="s2">]}).</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">f'</span><span class="s0">{{</span><span class="s5">&quot;</span><span class="s0">{</span><span class="s5">&quot;bar&quot; </span><span class="s2">* </span><span class="s4">100000</span><span class="s0">}</span><span class="s5">&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:1</span><span class="s0">}}</span><span class="s5">,&quot;foo&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:1337</span><span class="s0">}}}}</span><span class="s5">'</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s0">def </span><span class="s1">test_series_non_unique_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;Series index must be unique for orient='index'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;index&quot;</span><span class="s2">)</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span>
            <span class="s1">s</span><span class="s2">,</span>
            <span class="s1">read_json</span><span class="s2">(</span>
                <span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;split&quot;</span><span class="s2">)), </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span>
            <span class="s2">),</span>
        <span class="s2">)</span>
        <span class="s1">unserialized </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
            <span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">)), </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span>
        <span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">unserialized</span><span class="s2">.</span><span class="s1">values</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_default_orient</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">string_series</span><span class="s2">):</span>
        <span class="s0">assert </span><span class="s1">string_series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">() == </span><span class="s1">string_series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;index&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_roundtrip_simple</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">string_series</span><span class="s2">, </span><span class="s1">using_infer_string</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">string_series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">string_series</span>
        <span class="s0">if </span><span class="s1">using_infer_string </span><span class="s0">and </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">):</span>
            <span class="s3"># These schemas don't contain dtypes, so we infer string</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s5">&quot;string[pyarrow_numpy]&quot;</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;values&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">):</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">reset_index</span><span class="s2">(</span><span class="s1">drop</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s2">!= </span><span class="s5">&quot;split&quot;</span><span class="s2">:</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">name </span><span class="s2">= </span><span class="s0">None</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s0">None</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_series_roundtrip_object</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">object_series</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">object_series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">object_series</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;values&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">):</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">reset_index</span><span class="s2">(</span><span class="s1">drop</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s2">!= </span><span class="s5">&quot;split&quot;</span><span class="s2">:</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">name </span><span class="s2">= </span><span class="s0">None</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_roundtrip_empty</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s1">empty_series </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([], </span><span class="s1">index</span><span class="s2">=[], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">)</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">empty_series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">empty_series</span><span class="s2">.</span><span class="s1">reset_index</span><span class="s2">(</span><span class="s1">drop</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;split&quot;</span><span class="s2">):</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">)</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_roundtrip_timeseries</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">datetime_series</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">datetime_series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">datetime_series</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;values&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">):</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">reset_index</span><span class="s2">(</span><span class="s1">drop</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s2">!= </span><span class="s5">&quot;split&quot;</span><span class="s2">:</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">name </span><span class="s2">= </span><span class="s0">None</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">, </span><span class="s1">int</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_series_roundtrip_numeric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">6</span><span class="s2">), </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">, </span><span class="s5">&quot;e&quot;</span><span class="s2">, </span><span class="s5">&quot;f&quot;</span><span class="s2">])</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s0">if </span><span class="s1">orient </span><span class="s0">in </span><span class="s2">(</span><span class="s5">&quot;values&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">):</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">reset_index</span><span class="s2">(</span><span class="s1">drop</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_to_json_except</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;Invalid value 'garbage' for option 'orient'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;garbage&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_from_json_precise_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()), </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">precise_float</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">check_index_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_series_with_dtype</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH 21986</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()), </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">4</span><span class="s2">] * </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;dtype,expected&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span><span class="s0">True</span><span class="s2">, </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">&quot;2000-01-01&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;datetime64[ns]&quot;</span><span class="s2">)),</span>
            <span class="s2">(</span><span class="s0">False</span><span class="s2">, </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">946684800000</span><span class="s2">])),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_series_with_dtype_datetime</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">&quot;2000-01-01&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;datetime64[ns]&quot;</span><span class="s2">)</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_frame_from_json_precise_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">], [</span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">, </span><span class="s4">4.56</span><span class="s2">]])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()), </span><span class="s1">precise_float</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">df</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_typ</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">6</span><span class="s2">), </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">, </span><span class="s5">&quot;e&quot;</span><span class="s2">, </span><span class="s5">&quot;f&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;int64&quot;</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()), </span><span class="s1">typ</span><span class="s2">=</span><span class="s0">None</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_reconstruction_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()))</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">df</span><span class="s2">)</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s5">&quot;b&quot;</span><span class="s2">: [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]}, </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">&quot;A&quot;</span><span class="s2">, </span><span class="s5">&quot;B&quot;</span><span class="s2">, </span><span class="s5">&quot;C&quot;</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()))</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">df</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_path</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">float_frame</span><span class="s2">, </span><span class="s1">int_frame</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">ensure_clean</span><span class="s2">(</span><span class="s5">&quot;test.json&quot;</span><span class="s2">) </span><span class="s0">as </span><span class="s1">path</span><span class="s2">:</span>
            <span class="s0">for </span><span class="s1">df </span><span class="s0">in </span><span class="s2">[</span><span class="s1">float_frame</span><span class="s2">, </span><span class="s1">int_frame</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">]:</span>
                <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">path</span><span class="s2">)</span>
                <span class="s1">read_json</span><span class="s2">(</span><span class="s1">path</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_axis_dates</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datetime_series</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">):</span>
        <span class="s3"># frame</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">datetime_frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">)</span>

        <span class="s3"># series</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">datetime_series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">datetime_series</span><span class="s2">, </span><span class="s1">check_names</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result</span><span class="s2">.</span><span class="s1">name </span><span class="s0">is None</span>

    <span class="s0">def </span><span class="s1">test_convert_dates</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datetime_series</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">):</span>
        <span class="s3"># frame</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">datetime_frame</span>
        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;date&quot;</span><span class="s2">] = </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">).</span><span class="s1">as_unit</span><span class="s2">(</span><span class="s5">&quot;ns&quot;</span><span class="s2">)</span>

        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">df</span><span class="s2">)</span>

        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;foo&quot;</span><span class="s2">] = </span><span class="s4">1.0</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_unit</span><span class="s2">=</span><span class="s5">&quot;ns&quot;</span><span class="s2">))</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">, </span><span class="s1">convert_dates</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">expected</span><span class="s2">[</span><span class="s5">&quot;date&quot;</span><span class="s2">] = </span><span class="s1">expected</span><span class="s2">[</span><span class="s5">&quot;date&quot;</span><span class="s2">].</span><span class="s1">values</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s5">&quot;i8&quot;</span><span class="s2">)</span>
        <span class="s1">expected</span><span class="s2">[</span><span class="s5">&quot;foo&quot;</span><span class="s2">] = </span><span class="s1">expected</span><span class="s2">[</span><span class="s5">&quot;foo&quot;</span><span class="s2">].</span><span class="s1">astype</span><span class="s2">(</span><span class="s5">&quot;int64&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s3"># series</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">).</span><span class="s1">as_unit</span><span class="s2">(</span><span class="s5">&quot;ns&quot;</span><span class="s2">), </span><span class="s1">index</span><span class="s2">=</span><span class="s1">datetime_series</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">ts</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">ts</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;date_format&quot;</span><span class="s2">, [</span><span class="s5">&quot;epoch&quot;</span><span class="s2">, </span><span class="s5">&quot;iso&quot;</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;as_object&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;date_typ&quot;</span><span class="s2">, [</span><span class="s1">datetime</span><span class="s2">.</span><span class="s1">date</span><span class="s2">, </span><span class="s1">datetime</span><span class="s2">.</span><span class="s1">datetime</span><span class="s2">, </span><span class="s1">Timestamp</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_date_index_and_values</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">date_format</span><span class="s2">, </span><span class="s1">as_object</span><span class="s2">, </span><span class="s1">date_typ</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= [</span><span class="s1">date_typ</span><span class="s2">(</span><span class="s1">year</span><span class="s2">=</span><span class="s4">2020</span><span class="s2">, </span><span class="s1">month</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">day</span><span class="s2">=</span><span class="s4">1</span><span class="s2">), </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span><span class="s2">]</span>
        <span class="s0">if </span><span class="s1">as_object</span><span class="s2">:</span>
            <span class="s1">data</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s5">&quot;a&quot;</span><span class="s2">)</span>

        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">data</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s1">date_format</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">date_format </span><span class="s2">== </span><span class="s5">&quot;epoch&quot;</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;1577836800000&quot;:1577836800000,&quot;null&quot;:null}'</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= (</span>
                <span class="s5">'{&quot;2020-01-01T00:00:00.000&quot;:&quot;2020-01-01T00:00:00.000&quot;,&quot;null&quot;:null}'</span>
            <span class="s2">)</span>

        <span class="s0">if </span><span class="s1">as_object</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s5">&quot;}&quot;</span><span class="s2">, </span><span class="s5">',&quot;a&quot;:&quot;a&quot;}'</span><span class="s2">)</span>

        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;infer_word&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s5">&quot;trade_time&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;date&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;datetime&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;sold_at&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;modified&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;timestamp&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;timestamps&quot;</span><span class="s2">,</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_convert_dates_infer</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">infer_word</span><span class="s2">):</span>
        <span class="s3"># GH10747</span>

        <span class="s1">data </span><span class="s2">= [{</span><span class="s5">&quot;id&quot;</span><span class="s2">: </span><span class="s4">1</span><span class="s2">, </span><span class="s1">infer_word</span><span class="s2">: </span><span class="s4">1036713600000</span><span class="s2">}, {</span><span class="s5">&quot;id&quot;</span><span class="s2">: </span><span class="s4">2</span><span class="s2">}]</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">[[</span><span class="s4">1</span><span class="s2">, </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;2002-11-08&quot;</span><span class="s2">)], [</span><span class="s4">2</span><span class="s2">, </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;id&quot;</span><span class="s2">, </span><span class="s1">infer_word</span><span class="s2">]</span>
        <span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)))[[</span><span class="s5">&quot;id&quot;</span><span class="s2">, </span><span class="s1">infer_word</span><span class="s2">]]</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;date,date_unit&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42&quot;</span><span class="s2">, </span><span class="s5">&quot;s&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123&quot;</span><span class="s2">, </span><span class="s5">&quot;ms&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123456&quot;</span><span class="s2">, </span><span class="s5">&quot;us&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123456789&quot;</span><span class="s2">, </span><span class="s5">&quot;ns&quot;</span><span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_date_format_frame</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">date</span><span class="s2">, </span><span class="s1">date_unit</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">datetime_frame</span>

        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;date&quot;</span><span class="s2">] = </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s1">date</span><span class="s2">).</span><span class="s1">as_unit</span><span class="s2">(</span><span class="s5">&quot;ns&quot;</span><span class="s2">)</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s1">df</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">get_loc</span><span class="s2">(</span><span class="s5">&quot;date&quot;</span><span class="s2">)] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">5</span><span class="s2">, </span><span class="s1">df</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">get_loc</span><span class="s2">(</span><span class="s5">&quot;date&quot;</span><span class="s2">)] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span>
        <span class="s0">if </span><span class="s1">date_unit</span><span class="s2">:</span>
            <span class="s1">json </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s5">&quot;iso&quot;</span><span class="s2">, </span><span class="s1">date_unit</span><span class="s2">=</span><span class="s1">date_unit</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">json </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s5">&quot;iso&quot;</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">json</span><span class="s2">))</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_date_format_frame_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">datetime_frame</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;Invalid value 'foo' for option 'date_unit'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s5">&quot;iso&quot;</span><span class="s2">, </span><span class="s1">date_unit</span><span class="s2">=</span><span class="s5">&quot;foo&quot;</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;date,date_unit&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42&quot;</span><span class="s2">, </span><span class="s5">&quot;s&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123&quot;</span><span class="s2">, </span><span class="s5">&quot;ms&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123456&quot;</span><span class="s2">, </span><span class="s5">&quot;us&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123456789&quot;</span><span class="s2">, </span><span class="s5">&quot;ns&quot;</span><span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_date_format_series</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">date</span><span class="s2">, </span><span class="s1">date_unit</span><span class="s2">, </span><span class="s1">datetime_series</span><span class="s2">):</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s1">date</span><span class="s2">).</span><span class="s1">as_unit</span><span class="s2">(</span><span class="s5">&quot;ns&quot;</span><span class="s2">), </span><span class="s1">index</span><span class="s2">=</span><span class="s1">datetime_series</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>
        <span class="s1">ts</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">1</span><span class="s2">] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span>
        <span class="s1">ts</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">5</span><span class="s2">] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span>
        <span class="s0">if </span><span class="s1">date_unit</span><span class="s2">:</span>
            <span class="s1">json </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s5">&quot;iso&quot;</span><span class="s2">, </span><span class="s1">date_unit</span><span class="s2">=</span><span class="s1">date_unit</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">json </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s5">&quot;iso&quot;</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">json</span><span class="s2">), </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_date_format_series_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datetime_series</span><span class="s2">):</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130101 20:43:42.123&quot;</span><span class="s2">), </span><span class="s1">index</span><span class="s2">=</span><span class="s1">datetime_series</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;Invalid value 'foo' for option 'date_unit'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">ts</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s5">&quot;iso&quot;</span><span class="s2">, </span><span class="s1">date_unit</span><span class="s2">=</span><span class="s5">&quot;foo&quot;</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;unit&quot;</span><span class="s2">, [</span><span class="s5">&quot;s&quot;</span><span class="s2">, </span><span class="s5">&quot;ms&quot;</span><span class="s2">, </span><span class="s5">&quot;us&quot;</span><span class="s2">, </span><span class="s5">&quot;ns&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_date_unit</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">unit</span><span class="s2">, </span><span class="s1">datetime_frame</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">datetime_frame</span>
        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;date&quot;</span><span class="s2">] = </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130101 20:43:42&quot;</span><span class="s2">).</span><span class="s1">as_unit</span><span class="s2">(</span><span class="s5">&quot;ns&quot;</span><span class="s2">)</span>
        <span class="s1">dl </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">get_loc</span><span class="s2">(</span><span class="s5">&quot;date&quot;</span><span class="s2">)</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s1">dl</span><span class="s2">] = </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;19710101 20:43:42&quot;</span><span class="s2">)</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s1">dl</span><span class="s2">] = </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;21460101 20:43:42&quot;</span><span class="s2">)</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">iloc</span><span class="s2">[</span><span class="s4">4</span><span class="s2">, </span><span class="s1">dl</span><span class="s2">] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span>

        <span class="s1">json </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s5">&quot;epoch&quot;</span><span class="s2">, </span><span class="s1">date_unit</span><span class="s2">=</span><span class="s1">unit</span><span class="s2">)</span>

        <span class="s3"># force date unit</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">json</span><span class="s2">), </span><span class="s1">date_unit</span><span class="s2">=</span><span class="s1">unit</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">df</span><span class="s2">)</span>

        <span class="s3"># detect date unit</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">json</span><span class="s2">), </span><span class="s1">date_unit</span><span class="s2">=</span><span class="s0">None</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">df</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;unit&quot;</span><span class="s2">, [</span><span class="s5">&quot;s&quot;</span><span class="s2">, </span><span class="s5">&quot;ms&quot;</span><span class="s2">, </span><span class="s5">&quot;us&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_iso_non_nano_datetimes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">unit</span><span class="s2">):</span>
        <span class="s3"># Test that numpy datetimes</span>
        <span class="s3"># in an Index or a column with non-nano resolution can be serialized</span>
        <span class="s3"># correctly</span>
        <span class="s3"># GH53686</span>
        <span class="s1">index </span><span class="s2">= </span><span class="s1">DatetimeIndex</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">datetime64</span><span class="s2">(</span><span class="s5">&quot;2023-01-01T11:22:33.123456&quot;</span><span class="s2">, </span><span class="s1">unit</span><span class="s2">)],</span>
            <span class="s1">dtype</span><span class="s2">=</span><span class="s5">f&quot;datetime64[</span><span class="s0">{</span><span class="s1">unit</span><span class="s0">}</span><span class="s5">]&quot;</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span>
                <span class="s5">&quot;date&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">(</span>
                    <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">datetime64</span><span class="s2">(</span><span class="s5">&quot;2022-01-01T11:22:33.123456&quot;</span><span class="s2">, </span><span class="s1">unit</span><span class="s2">)],</span>
                    <span class="s1">dtype</span><span class="s2">=</span><span class="s5">f&quot;datetime64[</span><span class="s0">{</span><span class="s1">unit</span><span class="s0">}</span><span class="s5">]&quot;</span><span class="s2">,</span>
                    <span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">,</span>
                <span class="s2">),</span>
                <span class="s5">&quot;date_obj&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">(</span>
                    <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">datetime64</span><span class="s2">(</span><span class="s5">&quot;2023-01-01T11:22:33.123456&quot;</span><span class="s2">, </span><span class="s1">unit</span><span class="s2">)],</span>
                    <span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">,</span>
                    <span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">,</span>
                <span class="s2">),</span>
            <span class="s2">},</span>
        <span class="s2">)</span>

        <span class="s1">buf </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">()</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">buf</span><span class="s2">, </span><span class="s1">date_format</span><span class="s2">=</span><span class="s5">&quot;iso&quot;</span><span class="s2">, </span><span class="s1">date_unit</span><span class="s2">=</span><span class="s1">unit</span><span class="s2">)</span>
        <span class="s1">buf</span><span class="s2">.</span><span class="s1">seek</span><span class="s2">(</span><span class="s4">0</span><span class="s2">)</span>

        <span class="s3"># read_json always reads datetimes in nanosecond resolution</span>
        <span class="s3"># TODO: check_dtype/check_index_type should be removable</span>
        <span class="s3"># once read_json gets non-nano support</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">buf</span><span class="s2">, </span><span class="s1">convert_dates</span><span class="s2">=[</span><span class="s5">&quot;date&quot;</span><span class="s2">, </span><span class="s5">&quot;date_obj&quot;</span><span class="s2">]),</span>
            <span class="s1">df</span><span class="s2">,</span>
            <span class="s1">check_index_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
            <span class="s1">check_dtype</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weird_nested_json</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># this used to core dump the parser</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s5">r&quot;&quot;&quot;{ 
        &quot;status&quot;: &quot;success&quot;, 
        &quot;data&quot;: { 
        &quot;posts&quot;: [ 
            { 
            &quot;id&quot;: 1, 
            &quot;title&quot;: &quot;A blog post&quot;, 
            &quot;body&quot;: &quot;Some useful content&quot; 
            }, 
            { 
            &quot;id&quot;: 2, 
            &quot;title&quot;: &quot;Another blog post&quot;, 
            &quot;body&quot;: &quot;More content&quot; 
            } 
           ] 
          } 
        }&quot;&quot;&quot;</span>
        <span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_doc_example</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dfj2 </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s4">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">((</span><span class="s4">5</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)), </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">list</span><span class="s2">(</span><span class="s5">&quot;AB&quot;</span><span class="s2">)</span>
        <span class="s2">)</span>
        <span class="s1">dfj2</span><span class="s2">[</span><span class="s5">&quot;date&quot;</span><span class="s2">] = </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">)</span>
        <span class="s1">dfj2</span><span class="s2">[</span><span class="s5">&quot;ints&quot;</span><span class="s2">] = </span><span class="s1">range</span><span class="s2">(</span><span class="s4">5</span><span class="s2">)</span>
        <span class="s1">dfj2</span><span class="s2">[</span><span class="s5">&quot;bools&quot;</span><span class="s2">] = </span><span class="s0">True</span>
        <span class="s1">dfj2</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">dfj2</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">={</span><span class="s5">&quot;ints&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">, </span><span class="s5">&quot;bools&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool_</span><span class="s2">})</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">result</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_round_trip_exception</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
        <span class="s3"># GH 3867</span>
        <span class="s1">path </span><span class="s2">= </span><span class="s1">datapath</span><span class="s2">(</span><span class="s5">&quot;io&quot;</span><span class="s2">, </span><span class="s5">&quot;json&quot;</span><span class="s2">, </span><span class="s5">&quot;data&quot;</span><span class="s2">, </span><span class="s5">&quot;teams.csv&quot;</span><span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">read_csv</span><span class="s2">(</span><span class="s1">path</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">s</span><span class="s2">))</span>
        <span class="s1">res </span><span class="s2">= </span><span class="s1">result</span><span class="s2">.</span><span class="s1">reindex</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s1">df</span><span class="s2">.</span><span class="s1">index</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">df</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">)</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;The 'downcast' keyword in fillna is deprecated&quot;</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">res </span><span class="s2">= </span><span class="s1">res</span><span class="s2">.</span><span class="s1">fillna</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">downcast</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">res</span><span class="s2">, </span><span class="s1">df</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">network</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">single_cpu</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;field,dtype&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">[</span><span class="s5">&quot;created_at&quot;</span><span class="s2">, </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">DatetimeTZDtype</span><span class="s2">(</span><span class="s1">tz</span><span class="s2">=</span><span class="s5">&quot;UTC&quot;</span><span class="s2">)],</span>
            <span class="s2">[</span><span class="s5">&quot;closed_at&quot;</span><span class="s2">, </span><span class="s5">&quot;datetime64[ns]&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s5">&quot;updated_at&quot;</span><span class="s2">, </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">DatetimeTZDtype</span><span class="s2">(</span><span class="s1">tz</span><span class="s2">=</span><span class="s5">&quot;UTC&quot;</span><span class="s2">)],</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_url</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">field</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">httpserver</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s5">'{&quot;created_at&quot;: [&quot;2023-06-23T18:21:36Z&quot;], &quot;closed_at&quot;: [&quot;2023-06-23T18:21:36&quot;], &quot;updated_at&quot;: [&quot;2023-06-23T18:21:36Z&quot;]}</span><span class="s0">\n</span><span class="s5">'  </span><span class="s3"># noqa: E501</span>
        <span class="s1">httpserver</span><span class="s2">.</span><span class="s1">serve_content</span><span class="s2">(</span><span class="s1">content</span><span class="s2">=</span><span class="s1">data</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">httpserver</span><span class="s2">.</span><span class="s1">url</span><span class="s2">, </span><span class="s1">convert_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result</span><span class="s2">[</span><span class="s1">field</span><span class="s2">].</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">dtype</span>

    <span class="s0">def </span><span class="s1">test_timedelta</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">converter </span><span class="s2">= </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">to_timedelta</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">unit</span><span class="s2">=</span><span class="s5">&quot;ms&quot;</span><span class="s2">)</span>

        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">timedelta</span><span class="s2">(</span><span class="s4">23</span><span class="s2">), </span><span class="s1">timedelta</span><span class="s2">(</span><span class="s1">seconds</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)])</span>
        <span class="s0">assert </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s5">&quot;timedelta64[ns]&quot;</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()), </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">).</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">converter</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">ser</span><span class="s2">)</span>

        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">timedelta</span><span class="s2">(</span><span class="s4">23</span><span class="s2">), </span><span class="s1">timedelta</span><span class="s2">(</span><span class="s1">seconds</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]))</span>
        <span class="s0">assert </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s5">&quot;timedelta64[ns]&quot;</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()), </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">).</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">converter</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">ser</span><span class="s2">)</span>

        <span class="s1">frame </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([</span><span class="s1">timedelta</span><span class="s2">(</span><span class="s4">23</span><span class="s2">), </span><span class="s1">timedelta</span><span class="s2">(</span><span class="s1">seconds</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)])</span>
        <span class="s0">assert </span><span class="s1">frame</span><span class="s2">[</span><span class="s4">0</span><span class="s2">].</span><span class="s1">dtype </span><span class="s2">== </span><span class="s5">&quot;timedelta64[ns]&quot;</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span>
            <span class="s1">frame</span><span class="s2">, </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">())).</span><span class="s1">apply</span><span class="s2">(</span><span class="s1">converter</span><span class="s2">)</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_timedelta2</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">frame </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span>
                <span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s1">timedelta</span><span class="s2">(</span><span class="s1">days</span><span class="s2">=</span><span class="s4">23</span><span class="s2">), </span><span class="s1">timedelta</span><span class="s2">(</span><span class="s1">seconds</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)],</span>
                <span class="s5">&quot;b&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">],</span>
                <span class="s5">&quot;c&quot;</span><span class="s2">: </span><span class="s1">date_range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">=</span><span class="s5">&quot;20130101&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">2</span><span class="s2">),</span>
            <span class="s2">}</span>
        <span class="s2">)</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_unit</span><span class="s2">=</span><span class="s5">&quot;ns&quot;</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>
        <span class="s1">result</span><span class="s2">[</span><span class="s5">&quot;a&quot;</span><span class="s2">] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">to_timedelta</span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">a</span><span class="s2">, </span><span class="s1">unit</span><span class="s2">=</span><span class="s5">&quot;ns&quot;</span><span class="s2">)</span>
        <span class="s1">result</span><span class="s2">[</span><span class="s5">&quot;c&quot;</span><span class="s2">] = </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">to_datetime</span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">c</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">frame</span><span class="s2">, </span><span class="s1">result</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_mixed_timedelta_datetime</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">td </span><span class="s2">= </span><span class="s1">timedelta</span><span class="s2">(</span><span class="s4">23</span><span class="s2">)</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">)</span>
        <span class="s1">frame </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s1">td</span><span class="s2">, </span><span class="s1">ts</span><span class="s2">]}, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Timedelta</span><span class="s2">(</span><span class="s1">td</span><span class="s2">).</span><span class="s1">as_unit</span><span class="s2">(</span><span class="s5">&quot;ns&quot;</span><span class="s2">).</span><span class="s1">_value</span><span class="s2">, </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">as_unit</span><span class="s2">(</span><span class="s5">&quot;ns&quot;</span><span class="s2">).</span><span class="s1">_value</span><span class="s2">]}</span>
        <span class="s2">)</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_unit</span><span class="s2">=</span><span class="s5">&quot;ns&quot;</span><span class="s2">))</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">={</span><span class="s5">&quot;a&quot;</span><span class="s2">: </span><span class="s5">&quot;int64&quot;</span><span class="s2">})</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">check_index_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;as_object&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;date_format&quot;</span><span class="s2">, [</span><span class="s5">&quot;iso&quot;</span><span class="s2">, </span><span class="s5">&quot;epoch&quot;</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;timedelta_typ&quot;</span><span class="s2">, [</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Timedelta</span><span class="s2">, </span><span class="s1">timedelta</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_timedelta_to_json</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">as_object</span><span class="s2">, </span><span class="s1">date_format</span><span class="s2">, </span><span class="s1">timedelta_typ</span><span class="s2">):</span>
        <span class="s3"># GH28156: to_json not correctly formatting Timedelta</span>
        <span class="s1">data </span><span class="s2">= [</span><span class="s1">timedelta_typ</span><span class="s2">(</span><span class="s1">days</span><span class="s2">=</span><span class="s4">1</span><span class="s2">), </span><span class="s1">timedelta_typ</span><span class="s2">(</span><span class="s1">days</span><span class="s2">=</span><span class="s4">2</span><span class="s2">), </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">NaT</span><span class="s2">]</span>
        <span class="s0">if </span><span class="s1">as_object</span><span class="s2">:</span>
            <span class="s1">data</span><span class="s2">.</span><span class="s1">append</span><span class="s2">(</span><span class="s5">&quot;a&quot;</span><span class="s2">)</span>

        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">data</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">date_format </span><span class="s2">== </span><span class="s5">&quot;iso&quot;</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= (</span>
                <span class="s5">'{&quot;P1DT0H0M0S&quot;:&quot;P1DT0H0M0S&quot;,&quot;P2DT0H0M0S&quot;:&quot;P2DT0H0M0S&quot;,&quot;null&quot;:null}'</span>
            <span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;86400000&quot;:86400000,&quot;172800000&quot;:172800000,&quot;null&quot;:null}'</span>

        <span class="s0">if </span><span class="s1">as_object</span><span class="s2">:</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s5">&quot;}&quot;</span><span class="s2">, </span><span class="s5">',&quot;a&quot;:&quot;a&quot;}'</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s1">date_format</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;as_object&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;timedelta_typ&quot;</span><span class="s2">, [</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Timedelta</span><span class="s2">, </span><span class="s1">timedelta</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_timedelta_to_json_fractional_precision</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">as_object</span><span class="s2">, </span><span class="s1">timedelta_typ</span><span class="s2">):</span>
        <span class="s1">data </span><span class="s2">= [</span><span class="s1">timedelta_typ</span><span class="s2">(</span><span class="s1">milliseconds</span><span class="s2">=</span><span class="s4">42</span><span class="s2">)]</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">data</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">as_object</span><span class="s2">:</span>
            <span class="s1">ser </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;42&quot;:42}'</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s0">def </span><span class="s1">test_default_handler</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">value </span><span class="s2">= </span><span class="s1">object</span><span class="s2">()</span>
        <span class="s1">frame </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">7</span><span class="s2">, </span><span class="s1">value</span><span class="s2">]})</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">7</span><span class="s2">, </span><span class="s1">str</span><span class="s2">(</span><span class="s1">value</span><span class="s2">)]})</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">frame</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">default_handler</span><span class="s2">=</span><span class="s1">str</span><span class="s2">)))</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">result</span><span class="s2">, </span><span class="s1">check_index_type</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_default_handler_indirect</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">default</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">):</span>
            <span class="s0">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">, </span><span class="s1">complex</span><span class="s2">):</span>
                <span class="s0">return </span><span class="s2">[(</span><span class="s5">&quot;mathjs&quot;</span><span class="s2">, </span><span class="s5">&quot;Complex&quot;</span><span class="s2">), (</span><span class="s5">&quot;re&quot;</span><span class="s2">, </span><span class="s1">obj</span><span class="s2">.</span><span class="s1">real</span><span class="s2">), (</span><span class="s5">&quot;im&quot;</span><span class="s2">, </span><span class="s1">obj</span><span class="s2">.</span><span class="s1">imag</span><span class="s2">)]</span>
            <span class="s0">return </span><span class="s1">str</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">)</span>

        <span class="s1">df_list </span><span class="s2">= [</span>
            <span class="s4">9</span><span class="s2">,</span>
            <span class="s1">DataFrame</span><span class="s2">(</span>
                <span class="s2">{</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s5">&quot;STR&quot;</span><span class="s2">, </span><span class="s1">complex</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, -</span><span class="s4">5</span><span class="s2">)], </span><span class="s5">&quot;b&quot;</span><span class="s2">: [</span><span class="s1">float</span><span class="s2">(</span><span class="s5">&quot;nan&quot;</span><span class="s2">), </span><span class="s0">None</span><span class="s2">, </span><span class="s5">&quot;N/A&quot;</span><span class="s2">]},</span>
                <span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">],</span>
            <span class="s2">),</span>
        <span class="s2">]</span>
        <span class="s1">expected </span><span class="s2">= (</span>
            <span class="s5">'[9,[[1,null],[&quot;STR&quot;,null],[[[&quot;mathjs&quot;,&quot;Complex&quot;],'</span>
            <span class="s5">'[&quot;re&quot;,4.0],[&quot;im&quot;,-5.0]],&quot;N</span><span class="s0">\\</span><span class="s5">/A&quot;]]]'</span>
        <span class="s2">)</span>
        <span class="s0">assert </span><span class="s2">(</span>
            <span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">df_list</span><span class="s2">, </span><span class="s1">default_handler</span><span class="s2">=</span><span class="s1">default</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;values&quot;</span><span class="s2">) == </span><span class="s1">expected</span>
        <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_default_handler_numpy_unsupported_dtype</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH12554 to_json raises 'Unhandled numpy dtype 15'</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2.3</span><span class="s2">, </span><span class="s1">complex</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, -</span><span class="s4">5</span><span class="s2">)], </span><span class="s5">&quot;b&quot;</span><span class="s2">: [</span><span class="s1">float</span><span class="s2">(</span><span class="s5">&quot;nan&quot;</span><span class="s2">), </span><span class="s0">None</span><span class="s2">, </span><span class="s1">complex</span><span class="s2">(</span><span class="s4">1.2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">)]},</span>
            <span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">],</span>
        <span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= (</span>
            <span class="s5">'[[&quot;(1+0j)&quot;,&quot;(nan+0j)&quot;],'</span>
            <span class="s5">'[&quot;(2.3+0j)&quot;,&quot;(nan+0j)&quot;],'</span>
            <span class="s5">'[&quot;(4-5j)&quot;,&quot;(1.2+0j)&quot;]]'</span>
        <span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">default_handler</span><span class="s2">=</span><span class="s1">str</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;values&quot;</span><span class="s2">) == </span><span class="s1">expected</span>

    <span class="s0">def </span><span class="s1">test_default_handler_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;raisin&quot;</span>

        <span class="s0">def </span><span class="s1">my_handler_raises</span><span class="s2">(</span><span class="s1">obj</span><span class="s2">):</span>
            <span class="s0">raise </span><span class="s1">TypeError</span><span class="s2">(</span><span class="s1">msg</span><span class="s2">)</span>

        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">object</span><span class="s2">()]}).</span><span class="s1">to_json</span><span class="s2">(</span>
                <span class="s1">default_handler</span><span class="s2">=</span><span class="s1">my_handler_raises</span>
            <span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">complex</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, -</span><span class="s4">5</span><span class="s2">)]}).</span><span class="s1">to_json</span><span class="s2">(</span>
                <span class="s1">default_handler</span><span class="s2">=</span><span class="s1">my_handler_raises</span>
            <span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_categorical</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH4377 df.to_json segfaults with non-ndarray blocks</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;a&quot;</span><span class="s2">]})</span>
        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;B&quot;</span><span class="s2">] = </span><span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;A&quot;</span><span class="s2">]</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

        <span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;B&quot;</span><span class="s2">] = </span><span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;A&quot;</span><span class="s2">].</span><span class="s1">astype</span><span class="s2">(</span><span class="s5">&quot;category&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">expected </span><span class="s2">== </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

        <span class="s1">s </span><span class="s2">= </span><span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;A&quot;</span><span class="s2">]</span>
        <span class="s1">sc </span><span class="s2">= </span><span class="s1">df</span><span class="s2">[</span><span class="s5">&quot;B&quot;</span><span class="s2">]</span>
        <span class="s0">assert </span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">() == </span><span class="s1">sc</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_datetime_tz</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH4377 df.to_json segfaults with non-ndarray blocks</span>
        <span class="s1">tz_range </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">tz</span><span class="s2">=</span><span class="s5">&quot;US/Eastern&quot;</span><span class="s2">)</span>
        <span class="s1">tz_naive </span><span class="s2">= </span><span class="s1">tz_range</span><span class="s2">.</span><span class="s1">tz_convert</span><span class="s2">(</span><span class="s5">&quot;utc&quot;</span><span class="s2">).</span><span class="s1">tz_localize</span><span class="s2">(</span><span class="s0">None</span><span class="s2">)</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;A&quot;</span><span class="s2">: </span><span class="s1">tz_range</span><span class="s2">, </span><span class="s5">&quot;B&quot;</span><span class="s2">: </span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;20130101&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)})</span>

        <span class="s1">df_naive </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">df_naive</span><span class="s2">[</span><span class="s5">&quot;A&quot;</span><span class="s2">] = </span><span class="s1">tz_naive</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df_naive</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">expected </span><span class="s2">== </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

        <span class="s1">stz </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">tz_range</span><span class="s2">)</span>
        <span class="s1">s_naive </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">tz_naive</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">stz</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">() == </span><span class="s1">s_naive</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_sparse</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH4377 df.to_json segfaults with non-ndarray blocks</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s4">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">((</span><span class="s4">10</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)))</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[:</span><span class="s4">8</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span>

        <span class="s1">sdf </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s5">&quot;Sparse&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">expected </span><span class="s2">== </span><span class="s1">sdf</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

        <span class="s1">s </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s4">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s4">10</span><span class="s2">))</span>
        <span class="s1">s</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[:</span><span class="s4">8</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span>
        <span class="s1">ss </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s5">&quot;Sparse&quot;</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">s</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">expected </span><span class="s2">== </span><span class="s1">ss</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;ts&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;2013-01-10 05:00:00Z&quot;</span><span class="s2">),</span>
            <span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;2013-01-10 00:00:00&quot;</span><span class="s2">, </span><span class="s1">tz</span><span class="s2">=</span><span class="s5">&quot;US/Eastern&quot;</span><span class="s2">),</span>
            <span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;2013-01-10 00:00:00-0500&quot;</span><span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_tz_is_utc</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">ts</span><span class="s2">):</span>
        <span class="s1">exp </span><span class="s2">= </span><span class="s5">'&quot;2013-01-10T05:00:00.000Z&quot;'</span>

        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">ts</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>
        <span class="s1">dt </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">to_pydatetime</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>

    <span class="s0">def </span><span class="s1">test_tz_is_naive</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">ts </span><span class="s2">= </span><span class="s1">Timestamp</span><span class="s2">(</span><span class="s5">&quot;2013-01-10 05:00:00&quot;</span><span class="s2">)</span>
        <span class="s1">exp </span><span class="s2">= </span><span class="s5">'&quot;2013-01-10T05:00:00.000&quot;'</span>

        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">ts</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>
        <span class="s1">dt </span><span class="s2">= </span><span class="s1">ts</span><span class="s2">.</span><span class="s1">to_pydatetime</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;tz_range&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;2013-01-01 05:00:00Z&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">2</span><span class="s2">),</span>
            <span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;2013-01-01 00:00:00&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">tz</span><span class="s2">=</span><span class="s5">&quot;US/Eastern&quot;</span><span class="s2">),</span>
            <span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;2013-01-01 00:00:00-0500&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">2</span><span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_tz_range_is_utc</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">tz_range</span><span class="s2">):</span>
        <span class="s1">exp </span><span class="s2">= </span><span class="s5">'[&quot;2013-01-01T05:00:00.000Z&quot;,&quot;2013-01-02T05:00:00.000Z&quot;]'</span>
        <span class="s1">dfexp </span><span class="s2">= (</span>
            <span class="s5">'{&quot;DT&quot;:{'</span>
            <span class="s5">'&quot;0&quot;:&quot;2013-01-01T05:00:00.000Z&quot;,'</span>
            <span class="s5">'&quot;1&quot;:&quot;2013-01-02T05:00:00.000Z&quot;}}'</span>
        <span class="s2">)</span>

        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">tz_range</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>
        <span class="s1">dti </span><span class="s2">= </span><span class="s1">DatetimeIndex</span><span class="s2">(</span><span class="s1">tz_range</span><span class="s2">)</span>
        <span class="s3"># Ensure datetimes in object array are serialized correctly</span>
        <span class="s3"># in addition to the normal DTI case</span>
        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">dti</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>
        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">dti</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">), </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;DT&quot;</span><span class="s2">: </span><span class="s1">dti</span><span class="s2">})</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">dfexp</span>
        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">({</span><span class="s5">&quot;DT&quot;</span><span class="s2">: </span><span class="s1">object</span><span class="s2">}), </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_tz_range_is_naive</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dti </span><span class="s2">= </span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;2013-01-01 05:00:00&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s4">2</span><span class="s2">)</span>

        <span class="s1">exp </span><span class="s2">= </span><span class="s5">'[&quot;2013-01-01T05:00:00.000&quot;,&quot;2013-01-02T05:00:00.000&quot;]'</span>
        <span class="s1">dfexp </span><span class="s2">= </span><span class="s5">'{&quot;DT&quot;:{&quot;0&quot;:&quot;2013-01-01T05:00:00.000&quot;,&quot;1&quot;:&quot;2013-01-02T05:00:00.000&quot;}}'</span>

        <span class="s3"># Ensure datetimes in object array are serialized correctly</span>
        <span class="s3"># in addition to the normal DTI case</span>
        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">dti</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>
        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">dti</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">), </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) == </span><span class="s1">exp</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;DT&quot;</span><span class="s2">: </span><span class="s1">dti</span><span class="s2">})</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">dfexp</span>
        <span class="s0">assert </span><span class="s1">ujson_dumps</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">astype</span><span class="s2">({</span><span class="s5">&quot;DT&quot;</span><span class="s2">: </span><span class="s1">object</span><span class="s2">}), </span><span class="s1">iso_dates</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_read_inline_jsonl</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH9180</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s5">'{&quot;a&quot;: 1, &quot;b&quot;: 2}</span><span class="s0">\n</span><span class="s5">{&quot;b&quot;:2, &quot;a&quot; :1}</span><span class="s0">\n</span><span class="s5">'</span><span class="s2">), </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">single_cpu</span>
    <span class="s2">@</span><span class="s1">td</span><span class="s2">.</span><span class="s1">skip_if_not_us_locale</span>
    <span class="s0">def </span><span class="s1">test_read_s3_jsonl</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">s3_public_bucket_with_data</span><span class="s2">, </span><span class="s1">s3so</span><span class="s2">):</span>
        <span class="s3"># GH17200</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
            <span class="s5">f&quot;s3n://</span><span class="s0">{</span><span class="s1">s3_public_bucket_with_data</span><span class="s2">.</span><span class="s1">name</span><span class="s0">}</span><span class="s5">/items.jsonl&quot;</span><span class="s2">,</span>
            <span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
            <span class="s1">storage_options</span><span class="s2">=</span><span class="s1">s3so</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_read_local_jsonl</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH17200</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">ensure_clean</span><span class="s2">(</span><span class="s5">&quot;tmp_items.json&quot;</span><span class="s2">) </span><span class="s0">as </span><span class="s1">path</span><span class="s2">:</span>
            <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">path</span><span class="s2">, </span><span class="s5">&quot;w&quot;</span><span class="s2">, </span><span class="s1">encoding</span><span class="s2">=</span><span class="s5">&quot;utf-8&quot;</span><span class="s2">) </span><span class="s0">as </span><span class="s1">infile</span><span class="s2">:</span>
                <span class="s1">infile</span><span class="s2">.</span><span class="s1">write</span><span class="s2">(</span><span class="s5">'{&quot;a&quot;: 1, &quot;b&quot;: 2}</span><span class="s0">\n</span><span class="s5">{&quot;b&quot;:2, &quot;a&quot; :1}</span><span class="s0">\n</span><span class="s5">'</span><span class="s2">)</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">path</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
            <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_read_jsonl_unicode_chars</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH15132: non-ascii unicode characters</span>
        <span class="s3"># \u201d == RIGHT DOUBLE QUOTATION MARK</span>

        <span class="s3"># simulate file handle</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s5">'{&quot;a&quot;: &quot;foo”&quot;, &quot;b&quot;: &quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">{&quot;a&quot;: &quot;foo&quot;, &quot;b&quot;: &quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">'</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">json</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;foo</span><span class="s0">\u201d</span><span class="s5">&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">], [</span><span class="s5">&quot;foo&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s3"># simulate string</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s5">'{&quot;a&quot;: &quot;foo”&quot;, &quot;b&quot;: &quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">{&quot;a&quot;: &quot;foo&quot;, &quot;b&quot;: &quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">'</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;foo</span><span class="s0">\u201d</span><span class="s5">&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">], [</span><span class="s5">&quot;foo&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;bigNum&quot;</span><span class="s2">, [</span><span class="s1">sys</span><span class="s2">.</span><span class="s1">maxsize </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">, -(</span><span class="s1">sys</span><span class="s2">.</span><span class="s1">maxsize </span><span class="s2">+ </span><span class="s4">2</span><span class="s2">)])</span>
    <span class="s0">def </span><span class="s1">test_to_json_large_numbers</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">bigNum</span><span class="s2">):</span>
        <span class="s3"># GH34473</span>
        <span class="s1">series </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">bigNum</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">&quot;articleId&quot;</span><span class="s2">])</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;articleId&quot;:' </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">bigNum</span><span class="s2">) + </span><span class="s5">&quot;}&quot;</span>
        <span class="s0">assert </span><span class="s1">json </span><span class="s2">== </span><span class="s1">expected</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">bigNum</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">&quot;articleId&quot;</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;0&quot;:{&quot;articleId&quot;:' </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">bigNum</span><span class="s2">) + </span><span class="s5">&quot;}}&quot;</span>
        <span class="s0">assert </span><span class="s1">json </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;bigNum&quot;</span><span class="s2">, [-(</span><span class="s4">2</span><span class="s2">**</span><span class="s4">63</span><span class="s2">) - </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">64</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_read_json_large_numbers</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">bigNum</span><span class="s2">):</span>
        <span class="s3"># GH20599, 26068</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s5">'{&quot;articleId&quot;:' </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">bigNum</span><span class="s2">) + </span><span class="s5">&quot;}&quot;</span><span class="s2">)</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">r&quot;Value is too small|Value is too big&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">)</span>

        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s5">'{&quot;0&quot;:{&quot;articleId&quot;:' </span><span class="s2">+ </span><span class="s1">str</span><span class="s2">(</span><span class="s1">bigNum</span><span class="s2">) + </span><span class="s5">&quot;}}&quot;</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_read_json_large_numbers2</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH18842</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s5">'{&quot;articleId&quot;: &quot;1404366058080022500245&quot;}'</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">json</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s4">1.404366e21</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">&quot;articleId&quot;</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">json </span><span class="s2">= </span><span class="s5">'{&quot;0&quot;: {&quot;articleId&quot;: &quot;1404366058080022500245&quot;}}'</span>
        <span class="s1">json </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">json</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">json</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s4">1.404366e21</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">&quot;articleId&quot;</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_to_jsonl</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH9180</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;a&quot;:1,&quot;b&quot;:2}</span><span class="s0">\n</span><span class="s5">{&quot;a&quot;:1,&quot;b&quot;:2}</span><span class="s0">\n</span><span class="s5">'</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;foo}&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">], [</span><span class="s5">'foo&quot;'</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;a&quot;:&quot;foo}&quot;,&quot;b&quot;:&quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">{&quot;a&quot;:&quot;foo</span><span class="s0">\\</span><span class="s5">&quot;&quot;,&quot;b&quot;:&quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">'</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">result</span><span class="s2">), </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">), </span><span class="s1">df</span><span class="s2">)</span>

        <span class="s3"># GH15096: escaped characters in columns and data</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;foo</span><span class="s0">\\</span><span class="s5">&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">], [</span><span class="s5">'foo&quot;'</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a</span><span class="s0">\\</span><span class="s5">&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">'{&quot;a</span><span class="s0">\\\\</span><span class="s5">&quot;:&quot;foo</span><span class="s0">\\\\</span><span class="s5">&quot;,&quot;b&quot;:&quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">{&quot;a</span><span class="s0">\\\\</span><span class="s5">&quot;:&quot;foo</span><span class="s0">\\</span><span class="s5">&quot;&quot;,&quot;b&quot;:&quot;bar&quot;}</span><span class="s0">\n</span><span class="s5">'</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">result</span><span class="s2">), </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">), </span><span class="s1">df</span><span class="s2">)</span>

    <span class="s3"># TODO: there is a near-identical test for pytables; can we share?</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span><span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;GH#13774 encoding kwarg not supported&quot;</span><span class="s2">, </span><span class="s1">raises</span><span class="s2">=</span><span class="s1">TypeError</span><span class="s2">)</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;val&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">[</span><span class="s6">b&quot;E</span><span class="s0">\xc9</span><span class="s6">, 17&quot;</span><span class="s2">, </span><span class="s6">b&quot;&quot;</span><span class="s2">, </span><span class="s6">b&quot;a&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s6">b&quot;E</span><span class="s0">\xc9</span><span class="s6">, 17&quot;</span><span class="s2">, </span><span class="s6">b&quot;a&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s6">b&quot;EE, 17&quot;</span><span class="s2">, </span><span class="s6">b&quot;&quot;</span><span class="s2">, </span><span class="s6">b&quot;a&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s6">b&quot;E</span><span class="s0">\xc9</span><span class="s6">, 17&quot;</span><span class="s2">, </span><span class="s6">b&quot;</span><span class="s0">\xf8\xfc</span><span class="s6">&quot;</span><span class="s2">, </span><span class="s6">b&quot;a&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s6">b&quot;&quot;</span><span class="s2">, </span><span class="s6">b&quot;a&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s6">b&quot;</span><span class="s0">\xf8\xfc</span><span class="s6">&quot;</span><span class="s2">, </span><span class="s6">b&quot;a&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s6">b&quot;A</span><span class="s0">\xf8\xfc</span><span class="s6">&quot;</span><span class="s2">, </span><span class="s6">b&quot;&quot;</span><span class="s2">, </span><span class="s6">b&quot;a&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s6">b&quot;&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s6">b&quot;A</span><span class="s0">\xf8\xfc</span><span class="s6">&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s6">b&quot;&quot;</span><span class="s2">, </span><span class="s6">b&quot;b&quot;</span><span class="s2">, </span><span class="s6">b&quot;c&quot;</span><span class="s2">],</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s5">&quot;category&quot;</span><span class="s2">, </span><span class="s1">object</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_latin_encoding</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">val</span><span class="s2">):</span>
        <span class="s3"># GH 13774</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s1">x</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">(</span><span class="s5">&quot;latin-1&quot;</span><span class="s2">) </span><span class="s0">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">bytes</span><span class="s2">) </span><span class="s0">else </span><span class="s1">x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">val</span><span class="s2">],</span>
            <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">encoding </span><span class="s2">= </span><span class="s5">&quot;latin-1&quot;</span>
        <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">ensure_clean</span><span class="s2">(</span><span class="s5">&quot;test.json&quot;</span><span class="s2">) </span><span class="s0">as </span><span class="s1">path</span><span class="s2">:</span>
            <span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">path</span><span class="s2">, </span><span class="s1">encoding</span><span class="s2">=</span><span class="s1">encoding</span><span class="s2">)</span>
            <span class="s1">retr </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">path</span><span class="s2">), </span><span class="s1">encoding</span><span class="s2">=</span><span class="s1">encoding</span><span class="s2">)</span>
            <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">ser</span><span class="s2">, </span><span class="s1">retr</span><span class="s2">, </span><span class="s1">check_categorical</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_data_frame_size_after_to_json</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH15344</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s1">str</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)]})</span>

        <span class="s1">size_before </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">memory_usage</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">deep</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">sum</span><span class="s2">()</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s1">size_after </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">memory_usage</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">deep</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">sum</span><span class="s2">()</span>

        <span class="s0">assert </span><span class="s1">size_before </span><span class="s2">== </span><span class="s1">size_after</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;index&quot;</span><span class="s2">, [</span><span class="s0">None</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">], [</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;1&quot;</span><span class="s2">, </span><span class="s5">&quot;2&quot;</span><span class="s2">], [</span><span class="s5">&quot;1.&quot;</span><span class="s2">, </span><span class="s5">&quot;2.&quot;</span><span class="s2">]]</span>
    <span class="s2">)</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;columns&quot;</span><span class="s2">, [[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;1&quot;</span><span class="s2">, </span><span class="s5">&quot;2&quot;</span><span class="s2">], [</span><span class="s5">&quot;1.&quot;</span><span class="s2">, </span><span class="s5">&quot;2.&quot;</span><span class="s2">]])</span>
    <span class="s0">def </span><span class="s1">test_from_json_to_json_table_index_and_columns</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">):</span>
        <span class="s3"># GH25433 GH25435</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">columns</span><span class="s2">)</span>
        <span class="s1">dfjson </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">dfjson</span><span class="s2">), </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_from_json_to_json_table_dtypes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH21345</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s5">&quot;b&quot;</span><span class="s2">: [</span><span class="s4">3.0</span><span class="s2">, </span><span class="s4">4.0</span><span class="s2">], </span><span class="s5">&quot;c&quot;</span><span class="s2">: [</span><span class="s5">&quot;5&quot;</span><span class="s2">, </span><span class="s5">&quot;6&quot;</span><span class="s2">]})</span>
        <span class="s1">dfjson </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">dfjson</span><span class="s2">), </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s3"># TODO: We are casting to string which coerces None to NaN before casting back</span>
    <span class="s3"># to object, ending up with incorrect na values</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span><span class="s1">using_pyarrow_string_dtype</span><span class="s2">(), </span><span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;incorrect na conversion&quot;</span><span class="s2">)</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_to_json_from_json_columns_dtypes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s3"># GH21892 GH33205</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">.</span><span class="s1">from_dict</span><span class="s2">(</span>
            <span class="s2">{</span>
                <span class="s5">&quot;Integer&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;int64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;Float&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s0">None</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">, </span><span class="s4">3.0</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;float64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;Object&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s0">None</span><span class="s2">, </span><span class="s5">&quot;&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;object&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;Bool&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;bool&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;Category&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;category&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;Datetime&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">(</span>
                    <span class="s2">[</span><span class="s5">&quot;2020-01-01&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s5">&quot;2020-01-03&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;datetime64[ns]&quot;</span>
                <span class="s2">),</span>
            <span class="s2">}</span>
        <span class="s2">)</span>
        <span class="s1">dfjson </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
            <span class="s1">StringIO</span><span class="s2">(</span><span class="s1">dfjson</span><span class="s2">),</span>
            <span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">,</span>
            <span class="s1">dtype</span><span class="s2">={</span>
                <span class="s5">&quot;Integer&quot;</span><span class="s2">: </span><span class="s5">&quot;int64&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;Float&quot;</span><span class="s2">: </span><span class="s5">&quot;float64&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;Object&quot;</span><span class="s2">: </span><span class="s5">&quot;object&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;Bool&quot;</span><span class="s2">: </span><span class="s5">&quot;bool&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;Category&quot;</span><span class="s2">: </span><span class="s5">&quot;category&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;Datetime&quot;</span><span class="s2">: </span><span class="s5">&quot;datetime64[ns]&quot;</span><span class="s2">,</span>
            <span class="s2">},</span>
        <span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, {</span><span class="s5">&quot;b&quot;</span><span class="s2">: </span><span class="s1">int</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">: </span><span class="s1">int</span><span class="s2">}])</span>
    <span class="s0">def </span><span class="s1">test_read_json_table_dtype_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
        <span class="s3"># GH21345</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s5">&quot;b&quot;</span><span class="s2">: [</span><span class="s4">3.0</span><span class="s2">, </span><span class="s4">4.0</span><span class="s2">], </span><span class="s5">&quot;c&quot;</span><span class="s2">: [</span><span class="s5">&quot;5&quot;</span><span class="s2">, </span><span class="s5">&quot;6&quot;</span><span class="s2">]})</span>
        <span class="s1">dfjson </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">)</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;cannot pass both dtype and orient='table'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">dfjson</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s5">&quot;values&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_read_json_table_empty_axes_dtype</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s3"># GH28558</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">()</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s5">&quot;{}&quot;</span><span class="s2">), </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_index_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">index</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">index</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_index_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_read_json_table_convert_axes_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH25433 GH25435</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]], </span><span class="s1">index</span><span class="s2">=[</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;1.&quot;</span><span class="s2">, </span><span class="s5">&quot;2.&quot;</span><span class="s2">])</span>
        <span class="s1">dfjson </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">)</span>
        <span class="s1">msg </span><span class="s2">= </span><span class="s5">&quot;cannot pass both convert_axes and orient='table'&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">dfjson</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">, </span><span class="s1">convert_axes</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;data, expected&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span>
                <span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">]),</span>
                <span class="s2">{</span><span class="s5">&quot;columns&quot;</span><span class="s2">: [</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], </span><span class="s5">&quot;data&quot;</span><span class="s2">: [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]]},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">]).</span><span class="s1">rename_axis</span><span class="s2">(</span><span class="s5">&quot;foo&quot;</span><span class="s2">),</span>
                <span class="s2">{</span><span class="s5">&quot;columns&quot;</span><span class="s2">: [</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], </span><span class="s5">&quot;data&quot;</span><span class="s2">: [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]]},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s1">DataFrame</span><span class="s2">(</span>
                    <span class="s2">[[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]]</span>
                <span class="s2">),</span>
                <span class="s2">{</span><span class="s5">&quot;columns&quot;</span><span class="s2">: [</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], </span><span class="s5">&quot;data&quot;</span><span class="s2">: [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]]},</span>
            <span class="s2">),</span>
            <span class="s2">(</span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s5">&quot;A&quot;</span><span class="s2">), {</span><span class="s5">&quot;name&quot;</span><span class="s2">: </span><span class="s5">&quot;A&quot;</span><span class="s2">, </span><span class="s5">&quot;data&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]}),</span>
            <span class="s2">(</span>
                <span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s5">&quot;A&quot;</span><span class="s2">).</span><span class="s1">rename_axis</span><span class="s2">(</span><span class="s5">&quot;foo&quot;</span><span class="s2">),</span>
                <span class="s2">{</span><span class="s5">&quot;name&quot;</span><span class="s2">: </span><span class="s5">&quot;A&quot;</span><span class="s2">, </span><span class="s5">&quot;data&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]},</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s5">&quot;A&quot;</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=[[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]]),</span>
                <span class="s2">{</span><span class="s5">&quot;name&quot;</span><span class="s2">: </span><span class="s5">&quot;A&quot;</span><span class="s2">, </span><span class="s5">&quot;data&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]},</span>
            <span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_index_false_to_json_split</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">data</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s3"># GH 17394</span>
        <span class="s3"># Testing index=False in to_json with orient='split'</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">data</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">json</span><span class="s2">.</span><span class="s1">loads</span><span class="s2">(</span><span class="s1">result</span><span class="s2">)</span>

        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;data&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])),</span>
            <span class="s2">(</span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">]).</span><span class="s1">rename_axis</span><span class="s2">(</span><span class="s5">&quot;foo&quot;</span><span class="s2">)),</span>
            <span class="s2">(</span>
                <span class="s1">DataFrame</span><span class="s2">(</span>
                    <span class="s2">[[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=[[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]]</span>
                <span class="s2">)</span>
            <span class="s2">),</span>
            <span class="s2">(</span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s5">&quot;A&quot;</span><span class="s2">)),</span>
            <span class="s2">(</span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s5">&quot;A&quot;</span><span class="s2">).</span><span class="s1">rename_axis</span><span class="s2">(</span><span class="s5">&quot;foo&quot;</span><span class="s2">)),</span>
            <span class="s2">(</span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s5">&quot;A&quot;</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=[[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]])),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_index_false_to_json_table</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">data</span><span class="s2">):</span>
        <span class="s3"># GH 17394</span>
        <span class="s3"># Testing index=False in to_json with orient='table'</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">data</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;table&quot;</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">json</span><span class="s2">.</span><span class="s1">loads</span><span class="s2">(</span><span class="s1">result</span><span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= {</span>
            <span class="s5">&quot;schema&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">io</span><span class="s2">.</span><span class="s1">json</span><span class="s2">.</span><span class="s1">build_table_schema</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">),</span>
            <span class="s5">&quot;data&quot;</span><span class="s2">: </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">).</span><span class="s1">to_dict</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">),</span>
        <span class="s2">}</span>

        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_index_false_error_to_json</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s3"># GH 17394, 25513</span>
        <span class="s3"># Testing error message from to_json with index=False</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>

        <span class="s1">msg </span><span class="s2">= (</span>
            <span class="s5">&quot;'index=False' is only valid when 'orient' is 'split', &quot;</span>
            <span class="s5">&quot;'table', 'records', or 'values'&quot;</span>
        <span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s5">&quot;values&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_index_true_error_to_json</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s3"># GH 25513</span>
        <span class="s3"># Testing error message from to_json with index=True</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>

        <span class="s1">msg </span><span class="s2">= (</span>
            <span class="s5">&quot;'index=True' is only valid when 'orient' is 'split', &quot;</span>
            <span class="s5">&quot;'table', 'index', or 'columns'&quot;</span>
        <span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s5">&quot;table&quot;</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;index&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_index_false_from_json_to_json</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">index</span><span class="s2">):</span>
        <span class="s3"># GH25170</span>
        <span class="s3"># Test index=False in from_json to_json</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s5">&quot;b&quot;</span><span class="s2">: [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]})</span>
        <span class="s1">dfjson </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">dfjson</span><span class="s2">), </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_read_timezone_information</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH 25546</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
            <span class="s1">StringIO</span><span class="s2">(</span><span class="s5">'{&quot;2019-01-01T11:00:00.000Z&quot;:88}'</span><span class="s2">), </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;index&quot;</span>
        <span class="s2">)</span>
        <span class="s1">exp_dti </span><span class="s2">= </span><span class="s1">DatetimeIndex</span><span class="s2">([</span><span class="s5">&quot;2019-01-01 11:00:00&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;M8[ns, UTC]&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">88</span><span class="s2">], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">exp_dti</span><span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;url&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s5">&quot;s3://example-fsspec/&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;gcs://another-fsspec/file.json&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;https://example-site.com/data&quot;</span><span class="s2">,</span>
            <span class="s5">&quot;some-protocol://data.txt&quot;</span><span class="s2">,</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_read_json_with_url_value</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">url</span><span class="s2">):</span>
        <span class="s3"># GH 36271</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s5">f'</span><span class="s0">{{</span><span class="s5">&quot;url&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:&quot;</span><span class="s0">{</span><span class="s1">url</span><span class="s0">}</span><span class="s5">&quot;</span><span class="s0">}}}}</span><span class="s5">'</span><span class="s2">))</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;url&quot;</span><span class="s2">: [</span><span class="s1">url</span><span class="s2">]})</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;compression&quot;</span><span class="s2">,</span>
        <span class="s2">[</span><span class="s5">&quot;&quot;</span><span class="s2">, </span><span class="s5">&quot;.gz&quot;</span><span class="s2">, </span><span class="s5">&quot;.bz2&quot;</span><span class="s2">, </span><span class="s5">&quot;.tar&quot;</span><span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_read_json_with_very_long_file_path</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">compression</span><span class="s2">):</span>
        <span class="s3"># GH 46718</span>
        <span class="s1">long_json_path </span><span class="s2">= </span><span class="s5">f'</span><span class="s0">{</span><span class="s5">&quot;a&quot; </span><span class="s2">* </span><span class="s4">1000</span><span class="s0">}</span><span class="s5">.json</span><span class="s0">{</span><span class="s1">compression</span><span class="s0">}</span><span class="s5">'</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span>
            <span class="s1">FileNotFoundError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s5">f&quot;File </span><span class="s0">{</span><span class="s1">long_json_path</span><span class="s0">} </span><span class="s5">does not exist&quot;</span>
        <span class="s2">):</span>
            <span class="s3"># path too long for Windows is handled in file_exists() but raises in</span>
            <span class="s3"># _get_data_from_filepath()</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s1">long_json_path</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;date_format,key&quot;</span><span class="s2">, [(</span><span class="s5">&quot;epoch&quot;</span><span class="s2">, </span><span class="s4">86400000</span><span class="s2">), (</span><span class="s5">&quot;iso&quot;</span><span class="s2">, </span><span class="s5">&quot;P1DT0H0M0S&quot;</span><span class="s2">)]</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_timedelta_as_label</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">date_format</span><span class="s2">, </span><span class="s1">key</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Timedelta</span><span class="s2">(</span><span class="s5">&quot;1D&quot;</span><span class="s2">)])</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">f'</span><span class="s0">{{</span><span class="s5">&quot;</span><span class="s0">{</span><span class="s1">key</span><span class="s0">}</span><span class="s5">&quot;:</span><span class="s0">{{</span><span class="s5">&quot;0&quot;:1</span><span class="s0">}}}}</span><span class="s5">'</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">date_format</span><span class="s2">=</span><span class="s1">date_format</span><span class="s2">)</span>

        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;orient,expected&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;{</span><span class="s0">\&quot;</span><span class="s5">('a', 'b')</span><span class="s0">\&quot;</span><span class="s5">:{</span><span class="s0">\&quot;</span><span class="s5">('c', 'd')</span><span class="s0">\&quot;</span><span class="s5">:1}}&quot;</span><span class="s2">),</span>
            <span class="s2">(</span><span class="s5">&quot;columns&quot;</span><span class="s2">, </span><span class="s5">&quot;{</span><span class="s0">\&quot;</span><span class="s5">('c', 'd')</span><span class="s0">\&quot;</span><span class="s5">:{</span><span class="s0">\&quot;</span><span class="s5">('a', 'b')</span><span class="s0">\&quot;</span><span class="s5">:1}}&quot;</span><span class="s2">),</span>
            <span class="s3"># TODO: the below have separate encoding procedures</span>
            <span class="s1">pytest</span><span class="s2">.</span><span class="s1">param</span><span class="s2">(</span>
                <span class="s5">&quot;split&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;&quot;</span><span class="s2">,</span>
                <span class="s1">marks</span><span class="s2">=</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span>
                    <span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;Produces JSON but not in a consistent manner&quot;</span>
                <span class="s2">),</span>
            <span class="s2">),</span>
            <span class="s1">pytest</span><span class="s2">.</span><span class="s1">param</span><span class="s2">(</span>
                <span class="s5">&quot;table&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;&quot;</span><span class="s2">,</span>
                <span class="s1">marks</span><span class="s2">=</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span>
                    <span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;Produces JSON but not in a consistent manner&quot;</span>
                <span class="s2">),</span>
            <span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_tuple_labels</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s3"># GH 20500</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">]], </span><span class="s1">index</span><span class="s2">=[(</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">)], </span><span class="s1">columns</span><span class="s2">=[(</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">)])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;indent&quot;</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">4</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_to_json_indent</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">indent</span><span class="s2">):</span>
        <span class="s3"># GH 12004</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;foo&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">], [</span><span class="s5">&quot;baz&quot;</span><span class="s2">, </span><span class="s5">&quot;qux&quot;</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">indent</span><span class="s2">=</span><span class="s1">indent</span><span class="s2">)</span>
        <span class="s1">spaces </span><span class="s2">= </span><span class="s5">&quot; &quot; </span><span class="s2">* </span><span class="s1">indent</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s5">f&quot;&quot;&quot;</span><span class="s0">{{</span>
<span class="s0">{</span><span class="s1">spaces</span><span class="s0">}</span><span class="s5">&quot;a&quot;:</span><span class="s0">{{</span>
<span class="s0">{</span><span class="s1">spaces</span><span class="s0">}{</span><span class="s1">spaces</span><span class="s0">}</span><span class="s5">&quot;0&quot;:&quot;foo&quot;,</span>
<span class="s0">{</span><span class="s1">spaces</span><span class="s0">}{</span><span class="s1">spaces</span><span class="s0">}</span><span class="s5">&quot;1&quot;:&quot;baz&quot;</span>
<span class="s0">{</span><span class="s1">spaces</span><span class="s0">}}}</span><span class="s5">,</span>
<span class="s0">{</span><span class="s1">spaces</span><span class="s0">}</span><span class="s5">&quot;b&quot;:</span><span class="s0">{{</span>
<span class="s0">{</span><span class="s1">spaces</span><span class="s0">}{</span><span class="s1">spaces</span><span class="s0">}</span><span class="s5">&quot;0&quot;:&quot;bar&quot;,</span>
<span class="s0">{</span><span class="s1">spaces</span><span class="s0">}{</span><span class="s1">spaces</span><span class="s0">}</span><span class="s5">&quot;1&quot;:&quot;qux&quot;</span>
<span class="s0">{</span><span class="s1">spaces</span><span class="s0">}}}</span>
<span class="s0">}}</span><span class="s5">&quot;&quot;&quot;</span>

        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">skipif</span><span class="s2">(</span>
        <span class="s1">using_pyarrow_string_dtype</span><span class="s2">(),</span>
        <span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;Adjust expected when infer_string is default, no bug here, &quot;</span>
        <span class="s5">&quot;just a complicated parametrization&quot;</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;orient,expected&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span>
                <span class="s5">&quot;split&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;&quot;&quot;{ 
    &quot;columns&quot;:[ 
        &quot;a&quot;, 
        &quot;b&quot; 
    ], 
    &quot;index&quot;:[ 
        0, 
        1 
    ], 
    &quot;data&quot;:[ 
        [ 
            &quot;foo&quot;, 
            &quot;bar&quot; 
        ], 
        [ 
            &quot;baz&quot;, 
            &quot;qux&quot; 
        ] 
    ] 
}&quot;&quot;&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s5">&quot;records&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;&quot;&quot;[ 
    { 
        &quot;a&quot;:&quot;foo&quot;, 
        &quot;b&quot;:&quot;bar&quot; 
    }, 
    { 
        &quot;a&quot;:&quot;baz&quot;, 
        &quot;b&quot;:&quot;qux&quot; 
    } 
]&quot;&quot;&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s5">&quot;index&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;&quot;&quot;{ 
    &quot;0&quot;:{ 
        &quot;a&quot;:&quot;foo&quot;, 
        &quot;b&quot;:&quot;bar&quot; 
    }, 
    &quot;1&quot;:{ 
        &quot;a&quot;:&quot;baz&quot;, 
        &quot;b&quot;:&quot;qux&quot; 
    } 
}&quot;&quot;&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s5">&quot;columns&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;&quot;&quot;{ 
    &quot;a&quot;:{ 
        &quot;0&quot;:&quot;foo&quot;, 
        &quot;1&quot;:&quot;baz&quot; 
    }, 
    &quot;b&quot;:{ 
        &quot;0&quot;:&quot;bar&quot;, 
        &quot;1&quot;:&quot;qux&quot; 
    } 
}&quot;&quot;&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s5">&quot;values&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;&quot;&quot;[ 
    [ 
        &quot;foo&quot;, 
        &quot;bar&quot; 
    ], 
    [ 
        &quot;baz&quot;, 
        &quot;qux&quot; 
    ] 
]&quot;&quot;&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s5">&quot;table&quot;</span><span class="s2">,</span>
                <span class="s5">&quot;&quot;&quot;{ 
    &quot;schema&quot;:{ 
        &quot;fields&quot;:[ 
            { 
                &quot;name&quot;:&quot;index&quot;, 
                &quot;type&quot;:&quot;integer&quot; 
            }, 
            { 
                &quot;name&quot;:&quot;a&quot;, 
                &quot;type&quot;:&quot;string&quot; 
            }, 
            { 
                &quot;name&quot;:&quot;b&quot;, 
                &quot;type&quot;:&quot;string&quot; 
            } 
        ], 
        &quot;primaryKey&quot;:[ 
            &quot;index&quot; 
        ], 
        &quot;pandas_version&quot;:&quot;1.4.0&quot; 
    }, 
    &quot;data&quot;:[ 
        { 
            &quot;index&quot;:0, 
            &quot;a&quot;:&quot;foo&quot;, 
            &quot;b&quot;:&quot;bar&quot; 
        }, 
        { 
            &quot;index&quot;:1, 
            &quot;a&quot;:&quot;baz&quot;, 
            &quot;b&quot;:&quot;qux&quot; 
        } 
    ] 
}&quot;&quot;&quot;</span><span class="s2">,</span>
            <span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_json_indent_all_orients</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s3"># GH 12004</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">&quot;foo&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">], [</span><span class="s5">&quot;baz&quot;</span><span class="s2">, </span><span class="s5">&quot;qux&quot;</span><span class="s2">]], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">indent</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s0">def </span><span class="s1">test_json_negative_indent_raises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s5">&quot;must be a nonnegative integer&quot;</span><span class="s2">):</span>
            <span class="s1">DataFrame</span><span class="s2">().</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">indent</span><span class="s2">=-</span><span class="s4">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_emca_262_nan_inf_support</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH 12213</span>
        <span class="s1">data </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">(</span>
            <span class="s5">'[&quot;a&quot;, NaN, &quot;NaN&quot;, Infinity, &quot;Infinity&quot;, -Infinity, &quot;-Infinity&quot;]'</span>
        <span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s5">&quot;NaN&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s5">&quot;Infinity&quot;</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s5">&quot;-Infinity&quot;</span><span class="s2">]</span>
        <span class="s2">)</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_frame_int_overflow</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH 30320</span>
        <span class="s1">encoded_json </span><span class="s2">= </span><span class="s1">json</span><span class="s2">.</span><span class="s1">dumps</span><span class="s2">([{</span><span class="s5">&quot;col&quot;</span><span class="s2">: </span><span class="s5">&quot;31900441201190696999&quot;</span><span class="s2">}, {</span><span class="s5">&quot;col&quot;</span><span class="s2">: </span><span class="s5">&quot;Text&quot;</span><span class="s2">}])</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;col&quot;</span><span class="s2">: [</span><span class="s5">&quot;31900441201190696999&quot;</span><span class="s2">, </span><span class="s5">&quot;Text&quot;</span><span class="s2">]})</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">encoded_json</span><span class="s2">))</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;dataframe,expected&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span>
                <span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;x&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s5">&quot;y&quot;</span><span class="s2">: [</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">]}),</span>
                <span class="s5">'{&quot;(0, </span><span class="s0">\'</span><span class="s5">x</span><span class="s0">\'</span><span class="s5">)&quot;:1,&quot;(0, </span><span class="s0">\'</span><span class="s5">y</span><span class="s0">\'</span><span class="s5">)&quot;:&quot;a&quot;,&quot;(1, </span><span class="s0">\'</span><span class="s5">x</span><span class="s0">\'</span><span class="s5">)&quot;:2,'</span>
                <span class="s5">'&quot;(1, </span><span class="s0">\'</span><span class="s5">y</span><span class="s0">\'</span><span class="s5">)&quot;:&quot;b&quot;,&quot;(2, </span><span class="s0">\'</span><span class="s5">x</span><span class="s0">\'</span><span class="s5">)&quot;:3,&quot;(2, </span><span class="s0">\'</span><span class="s5">y</span><span class="s0">\'</span><span class="s5">)&quot;:&quot;c&quot;}'</span><span class="s2">,</span>
            <span class="s2">)</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_json_multiindex</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">dataframe</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s1">series </span><span class="s2">= </span><span class="s1">dataframe</span><span class="s2">.</span><span class="s1">stack</span><span class="s2">(</span><span class="s1">future_stack</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;index&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">single_cpu</span>
    <span class="s0">def </span><span class="s1">test_to_s3</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">s3_public_bucket</span><span class="s2">, </span><span class="s1">s3so</span><span class="s2">):</span>
        <span class="s3"># GH 28375</span>
        <span class="s1">mock_bucket_name</span><span class="s2">, </span><span class="s1">target_file </span><span class="s2">= </span><span class="s1">s3_public_bucket</span><span class="s2">.</span><span class="s1">name</span><span class="s2">, </span><span class="s5">&quot;test.json&quot;</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;x&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s5">&quot;y&quot;</span><span class="s2">: [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]})</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s5">f&quot;s3://</span><span class="s0">{</span><span class="s1">mock_bucket_name</span><span class="s0">}</span><span class="s5">/</span><span class="s0">{</span><span class="s1">target_file</span><span class="s0">}</span><span class="s5">&quot;</span><span class="s2">, </span><span class="s1">storage_options</span><span class="s2">=</span><span class="s1">s3so</span><span class="s2">)</span>
        <span class="s1">timeout </span><span class="s2">= </span><span class="s4">5</span>
        <span class="s0">while True</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">target_file </span><span class="s0">in </span><span class="s2">(</span><span class="s1">obj</span><span class="s2">.</span><span class="s1">key </span><span class="s0">for </span><span class="s1">obj </span><span class="s0">in </span><span class="s1">s3_public_bucket</span><span class="s2">.</span><span class="s1">objects</span><span class="s2">.</span><span class="s1">all</span><span class="s2">()):</span>
                <span class="s0">break</span>
            <span class="s1">time</span><span class="s2">.</span><span class="s1">sleep</span><span class="s2">(</span><span class="s4">0.1</span><span class="s2">)</span>
            <span class="s1">timeout </span><span class="s2">-= </span><span class="s4">0.1</span>
            <span class="s0">assert </span><span class="s1">timeout </span><span class="s2">&gt; </span><span class="s4">0</span><span class="s2">, </span><span class="s5">&quot;Timed out waiting for file to appear on moto&quot;</span>

    <span class="s0">def </span><span class="s1">test_json_pandas_nulls</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">nulls_fixture</span><span class="s2">, </span><span class="s1">request</span><span class="s2">):</span>
        <span class="s3"># GH 31615</span>
        <span class="s0">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">nulls_fixture</span><span class="s2">, </span><span class="s1">Decimal</span><span class="s2">):</span>
            <span class="s1">mark </span><span class="s2">= </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">xfail</span><span class="s2">(</span><span class="s1">reason</span><span class="s2">=</span><span class="s5">&quot;not implemented&quot;</span><span class="s2">)</span>
            <span class="s1">request</span><span class="s2">.</span><span class="s1">applymarker</span><span class="s2">(</span><span class="s1">mark</span><span class="s2">)</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s1">nulls_fixture</span><span class="s2">]]).</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s5">'{&quot;0&quot;:{&quot;0&quot;:null}}'</span>

    <span class="s0">def </span><span class="s1">test_readjson_bool_series</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH31464</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s5">&quot;[true, true, false]&quot;</span><span class="s2">), </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s0">True</span><span class="s2">, </span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_to_json_multiindex_escape</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH 15273</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s0">True</span><span class="s2">,</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">date_range</span><span class="s2">(</span><span class="s5">&quot;2017-01-20&quot;</span><span class="s2">, </span><span class="s5">&quot;2017-01-23&quot;</span><span class="s2">),</span>
            <span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;foo&quot;</span><span class="s2">, </span><span class="s5">&quot;bar&quot;</span><span class="s2">],</span>
        <span class="s2">).</span><span class="s1">stack</span><span class="s2">(</span><span class="s1">future_stack</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= (</span>
            <span class="s5">&quot;{</span><span class="s0">\&quot;</span><span class="s5">(Timestamp('2017-01-20 00:00:00'), 'foo')</span><span class="s0">\&quot;</span><span class="s5">:true,&quot;</span>
            <span class="s5">&quot;</span><span class="s0">\&quot;</span><span class="s5">(Timestamp('2017-01-20 00:00:00'), 'bar')</span><span class="s0">\&quot;</span><span class="s5">:true,&quot;</span>
            <span class="s5">&quot;</span><span class="s0">\&quot;</span><span class="s5">(Timestamp('2017-01-21 00:00:00'), 'foo')</span><span class="s0">\&quot;</span><span class="s5">:true,&quot;</span>
            <span class="s5">&quot;</span><span class="s0">\&quot;</span><span class="s5">(Timestamp('2017-01-21 00:00:00'), 'bar')</span><span class="s0">\&quot;</span><span class="s5">:true,&quot;</span>
            <span class="s5">&quot;</span><span class="s0">\&quot;</span><span class="s5">(Timestamp('2017-01-22 00:00:00'), 'foo')</span><span class="s0">\&quot;</span><span class="s5">:true,&quot;</span>
            <span class="s5">&quot;</span><span class="s0">\&quot;</span><span class="s5">(Timestamp('2017-01-22 00:00:00'), 'bar')</span><span class="s0">\&quot;</span><span class="s5">:true,&quot;</span>
            <span class="s5">&quot;</span><span class="s0">\&quot;</span><span class="s5">(Timestamp('2017-01-23 00:00:00'), 'foo')</span><span class="s0">\&quot;</span><span class="s5">:true,&quot;</span>
            <span class="s5">&quot;</span><span class="s0">\&quot;</span><span class="s5">(Timestamp('2017-01-23 00:00:00'), 'bar')</span><span class="s0">\&quot;</span><span class="s5">:true}&quot;</span>
        <span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s0">def </span><span class="s1">test_to_json_series_of_objects</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">class </span><span class="s1">_TestObject</span><span class="s2">:</span>
            <span class="s0">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">_c</span><span class="s2">, </span><span class="s1">d</span><span class="s2">) </span><span class="s1">-&gt; </span><span class="s0">None</span><span class="s2">:</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">a </span><span class="s2">= </span><span class="s1">a</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">b </span><span class="s2">= </span><span class="s1">b</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">_c </span><span class="s2">= </span><span class="s1">_c</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">d </span><span class="s2">= </span><span class="s1">d</span>

            <span class="s0">def </span><span class="s1">e</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
                <span class="s0">return </span><span class="s4">5</span>

        <span class="s3"># JSON keys should be all non-callable non-underscore attributes, see GH-42768</span>
        <span class="s1">series </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s1">_TestObject</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">b</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">_c</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">d</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)])</span>
        <span class="s0">assert </span><span class="s1">json</span><span class="s2">.</span><span class="s1">loads</span><span class="s2">(</span><span class="s1">series</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()) == {</span><span class="s5">&quot;0&quot;</span><span class="s2">: {</span><span class="s5">&quot;a&quot;</span><span class="s2">: </span><span class="s4">1</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">: </span><span class="s4">2</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">: </span><span class="s4">4</span><span class="s2">}}</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;data,expected&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s2">(</span>
                <span class="s1">Series</span><span class="s2">({</span><span class="s4">0</span><span class="s2">: -</span><span class="s4">6 </span><span class="s2">+ </span><span class="s4">8j</span><span class="s2">, </span><span class="s4">1</span><span class="s2">: </span><span class="s4">0 </span><span class="s2">+ </span><span class="s4">1j</span><span class="s2">, </span><span class="s4">2</span><span class="s2">: </span><span class="s4">9 </span><span class="s2">- </span><span class="s4">5j</span><span class="s2">}),</span>
                <span class="s5">'{&quot;0&quot;:{&quot;imag&quot;:8.0,&quot;real&quot;:-6.0},'</span>
                <span class="s5">'&quot;1&quot;:{&quot;imag&quot;:1.0,&quot;real&quot;:0.0},'</span>
                <span class="s5">'&quot;2&quot;:{&quot;imag&quot;:-5.0,&quot;real&quot;:9.0}}'</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s1">Series</span><span class="s2">({</span><span class="s4">0</span><span class="s2">: -</span><span class="s4">9.39 </span><span class="s2">+ </span><span class="s4">0.66j</span><span class="s2">, </span><span class="s4">1</span><span class="s2">: </span><span class="s4">3.95 </span><span class="s2">+ </span><span class="s4">9.32j</span><span class="s2">, </span><span class="s4">2</span><span class="s2">: </span><span class="s4">4.03 </span><span class="s2">- </span><span class="s4">0.17j</span><span class="s2">}),</span>
                <span class="s5">'{&quot;0&quot;:{&quot;imag&quot;:0.66,&quot;real&quot;:-9.39},'</span>
                <span class="s5">'&quot;1&quot;:{&quot;imag&quot;:9.32,&quot;real&quot;:3.95},'</span>
                <span class="s5">'&quot;2&quot;:{&quot;imag&quot;:-0.17,&quot;real&quot;:4.03}}'</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s1">DataFrame</span><span class="s2">([[-</span><span class="s4">2 </span><span class="s2">+ </span><span class="s4">3j</span><span class="s2">, -</span><span class="s4">1 </span><span class="s2">- </span><span class="s4">0j</span><span class="s2">], [</span><span class="s4">4 </span><span class="s2">- </span><span class="s4">3j</span><span class="s2">, -</span><span class="s4">0 </span><span class="s2">- </span><span class="s4">10j</span><span class="s2">]]),</span>
                <span class="s5">'{&quot;0&quot;:{&quot;0&quot;:{&quot;imag&quot;:3.0,&quot;real&quot;:-2.0},'</span>
                <span class="s5">'&quot;1&quot;:{&quot;imag&quot;:-3.0,&quot;real&quot;:4.0}},'</span>
                <span class="s5">'&quot;1&quot;:{&quot;0&quot;:{&quot;imag&quot;:0.0,&quot;real&quot;:-1.0},'</span>
                <span class="s5">'&quot;1&quot;:{&quot;imag&quot;:-10.0,&quot;real&quot;:0.0}}}'</span><span class="s2">,</span>
            <span class="s2">),</span>
            <span class="s2">(</span>
                <span class="s1">DataFrame</span><span class="s2">(</span>
                    <span class="s2">[[-</span><span class="s4">0.28 </span><span class="s2">+ </span><span class="s4">0.34j</span><span class="s2">, -</span><span class="s4">1.08 </span><span class="s2">- </span><span class="s4">0.39j</span><span class="s2">], [</span><span class="s4">0.41 </span><span class="s2">- </span><span class="s4">0.34j</span><span class="s2">, -</span><span class="s4">0.78 </span><span class="s2">- </span><span class="s4">1.35j</span><span class="s2">]]</span>
                <span class="s2">),</span>
                <span class="s5">'{&quot;0&quot;:{&quot;0&quot;:{&quot;imag&quot;:0.34,&quot;real&quot;:-0.28},'</span>
                <span class="s5">'&quot;1&quot;:{&quot;imag&quot;:-0.34,&quot;real&quot;:0.41}},'</span>
                <span class="s5">'&quot;1&quot;:{&quot;0&quot;:{&quot;imag&quot;:-0.39,&quot;real&quot;:-1.08},'</span>
                <span class="s5">'&quot;1&quot;:{&quot;imag&quot;:-1.35,&quot;real&quot;:-0.78}}}'</span><span class="s2">,</span>
            <span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_complex_data_tojson</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">data</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s3"># GH41174</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">data</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s0">def </span><span class="s1">test_json_uint64</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s3"># GH21073</span>
        <span class="s1">expected </span><span class="s2">= (</span>
            <span class="s5">'{&quot;columns&quot;:[&quot;col1&quot;],&quot;index&quot;:[0,1],'</span>
            <span class="s5">'&quot;data&quot;:[[13342205958987758245],[12388075603347835679]]}'</span>
        <span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">={</span><span class="s5">&quot;col1&quot;</span><span class="s2">: [</span><span class="s4">13342205958987758245</span><span class="s2">, </span><span class="s4">12388075603347835679</span><span class="s2">]})</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;split&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s5">&quot;values&quot;</span><span class="s2">, </span><span class="s5">&quot;index&quot;</span><span class="s2">, </span><span class="s5">&quot;columns&quot;</span><span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_read_json_dtype_backend</span><span class="s2">(</span>
        <span class="s1">self</span><span class="s2">, </span><span class="s1">string_storage</span><span class="s2">, </span><span class="s1">dtype_backend</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">, </span><span class="s1">using_infer_string</span>
    <span class="s2">):</span>
        <span class="s3"># GH#50750</span>
        <span class="s1">pa </span><span class="s2">= </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span>
                <span class="s5">&quot;a&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Int64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;b&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Int64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;c&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1.5</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">2.5</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Float64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;d&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">, </span><span class="s4">2.5</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Float64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;e&quot;</span><span class="s2">: [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">None</span><span class="s2">],</span>
                <span class="s5">&quot;f&quot;</span><span class="s2">: [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">],</span>
                <span class="s5">&quot;g&quot;</span><span class="s2">: [</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">],</span>
                <span class="s5">&quot;h&quot;</span><span class="s2">: [</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">],</span>
            <span class="s2">}</span>
        <span class="s2">)</span>

        <span class="s0">if </span><span class="s1">using_infer_string</span><span class="s2">:</span>
            <span class="s1">string_array </span><span class="s2">= </span><span class="s1">ArrowStringArrayNumpySemantics</span><span class="s2">(</span><span class="s1">pa</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">]))</span>
            <span class="s1">string_array_na </span><span class="s2">= </span><span class="s1">ArrowStringArrayNumpySemantics</span><span class="s2">(</span><span class="s1">pa</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">]))</span>
        <span class="s0">elif </span><span class="s1">string_storage </span><span class="s2">== </span><span class="s5">&quot;python&quot;</span><span class="s2">:</span>
            <span class="s1">string_array </span><span class="s2">= </span><span class="s1">StringArray</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">object_</span><span class="s2">))</span>
            <span class="s1">string_array_na </span><span class="s2">= </span><span class="s1">StringArray</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s1">NA</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">object_</span><span class="s2">))</span>

        <span class="s0">elif </span><span class="s1">dtype_backend </span><span class="s2">== </span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">:</span>
            <span class="s1">pa </span><span class="s2">= </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">)</span>
            <span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">arrays </span><span class="s0">import </span><span class="s1">ArrowExtensionArray</span>

            <span class="s1">string_array </span><span class="s2">= </span><span class="s1">ArrowExtensionArray</span><span class="s2">(</span><span class="s1">pa</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">]))</span>
            <span class="s1">string_array_na </span><span class="s2">= </span><span class="s1">ArrowExtensionArray</span><span class="s2">(</span><span class="s1">pa</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">]))</span>

        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">string_array </span><span class="s2">= </span><span class="s1">ArrowStringArray</span><span class="s2">(</span><span class="s1">pa</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s5">&quot;c&quot;</span><span class="s2">]))</span>
            <span class="s1">string_array_na </span><span class="s2">= </span><span class="s1">ArrowStringArray</span><span class="s2">(</span><span class="s1">pa</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">]))</span>

        <span class="s1">out </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">option_context</span><span class="s2">(</span><span class="s5">&quot;mode.string_storage&quot;</span><span class="s2">, </span><span class="s1">string_storage</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
                <span class="s1">StringIO</span><span class="s2">(</span><span class="s1">out</span><span class="s2">), </span><span class="s1">dtype_backend</span><span class="s2">=</span><span class="s1">dtype_backend</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span>
            <span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span>
                <span class="s5">&quot;a&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Int64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;b&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Int64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;c&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1.5</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">2.5</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Float64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;d&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">2.0</span><span class="s2">, </span><span class="s4">2.5</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Float64&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;e&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s1">NA</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;boolean&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;f&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">, </span><span class="s0">True</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;boolean&quot;</span><span class="s2">),</span>
                <span class="s5">&quot;g&quot;</span><span class="s2">: </span><span class="s1">string_array</span><span class="s2">,</span>
                <span class="s5">&quot;h&quot;</span><span class="s2">: </span><span class="s1">string_array_na</span><span class="s2">,</span>
            <span class="s2">}</span>
        <span class="s2">)</span>

        <span class="s0">if </span><span class="s1">dtype_backend </span><span class="s2">== </span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">:</span>
            <span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">arrays </span><span class="s0">import </span><span class="s1">ArrowExtensionArray</span>

            <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
                <span class="s2">{</span>
                    <span class="s1">col</span><span class="s2">: </span><span class="s1">ArrowExtensionArray</span><span class="s2">(</span><span class="s1">pa</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">[</span><span class="s1">col</span><span class="s2">], </span><span class="s1">from_pandas</span><span class="s2">=</span><span class="s0">True</span><span class="s2">))</span>
                    <span class="s0">for </span><span class="s1">col </span><span class="s0">in </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">columns</span>
                <span class="s2">}</span>
            <span class="s2">)</span>

        <span class="s0">if </span><span class="s1">orient </span><span class="s2">== </span><span class="s5">&quot;values&quot;</span><span class="s2">:</span>
            <span class="s1">expected</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">list</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">8</span><span class="s2">))</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s5">&quot;orient&quot;</span><span class="s2">, [</span><span class="s5">&quot;split&quot;</span><span class="s2">, </span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s5">&quot;index&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_read_json_nullable_series</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">string_storage</span><span class="s2">, </span><span class="s1">dtype_backend</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">):</span>
        <span class="s3"># GH#50750</span>
        <span class="s1">pa </span><span class="s2">= </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">)</span>
        <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Int64&quot;</span><span class="s2">)</span>

        <span class="s1">out </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">option_context</span><span class="s2">(</span><span class="s5">&quot;mode.string_storage&quot;</span><span class="s2">, </span><span class="s1">string_storage</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span>
                <span class="s1">StringIO</span><span class="s2">(</span><span class="s1">out</span><span class="s2">), </span><span class="s1">dtype_backend</span><span class="s2">=</span><span class="s1">dtype_backend</span><span class="s2">, </span><span class="s1">orient</span><span class="s2">=</span><span class="s1">orient</span><span class="s2">, </span><span class="s1">typ</span><span class="s2">=</span><span class="s5">&quot;series&quot;</span>
            <span class="s2">)</span>

        <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Int64&quot;</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">dtype_backend </span><span class="s2">== </span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">:</span>
            <span class="s0">from </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">arrays </span><span class="s0">import </span><span class="s1">ArrowExtensionArray</span>

            <span class="s1">expected </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">ArrowExtensionArray</span><span class="s2">(</span><span class="s1">pa</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">, </span><span class="s1">from_pandas</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>

        <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_series_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_dtype_backend</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">msg </span><span class="s2">= (</span>
            <span class="s5">&quot;dtype_backend numpy is invalid, only 'numpy_nullable' and &quot;</span>
            <span class="s5">&quot;'pyarrow' are allowed.&quot;</span>
        <span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
            <span class="s1">read_json</span><span class="s2">(</span><span class="s5">&quot;test&quot;</span><span class="s2">, </span><span class="s1">dtype_backend</span><span class="s2">=</span><span class="s5">&quot;numpy&quot;</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_invalid_engine</span><span class="s2">():</span>
    <span class="s3"># GH 48893</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">1</span><span class="s2">))</span>
    <span class="s1">out </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s5">&quot;The engine type foo&quot;</span><span class="s2">):</span>
        <span class="s1">read_json</span><span class="s2">(</span><span class="s1">out</span><span class="s2">, </span><span class="s1">engine</span><span class="s2">=</span><span class="s5">&quot;foo&quot;</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_pyarrow_engine_lines_false</span><span class="s2">():</span>
    <span class="s3"># GH 48893</span>
    <span class="s1">ser </span><span class="s2">= </span><span class="s1">Series</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">1</span><span class="s2">))</span>
    <span class="s1">out </span><span class="s2">= </span><span class="s1">ser</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s5">&quot;currently pyarrow engine only supports&quot;</span><span class="s2">):</span>
        <span class="s1">read_json</span><span class="s2">(</span><span class="s1">out</span><span class="s2">, </span><span class="s1">engine</span><span class="s2">=</span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_json_roundtrip_string_inference</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">):</span>
    <span class="s1">pytest</span><span class="s2">.</span><span class="s1">importorskip</span><span class="s2">(</span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">)</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s2">[[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]], </span><span class="s1">index</span><span class="s2">=[</span><span class="s5">&quot;row 1&quot;</span><span class="s2">, </span><span class="s5">&quot;row 2&quot;</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">&quot;col 1&quot;</span><span class="s2">, </span><span class="s5">&quot;col 2&quot;</span><span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s1">out </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">()</span>
    <span class="s0">with </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">option_context</span><span class="s2">(</span><span class="s5">&quot;future.infer_string&quot;</span><span class="s2">, </span><span class="s0">True</span><span class="s2">):</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">out</span><span class="s2">))</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s2">[[</span><span class="s5">&quot;a&quot;</span><span class="s2">, </span><span class="s5">&quot;b&quot;</span><span class="s2">], [</span><span class="s5">&quot;c&quot;</span><span class="s2">, </span><span class="s5">&quot;d&quot;</span><span class="s2">]],</span>
        <span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;string[pyarrow_numpy]&quot;</span><span class="s2">,</span>
        <span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">&quot;row 1&quot;</span><span class="s2">, </span><span class="s5">&quot;row 2&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;string[pyarrow_numpy]&quot;</span><span class="s2">),</span>
        <span class="s1">columns</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">&quot;col 1&quot;</span><span class="s2">, </span><span class="s5">&quot;col 2&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;string[pyarrow_numpy]&quot;</span><span class="s2">),</span>
    <span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_frame_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_json_pos_args_deprecation</span><span class="s2">():</span>
    <span class="s3"># GH-54229</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s5">&quot;a&quot;</span><span class="s2">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]})</span>
    <span class="s1">msg </span><span class="s2">= (</span>
        <span class="s5">r&quot;Starting with pandas version 3.0 all arguments of to_json except for the &quot;</span>
        <span class="s5">r&quot;argument 'path_or_buf' will be keyword-only.&quot;</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">buf </span><span class="s2">= </span><span class="s1">BytesIO</span><span class="s2">()</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">buf</span><span class="s2">, </span><span class="s5">&quot;split&quot;</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">td</span><span class="s2">.</span><span class="s1">skip_if_no</span><span class="s2">(</span><span class="s5">&quot;pyarrow&quot;</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_json_ea_null</span><span class="s2">():</span>
    <span class="s3"># GH#57224</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s2">{</span>
            <span class="s5">&quot;a&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s1">NA</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;int64[pyarrow]&quot;</span><span class="s2">),</span>
            <span class="s5">&quot;b&quot;</span><span class="s2">: </span><span class="s1">Series</span><span class="s2">([</span><span class="s4">2</span><span class="s2">, </span><span class="s1">NA</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s5">&quot;Int64&quot;</span><span class="s2">),</span>
        <span class="s2">}</span>
    <span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_json</span><span class="s2">(</span><span class="s1">orient</span><span class="s2">=</span><span class="s5">&quot;records&quot;</span><span class="s2">, </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s5">&quot;&quot;&quot;{&quot;a&quot;:1,&quot;b&quot;:2} 
{&quot;a&quot;:null,&quot;b&quot;:null} 
&quot;&quot;&quot;</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_read_json_lines_rangeindex</span><span class="s2">():</span>
    <span class="s3"># GH 57429</span>
    <span class="s1">data </span><span class="s2">= </span><span class="s5">&quot;&quot;&quot; 
{&quot;a&quot;: 1, &quot;b&quot;: 2} 
{&quot;a&quot;: 3, &quot;b&quot;: 4} 
&quot;&quot;&quot;</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">read_json</span><span class="s2">(</span><span class="s1">StringIO</span><span class="s2">(</span><span class="s1">data</span><span class="s2">), </span><span class="s1">lines</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">index</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">RangeIndex</span><span class="s2">(</span><span class="s4">2</span><span class="s2">)</span>
    <span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_index_equal</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">exact</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
</pre>
</body>
</html>