<html>
<head>
<title>test_generator_mt19937.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #2aacb8;}
.s5 { color: #7a7e85;}
.s6 { color: #a5c261;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_generator_mt19937.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span>
<span class="s0">import </span><span class="s1">sys</span>
<span class="s0">import </span><span class="s1">hashlib</span>

<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">exceptions </span><span class="s0">import </span><span class="s1">AxisError</span>
<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">linalg </span><span class="s0">import </span><span class="s1">LinAlgError</span>
<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">testing </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">assert_</span><span class="s2">, </span><span class="s1">assert_raises</span><span class="s2">, </span><span class="s1">assert_equal</span><span class="s2">, </span><span class="s1">assert_allclose</span><span class="s2">,</span>
    <span class="s1">assert_warns</span><span class="s2">, </span><span class="s1">assert_no_warnings</span><span class="s2">, </span><span class="s1">assert_array_equal</span><span class="s2">,</span>
    <span class="s1">assert_array_almost_equal</span><span class="s2">, </span><span class="s1">suppress_warnings</span><span class="s2">, </span><span class="s1">IS_WASM</span><span class="s2">)</span>

<span class="s0">from </span><span class="s1">numpy</span><span class="s2">.</span><span class="s1">random </span><span class="s0">import </span><span class="s1">Generator</span><span class="s2">, </span><span class="s1">MT19937</span><span class="s2">, </span><span class="s1">SeedSequence</span><span class="s2">, </span><span class="s1">RandomState</span>

<span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">())</span>

<span class="s1">JUMP_TEST_DATA </span><span class="s2">= [</span>
    <span class="s2">{</span>
        <span class="s3">&quot;seed&quot;</span><span class="s2">: </span><span class="s4">0</span><span class="s2">,</span>
        <span class="s3">&quot;steps&quot;</span><span class="s2">: </span><span class="s4">10</span><span class="s2">,</span>
        <span class="s3">&quot;initial&quot;</span><span class="s2">: {</span><span class="s3">&quot;key_sha256&quot;</span><span class="s2">: </span><span class="s3">&quot;bb1636883c2707b51c5b7fc26c6927af4430f2e0785a8c7bc886337f919f9edf&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">: </span><span class="s4">9</span><span class="s2">},</span>
        <span class="s3">&quot;jumped&quot;</span><span class="s2">: {</span><span class="s3">&quot;key_sha256&quot;</span><span class="s2">: </span><span class="s3">&quot;ff682ac12bb140f2d72fba8d3506cf4e46817a0db27aae1683867629031d8d55&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">: </span><span class="s4">598</span><span class="s2">},</span>
    <span class="s2">},</span>
    <span class="s2">{</span>
        <span class="s3">&quot;seed&quot;</span><span class="s2">:</span><span class="s4">384908324</span><span class="s2">,</span>
        <span class="s3">&quot;steps&quot;</span><span class="s2">:</span><span class="s4">312</span><span class="s2">,</span>
        <span class="s3">&quot;initial&quot;</span><span class="s2">: {</span><span class="s3">&quot;key_sha256&quot;</span><span class="s2">: </span><span class="s3">&quot;16b791a1e04886ccbbb4d448d6ff791267dc458ae599475d08d5cced29d11614&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">: </span><span class="s4">311</span><span class="s2">},</span>
        <span class="s3">&quot;jumped&quot;</span><span class="s2">: {</span><span class="s3">&quot;key_sha256&quot;</span><span class="s2">: </span><span class="s3">&quot;a0110a2cf23b56be0feaed8f787a7fc84bef0cb5623003d75b26bdfa1c18002c&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">: </span><span class="s4">276</span><span class="s2">},</span>
    <span class="s2">},</span>
    <span class="s2">{</span>
        <span class="s3">&quot;seed&quot;</span><span class="s2">: [</span><span class="s4">839438204</span><span class="s2">, </span><span class="s4">980239840</span><span class="s2">, </span><span class="s4">859048019</span><span class="s2">, </span><span class="s4">821</span><span class="s2">],</span>
        <span class="s3">&quot;steps&quot;</span><span class="s2">: </span><span class="s4">511</span><span class="s2">,</span>
        <span class="s3">&quot;initial&quot;</span><span class="s2">: {</span><span class="s3">&quot;key_sha256&quot;</span><span class="s2">: </span><span class="s3">&quot;d306cf01314d51bd37892d874308200951a35265ede54d200f1e065004c3e9ea&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">: </span><span class="s4">510</span><span class="s2">},</span>
        <span class="s3">&quot;jumped&quot;</span><span class="s2">: {</span><span class="s3">&quot;key_sha256&quot;</span><span class="s2">: </span><span class="s3">&quot;0e00ab449f01a5195a83b4aee0dfbc2ce8d46466a640b92e33977d2e42f777f8&quot;</span><span class="s2">, </span><span class="s3">&quot;pos&quot;</span><span class="s2">: </span><span class="s4">475</span><span class="s2">},</span>
    <span class="s2">},</span>
<span class="s2">]</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span><span class="s2">(</span><span class="s1">scope</span><span class="s2">=</span><span class="s3">'module'</span><span class="s2">, </span><span class="s1">params</span><span class="s2">=[</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">endpoint</span><span class="s2">(</span><span class="s1">request</span><span class="s2">):</span>
    <span class="s0">return </span><span class="s1">request</span><span class="s2">.</span><span class="s1">param</span>


<span class="s0">class </span><span class="s1">TestSeed</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_scalar</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">0</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">479</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">4294967295</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">324</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">10</span><span class="s2">)))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">465</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">10</span><span class="s2">)))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">465</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">([</span><span class="s4">0</span><span class="s2">]))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">479</span><span class="s2">)</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">([</span><span class="s4">4294967295</span><span class="s2">]))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">1000</span><span class="s2">), </span><span class="s4">324</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_seedsequence</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">SeedSequence</span><span class="s2">(</span><span class="s4">0</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">s</span><span class="s2">.</span><span class="s1">random_raw</span><span class="s2">(</span><span class="s4">1</span><span class="s2">), </span><span class="s4">2058676884</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_scalar</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">MT19937</span><span class="s2">, -</span><span class="s4">0.5</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">MT19937</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># seed must be an unsigned integer</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">MT19937</span><span class="s2">, [-</span><span class="s4">0.5</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">MT19937</span><span class="s2">, [-</span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">MT19937</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, -</span><span class="s4">2</span><span class="s2">, </span><span class="s4">4294967296</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_noninstantized_bitgen</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">Generator</span><span class="s2">, </span><span class="s1">MT19937</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestBinomial</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_n_zero</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Tests the corner case of n == 0 for the binomial distribution.</span>
        <span class="s5"># binomial(0, p) should be zero for any p in [0, 1].</span>
        <span class="s5"># This test addresses issue #3480.</span>
        <span class="s1">zeros </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">'int'</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">p </span><span class="s0">in </span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">.5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]:</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">p</span><span class="s2">) == </span><span class="s4">0</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s1">zeros</span><span class="s2">, </span><span class="s1">p</span><span class="s2">), </span><span class="s1">zeros</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_p_is_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Issue #4571.</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestMultinomial</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_basic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, [</span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">0.8</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_zero_probability</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, [</span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">0.8</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_int_negative_interval</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_</span><span class="s2">(-</span><span class="s4">5 </span><span class="s2">&lt;= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(-</span><span class="s4">5</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">) &lt; -</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(-</span><span class="s4">5</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(-</span><span class="s4">5 </span><span class="s2">&lt;= </span><span class="s1">x</span><span class="s2">))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">x </span><span class="s2">&lt; -</span><span class="s4">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_size</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-3173</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))).</span><span class="s1">shape</span><span class="s2">,</span>
                     <span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">p</span><span class="s2">,</span>
                      <span class="s1">float</span><span class="s2">(</span><span class="s4">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_invalid_prob</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s4">100</span><span class="s2">, [</span><span class="s4">1.1</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s4">100</span><span class="s2">, [-</span><span class="s4">.1</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_invalid_n</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, [</span><span class="s4">0.8</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, [-</span><span class="s4">1</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">, [</span><span class="s4">0.8</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_p_non_contiguous</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">15.</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">/= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">sum</span><span class="s2">(</span><span class="s1">p</span><span class="s2">[</span><span class="s4">1</span><span class="s2">::</span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">pvals </span><span class="s2">= </span><span class="s1">p</span><span class="s2">[</span><span class="s4">1</span><span class="s2">::</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1432985819</span><span class="s2">))</span>
        <span class="s1">non_contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">=</span><span class="s1">pvals</span><span class="s2">)</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1432985819</span><span class="s2">))</span>
        <span class="s1">contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">100</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ascontiguousarray</span><span class="s2">(</span><span class="s1">pvals</span><span class="s2">))</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">non_contig</span><span class="s2">, </span><span class="s1">contig</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_multinomial_pvals_float32</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">9.9e-01</span><span class="s2">, </span><span class="s4">9.9e-01</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">,</span>
                      <span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">, </span><span class="s4">1.0e-09</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s1">pvals </span><span class="s2">= </span><span class="s1">x </span><span class="s2">/ </span><span class="s1">x</span><span class="s2">.</span><span class="s1">sum</span><span class="s2">()</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1432985819</span><span class="s2">))</span>
        <span class="s1">match </span><span class="s2">= </span><span class="s3">r&quot;[\w\s]*pvals array is cast to 64-bit floating&quot;</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">match</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestMultivariateHypergeometric</span><span class="s2">:</span>

    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s4">8675309</span>

    <span class="s0">def </span><span class="s1">test_argument_validation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Error cases...</span>

        <span class="s5"># `colors` must be a 1-d sequence</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">,</span>
                      <span class="s4">10</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)</span>

        <span class="s5"># Negative nsample</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">,</span>
                      <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">], -</span><span class="s4">1</span><span class="s2">)</span>

        <span class="s5"># Negative color</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">,</span>
                      <span class="s2">[-</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s4">2</span><span class="s2">)</span>

        <span class="s5"># nsample exceeds sum(colors)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">,</span>
                      <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">], </span><span class="s4">10</span><span class="s2">)</span>

        <span class="s5"># nsample exceeds sum(colors) (edge case of empty colors)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">,</span>
                      <span class="s2">[], </span><span class="s4">1</span><span class="s2">)</span>

        <span class="s5"># Validation errors associated with very large values in colors.</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">,</span>
                      <span class="s2">[</span><span class="s4">999999999</span><span class="s2">, </span><span class="s4">101</span><span class="s2">], </span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s3">'marginals'</span><span class="s2">)</span>

        <span class="s1">int64_info </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">max_int64 </span><span class="s2">= </span><span class="s1">int64_info</span><span class="s2">.</span><span class="s1">max</span>
        <span class="s1">max_int64_index </span><span class="s2">= </span><span class="s1">max_int64 </span><span class="s2">// </span><span class="s1">int64_info</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">itemsize</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">,</span>
                      <span class="s2">[</span><span class="s1">max_int64_index </span><span class="s2">- </span><span class="s4">100</span><span class="s2">, </span><span class="s4">101</span><span class="s2">], </span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s3">'count'</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">'method'</span><span class="s2">, [</span><span class="s3">'count'</span><span class="s2">, </span><span class="s3">'marginals'</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_edge_cases</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">method</span><span class="s2">):</span>
        <span class="s5"># Set the seed, but in fact, all the results in this test are</span>
        <span class="s5"># deterministic, so we don't really need this.</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], </span><span class="s4">0</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([], </span><span class="s4">0</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, [])</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([], </span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">))</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s4">0</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([</span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], </span><span class="s4">3</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>

        <span class="s1">colors </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">(</span><span class="s1">colors</span><span class="s2">, </span><span class="s1">sum</span><span class="s2">(</span><span class="s1">colors</span><span class="s2">),</span>
                                               <span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">colors</span><span class="s2">)</span>

        <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">], </span><span class="s4">12</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">,</span>
                                               <span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, [[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]]*</span><span class="s4">3</span><span class="s2">)</span>

    <span class="s5"># Cases for nsample:</span>
    <span class="s5">#     nsample &lt; 10</span>
    <span class="s5">#     10 &lt;= nsample &lt; colors.sum()/2</span>
    <span class="s5">#     colors.sum()/2 &lt; nsample &lt; colors.sum() - 10</span>
    <span class="s5">#     colors.sum() - 10 &lt; nsample &lt; colors.sum()</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">'nsample'</span><span class="s2">, [</span><span class="s4">8</span><span class="s2">, </span><span class="s4">25</span><span class="s2">, </span><span class="s4">45</span><span class="s2">, </span><span class="s4">55</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">'method'</span><span class="s2">, [</span><span class="s3">'count'</span><span class="s2">, </span><span class="s3">'marginals'</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">'size'</span><span class="s2">, [</span><span class="s4">5</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">), </span><span class="s4">150000</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_typical_cases</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">, </span><span class="s1">method</span><span class="s2">, </span><span class="s1">size</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>

        <span class="s1">colors </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">10</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">20</span><span class="s2">, </span><span class="s4">25</span><span class="s2">])</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">(</span><span class="s1">colors</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">, </span><span class="s1">size</span><span class="s2">,</span>
                                                    <span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">size</span><span class="s2">, </span><span class="s1">int</span><span class="s2">):</span>
            <span class="s1">expected_shape </span><span class="s2">= (</span><span class="s1">size</span><span class="s2">,) + </span><span class="s1">colors</span><span class="s2">.</span><span class="s1">shape</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">expected_shape </span><span class="s2">= </span><span class="s1">size </span><span class="s2">+ </span><span class="s1">colors</span><span class="s2">.</span><span class="s1">shape</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">expected_shape</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">((</span><span class="s1">sample </span><span class="s2">&gt;= </span><span class="s4">0</span><span class="s2">).</span><span class="s1">all</span><span class="s2">())</span>
        <span class="s1">assert_</span><span class="s2">((</span><span class="s1">sample </span><span class="s2">&lt;= </span><span class="s1">colors</span><span class="s2">).</span><span class="s1">all</span><span class="s2">())</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">sum</span><span class="s2">(</span><span class="s1">axis</span><span class="s2">=-</span><span class="s4">1</span><span class="s2">),</span>
                           <span class="s1">np</span><span class="s2">.</span><span class="s1">full</span><span class="s2">(</span><span class="s1">size</span><span class="s2">, </span><span class="s1">fill_value</span><span class="s2">=</span><span class="s1">nsample</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">int</span><span class="s2">))</span>
        <span class="s0">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">size</span><span class="s2">, </span><span class="s1">int</span><span class="s2">) </span><span class="s0">and </span><span class="s1">size </span><span class="s2">&gt;= </span><span class="s4">100000</span><span class="s2">:</span>
            <span class="s5"># This sample is large enough to compare its mean to</span>
            <span class="s5"># the expected values.</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">mean</span><span class="s2">(</span><span class="s1">axis</span><span class="s2">=</span><span class="s4">0</span><span class="s2">),</span>
                            <span class="s1">nsample </span><span class="s2">* </span><span class="s1">colors </span><span class="s2">/ </span><span class="s1">colors</span><span class="s2">.</span><span class="s1">sum</span><span class="s2">(),</span>
                            <span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-3</span><span class="s2">, </span><span class="s1">atol</span><span class="s2">=</span><span class="s4">0.005</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability1</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([</span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">], </span><span class="s4">5</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">5</span><span class="s2">,</span>
                                                    <span class="s1">method</span><span class="s2">=</span><span class="s3">'count'</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">3</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability2</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([</span><span class="s4">20</span><span class="s2">, </span><span class="s4">30</span><span class="s2">, </span><span class="s4">50</span><span class="s2">], </span><span class="s4">50</span><span class="s2">,</span>
                                                    <span class="s1">size</span><span class="s2">=</span><span class="s4">5</span><span class="s2">,</span>
                                                    <span class="s1">method</span><span class="s2">=</span><span class="s3">'marginals'</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">9</span><span class="s2">, </span><span class="s4">17</span><span class="s2">, </span><span class="s4">24</span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">7</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">30</span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">9</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">26</span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">9</span><span class="s2">, </span><span class="s4">17</span><span class="s2">, </span><span class="s4">24</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">12</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s4">24</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability3</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_hypergeometric</span><span class="s2">([</span><span class="s4">20</span><span class="s2">, </span><span class="s4">30</span><span class="s2">, </span><span class="s4">50</span><span class="s2">], </span><span class="s4">12</span><span class="s2">,</span>
                                                    <span class="s1">size</span><span class="s2">=</span><span class="s4">5</span><span class="s2">,</span>
                                                    <span class="s1">method</span><span class="s2">=</span><span class="s3">'marginals'</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">7</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">5</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestSetState</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s4">1234567890</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">rg </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">bit_generator </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rg</span><span class="s2">.</span><span class="s1">bit_generator</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">legacy_state </span><span class="s2">= (</span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[</span><span class="s3">'bit_generator'</span><span class="s2">],</span>
                             <span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'key'</span><span class="s2">],</span>
                             <span class="s1">self</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">][</span><span class="s3">'pos'</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Make sure the cached every-other-Gaussian is reset.</span>
        <span class="s1">old </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rg</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">state</span>
        <span class="s1">new </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rg</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">old </span><span class="s2">== </span><span class="s1">new</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset_in_media_res</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># When the state is saved with a cached Gaussian, make sure the</span>
        <span class="s5"># cached Gaussian is restored.</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">rg</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">()</span>
        <span class="s1">state </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state</span>
        <span class="s1">old </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rg</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state </span><span class="s2">= </span><span class="s1">state</span>
        <span class="s1">new </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rg</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">old </span><span class="s2">== </span><span class="s1">new</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Ensure that the negative binomial results take floating point</span>
        <span class="s5"># arguments without truncation.</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">rg</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">(</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestIntegers</span><span class="s2">:</span>
    <span class="s1">rfunc </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span>

    <span class="s5"># valid integer/boolean types</span>
    <span class="s1">itype </span><span class="s2">= [</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int16</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint16</span><span class="s2">,</span>
             <span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">]</span>

    <span class="s0">def </span><span class="s1">test_unsupported_type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">float</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_bounds_checking</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">lbnd </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">,</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">,</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">lbnd</span><span class="s2">,</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                          <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, [</span><span class="s1">lbnd </span><span class="s2">- </span><span class="s4">1</span><span class="s2">], </span><span class="s1">ubnd</span><span class="s2">,</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, [</span><span class="s1">lbnd</span><span class="s2">], [</span><span class="s1">ubnd </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">],</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, [</span><span class="s1">ubnd</span><span class="s2">], [</span><span class="s1">lbnd</span><span class="s2">],</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, [</span><span class="s4">0</span><span class="s2">],</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, [</span><span class="s1">ubnd</span><span class="s2">+</span><span class="s4">1</span><span class="s2">], [</span><span class="s1">ubnd</span><span class="s2">],</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_bounds_checking_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ (</span><span class="s0">not </span><span class="s1">endpoint</span><span class="s2">)</span>

            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, [</span><span class="s1">lbnd </span><span class="s2">- </span><span class="s4">1</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">, [</span><span class="s1">ubnd</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">,</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, [</span><span class="s1">lbnd</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">,</span>
                          <span class="s2">[</span><span class="s1">ubnd </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, [</span><span class="s1">lbnd</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">,</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">,</span>
                          <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rng_zero_and_extremes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>
            <span class="s1">is_open </span><span class="s2">= </span><span class="s0">not </span><span class="s1">endpoint</span>

            <span class="s1">tgt </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s1">is_open</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">,</span>
                                    <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([</span><span class="s1">tgt</span><span class="s2">], </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s1">is_open</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">,</span>
                                    <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

            <span class="s1">tgt </span><span class="s2">= </span><span class="s1">lbnd</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s1">is_open</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">,</span>
                                    <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s1">is_open</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">,</span>
                                    <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

            <span class="s1">tgt </span><span class="s2">= (</span><span class="s1">lbnd </span><span class="s2">+ </span><span class="s1">ubnd</span><span class="s2">) // </span><span class="s4">2</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">tgt </span><span class="s2">+ </span><span class="s1">is_open</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">,</span>
                                    <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([</span><span class="s1">tgt</span><span class="s2">], [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s1">is_open</span><span class="s2">],</span>
                                    <span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">),</span>
                         <span class="s1">tgt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rng_zero_and_extremes_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s1">size </span><span class="s2">= </span><span class="s4">1000</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s1">tgt </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([</span><span class="s1">tgt</span><span class="s2">], [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">],</span>
                                    <span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span>
                <span class="s2">[</span><span class="s1">tgt</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span>
                <span class="s2">[</span><span class="s1">tgt</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

            <span class="s1">tgt </span><span class="s2">= </span><span class="s1">lbnd</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([</span><span class="s1">tgt</span><span class="s2">], [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">],</span>
                                    <span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span>
                <span class="s2">[</span><span class="s1">tgt</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span>
                <span class="s2">[</span><span class="s1">tgt</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

            <span class="s1">tgt </span><span class="s2">= (</span><span class="s1">lbnd </span><span class="s2">+ </span><span class="s1">ubnd</span><span class="s2">) // </span><span class="s4">2</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([</span><span class="s1">tgt</span><span class="s2">], [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">],</span>
                                    <span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span>
                <span class="s2">[</span><span class="s1">tgt</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span>
                <span class="s2">[</span><span class="s1">tgt</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, [</span><span class="s1">tgt </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">), </span><span class="s1">tgt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_full_range</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s5"># Test for ticket #1690</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s0">raise </span><span class="s1">AssertionError</span><span class="s2">(</span><span class="s3">&quot;No error should have been raised, &quot;</span>
                                     <span class="s3">&quot;but one was with the following &quot;</span>
                                     <span class="s3">&quot;message:</span><span class="s0">\n\n</span><span class="s3">%s&quot; </span><span class="s2">% </span><span class="s1">str</span><span class="s2">(</span><span class="s1">e</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_full_range_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s5"># Test for ticket #1690</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s0">try</span><span class="s2">:</span>
                <span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([</span><span class="s1">lbnd</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">, [</span><span class="s1">ubnd</span><span class="s2">], </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
                <span class="s0">raise </span><span class="s1">AssertionError</span><span class="s2">(</span><span class="s3">&quot;No error should have been raised, &quot;</span>
                                     <span class="s3">&quot;but one was with the following &quot;</span>
                                     <span class="s3">&quot;message:</span><span class="s0">\n\n</span><span class="s3">%s&quot; </span><span class="s2">% </span><span class="s1">str</span><span class="s2">(</span><span class="s1">e</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_in_bounds_fuzz</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s5"># Don't use fixed seed</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">())</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">[</span><span class="s4">1</span><span class="s2">:]:</span>
            <span class="s0">for </span><span class="s1">ubnd </span><span class="s0">in </span><span class="s2">[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">16</span><span class="s2">]:</span>
                <span class="s1">vals </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">2 </span><span class="s2">** </span><span class="s4">16</span><span class="s2">,</span>
                                  <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
                <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">max</span><span class="s2">() &lt; </span><span class="s1">ubnd</span><span class="s2">)</span>
                <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">min</span><span class="s2">() &gt;= </span><span class="s4">2</span><span class="s2">)</span>

        <span class="s1">vals </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2 </span><span class="s2">- </span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">2 </span><span class="s2">** </span><span class="s4">16</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                          <span class="s1">dtype</span><span class="s2">=</span><span class="s1">bool</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">max</span><span class="s2">() &lt; </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">vals</span><span class="s2">.</span><span class="s1">min</span><span class="s2">() &gt;= </span><span class="s4">0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_scalar_array_equiv</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s1">size </span><span class="s2">= </span><span class="s4">1000</span>
            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>
            <span class="s1">scalar </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                                <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>
            <span class="s1">scalar_array </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">([</span><span class="s1">lbnd</span><span class="s2">], [</span><span class="s1">ubnd</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">,</span>
                                      <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>
            <span class="s1">array </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">([</span><span class="s1">lbnd</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">, [</span><span class="s1">ubnd</span><span class="s2">] *</span>
                               <span class="s1">size</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">scalar</span><span class="s2">, </span><span class="s1">scalar_array</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">scalar</span><span class="s2">, </span><span class="s1">array</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s5"># We use a sha256 hash of generated sequences of 1000 samples</span>
        <span class="s5"># in the range [0, 6) for all but bool, where the range</span>
        <span class="s5"># is [0, 2). Hashes are for little endian numbers.</span>
        <span class="s1">tgt </span><span class="s2">= {</span><span class="s3">'bool'</span><span class="s2">:   </span><span class="s3">'053594a9b82d656f967c54869bc6970aa0358cf94ad469c81478459c6a90eee3'</span><span class="s2">,</span>
               <span class="s3">'int16'</span><span class="s2">:  </span><span class="s3">'54de9072b6ee9ff7f20b58329556a46a447a8a29d67db51201bf88baa6e4e5d4'</span><span class="s2">,</span>
               <span class="s3">'int32'</span><span class="s2">:  </span><span class="s3">'d3a0d5efb04542b25ac712e50d21f39ac30f312a5052e9bbb1ad3baa791ac84b'</span><span class="s2">,</span>
               <span class="s3">'int64'</span><span class="s2">:  </span><span class="s3">'14e224389ac4580bfbdccb5697d6190b496f91227cf67df60989de3d546389b1'</span><span class="s2">,</span>
               <span class="s3">'int8'</span><span class="s2">:   </span><span class="s3">'0e203226ff3fbbd1580f15da4621e5f7164d0d8d6b51696dd42d004ece2cbec1'</span><span class="s2">,</span>
               <span class="s3">'uint16'</span><span class="s2">: </span><span class="s3">'54de9072b6ee9ff7f20b58329556a46a447a8a29d67db51201bf88baa6e4e5d4'</span><span class="s2">,</span>
               <span class="s3">'uint32'</span><span class="s2">: </span><span class="s3">'d3a0d5efb04542b25ac712e50d21f39ac30f312a5052e9bbb1ad3baa791ac84b'</span><span class="s2">,</span>
               <span class="s3">'uint64'</span><span class="s2">: </span><span class="s3">'14e224389ac4580bfbdccb5697d6190b496f91227cf67df60989de3d546389b1'</span><span class="s2">,</span>
               <span class="s3">'uint8'</span><span class="s2">:  </span><span class="s3">'0e203226ff3fbbd1580f15da4621e5f7164d0d8d6b51696dd42d004ece2cbec1'</span><span class="s2">}</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">[</span><span class="s4">1</span><span class="s2">:]:</span>
            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>

            <span class="s5"># view as little endian for hash</span>
            <span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">== </span><span class="s3">'little'</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">6 </span><span class="s2">- </span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                                 <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">val </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">6 </span><span class="s2">- </span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                                 <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">byteswap</span><span class="s2">()</span>

            <span class="s1">res </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">val</span><span class="s2">).</span><span class="s1">hexdigest</span><span class="s2">()</span>
            <span class="s1">assert_</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">name</span><span class="s2">] == </span><span class="s1">res</span><span class="s2">)</span>

        <span class="s5"># bools do not depend on endianness</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>
        <span class="s1">val </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2 </span><span class="s2">- </span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                         <span class="s1">dtype</span><span class="s2">=</span><span class="s1">bool</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">)</span>
        <span class="s1">res </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">val</span><span class="s2">).</span><span class="s1">hexdigest</span><span class="s2">()</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">tgt</span><span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">(</span><span class="s1">bool</span><span class="s2">).</span><span class="s1">name</span><span class="s2">] == </span><span class="s1">res</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability_broadcasting</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">in </span><span class="s2">(</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool</span><span class="s2">) </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">in </span><span class="s2">(</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool</span><span class="s2">) </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s5"># view as little endian for hash</span>
            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>
            <span class="s1">val </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">1000</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                             <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>
            <span class="s1">val_bc </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">([</span><span class="s1">lbnd</span><span class="s2">] * </span><span class="s4">1000</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                                <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">val</span><span class="s2">, </span><span class="s1">val_bc</span><span class="s2">)</span>

            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>
            <span class="s1">val_bc </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">([</span><span class="s1">lbnd</span><span class="s2">] * </span><span class="s4">1000</span><span class="s2">, [</span><span class="s1">ubnd</span><span class="s2">] * </span><span class="s4">1000</span><span class="s2">,</span>
                                <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>

            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">val</span><span class="s2">, </span><span class="s1">val_bc</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">'bound, expected'</span><span class="s2">,</span>
        <span class="s2">[(</span><span class="s4">2</span><span class="s2">**</span><span class="s4">32 </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">517043486</span><span class="s2">, </span><span class="s4">1364798665</span><span class="s2">, </span><span class="s4">1733884389</span><span class="s2">, </span><span class="s4">1353720612</span><span class="s2">,</span>
                               <span class="s4">3769704066</span><span class="s2">, </span><span class="s4">1170797179</span><span class="s2">, </span><span class="s4">4108474671</span><span class="s2">])),</span>
         <span class="s2">(</span><span class="s4">2</span><span class="s2">**</span><span class="s4">32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">517043487</span><span class="s2">, </span><span class="s4">1364798666</span><span class="s2">, </span><span class="s4">1733884390</span><span class="s2">, </span><span class="s4">1353720613</span><span class="s2">,</span>
                           <span class="s4">3769704067</span><span class="s2">, </span><span class="s4">1170797180</span><span class="s2">, </span><span class="s4">4108474672</span><span class="s2">])),</span>
         <span class="s2">(</span><span class="s4">2</span><span class="s2">**</span><span class="s4">32 </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">517043487</span><span class="s2">, </span><span class="s4">1733884390</span><span class="s2">, </span><span class="s4">3769704068</span><span class="s2">, </span><span class="s4">4108474673</span><span class="s2">,</span>
                               <span class="s4">1831631863</span><span class="s2">, </span><span class="s4">1215661561</span><span class="s2">, </span><span class="s4">3869512430</span><span class="s2">]))]</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_repeatability_32bit_boundary</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">bound</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s0">for </span><span class="s1">size </span><span class="s0">in </span><span class="s2">[</span><span class="s0">None</span><span class="s2">, </span><span class="s1">len</span><span class="s2">(</span><span class="s1">expected</span><span class="s2">)]:</span>
            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">1234</span><span class="s2">))</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s1">bound</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">expected </span><span class="s0">if </span><span class="s1">size </span><span class="s0">is not None else </span><span class="s1">expected</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_repeatability_32bit_boundary_broadcasting</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">1622936284</span><span class="s2">, </span><span class="s4">3620788691</span><span class="s2">, </span><span class="s4">1659384060</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1417365545</span><span class="s2">,  </span><span class="s4">760222891</span><span class="s2">, </span><span class="s4">1909653332</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">3788118662</span><span class="s2">,  </span><span class="s4">660249498</span><span class="s2">, </span><span class="s4">4092002593</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">3625610153</span><span class="s2">, </span><span class="s4">2979601262</span><span class="s2">, </span><span class="s4">3844162757</span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">685800658</span><span class="s2">,  </span><span class="s4">120261497</span><span class="s2">, </span><span class="s4">2694012896</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1207779440</span><span class="s2">, </span><span class="s4">1586594375</span><span class="s2">, </span><span class="s4">3854335050</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">3004074748</span><span class="s2">, </span><span class="s4">2310761796</span><span class="s2">, </span><span class="s4">3012642217</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">2067714190</span><span class="s2">, </span><span class="s4">2786677879</span><span class="s2">, </span><span class="s4">1363865881</span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">791663441</span><span class="s2">, </span><span class="s4">1867303284</span><span class="s2">, </span><span class="s4">2169727960</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">1939603804</span><span class="s2">, </span><span class="s4">1250951100</span><span class="s2">,  </span><span class="s4">298950036</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1040128489</span><span class="s2">, </span><span class="s4">3791912209</span><span class="s2">, </span><span class="s4">3317053765</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">3155528714</span><span class="s2">,   </span><span class="s4">61360675</span><span class="s2">, </span><span class="s4">2305155588</span><span class="s2">]],</span>
                            <span class="s2">[[ </span><span class="s4">817688762</span><span class="s2">, </span><span class="s4">1335621943</span><span class="s2">, </span><span class="s4">3288952434</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">1770890872</span><span class="s2">, </span><span class="s4">1102951817</span><span class="s2">, </span><span class="s4">1957607470</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">3099996017</span><span class="s2">,  </span><span class="s4">798043451</span><span class="s2">,   </span><span class="s4">48334215</span><span class="s2">]]])</span>
        <span class="s0">for </span><span class="s1">size </span><span class="s0">in </span><span class="s2">[</span><span class="s0">None</span><span class="s2">, (</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)]:</span>
            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">12345</span><span class="s2">))</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">([[-</span><span class="s4">1</span><span class="s2">], [</span><span class="s4">0</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">]],</span>
                                <span class="s2">[</span><span class="s4">2</span><span class="s2">**</span><span class="s4">32 </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">32</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">32 </span><span class="s2">+ </span><span class="s4">1</span><span class="s2">],</span>
                                <span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">desired </span><span class="s0">if </span><span class="s1">size </span><span class="s0">is not None else </span><span class="s1">desired</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_int64_uint64_broadcast_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s1">configs </span><span class="s2">= {</span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">: ((</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">65</span><span class="s2">), (-</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">62</span><span class="s2">), (</span><span class="s4">10</span><span class="s2">, </span><span class="s4">9</span><span class="s2">), (</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">)),</span>
                   <span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">: ((</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">64</span><span class="s2">), (-(</span><span class="s4">2</span><span class="s2">**</span><span class="s4">64</span><span class="s2">), </span><span class="s4">2</span><span class="s2">**</span><span class="s4">62</span><span class="s2">), (</span><span class="s4">10</span><span class="s2">, </span><span class="s4">9</span><span class="s2">), (</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">),</span>
                              <span class="s2">(-</span><span class="s4">2</span><span class="s2">**</span><span class="s4">63</span><span class="s2">-</span><span class="s4">1</span><span class="s2">, -</span><span class="s4">2</span><span class="s2">**</span><span class="s4">63</span><span class="s2">-</span><span class="s4">1</span><span class="s2">))}</span>
        <span class="s0">for </span><span class="s1">dtype </span><span class="s0">in </span><span class="s1">configs</span><span class="s2">:</span>
            <span class="s0">for </span><span class="s1">config </span><span class="s0">in </span><span class="s1">configs</span><span class="s2">[</span><span class="s1">dtype</span><span class="s2">]:</span>
                <span class="s1">low</span><span class="s2">, </span><span class="s1">high </span><span class="s2">= </span><span class="s1">config</span>
                <span class="s1">high </span><span class="s2">= </span><span class="s1">high </span><span class="s2">- </span><span class="s1">endpoint</span>
                <span class="s1">low_a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s1">low</span><span class="s2">]*</span><span class="s4">10</span><span class="s2">])</span>
                <span class="s1">high_a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s1">high</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
                <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">, </span><span class="s1">low</span><span class="s2">, </span><span class="s1">high</span><span class="s2">,</span>
                              <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
                <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">, </span><span class="s1">low_a</span><span class="s2">, </span><span class="s1">high</span><span class="s2">,</span>
                              <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
                <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">, </span><span class="s1">low</span><span class="s2">, </span><span class="s1">high_a</span><span class="s2">,</span>
                              <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
                <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">, </span><span class="s1">low_a</span><span class="s2">, </span><span class="s1">high_a</span><span class="s2">,</span>
                              <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>

                <span class="s1">low_o </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s1">low</span><span class="s2">]*</span><span class="s4">10</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
                <span class="s1">high_o </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s1">high</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
                <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">, </span><span class="s1">low_o</span><span class="s2">, </span><span class="s1">high</span><span class="s2">,</span>
                              <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
                <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">, </span><span class="s1">low</span><span class="s2">, </span><span class="s1">high_o</span><span class="s2">,</span>
                              <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
                <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">, </span><span class="s1">low_o</span><span class="s2">, </span><span class="s1">high_o</span><span class="s2">,</span>
                              <span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_int64_uint64_corner_case</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s5"># When stored in Numpy arrays, `lbnd` is casted</span>
        <span class="s5"># as np.int64, and `ubnd` is casted as np.uint64.</span>
        <span class="s5"># Checking whether `lbnd` &gt;= `ubnd` used to be</span>
        <span class="s5"># done solely via direct comparison, which is incorrect</span>
        <span class="s5"># because when Numpy tries to compare both numbers,</span>
        <span class="s5"># it casts both to np.float64 because there is</span>
        <span class="s5"># no integer superset of np.int64 and np.uint64. However,</span>
        <span class="s5"># `ubnd` is too large to be represented in np.float64,</span>
        <span class="s5"># causing it be round down to np.iinfo(np.int64).max,</span>
        <span class="s5"># leading to a ValueError because `lbnd` now equals</span>
        <span class="s5"># the new `ubnd`.</span>

        <span class="s1">dt </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span>
        <span class="s1">tgt </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">lbnd </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max</span><span class="s2">)</span>
        <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1 </span><span class="s2">- </span><span class="s1">endpoint</span><span class="s2">)</span>

        <span class="s5"># None of these function calls should</span>
        <span class="s5"># generate a ValueError now.</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">tgt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_respect_dtype_singleton</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s5"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>
            <span class="s1">dt </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">dt</span>

            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">dt</span><span class="s2">)</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s2">(</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">int</span><span class="s2">):</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s5"># gh-7284: Ensure that we get Python data types</span>
            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s1">lbnd</span><span class="s2">, </span><span class="s1">ubnd</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">assert not </span><span class="s1">hasattr</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">, </span><span class="s3">'dtype'</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">type</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">), </span><span class="s1">dt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_respect_dtype_array</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s5"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">lbnd </span><span class="s2">= </span><span class="s4">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">min</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s4">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">max </span><span class="s2">+ </span><span class="s4">1</span>
            <span class="s1">ubnd </span><span class="s2">= </span><span class="s1">ubnd </span><span class="s2">- </span><span class="s4">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>
            <span class="s1">dt </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">dt</span>

            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([</span><span class="s1">lbnd</span><span class="s2">], [</span><span class="s1">ubnd</span><span class="s2">], </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">([</span><span class="s1">lbnd</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">, [</span><span class="s1">ubnd</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                                <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">dt</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_zero_size</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s5"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self</span><span class="s2">.</span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">sample </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">), </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">sample</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">== (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">sample</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">dt</span>
            <span class="s0">assert </span><span class="s1">self</span><span class="s2">.</span><span class="s1">rfunc</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, -</span><span class="s4">10</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">,</span>
                              <span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">).</span><span class="s1">shape </span><span class="s2">== (</span><span class="s4">0</span><span class="s2">,)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">,</span>
                         <span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">))</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, -</span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>

    <span class="s0">def </span><span class="s1">test_error_byteorder</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">other_byteord_dt </span><span class="s2">= </span><span class="s3">'&lt;i4' </span><span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">== </span><span class="s3">'big' </span><span class="s0">else </span><span class="s3">'&gt;i4'</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">200</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">other_byteord_dt</span><span class="s2">)</span>

    <span class="s5"># chi2max is the maximum acceptable chi-squared value.</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">slow</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">'sample_size,high,dtype,chi2max'</span><span class="s2">,</span>
        <span class="s2">[(</span><span class="s4">5000000</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">, </span><span class="s4">125.0</span><span class="s2">),          </span><span class="s5"># p-value ~4.6e-25</span>
         <span class="s2">(</span><span class="s4">5000000</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint8</span><span class="s2">, </span><span class="s4">150.0</span><span class="s2">),         </span><span class="s5"># p-value ~7.7e-30</span>
         <span class="s2">(</span><span class="s4">10000000</span><span class="s2">, </span><span class="s4">2500</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int16</span><span class="s2">, </span><span class="s4">3300.0</span><span class="s2">),    </span><span class="s5"># p-value ~3.0e-25</span>
         <span class="s2">(</span><span class="s4">50000000</span><span class="s2">, </span><span class="s4">5000</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint16</span><span class="s2">, </span><span class="s4">6500.0</span><span class="s2">),   </span><span class="s5"># p-value ~3.5e-25</span>
        <span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_integers_small_dtype_chisquared</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">sample_size</span><span class="s2">, </span><span class="s1">high</span><span class="s2">,</span>
                                             <span class="s1">dtype</span><span class="s2">, </span><span class="s1">chi2max</span><span class="s2">):</span>
        <span class="s5"># Regression test for gh-14774.</span>
        <span class="s1">samples </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s1">high</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">sample_size</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>

        <span class="s1">values</span><span class="s2">, </span><span class="s1">counts </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">unique</span><span class="s2">(</span><span class="s1">samples</span><span class="s2">, </span><span class="s1">return_counts</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">sample_size </span><span class="s2">/ </span><span class="s1">high</span>
        <span class="s1">chi2 </span><span class="s2">= ((</span><span class="s1">counts </span><span class="s2">- </span><span class="s1">expected</span><span class="s2">)**</span><span class="s4">2 </span><span class="s2">/ </span><span class="s1">expected</span><span class="s2">).</span><span class="s1">sum</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">chi2 </span><span class="s2">&lt; </span><span class="s1">chi2max</span>


<span class="s0">class </span><span class="s1">TestRandomDist</span><span class="s2">:</span>
    <span class="s5"># Make sure the random distribution returns the correct value for a</span>
    <span class="s5"># given seed</span>

    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s4">1234567890</span>

    <span class="s0">def </span><span class="s1">test_integers</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(-</span><span class="s4">99</span><span class="s2">, </span><span class="s4">99</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s4">80</span><span class="s2">, -</span><span class="s4">56</span><span class="s2">], [</span><span class="s4">41</span><span class="s2">, </span><span class="s4">37</span><span class="s2">], [-</span><span class="s4">83</span><span class="s2">, -</span><span class="s4">16</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_integers_masked</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Test masked rejection sampling algorithm to generate array of</span>
        <span class="s5"># uint32 in an interval.</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">99</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">9</span><span class="s2">, </span><span class="s4">21</span><span class="s2">], [</span><span class="s4">70</span><span class="s2">, </span><span class="s4">68</span><span class="s2">], [</span><span class="s4">8</span><span class="s2">, </span><span class="s4">41</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_integers_closed</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(-</span><span class="s4">99</span><span class="s2">, </span><span class="s4">99</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">), </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s4">80</span><span class="s2">, -</span><span class="s4">56</span><span class="s2">], [ </span><span class="s4">41</span><span class="s2">, </span><span class="s4">38</span><span class="s2">], [-</span><span class="s4">83</span><span class="s2">, -</span><span class="s4">15</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_integers_max_int</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Tests whether integers with closed=True can generate the</span>
        <span class="s5"># maximum allowed Python int that can be converted</span>
        <span class="s5"># into a C long. Previous implementations of this</span>
        <span class="s5"># method have thrown an OverflowError when attempting</span>
        <span class="s5"># to generate this integer.</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span><span class="s2">,</span>
                                 <span class="s1">endpoint</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'l'</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.096999199829214</span><span class="s2">, </span><span class="s4">0.707517457682192</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.084364834598269</span><span class="s2">, </span><span class="s4">0.767731206553125</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.665069021359413</span><span class="s2">, </span><span class="s4">0.715487190596693</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">()</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.0969992 </span><span class="s2">, </span><span class="s4">0.70751746</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.08436483</span><span class="s2">, </span><span class="s4">0.76773121</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.66506902</span><span class="s2">, </span><span class="s4">0.71548719</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">7</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_random_float_scalar</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s4">0.0969992</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">7</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">'dtype, uint_view_type'</span><span class="s2">,</span>
                             <span class="s2">[(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">),</span>
                              <span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float64</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">)])</span>
    <span class="s0">def </span><span class="s1">test_random_distribution_of_lsb</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">uint_view_type</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">(</span><span class="s4">100000</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s1">num_ones_in_lsb </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">count_nonzero</span><span class="s2">(</span><span class="s1">sample</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">uint_view_type</span><span class="s2">) &amp; </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s5"># The probability of a 1 in the least significant bit is 0.25.</span>
        <span class="s5"># With a sample size of 100000, the probability that num_ones_in_lsb</span>
        <span class="s5"># is outside the following range is less than 5e-11.</span>
        <span class="s0">assert </span><span class="s4">24100 </span><span class="s2">&lt; </span><span class="s1">num_ones_in_lsb </span><span class="s2">&lt; </span><span class="s4">25900</span>

    <span class="s0">def </span><span class="s1">test_random_unsupported_type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">'int32'</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_replace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_replace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">])</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_noreplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">shuffle</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_noreplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">])</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_noninteger</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s3">'a'</span><span class="s2">, </span><span class="s3">'b'</span><span class="s2">, </span><span class="s3">'c'</span><span class="s2">, </span><span class="s3">'d'</span><span class="s2">], </span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s3">'a'</span><span class="s2">, </span><span class="s3">'a'</span><span class="s2">, </span><span class="s3">'c'</span><span class="s2">, </span><span class="s3">'c'</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_multidimensional_default_axis</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">], [</span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">]], </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_multidimensional_custom_axis</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">], [</span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">]], </span><span class="s4">1</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">], [</span><span class="s4">2</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">], [</span><span class="s4">6</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, </span><span class="s4">3.</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [], </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">], </span><span class="s4">3</span><span class="s2">,</span>
                      <span class="s1">p</span><span class="s2">=[[</span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">], [</span><span class="s4">0.25</span><span class="s2">, </span><span class="s4">0.25</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">1.1</span><span class="s2">, -</span><span class="s4">0.1</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s4">4</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s5"># gh-13087</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], -</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], (-</span><span class="s4">1</span><span class="s2">,), </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], (-</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">), </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">sample</span><span class="s2">, [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s4">2</span><span class="s2">,</span>
                      <span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_choice_return_shape</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">]</span>
        <span class="s5"># Check scalar</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s0">None</span><span class="s2">], </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) </span><span class="s0">is None</span><span class="s2">)</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">arr</span><span class="s2">[</span><span class="s4">0</span><span class="s2">] = </span><span class="s1">a</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">arr</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">) </span><span class="s0">is </span><span class="s1">a</span><span class="s2">)</span>

        <span class="s5"># Check 0-d array</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">tuple</span><span class="s2">()</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s0">not </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isscalar</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)))</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s0">None</span><span class="s2">], </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">ndim </span><span class="s2">== </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">)</span>
        <span class="s1">arr</span><span class="s2">[</span><span class="s4">0</span><span class="s2">] = </span><span class="s1">a</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">arr</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">item</span><span class="s2">() </span><span class="s0">is </span><span class="s1">a</span><span class="s2">)</span>

        <span class="s5"># Check multi dimensional array</span>
        <span class="s1">s </span><span class="s2">= (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">0.4</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">]</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">6</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">6</span><span class="s2">), </span><span class="s1">s</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">s</span><span class="s2">)</span>

        <span class="s5"># Check zero-size</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, -</span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">0</span><span class="s2">).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">0</span><span class="s2">,)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">0</span><span class="s2">,))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s3">'a'</span><span class="s2">, </span><span class="s3">'b'</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">,</span>
                     <span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">, [], </span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nan_probabilities</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">42</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">]</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">, </span><span class="s1">a</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_p_non_contiguous</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">(</span><span class="s4">10</span><span class="s2">) / </span><span class="s4">5</span>
        <span class="s1">p</span><span class="s2">[</span><span class="s4">1</span><span class="s2">::</span><span class="s4">2</span><span class="s2">] = </span><span class="s4">3.0</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">non_contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">[::</span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ascontiguousarray</span><span class="s2">(</span><span class="s1">p</span><span class="s2">[::</span><span class="s4">2</span><span class="s2">]))</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">non_contig</span><span class="s2">, </span><span class="s1">contig</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_return_type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh 9867</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">(</span><span class="s4">4</span><span class="s2">) / </span><span class="s4">4.</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s1">p</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span>

    <span class="s0">def </span><span class="s1">test_choice_large_sample</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">choice_hash </span><span class="s2">= </span><span class="s3">'4266599d12bfcfb815213303432341c06b4349f5455890446578877bb322e222'</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">(</span><span class="s4">10000</span><span class="s2">, </span><span class="s4">5000</span><span class="s2">, </span><span class="s1">replace</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">!= </span><span class="s3">'little'</span><span class="s2">:</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">byteswap</span><span class="s2">()</span>
        <span class="s1">res </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">)).</span><span class="s1">hexdigest</span><span class="s2">()</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">choice_hash </span><span class="s2">== </span><span class="s1">res</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_choice_array_size_empty_tuple</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=()), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s4">1</span><span class="s2">),</span>
                           <span class="s1">strict</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]], </span><span class="s1">size</span><span class="s2">=()), [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">]], </span><span class="s1">size</span><span class="s2">=()), [</span><span class="s4">1</span><span class="s2">], </span><span class="s1">strict</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">choice</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">]], </span><span class="s1">size</span><span class="s2">=(), </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">), [</span><span class="s4">1</span><span class="s2">],</span>
                           <span class="s1">strict</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_bytes</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">bytes</span><span class="s2">(</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s6">b'</span><span class="s0">\x86\xf0\xd4\x18\xe1\x81\t</span><span class="s6">8%</span><span class="s0">\xdd</span><span class="s6">'</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Test lists, arrays (of various dtypes), and multidimensional versions</span>
        <span class="s5"># of both, c-contiguous or not:</span>
        <span class="s0">for </span><span class="s1">conv </span><span class="s0">in </span><span class="s2">[</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([]),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x</span><span class="s2">,</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">complex64</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">(</span><span class="s1">x</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">object</span><span class="s2">),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: [(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([[</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">] </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">]),</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">vstack</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">x</span><span class="s2">]).</span><span class="s1">T</span><span class="s2">,</span>
                     <span class="s5"># gh-11442</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: (</span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                                           <span class="s2">[(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">int</span><span class="s2">), (</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">int</span><span class="s2">)])</span>
                                <span class="s2">.</span><span class="s1">view</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">recarray</span><span class="s2">)),</span>
                     <span class="s5"># gh-4270</span>
                     <span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">asarray</span><span class="s2">([(</span><span class="s1">i</span><span class="s2">, </span><span class="s1">i</span><span class="s2">) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x</span><span class="s2">],</span>
                                          <span class="s2">[(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">object</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">,)),</span>
                                           <span class="s2">(</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">,))])]:</span>
            <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
            <span class="s1">alist </span><span class="s2">= </span><span class="s1">conv</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">alist</span><span class="s2">)</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">alist</span>
            <span class="s1">desired </span><span class="s2">= </span><span class="s1">conv</span><span class="s2">([</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">7</span><span class="s2">])</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_custom_axis</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">16</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">((</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">))</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">0</span><span class="s2">,  </span><span class="s4">3</span><span class="s2">,  </span><span class="s4">1</span><span class="s2">,  </span><span class="s4">2</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">4</span><span class="s2">,  </span><span class="s4">7</span><span class="s2">,  </span><span class="s4">5</span><span class="s2">,  </span><span class="s4">6</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">8</span><span class="s2">, </span><span class="s4">11</span><span class="s2">,  </span><span class="s4">9</span><span class="s2">, </span><span class="s4">10</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">12</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">14</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">16</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">((</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">))</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=-</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_custom_axis_empty</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([]).</span><span class="s1">reshape</span><span class="s2">((</span><span class="s4">0</span><span class="s2">, </span><span class="s4">6</span><span class="s2">))</span>
        <span class="s0">for </span><span class="s1">axis </span><span class="s0">in </span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">):</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([]).</span><span class="s1">reshape</span><span class="s2">((</span><span class="s4">0</span><span class="s2">, </span><span class="s4">6</span><span class="s2">))</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s1">axis</span><span class="s2">)</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_axis_nonsquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">y1 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">20</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">y2 </span><span class="s2">= </span><span class="s1">y1</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">y1</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">y2</span><span class="s2">.</span><span class="s1">T</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">y1</span><span class="s2">, </span><span class="s1">y2</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_masked</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-3263</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ma</span><span class="s2">.</span><span class="s1">masked_values</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">reshape</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s4">20</span><span class="s2">), (</span><span class="s4">5</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)) % </span><span class="s4">3 </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">b </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ma</span><span class="s2">.</span><span class="s1">masked_values</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">20</span><span class="s2">) % </span><span class="s4">3 </span><span class="s2">- </span><span class="s4">1</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">a_orig </span><span class="s2">= </span><span class="s1">a</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">b_orig </span><span class="s2">= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s4">50</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">a</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span>
                <span class="s1">sorted</span><span class="s2">(</span><span class="s1">a</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">a</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]), </span><span class="s1">sorted</span><span class="s2">(</span><span class="s1">a_orig</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">a_orig</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]))</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">b</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span>
                <span class="s1">sorted</span><span class="s2">(</span><span class="s1">b</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">b</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]), </span><span class="s1">sorted</span><span class="s2">(</span><span class="s1">b_orig</span><span class="s2">.</span><span class="s1">data</span><span class="s2">[~</span><span class="s1">b_orig</span><span class="s2">.</span><span class="s1">mask</span><span class="s2">]))</span>

    <span class="s0">def </span><span class="s1">test_shuffle_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">AxisError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">9</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">AxisError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">, </span><span class="s1">slice</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s0">None</span><span class="s2">))</span>
        <span class="s1">arr </span><span class="s2">= [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">], [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]]</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">NotImplementedError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span>

        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">)</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">AxisError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_not_writeable</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s4">5</span><span class="s2">)</span>
        <span class="s1">a</span><span class="s2">.</span><span class="s1">flags</span><span class="s2">.</span><span class="s1">writeable </span><span class="s2">= </span><span class="s0">False</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">'read-only'</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">(</span><span class="s1">a</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_permutation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">alist </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">(</span><span class="s1">alist</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= [</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">7</span><span class="s2">]</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">arr_2d </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">atleast_2d</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]).</span><span class="s1">T</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">(</span><span class="s1">arr_2d</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">atleast_2d</span><span class="s2">(</span><span class="s1">desired</span><span class="s2">).</span><span class="s1">T</span><span class="s2">)</span>

        <span class="s1">bad_x_str </span><span class="s2">= </span><span class="s3">&quot;abcd&quot;</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">AxisError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">, </span><span class="s1">bad_x_str</span><span class="s2">)</span>

        <span class="s1">bad_x_float </span><span class="s2">= </span><span class="s4">1.2</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">AxisError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">, </span><span class="s1">bad_x_float</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">integer_val </span><span class="s2">= </span><span class="s4">10</span>
        <span class="s1">desired </span><span class="s2">= [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">6</span><span class="s2">]</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">(</span><span class="s1">integer_val</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_permutation_custom_axis</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">16</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">((</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">0</span><span class="s2">,  </span><span class="s4">3</span><span class="s2">,  </span><span class="s4">1</span><span class="s2">,  </span><span class="s4">2</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">4</span><span class="s2">,  </span><span class="s4">7</span><span class="s2">,  </span><span class="s4">5</span><span class="s2">,  </span><span class="s4">6</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">8</span><span class="s2">, </span><span class="s4">11</span><span class="s2">,  </span><span class="s4">9</span><span class="s2">, </span><span class="s4">10</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">12</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">14</span><span class="s2">]])</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=-</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_permutation_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">AxisError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">arr </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">9</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">AxisError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permutation</span><span class="s2">, </span><span class="s1">arr</span><span class="s2">, </span><span class="s1">slice</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s0">None</span><span class="s2">))</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s1">int</span><span class="s2">, </span><span class="s1">object</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;axis, expected&quot;</span><span class="s2">,</span>
                             <span class="s2">[(</span><span class="s0">None</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">11</span><span class="s2">],</span>
                                               <span class="s2">[</span><span class="s4">8</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">,  </span><span class="s4">1</span><span class="s2">,  </span><span class="s4">6</span><span class="s2">]])),</span>
                              <span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">6</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">11</span><span class="s2">],</span>
                                            <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">3</span><span class="s2">,  </span><span class="s4">4</span><span class="s2">,  </span><span class="s4">5</span><span class="s2">]])),</span>
                              <span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">,  </span><span class="s4">4</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">],</span>
                                            <span class="s2">[</span><span class="s4">11</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">7</span><span class="s2">]]))])</span>
    <span class="s0">def </span><span class="s1">test_permuted</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">12</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">6</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">permuted</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s1">axis</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">12</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">6</span><span class="s2">).</span><span class="s1">astype</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s1">y </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permuted</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s1">axis</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">y</span><span class="s2">.</span><span class="s1">dtype </span><span class="s2">== </span><span class="s1">dtype</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">y</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_permuted_with_strides</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">x0 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s4">22</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">11</span><span class="s2">)</span>
        <span class="s1">x1 </span><span class="s2">= </span><span class="s1">x0</span><span class="s2">.</span><span class="s1">copy</span><span class="s2">()</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">x0</span><span class="s2">[:, ::</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">y </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permuted</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">14</span><span class="s2">, </span><span class="s4">20</span><span class="s2">, </span><span class="s4">11</span><span class="s2">, </span><span class="s4">17</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">y</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s1">x1</span><span class="s2">[:, ::</span><span class="s4">3</span><span class="s2">] = </span><span class="s1">expected</span>
        <span class="s5"># Verify that the original x0 was modified in-place as expected.</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">x1</span><span class="s2">, </span><span class="s1">x0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_permuted_empty</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">y </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">permuted</span><span class="s2">([])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">y</span><span class="s2">, [])</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">'outshape'</span><span class="s2">, [(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">), </span><span class="s4">5</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_permuted_out_with_wrong_shape</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">outshape</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">out </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s1">outshape</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">a</span><span class="s2">.</span><span class="s1">dtype</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">'same shape'</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">permuted</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_permuted_out_with_wrong_type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">out </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">5</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">5</span><span class="s2">))</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">'Cannot cast'</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">permuted</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_permuted_not_writeable</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">))</span>
        <span class="s1">x</span><span class="s2">.</span><span class="s1">flags</span><span class="s2">.</span><span class="s1">writeable </span><span class="s2">= </span><span class="s0">False</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">'read-only'</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">permuted</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">axis</span><span class="s2">=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">x</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_beta</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span><span class="s2">(</span><span class="s4">.1</span><span class="s2">, </span><span class="s4">.9</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
            <span class="s2">[[</span><span class="s4">1.083029353267698e-10</span><span class="s2">, </span><span class="s4">2.449965303168024e-11</span><span class="s2">],</span>
             <span class="s2">[</span><span class="s4">2.397085162969853e-02</span><span class="s2">, </span><span class="s4">3.590779671820755e-08</span><span class="s2">],</span>
             <span class="s2">[</span><span class="s4">2.830254190078299e-04</span><span class="s2">, </span><span class="s4">1.744709918330393e-01</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s4">100.123</span><span class="s2">, </span><span class="s4">.456</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">42</span><span class="s2">, </span><span class="s4">41</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">42</span><span class="s2">, </span><span class="s4">48</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">44</span><span class="s2">, </span><span class="s4">50</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s4">100.123</span><span class="s2">, </span><span class="s4">.456</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s4">42</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">(</span><span class="s4">50</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">32.9850547060149</span><span class="s2">, </span><span class="s4">39.0219480493301</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">56.2006134779419</span><span class="s2">, </span><span class="s4">57.3474165711485</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">55.4243733880198</span><span class="s2">, </span><span class="s4">55.4209797925213</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">51.72840233779265162</span><span class="s2">, </span><span class="s4">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">0.5439892869558927</span><span class="s2">,  </span><span class="s4">0.45601071304410745</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">0.5588917345860708</span><span class="s2">,  </span><span class="s4">0.4411082654139292 </span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">0.5632074165063435</span><span class="s2">,  </span><span class="s4">0.43679258349365657</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">0.54862581112627</span><span class="s2">,    </span><span class="s4">0.45137418887373015</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">0.49961831357047226</span><span class="s2">, </span><span class="s4">0.5003816864295278 </span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">0.52374806183482</span><span class="s2">,    </span><span class="s4">0.47625193816517997</span><span class="s2">]]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>
        <span class="s1">bad_alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">5.4e-01</span><span class="s2">, -</span><span class="s4">1.0e-16</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">bad_alpha</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">51.72840233779265162</span><span class="s2">, </span><span class="s4">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_size</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-3173</span>
        <span class="s1">p </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">51.72840233779265162</span><span class="s2">, </span><span class="s4">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">p</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))).</span><span class="s1">shape</span><span class="s2">, (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">float</span><span class="s2">(</span><span class="s4">1</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_bad_alpha</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># gh-2089</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">5.4e-01</span><span class="s2">, -</span><span class="s4">1.0e-16</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">alpha</span><span class="s2">)</span>

        <span class="s5"># gh-15876</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, [[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, [[</span><span class="s4">5</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, [[[</span><span class="s4">5</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">]], [[</span><span class="s4">1</span><span class="s2">], [</span><span class="s4">5</span><span class="s2">]]])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]]))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_alpha_non_contiguous</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">51.72840233779265162</span><span class="s2">, -</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">39.74494232180943953</span><span class="s2">])</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">a</span><span class="s2">[::</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">non_contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">contig </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ascontiguousarray</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">),</span>
                                  <span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">non_contig</span><span class="s2">, </span><span class="s1">contig</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_small_alpha</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">eps </span><span class="s2">= </span><span class="s4">1.0e-9  </span><span class="s5"># 1.0e-10 -&gt; runtime x 10; 1e-11 -&gt; runtime x 200, etc.</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">eps </span><span class="s2">* </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.</span><span class="s2">, </span><span class="s4">1.0e-3</span><span class="s2">])</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span>
            <span class="s2">[[</span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">],</span>
             <span class="s2">[</span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">]],</span>
            <span class="s2">[[</span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">],</span>
             <span class="s2">[</span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">]],</span>
            <span class="s2">[[</span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">],</span>
             <span class="s2">[</span><span class="s4">1.</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">]]</span>
        <span class="s2">])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">slow</span>
    <span class="s0">def </span><span class="s1">test_dirichlet_moderately_small_alpha</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Use alpha.max() &lt; 0.1 to trigger stick breaking code path</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.02</span><span class="s2">, </span><span class="s4">0.04</span><span class="s2">, </span><span class="s4">0.03</span><span class="s2">])</span>
        <span class="s1">exact_mean </span><span class="s2">= </span><span class="s1">alpha </span><span class="s2">/ </span><span class="s1">alpha</span><span class="s2">.</span><span class="s1">sum</span><span class="s2">()</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">sample </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">20000000</span><span class="s2">)</span>
        <span class="s1">sample_mean </span><span class="s2">= </span><span class="s1">sample</span><span class="s2">.</span><span class="s1">mean</span><span class="s2">(</span><span class="s1">axis</span><span class="s2">=</span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">sample_mean</span><span class="s2">, </span><span class="s1">exact_mean</span><span class="s2">, </span><span class="s1">rtol</span><span class="s2">=</span><span class="s4">1e-3</span><span class="s2">)</span>

    <span class="s5"># This set of parameters includes inputs with alpha.max() &gt;= 0.1 and</span>
    <span class="s5"># alpha.max() &lt; 0.1 to exercise both generation methods within the</span>
    <span class="s5"># dirichlet code.</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">'alpha'</span><span class="s2">,</span>
        <span class="s2">[[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">8</span><span class="s2">],</span>
         <span class="s2">[</span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
         <span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
         <span class="s2">[</span><span class="s4">0.01</span><span class="s2">, </span><span class="s4">0.03</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.005</span><span class="s2">],</span>
         <span class="s2">[</span><span class="s4">1e-5</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
         <span class="s2">[</span><span class="s4">0.002</span><span class="s2">, </span><span class="s4">0.015</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0.04</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
         <span class="s2">[</span><span class="s4">0.0</span><span class="s2">],</span>
         <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_dirichlet_multiple_zeros_in_alpha</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">alpha</span><span class="s2">):</span>
        <span class="s1">alpha </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">)</span>
        <span class="s1">y </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">dirichlet</span><span class="s2">(</span><span class="s1">alpha</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">y</span><span class="s2">[</span><span class="s1">alpha </span><span class="s2">== </span><span class="s4">0</span><span class="s2">], </span><span class="s4">0.0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s4">1.1234</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.098845481066258</span><span class="s2">, </span><span class="s4">1.560752510746964</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.075730916041636</span><span class="s2">, </span><span class="s4">1.769098974710777</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.488602544592235</span><span class="s2">, </span><span class="s4">2.49684815275751 </span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_exponential_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">f</span><span class="s2">(</span><span class="s4">12</span><span class="s2">, </span><span class="s4">77</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.461720027077085</span><span class="s2">, </span><span class="s4">1.100441958872451</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.100337455217484</span><span class="s2">, </span><span class="s4">0.91421736740018 </span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.500811891303113</span><span class="s2">, </span><span class="s4">0.826802454552058</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">5.03850858902096</span><span class="s2">,  </span><span class="s4">7.9228656732049 </span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">18.73983605132985</span><span class="s2">, </span><span class="s4">19.57961681699238</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">18.17897755150825</span><span class="s2">, </span><span class="s4">18.17653912505234</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_geometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">(</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">11</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">12</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">11</span><span class="s2">, </span><span class="s4">17</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_geometric_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s4">1.1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, [</span><span class="s4">1.1</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, -</span><span class="s4">0.1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, [-</span><span class="s4">0.1</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">):</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">4.688397515056245</span><span class="s2">, -</span><span class="s4">0.289514845417841</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">4.981176042584683</span><span class="s2">, -</span><span class="s4">0.633224272589149</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">0.055915275687488</span><span class="s2">, -</span><span class="s4">0.333962478257953</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">10.1</span><span class="s2">, </span><span class="s4">5.5</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">9</span><span class="s2">, </span><span class="s4">9</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">9</span><span class="s2">, </span><span class="s4">9</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">10</span><span class="s2">, </span><span class="s4">9</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s5"># Test nbad = 0</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">15</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">12</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">12</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s5"># Test ngood = 0</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s4">3.156353949272393</span><span class="s2">,  </span><span class="s4">1.195863024830054</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">3.435458081645966</span><span class="s2">,  </span><span class="s4">1.656882398925444</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">0.924824032467446</span><span class="s2">,  </span><span class="s4">1.251116432209336</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logistic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s4">4.338584631510999</span><span class="s2">,  </span><span class="s4">1.890171436749954</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">4.64547787337966 </span><span class="s2">,  </span><span class="s4">2.514545562919217</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">1.495389489198666</span><span class="s2">,  </span><span class="s4">1.967827627577474</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">0.0268252166335</span><span class="s2">, </span><span class="s4">13.9534486483053</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">0.1204014788936</span><span class="s2">,  </span><span class="s4">2.2422077497792</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">4.2484199496128</span><span class="s2">, </span><span class="s4">12.0093343977523</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">13</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">sigma</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logseries</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">p</span><span class="s2">=</span><span class="s4">.923456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">14</span><span class="s2">, </span><span class="s4">17</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">18</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logseries_zero</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s0">assert </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s4">0</span><span class="s2">) == </span><span class="s4">1</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;value&quot;</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nextafter</span><span class="s2">(</span><span class="s4">0.</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">), </span><span class="s4">1.</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s4">5.</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_logseries_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">value</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s3">&quot;ignore&quot;</span><span class="s2">):</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
                <span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">value</span><span class="s2">)</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
                <span class="s5"># contiguous path:</span>
                <span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s1">value</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">))</span>
            <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
                <span class="s5"># non-contiguous path:</span>
                <span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s1">value</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)[::</span><span class="s4">2</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_multinomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">20</span><span class="s2">, [</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6.</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">7</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">6</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">skipif</span><span class="s2">(</span><span class="s1">IS_WASM</span><span class="s2">, </span><span class="s1">reason</span><span class="s2">=</span><span class="s3">&quot;fp errors don't work in wasm&quot;</span><span class="s2">)</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;method&quot;</span><span class="s2">, [</span><span class="s3">&quot;svd&quot;</span><span class="s2">, </span><span class="s3">&quot;eigh&quot;</span><span class="s2">, </span><span class="s3">&quot;cholesky&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_multivariate_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">method</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">mean </span><span class="s2">= (</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">cov </span><span class="s2">= [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">], [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]]</span>
        <span class="s1">size </span><span class="s2">= (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">, </span><span class="s1">size</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[-</span><span class="s4">1.747478062846581</span><span class="s2">,  </span><span class="s4">11.25613495182354  </span><span class="s2">],</span>
                             <span class="s2">[-</span><span class="s4">0.9967333370066214</span><span class="s2">, </span><span class="s4">10.342002097029821 </span><span class="s2">]],</span>
                            <span class="s2">[[ </span><span class="s4">0.7850019631242964</span><span class="s2">, </span><span class="s4">11.181113712443013 </span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">0.8901349653255224</span><span class="s2">,  </span><span class="s4">8.873825399642492 </span><span class="s2">]],</span>
                            <span class="s2">[[ </span><span class="s4">0.7130260107430003</span><span class="s2">,  </span><span class="s4">9.551628690083056 </span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">0.7127098726541128</span><span class="s2">, </span><span class="s4">11.991709234143173 </span><span class="s2">]]])</span>

        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

        <span class="s5"># Check for default size, was raising deprecation warning</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.233278563284287</span><span class="s2">, </span><span class="s4">9.424140804347195</span><span class="s2">])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>
        <span class="s5"># Check that non symmetric covariance input raises exception when</span>
        <span class="s5"># check_valid='raises' if using default svd method.</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">cov </span><span class="s2">= [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]]</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                      <span class="s1">check_valid</span><span class="s2">=</span><span class="s3">'raise'</span><span class="s2">)</span>

        <span class="s5"># Check that non positive-semidefinite covariance warns with</span>
        <span class="s5"># RuntimeWarning</span>
        <span class="s1">cov </span><span class="s2">= [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]]</span>
        <span class="s1">assert_warns</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">)</span>
        <span class="s1">assert_warns</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                     <span class="s1">method</span><span class="s2">=</span><span class="s3">'eigh'</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">LinAlgError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                      <span class="s1">method</span><span class="s2">=</span><span class="s3">'cholesky'</span><span class="s2">)</span>

        <span class="s5"># and that it doesn't warn with RuntimeWarning check_valid='ignore'</span>
        <span class="s1">assert_no_warnings</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                           <span class="s1">check_valid</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">)</span>

        <span class="s5"># and that it raises with RuntimeWarning check_valid='raises'</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                      <span class="s1">check_valid</span><span class="s2">=</span><span class="s3">'raise'</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                      <span class="s1">check_valid</span><span class="s2">=</span><span class="s3">'raise'</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s3">'eigh'</span><span class="s2">)</span>

        <span class="s5"># check degenerate samples from singular covariance matrix</span>
        <span class="s1">cov </span><span class="s2">= [[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]]</span>
        <span class="s0">if </span><span class="s1">method </span><span class="s0">in </span><span class="s2">(</span><span class="s3">'svd'</span><span class="s2">, </span><span class="s3">'eigh'</span><span class="s2">):</span>
            <span class="s1">samples </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">),</span>
                                                 <span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
            <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">samples</span><span class="s2">[..., </span><span class="s4">0</span><span class="s2">], </span><span class="s1">samples</span><span class="s2">[..., </span><span class="s4">1</span><span class="s2">],</span>
                                      <span class="s1">decimal</span><span class="s2">=</span><span class="s4">6</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">LinAlgError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                          <span class="s1">method</span><span class="s2">=</span><span class="s3">'cholesky'</span><span class="s2">)</span>

        <span class="s1">cov </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">], [</span><span class="s4">0.1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings</span><span class="s2">() </span><span class="s0">as </span><span class="s1">sup</span><span class="s2">:</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">, </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
            <span class="s1">w </span><span class="s2">= </span><span class="s1">sup</span><span class="s2">.</span><span class="s1">record</span><span class="s2">(</span><span class="s1">RuntimeWarning</span><span class="s2">)</span>
            <span class="s0">assert </span><span class="s1">len</span><span class="s2">(</span><span class="s1">w</span><span class="s2">) == </span><span class="s4">0</span>

        <span class="s1">mu </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">cov </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">eye</span><span class="s2">(</span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">,</span>
                      <span class="s1">check_valid</span><span class="s2">=</span><span class="s3">'other'</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">,</span>
                      <span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)), </span><span class="s1">cov</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">,</span>
                      <span class="s1">mu</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">,</span>
                      <span class="s1">mu</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">eye</span><span class="s2">(</span><span class="s4">3</span><span class="s2">))</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">'mean, cov'</span><span class="s2">, [([</span><span class="s4">0</span><span class="s2">], [[</span><span class="s4">1</span><span class="s2">+</span><span class="s4">1j</span><span class="s2">]]), ([</span><span class="s4">0j</span><span class="s2">], [[</span><span class="s4">1</span><span class="s2">]])])</span>
    <span class="s0">def </span><span class="s1">test_multivariate_normal_disallow_complex</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;must not be complex&quot;</span><span class="s2">):</span>
            <span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;method&quot;</span><span class="s2">, [</span><span class="s3">&quot;svd&quot;</span><span class="s2">, </span><span class="s3">&quot;eigh&quot;</span><span class="s2">, </span><span class="s3">&quot;cholesky&quot;</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_multivariate_normal_basic_stats</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">method</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">n_s </span><span class="s2">= </span><span class="s4">1000</span>
        <span class="s1">mean </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">cov </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">]])</span>
        <span class="s1">s </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multivariate_normal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">cov</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s1">n_s</span><span class="s2">,), </span><span class="s1">method</span><span class="s2">=</span><span class="s1">method</span><span class="s2">)</span>
        <span class="s1">s_center </span><span class="s2">= </span><span class="s1">s </span><span class="s2">- </span><span class="s1">mean</span>
        <span class="s1">cov_emp </span><span class="s2">= (</span><span class="s1">s_center</span><span class="s2">.</span><span class="s1">T </span><span class="s2">@ </span><span class="s1">s_center</span><span class="s2">) / (</span><span class="s1">n_s </span><span class="s2">- </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s5"># these are pretty loose and are only designed to detect major errors</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">abs</span><span class="s2">(</span><span class="s1">s_center</span><span class="s2">.</span><span class="s1">mean</span><span class="s2">(-</span><span class="s4">2</span><span class="s2">)) &lt; </span><span class="s4">0.1</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">abs</span><span class="s2">(</span><span class="s1">cov_emp </span><span class="s2">- </span><span class="s1">cov</span><span class="s2">) &lt; </span><span class="s4">0.2</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">=</span><span class="s4">100</span><span class="s2">, </span><span class="s1">p</span><span class="s2">=</span><span class="s4">.12345</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">543</span><span class="s2">, </span><span class="s4">727</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">775</span><span class="s2">, </span><span class="s4">760</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">600</span><span class="s2">, </span><span class="s4">674</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">):</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">, </span><span class="s4">100</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">, </span><span class="s4">100</span><span class="s2">,</span>
                          <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial_p0_exception</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Verify that p=0 raises an exception.</span>
        <span class="s0">with </span><span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial_invalid_p_n_combination</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Verify that values of p and n that would result in an overflow</span>
        <span class="s5"># or infinite loop raise an exception.</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">):</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">62</span><span class="s2">, </span><span class="s4">0.1</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">, [</span><span class="s4">2</span><span class="s2">**</span><span class="s4">62</span><span class="s2">], [</span><span class="s4">0.1</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">1.70561552362133</span><span class="s2">, </span><span class="s4">15.97378184942111</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">13.71483425173724</span><span class="s2">, </span><span class="s4">20.17859633310629</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">11.3615477156643 </span><span class="s2">,  </span><span class="s4">3.67891108738029</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s4">.5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s4">.2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">9.41427665607629e-04</span><span class="s2">, </span><span class="s4">1.70473157518850e-04</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.14554372041263e+00</span><span class="s2">, </span><span class="s4">1.38187755933435e-03</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.90659181905387e+00</span><span class="s2">, </span><span class="s4">1.21772577941822e+00</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.82947954590419</span><span class="s2">, </span><span class="s4">1.80139670767078</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">6.58720057417794</span><span class="s2">, </span><span class="s4">7.00491463609814</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">6.31101879073157</span><span class="s2">, </span><span class="s4">6.30982307753005</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s4">1</span><span class="s2">,</span>
                                     <span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.060310671139  </span><span class="s2">, </span><span class="s4">0.23866058175939</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.86860246709073</span><span class="s2">, </span><span class="s4">0.2668510459738 </span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.23375780078364</span><span class="s2">, </span><span class="s4">1.88922102885943</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">2.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s4">3.618412914693162</span><span class="s2">,  </span><span class="s4">2.635726692647081</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">2.116923463013243</span><span class="s2">,  </span><span class="s4">0.807460983059643</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">1.446547137248593</span><span class="s2">,  </span><span class="s4">2.485684213886024</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_pareto</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.0394926776069018e+00</span><span class="s2">, </span><span class="s4">7.7142534343505773e+04</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">7.2640150889064703e-01</span><span class="s2">, </span><span class="s4">3.4650454783825594e+05</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">4.5852344481994740e+04</span><span class="s2">, </span><span class="s4">6.5851383009539105e+07</span><span class="s2">]])</span>
        <span class="s5"># For some reason on 32-bit x86 Ubuntu 12.10 the [1, 0] entry in this</span>
        <span class="s5"># matrix differs by 24 nulps. Discussion:</span>
        <span class="s5">#   https://mail.python.org/pipermail/numpy-discussion/2012-September/063801.html</span>
        <span class="s5"># Consensus is that this is probably some gcc quirk that affects</span>
        <span class="s5"># rounding but not in any important way, so we just use a looser</span>
        <span class="s5"># tolerance on this test:</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">testing</span><span class="s2">.</span><span class="s1">assert_array_almost_equal_nulp</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">nulp</span><span class="s2">=</span><span class="s4">30</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">(</span><span class="s1">lam</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson_exceptions</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">lambig </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">iinfo</span><span class="s2">(</span><span class="s3">'int64'</span><span class="s2">).</span><span class="s1">max</span>
        <span class="s1">lamneg </span><span class="s2">= -</span><span class="s4">1</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">lamneg</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, [</span><span class="s1">lamneg</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">lambig</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, [</span><span class="s1">lambig</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">):</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s4">10</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_power</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">.123456789</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">1.977857368842754e-09</span><span class="s2">, </span><span class="s4">9.806792196620341e-02</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2.482442984543471e-10</span><span class="s2">, </span><span class="s4">1.527108843266079e-01</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">8.188283434244285e-02</span><span class="s2">, </span><span class="s4">3.950547209346948e-01</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">4.19494429102666</span><span class="s2">, </span><span class="s4">16.66920198906598</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3.67184544902662</span><span class="s2">, </span><span class="s4">17.74695521962917</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">16.27935397855501</span><span class="s2">, </span><span class="s4">21.08355560691792</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_cauchy</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_cauchy</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s4">1.489437778266206</span><span class="s2">, -</span><span class="s4">3.275389641569784</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">0.560102864910406</span><span class="s2">, -</span><span class="s4">0.680780916282552</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">1.314912905226277</span><span class="s2">,  </span><span class="s4">0.295852965660225</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_exponential</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">), </span><span class="s1">method</span><span class="s2">=</span><span class="s3">'inv'</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.102031839440643</span><span class="s2">, </span><span class="s4">1.229350298474972</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.088137284693098</span><span class="s2">, </span><span class="s4">1.459859985522667</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.093830802293668</span><span class="s2">, </span><span class="s4">1.256977002164613</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_expoential_type_error</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_exponential</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.62970724056362</span><span class="s2">, </span><span class="s4">1.22379851271008</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3.899412530884  </span><span class="s2">, </span><span class="s4">4.12479964250139</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3.74994102464584</span><span class="s2">, </span><span class="s4">3.74929307690815</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gammma_scalar_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s4">3</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s4">2.9242148399353027</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">6</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.62971</span><span class="s2">, </span><span class="s4">1.2238 </span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3.89941</span><span class="s2">, </span><span class="s4">4.1248 </span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">3.74994</span><span class="s2">, </span><span class="s4">3.74929</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gammma_float_out</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s4">10.0</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">10.14987</span><span class="s2">,  </span><span class="s4">7.87012</span><span class="s2">],</span>
                             <span class="s2">[ </span><span class="s4">9.46284</span><span class="s2">, </span><span class="s4">12.56832</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">13.82495</span><span class="s2">,  </span><span class="s4">7.81533</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s4">10.0</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">float32</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">5</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_unknown_type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">, </span><span class="s4">1.</span><span class="s2">,</span>
                      <span class="s1">dtype</span><span class="s2">=</span><span class="s3">'int32'</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_out_size_mismatch</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">out </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">, </span><span class="s4">10.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">20</span><span class="s2">,</span>
                      <span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">, </span><span class="s4">10.0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">1</span><span class="s2">),</span>
                      <span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s4">0</span><span class="s2">), </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s4">1.870934851846581</span><span class="s2">,  </span><span class="s4">1.25613495182354 </span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">1.120190126006621</span><span class="s2">,  </span><span class="s4">0.342002097029821</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">0.661545174124296</span><span class="s2">,  </span><span class="s4">1.181113712443012</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal_unsupported_type</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">(</span><span class="s1">df</span><span class="s2">=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[-</span><span class="s4">1.484666193042647</span><span class="s2">,  </span><span class="s4">0.30597891831161 </span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">1.056684299648085</span><span class="s2">, -</span><span class="s4">0.407312602088507</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">0.130704414281157</span><span class="s2">, -</span><span class="s4">2.038053410490321</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_triangular</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">=</span><span class="s4">5.12</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">=</span><span class="s4">10.23</span><span class="s2">, </span><span class="s1">right</span><span class="s2">=</span><span class="s4">20.34</span><span class="s2">,</span>
                                   <span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">7.86664070590917</span><span class="s2">, </span><span class="s4">13.6313848513185 </span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">7.68152445215983</span><span class="s2">, </span><span class="s4">14.36169131136546</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">13.16105603911429</span><span class="s2">, </span><span class="s4">13.72341621856971</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_uniform</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">high</span><span class="s2">=</span><span class="s4">10.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">2.13306255040998 </span><span class="s2">, </span><span class="s4">7.816987531021207</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2.015436610109887</span><span class="s2">, </span><span class="s4">8.377577533009589</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">7.421792588856135</span><span class="s2">, </span><span class="s4">7.891185744455209</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_uniform_range_bounds</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">fmin </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">finfo</span><span class="s2">(</span><span class="s3">'float'</span><span class="s2">).</span><span class="s1">min</span>
        <span class="s1">fmax </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">finfo</span><span class="s2">(</span><span class="s3">'float'</span><span class="s2">).</span><span class="s1">max</span>

        <span class="s1">func </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">, </span><span class="s4">0</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, </span><span class="s1">fmin</span><span class="s2">, </span><span class="s1">fmax</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, [-</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">], [</span><span class="s4">0</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">OverflowError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, [</span><span class="s4">0</span><span class="s2">], [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">inf</span><span class="s2">])</span>

        <span class="s5"># (fmax / 1e17) - fmin is within range, so this should not throw</span>
        <span class="s5"># account for i386 extended precision DBL_MAX / 1e17 + DBL_MAX &gt;</span>
        <span class="s5"># DBL_MAX by increasing fmin a bit</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nextafter</span><span class="s2">(</span><span class="s1">fmin</span><span class="s2">, </span><span class="s4">1</span><span class="s2">), </span><span class="s1">high</span><span class="s2">=</span><span class="s1">fmax </span><span class="s2">/ </span><span class="s4">1e17</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_uniform_zero_range</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">func </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">)</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s4">1.5</span><span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">func</span><span class="s2">([</span><span class="s4">0.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">], [</span><span class="s4">0.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, [</span><span class="s4">0.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">])</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">func</span><span class="s2">([[</span><span class="s4">2145.12</span><span class="s2">], [</span><span class="s4">2145.12</span><span class="s2">]], [</span><span class="s4">2145.12</span><span class="s2">, </span><span class="s4">2145.12</span><span class="s2">])</span>
        <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">result</span><span class="s2">, </span><span class="s4">2145.12 </span><span class="s2">+ </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)))</span>

    <span class="s0">def </span><span class="s1">test_uniform_neg_range</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">func </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">,  [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">func</span><span class="s2">,  [[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">],[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]], </span><span class="s4">2</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_scalar_exception_propagation</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Tests that exceptions are correctly propagated in distributions</span>
        <span class="s5"># when called with objects that throw exceptions when converted to</span>
        <span class="s5"># scalars.</span>
        <span class="s5">#</span>
        <span class="s5"># Regression test for gh: 8865</span>

        <span class="s0">class </span><span class="s1">ThrowingFloat</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ndarray</span><span class="s2">):</span>
            <span class="s0">def </span><span class="s1">__float__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_float </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s4">1.0</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">ThrowingFloat</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">, </span><span class="s1">throwing_float</span><span class="s2">,</span>
                      <span class="s1">throwing_float</span><span class="s2">)</span>

        <span class="s0">class </span><span class="s1">ThrowingInteger</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ndarray</span><span class="s2">):</span>
            <span class="s0">def </span><span class="s1">__int__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_int </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span><span class="s4">1</span><span class="s2">).</span><span class="s1">view</span><span class="s2">(</span><span class="s1">ThrowingInteger</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">throwing_int</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s4">1.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[ </span><span class="s4">1.107972248690106</span><span class="s2">,  </span><span class="s4">2.841536476232361</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">1.832602376042457</span><span class="s2">,  </span><span class="s4">1.945511926976032</span><span class="s2">],</span>
                            <span class="s2">[-</span><span class="s4">0.260147475776542</span><span class="s2">,  </span><span class="s4">2.058047492231698</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises_small</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># check infinite loop, gh-4720</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">r </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s4">0.</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s4">1.1e-8</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">10</span><span class="s2">**</span><span class="s4">6</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isfinite</span><span class="s2">(</span><span class="s1">r</span><span class="s2">).</span><span class="s1">all</span><span class="s2">())</span>

    <span class="s0">def </span><span class="s1">test_vonmises_nan</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">r </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">=</span><span class="s4">0.</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">r</span><span class="s2">))</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;kappa&quot;</span><span class="s2">, [</span><span class="s4">1e4</span><span class="s2">, </span><span class="s4">1e15</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_vonmises_large_kappa</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">rs </span><span class="s2">= </span><span class="s1">RandomState</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">)</span>
        <span class="s1">state </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state</span>

        <span class="s1">random_state_vals </span><span class="s2">= </span><span class="s1">rs</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state </span><span class="s2">= </span><span class="s1">state</span>
        <span class="s1">gen_vals </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s4">0</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">10</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">kappa </span><span class="s2">&lt; </span><span class="s4">1e6</span><span class="s2">:</span>
            <span class="s1">assert_allclose</span><span class="s2">(</span><span class="s1">random_state_vals</span><span class="s2">, </span><span class="s1">gen_vals</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">random_state_vals </span><span class="s2">!= </span><span class="s1">gen_vals</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;mu&quot;</span><span class="s2">, [-</span><span class="s4">7.</span><span class="s2">, -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">, -</span><span class="s4">3.1</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">, </span><span class="s4">3.2</span><span class="s2">])</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;kappa&quot;</span><span class="s2">, [</span><span class="s4">1e-9</span><span class="s2">, </span><span class="s4">1e-6</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1e3</span><span class="s2">, </span><span class="s4">1e15</span><span class="s2">])</span>
    <span class="s0">def </span><span class="s1">test_vonmises_large_kappa_range</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">r </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">, </span><span class="s4">50</span><span class="s2">)</span>
        <span class="s1">assert_</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">r </span><span class="s2">&gt; -</span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">) </span><span class="s0">and </span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">r </span><span class="s2">&lt;= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">pi</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_wald</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">=</span><span class="s4">1.54</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.26871721804551</span><span class="s2">, </span><span class="s4">3.2233942732115 </span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2.20328374987066</span><span class="s2">, </span><span class="s4">2.40958405189353</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2.07093587449261</span><span class="s2">, </span><span class="s4">0.73073890064369</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0.138613914769468</span><span class="s2">, </span><span class="s4">1.306463419753191</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">0.111623365934763</span><span class="s2">, </span><span class="s4">1.446570494646721</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">1.257145775276011</span><span class="s2">, </span><span class="s4">1.914247725027957</span><span class="s2">]])</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">15</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull_0</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">0</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">12</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">(</span><span class="s4">12</span><span class="s2">))</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">, </span><span class="s1">a</span><span class="s2">=-</span><span class="s4">0.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_zipf</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span><span class="s2">(</span><span class="s1">a</span><span class="s2">=</span><span class="s4">1.23</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[  </span><span class="s4">1</span><span class="s2">,   </span><span class="s4">1</span><span class="s2">],</span>
                            <span class="s2">[ </span><span class="s4">10</span><span class="s2">, </span><span class="s4">867</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">354</span><span class="s2">,   </span><span class="s4">2</span><span class="s2">]])</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestBroadcast</span><span class="s2">:</span>
    <span class="s5"># tests that functions that broadcast behave</span>
    <span class="s5"># correctly when presented with non-scalar arguments</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seed </span><span class="s2">= </span><span class="s4">123456789</span>

    <span class="s0">def </span><span class="s1">test_uniform</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">low </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">high </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">uniform </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.16693771389729</span><span class="s2">, </span><span class="s4">0.19635129550675</span><span class="s2">, </span><span class="s4">0.75563050964095</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">high</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">(</span><span class="s1">low</span><span class="s2">, </span><span class="s1">high </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([-</span><span class="s4">0.38736406738527</span><span class="s2">,  </span><span class="s4">0.79594375042255</span><span class="s2">,  </span><span class="s4">0.0197076236097</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">normal </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">normal</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">normal</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_beta</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">b </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_b </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.18719338682602</span><span class="s2">, </span><span class="s4">0.73234824491364</span><span class="s2">, </span><span class="s4">0.17928615186455</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">beta </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">beta</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">b</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">b</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">beta</span><span class="s2">, </span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_b</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_exponential</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.67245993212806</span><span class="s2">, </span><span class="s4">0.21380495318094</span><span class="s2">, </span><span class="s4">0.7177848928629</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">shape </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_shape </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.67245993212806</span><span class="s2">, </span><span class="s4">0.21380495318094</span><span class="s2">, </span><span class="s4">0.7177848928629</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">std_gamma </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">std_gamma</span><span class="s2">(</span><span class="s1">shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">std_gamma</span><span class="s2">, </span><span class="s1">bad_shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gamma</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">shape </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_shape </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.34491986425611</span><span class="s2">, </span><span class="s4">0.42760990636187</span><span class="s2">, </span><span class="s4">1.4355697857258</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">gamma </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">bad_shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">gamma </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">bad_shape</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gamma</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dfnum </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">dfden </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_dfnum </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_dfden </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.07765056244107</span><span class="s2">, </span><span class="s4">7.72951397913186</span><span class="s2">, </span><span class="s4">0.05786093891763</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">f </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">f</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">f</span><span class="s2">(</span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">bad_dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">f </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">f</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">dfnum </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">dfden </span><span class="s2">= [</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">nonc </span><span class="s2">= [</span><span class="s4">4</span><span class="s2">]</span>
        <span class="s1">bad_dfnum </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">bad_dfden </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_nonc </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2.02434240411421</span><span class="s2">, </span><span class="s4">12.91838601070124</span><span class="s2">, </span><span class="s4">1.24395160354629</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">nonc_f </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">np</span><span class="s2">.</span><span class="s1">all</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">isnan</span><span class="s2">(</span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">] * </span><span class="s4">3</span><span class="s2">)))</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">nonc_f </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">nonc_f </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_f</span><span class="s2">(</span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">bad_dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">bad_dfden</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_f</span><span class="s2">, </span><span class="s1">dfnum</span><span class="s2">, </span><span class="s1">dfden</span><span class="s2">, </span><span class="s1">bad_nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_small_df</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.04714867120827</span><span class="s2">, </span><span class="s4">0.1239390327694</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s4">0.9</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.05573640064251</span><span class="s2">, </span><span class="s4">1.47220224353539</span><span class="s2">, </span><span class="s4">2.9469379318589</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">nonc </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_nonc </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.07710766249436</span><span class="s2">, </span><span class="s4">5.27829115110304</span><span class="s2">, </span><span class="s4">0.630732147399</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">nonc_chi </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_chi</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nonc</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nonc</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">nonc_chi </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">nonc_chi</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">bad_df</span><span class="s2">, </span><span class="s1">nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">nonc_chi</span><span class="s2">, </span><span class="s1">df</span><span class="s2">, </span><span class="s1">bad_nonc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_df </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([-</span><span class="s4">1.39498829447098</span><span class="s2">, -</span><span class="s4">1.23058658835223</span><span class="s2">, </span><span class="s4">0.17207021065983</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">(</span><span class="s1">df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">, </span><span class="s1">bad_df </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mu </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">kappa </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_kappa </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2.25935584988528</span><span class="s2">, </span><span class="s4">2.23326261461399</span><span class="s2">, -</span><span class="s4">2.84152146503326</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">kappa</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">mu </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_kappa</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">kappa </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">mu</span><span class="s2">, </span><span class="s1">bad_kappa </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_pareto</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.95905052946317</span><span class="s2">, </span><span class="s4">0.2383810889437 </span><span class="s2">, </span><span class="s4">1.04988745750013</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_weibull</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.67245993212806</span><span class="s2">, </span><span class="s4">0.21380495318094</span><span class="s2">, </span><span class="s4">0.7177848928629</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_power</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.48954864361052</span><span class="s2">, </span><span class="s4">0.19249412888486</span><span class="s2">, </span><span class="s4">0.51216834058807</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_laplace</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([-</span><span class="s4">1.09698732625119</span><span class="s2">, -</span><span class="s4">0.93470271947368</span><span class="s2">, </span><span class="s4">0.71592671378202</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">laplace </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">laplace </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">laplace</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">laplace</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.70020068231762</span><span class="s2">, </span><span class="s4">1.52054354273631</span><span class="s2">, -</span><span class="s4">0.34293267607081</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">gumbel </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">gumbel </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">gumbel</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logistic</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">loc </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([-</span><span class="s4">1.607487640433</span><span class="s2">, -</span><span class="s4">1.40925686003678</span><span class="s2">, </span><span class="s4">1.12887112820397</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">, </span><span class="s1">loc </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">(</span><span class="s1">loc</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">, </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">(</span><span class="s4">1.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">), </span><span class="s4">1.0</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">sigma </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_sigma </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.67884390500697</span><span class="s2">, </span><span class="s4">2.21653186290321</span><span class="s2">, </span><span class="s4">1.01990310084276</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">lognormal </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_sigma</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">sigma </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">bad_sigma </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s4">1.1597068009872629</span><span class="s2">,</span>
             <span class="s4">0.6539188836253857</span><span class="s2">,</span>
             <span class="s4">1.1981526554349398</span><span class="s2">]</span>
        <span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">(</span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_wald</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">mean </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">scale </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_mean </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">bad_scale </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.38052407392905</span><span class="s2">, </span><span class="s4">0.50701641508592</span><span class="s2">, </span><span class="s4">0.484935249864</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">, </span><span class="s1">bad_mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">scale</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">, </span><span class="s1">mean </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_scale</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">(</span><span class="s1">mean</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">, </span><span class="s1">bad_mean</span><span class="s2">, </span><span class="s1">scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">, </span><span class="s1">mean</span><span class="s2">, </span><span class="s1">bad_scale </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_triangular</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">left </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">right </span><span class="s2">= [</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">mode </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_left_one </span><span class="s2">= [</span><span class="s4">3</span><span class="s2">]</span>
        <span class="s1">bad_mode_one </span><span class="s2">= [</span><span class="s4">4</span><span class="s2">]</span>
        <span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two </span><span class="s2">= </span><span class="s1">right </span><span class="s2">* </span><span class="s4">2</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1.57781954604754</span><span class="s2">, </span><span class="s4">1.62665986867957</span><span class="s2">, </span><span class="s4">2.30090130831326</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">triangular </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_mode_one</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_mode_two</span><span class="s2">,</span>
                      <span class="s1">right</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">triangular </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">mode </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one</span><span class="s2">, </span><span class="s1">mode </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left</span><span class="s2">, </span><span class="s1">bad_mode_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">right</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">,</span>
                      <span class="s1">right</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">triangular </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">triangular</span><span class="s2">(</span><span class="s1">left</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">, </span><span class="s1">decimal</span><span class="s2">=</span><span class="s4">14</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_one</span><span class="s2">, </span><span class="s1">mode</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">left</span><span class="s2">, </span><span class="s1">bad_mode_one</span><span class="s2">, </span><span class="s1">right </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s1">bad_left_two</span><span class="s2">, </span><span class="s1">bad_mode_two</span><span class="s2">,</span>
                      <span class="s1">right </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">, </span><span class="s4">0.</span><span class="s2">, </span><span class="s4">20.</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">, </span><span class="s4">25.</span><span class="s2">, </span><span class="s4">20.</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">triangular</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">, </span><span class="s4">10.</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">n </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">bad_n </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s4">1.5</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">binom </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">binom</span><span class="s2">(</span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">bad_n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_p_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_p_two</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">bad_n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">n </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">bad_n </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s4">1.5</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">neg_binom </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">neg_binom</span><span class="s2">(</span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">bad_n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">p</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_p_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_p_two</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">neg_binom </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">neg_binom</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">bad_n</span><span class="s2">, </span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">neg_binom</span><span class="s2">, </span><span class="s1">n</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_poisson</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>

        <span class="s1">lam </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_lam_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">max_lam </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">_poisson_lam_max</span>
        <span class="s1">bad_lam_two </span><span class="s2">= [</span><span class="s1">max_lam </span><span class="s2">* </span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">poisson </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">poisson</span><span class="s2">(</span><span class="s1">lam </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">bad_lam_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">bad_lam_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_zipf</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">a </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_a </span><span class="s2">= [</span><span class="s4">0</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">zipf </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">zipf</span><span class="s2">(</span><span class="s1">a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, </span><span class="s1">bad_a </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">np</span><span class="s2">.</span><span class="s1">errstate</span><span class="s2">(</span><span class="s1">invalid</span><span class="s2">=</span><span class="s3">'ignore'</span><span class="s2">):</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">)</span>
            <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">zipf</span><span class="s2">, [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">])</span>

    <span class="s0">def </span><span class="s1">test_geometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [</span><span class="s4">1.5</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">geometric </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">geometric</span><span class="s2">(</span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">ngood </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">nbad </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">nsample </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_ngood </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_nbad </span><span class="s2">= [-</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_nsample_one </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">bad_nsample_two </span><span class="s2">= [</span><span class="s4">4</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s1">ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">bad_ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nbad</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">ngood </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_two</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">(</span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">bad_ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">bad_nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">nsample</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nsample_one</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad </span><span class="s2">* </span><span class="s4">3</span><span class="s2">, </span><span class="s1">bad_nsample_two</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">hypergeom </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">hypergeom</span><span class="s2">(</span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">bad_ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">bad_nbad</span><span class="s2">, </span><span class="s1">nsample </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s1">ngood</span><span class="s2">, </span><span class="s1">nbad</span><span class="s2">, </span><span class="s1">bad_nsample_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">20</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">, </span><span class="s4">20</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, -</span><span class="s4">1</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">25</span><span class="s2">)</span>

        <span class="s5"># ValueError for arguments that are too big.</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">30</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">20</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">999</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">31</span><span class="s2">, </span><span class="s4">50</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">hypergeom</span><span class="s2">, </span><span class="s4">999</span><span class="s2">, [</span><span class="s4">2</span><span class="s2">**</span><span class="s4">29</span><span class="s2">, </span><span class="s4">2</span><span class="s2">**</span><span class="s4">30</span><span class="s2">], </span><span class="s4">1000</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_logseries</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">p </span><span class="s2">= [</span><span class="s4">0.5</span><span class="s2">]</span>
        <span class="s1">bad_p_one </span><span class="s2">= [</span><span class="s4">2</span><span class="s2">]</span>
        <span class="s1">bad_p_two </span><span class="s2">= [-</span><span class="s4">1</span><span class="s2">]</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">])</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">logseries </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">logseries</span><span class="s2">(</span><span class="s1">p </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logseries</span><span class="s2">, </span><span class="s1">bad_p_one </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">logseries</span><span class="s2">, </span><span class="s1">bad_p_two </span><span class="s2">* </span><span class="s4">3</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_multinomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">([</span><span class="s4">5</span><span class="s2">, </span><span class="s4">20</span><span class="s2">], [</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6.</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">))</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">7</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">]]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">([</span><span class="s4">5</span><span class="s2">, </span><span class="s4">20</span><span class="s2">], [</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6.</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">([</span><span class="s4">5</span><span class="s2">, </span><span class="s4">20</span><span class="s2">], [[</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6.</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                            <span class="s2">[</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">([[</span><span class="s4">5</span><span class="s2">], [</span><span class="s4">20</span><span class="s2">]], [[</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6.</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">] * </span><span class="s4">2</span><span class="s2">)</span>
        <span class="s1">desired </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">0</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">]],</span>
                            <span class="s2">[[</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s2">],</span>
                             <span class="s2">[</span><span class="s4">7</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">4</span><span class="s2">]]], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">)</span>
        <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">actual</span><span class="s2">, </span><span class="s1">desired</span><span class="s2">)</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;n&quot;</span><span class="s2">, [</span><span class="s4">10</span><span class="s2">,</span>
                                   <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s2">]),</span>
                                   <span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([[[</span><span class="s4">10</span><span class="s2">]], [[</span><span class="s4">10</span><span class="s2">]]])</span>
                                   <span class="s2">]</span>
                             <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_multinomial_pval_broadcast</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">n</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">pvals </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">4</span><span class="s2">] * </span><span class="s4">4</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">)</span>
        <span class="s1">n_shape </span><span class="s2">= </span><span class="s1">tuple</span><span class="s2">() </span><span class="s0">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">int</span><span class="s2">) </span><span class="s0">else </span><span class="s1">n</span><span class="s2">.</span><span class="s1">shape</span>
        <span class="s1">expected_shape </span><span class="s2">= </span><span class="s1">n_shape </span><span class="s2">+ (</span><span class="s4">4</span><span class="s2">,)</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">== </span><span class="s1">expected_shape</span>
        <span class="s1">pvals </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">vstack</span><span class="s2">([</span><span class="s1">pvals</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">)</span>
        <span class="s1">expected_shape </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">broadcast_shapes</span><span class="s2">(</span><span class="s1">n_shape</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">[:-</span><span class="s4">1</span><span class="s2">]) + (</span><span class="s4">4</span><span class="s2">,)</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">== </span><span class="s1">expected_shape</span>

        <span class="s1">pvals </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">vstack</span><span class="s2">([[</span><span class="s1">pvals</span><span class="s2">], [</span><span class="s1">pvals</span><span class="s2">]])</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">)</span>
        <span class="s1">expected_shape </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">broadcast_shapes</span><span class="s2">(</span><span class="s1">n_shape</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">[:-</span><span class="s4">1</span><span class="s2">])</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">== </span><span class="s1">expected_shape </span><span class="s2">+ (</span><span class="s4">4</span><span class="s2">,)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">) + </span><span class="s1">expected_shape</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">== (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s2">) + </span><span class="s1">expected_shape </span><span class="s2">+ (</span><span class="s4">4</span><span class="s2">,)</span>

        <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
            <span class="s5"># Ensure that size is not broadcast</span>
            <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s1">n</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">1</span><span class="s2">,) * </span><span class="s4">6</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_pvals_broadcast</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">pvals </span><span class="s2">= [[</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">, [</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">4</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">]</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">pvals</span><span class="s2">)</span>
        <span class="s1">assert_raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_empty_outputs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">random </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seed</span><span class="s2">))</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">10</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">6</span><span class="s2">), </span><span class="s3">&quot;i8&quot;</span><span class="s2">), [</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">== (</span><span class="s4">10</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">6</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">12</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">10</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)))</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">== (</span><span class="s4">10</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">10</span><span class="s2">)</span>
        <span class="s1">actual </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">7</span><span class="s2">), </span><span class="s3">&quot;i8&quot;</span><span class="s2">),</span>
                                    <span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)))</span>
        <span class="s0">assert </span><span class="s1">actual</span><span class="s2">.</span><span class="s1">shape </span><span class="s2">== (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">4</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">skipif</span><span class="s2">(</span><span class="s1">IS_WASM</span><span class="s2">, </span><span class="s1">reason</span><span class="s2">=</span><span class="s3">&quot;can't start thread&quot;</span><span class="s2">)</span>
<span class="s0">class </span><span class="s1">TestThread</span><span class="s2">:</span>
    <span class="s5"># make sure each state produces the same sequence even in threads</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">seeds </span><span class="s2">= </span><span class="s1">range</span><span class="s2">(</span><span class="s4">4</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">function</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">):</span>
        <span class="s0">from </span><span class="s1">threading </span><span class="s0">import </span><span class="s1">Thread</span>

        <span class="s1">out1 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">),) + </span><span class="s1">sz</span><span class="s2">)</span>
        <span class="s1">out2 </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s1">len</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">),) + </span><span class="s1">sz</span><span class="s2">)</span>

        <span class="s5"># threaded generation</span>
        <span class="s1">t </span><span class="s2">= [</span><span class="s1">Thread</span><span class="s2">(</span><span class="s1">target</span><span class="s2">=</span><span class="s1">function</span><span class="s2">, </span><span class="s1">args</span><span class="s2">=(</span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">s</span><span class="s2">)), </span><span class="s1">o</span><span class="s2">))</span>
             <span class="s0">for </span><span class="s1">s</span><span class="s2">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">, </span><span class="s1">out1</span><span class="s2">)]</span>
        <span class="s2">[</span><span class="s1">x</span><span class="s2">.</span><span class="s1">start</span><span class="s2">() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t</span><span class="s2">]</span>
        <span class="s2">[</span><span class="s1">x</span><span class="s2">.</span><span class="s1">join</span><span class="s2">() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t</span><span class="s2">]</span>

        <span class="s5"># the same serial</span>
        <span class="s0">for </span><span class="s1">s</span><span class="s2">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">seeds</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">):</span>
            <span class="s1">function</span><span class="s2">(</span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">s</span><span class="s2">)), </span><span class="s1">o</span><span class="s2">)</span>

        <span class="s5"># these platforms change x87 fpu precision mode in threads</span>
        <span class="s0">if </span><span class="s1">np</span><span class="s2">.</span><span class="s1">intp</span><span class="s2">().</span><span class="s1">dtype</span><span class="s2">.</span><span class="s1">itemsize </span><span class="s2">== </span><span class="s4">4 </span><span class="s0">and </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">platform </span><span class="s2">== </span><span class="s3">&quot;win32&quot;</span><span class="s2">:</span>
            <span class="s1">assert_array_almost_equal</span><span class="s2">(</span><span class="s1">out1</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">assert_array_equal</span><span class="s2">(</span><span class="s1">out1</span><span class="s2">, </span><span class="s1">out2</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_normal</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=</span><span class="s4">10000</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s4">10000</span><span class="s2">,))</span>

    <span class="s0">def </span><span class="s1">test_exp</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">((</span><span class="s4">100</span><span class="s2">, </span><span class="s4">1000</span><span class="s2">)))</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">1000</span><span class="s2">))</span>

    <span class="s0">def </span><span class="s1">test_multinomial</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">def </span><span class="s1">gen_random</span><span class="s2">(</span><span class="s1">state</span><span class="s2">, </span><span class="s1">out</span><span class="s2">):</span>
            <span class="s1">out</span><span class="s2">[...] = </span><span class="s1">state</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">(</span><span class="s4">10</span><span class="s2">, [</span><span class="s4">1 </span><span class="s2">/ </span><span class="s4">6.</span><span class="s2">] * </span><span class="s4">6</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">10000</span><span class="s2">)</span>

        <span class="s1">self</span><span class="s2">.</span><span class="s1">check_function</span><span class="s2">(</span><span class="s1">gen_random</span><span class="s2">, </span><span class="s1">sz</span><span class="s2">=(</span><span class="s4">10000</span><span class="s2">, </span><span class="s4">6</span><span class="s2">))</span>


<span class="s5"># See Issue #4263</span>
<span class="s0">class </span><span class="s1">TestSingleEltArrayInput</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">setup_method</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argOne </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">2</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">3</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">argThree </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">4</span><span class="s2">])</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape </span><span class="s2">= (</span><span class="s4">1</span><span class="s2">,)</span>

    <span class="s0">def </span><span class="s1">test_one_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= (</span><span class="s1">random</span><span class="s2">.</span><span class="s1">exponential</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_t</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">pareto</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">weibull</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">power</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">rayleigh</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">poisson</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">zipf</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">)</span>

        <span class="s1">probfuncs </span><span class="s2">= (</span><span class="s1">random</span><span class="s2">.</span><span class="s1">geometric</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logseries</span><span class="s2">)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs</span><span class="s2">:  </span><span class="s5"># p &lt; 1.0</span>
                <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.5</span><span class="s2">]))</span>

            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">)</span>

            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_two_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= (</span><span class="s1">random</span><span class="s2">.</span><span class="s1">uniform</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">beta</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">gamma</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">f</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_chisquare</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">vonmises</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">laplace</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">gumbel</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">logistic</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">lognormal</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">wald</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">)</span>

        <span class="s1">probfuncs </span><span class="s2">= (</span><span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">negative_binomial</span><span class="s2">)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs</span><span class="s2">:  </span><span class="s5"># p &lt;= 1</span>
                <span class="s1">argTwo </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0.5</span><span class="s2">])</span>

            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">argTwo </span><span class="s2">= </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">argTwo</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">argTwo</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">argTwo</span><span class="s2">[</span><span class="s4">0</span><span class="s2">])</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_integers</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
        <span class="s1">itype </span><span class="s2">= [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">bool</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint8</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int16</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint16</span><span class="s2">,</span>
                 <span class="s1">np</span><span class="s2">.</span><span class="s1">int32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint32</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">int64</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">uint64</span><span class="s2">]</span>
        <span class="s1">func </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">integers</span>
        <span class="s1">high </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">1</span><span class="s2">])</span>
        <span class="s1">low </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([</span><span class="s4">0</span><span class="s2">])</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">itype</span><span class="s2">:</span>
            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">low</span><span class="s2">, </span><span class="s1">high</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">low</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">high</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">low</span><span class="s2">, </span><span class="s1">high</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dt</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_three_arg_funcs</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">funcs </span><span class="s2">= [</span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">triangular</span><span class="s2">,</span>
                 <span class="s1">random</span><span class="s2">.</span><span class="s1">hypergeometric</span><span class="s2">]</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs</span><span class="s2">:</span>
            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>

            <span class="s1">out </span><span class="s2">= </span><span class="s1">func</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">argOne</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argTwo</span><span class="s2">[</span><span class="s4">0</span><span class="s2">], </span><span class="s1">self</span><span class="s2">.</span><span class="s1">argThree</span><span class="s2">)</span>
            <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">self</span><span class="s2">.</span><span class="s1">tgtShape</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;config&quot;</span><span class="s2">, </span><span class="s1">JUMP_TEST_DATA</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_jumped</span><span class="s2">(</span><span class="s1">config</span><span class="s2">):</span>
    <span class="s5"># Each config contains the initial seed, a number of raw steps</span>
    <span class="s5"># the sha256 hashes of the initial and the final states' keys and</span>
    <span class="s5"># the position of the initial and the final state.</span>
    <span class="s5"># These were produced using the original C implementation.</span>
    <span class="s1">seed </span><span class="s2">= </span><span class="s1">config</span><span class="s2">[</span><span class="s3">&quot;seed&quot;</span><span class="s2">]</span>
    <span class="s1">steps </span><span class="s2">= </span><span class="s1">config</span><span class="s2">[</span><span class="s3">&quot;steps&quot;</span><span class="s2">]</span>

    <span class="s1">mt19937 </span><span class="s2">= </span><span class="s1">MT19937</span><span class="s2">(</span><span class="s1">seed</span><span class="s2">)</span>
    <span class="s5"># Burn step</span>
    <span class="s1">mt19937</span><span class="s2">.</span><span class="s1">random_raw</span><span class="s2">(</span><span class="s1">steps</span><span class="s2">)</span>
    <span class="s1">key </span><span class="s2">= </span><span class="s1">mt19937</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;key&quot;</span><span class="s2">]</span>
    <span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">== </span><span class="s3">'big'</span><span class="s2">:</span>
        <span class="s1">key </span><span class="s2">= </span><span class="s1">key</span><span class="s2">.</span><span class="s1">byteswap</span><span class="s2">()</span>
    <span class="s1">sha256 </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">key</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">mt19937</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;pos&quot;</span><span class="s2">] == </span><span class="s1">config</span><span class="s2">[</span><span class="s3">&quot;initial&quot;</span><span class="s2">][</span><span class="s3">&quot;pos&quot;</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s1">sha256</span><span class="s2">.</span><span class="s1">hexdigest</span><span class="s2">() == </span><span class="s1">config</span><span class="s2">[</span><span class="s3">&quot;initial&quot;</span><span class="s2">][</span><span class="s3">&quot;key_sha256&quot;</span><span class="s2">]</span>

    <span class="s1">jumped </span><span class="s2">= </span><span class="s1">mt19937</span><span class="s2">.</span><span class="s1">jumped</span><span class="s2">()</span>
    <span class="s1">key </span><span class="s2">= </span><span class="s1">jumped</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;key&quot;</span><span class="s2">]</span>
    <span class="s0">if </span><span class="s1">sys</span><span class="s2">.</span><span class="s1">byteorder </span><span class="s2">== </span><span class="s3">'big'</span><span class="s2">:</span>
        <span class="s1">key </span><span class="s2">= </span><span class="s1">key</span><span class="s2">.</span><span class="s1">byteswap</span><span class="s2">()</span>
    <span class="s1">sha256 </span><span class="s2">= </span><span class="s1">hashlib</span><span class="s2">.</span><span class="s1">sha256</span><span class="s2">(</span><span class="s1">key</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">jumped</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[</span><span class="s3">&quot;state&quot;</span><span class="s2">][</span><span class="s3">&quot;pos&quot;</span><span class="s2">] == </span><span class="s1">config</span><span class="s2">[</span><span class="s3">&quot;jumped&quot;</span><span class="s2">][</span><span class="s3">&quot;pos&quot;</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s1">sha256</span><span class="s2">.</span><span class="s1">hexdigest</span><span class="s2">() == </span><span class="s1">config</span><span class="s2">[</span><span class="s3">&quot;jumped&quot;</span><span class="s2">][</span><span class="s3">&quot;key_sha256&quot;</span><span class="s2">]</span>


<span class="s0">def </span><span class="s1">test_broadcast_size_error</span><span class="s2">():</span>
    <span class="s1">mu </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">(</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s1">sigma </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">((</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">))</span>
    <span class="s1">size </span><span class="s2">= (</span><span class="s4">10</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)).</span><span class="s1">shape </span><span class="s2">== (</span><span class="s4">5</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>
    <span class="s5"># 1 arg</span>
    <span class="s1">shape </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">((</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">size</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">3</span><span class="s2">,))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s5"># Check out</span>
    <span class="s1">out </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">(</span><span class="s1">size</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">)</span>

    <span class="s5"># 2 arg</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">(</span><span class="s4">1</span><span class="s2">, [</span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], </span><span class="s4">0.3</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">binomial</span><span class="s2">([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">0.3</span><span class="s2">, </span><span class="s4">0.7</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">multinomial</span><span class="s2">([</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s2">], [</span><span class="s4">.3</span><span class="s2">, </span><span class="s4">.7</span><span class="s2">], </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>

    <span class="s5"># 3 arg</span>
    <span class="s1">a </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s1">b </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">))</span>
    <span class="s1">c </span><span class="s2">= </span><span class="s1">random</span><span class="s2">.</span><span class="s1">chisquare</span><span class="s2">(</span><span class="s4">5</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">))</span>
    <span class="s0">assert </span><span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">c</span><span class="s2">).</span><span class="s1">shape </span><span class="s2">== (</span><span class="s4">5</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">3</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">r&quot;Output size \(6, 5, 1, 1\) is&quot;</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">noncentral_f</span><span class="s2">(</span><span class="s1">a</span><span class="s2">, </span><span class="s1">b</span><span class="s2">, </span><span class="s1">c</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=(</span><span class="s4">6</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">))</span>


<span class="s0">def </span><span class="s1">test_broadcast_size_scalar</span><span class="s2">():</span>
    <span class="s1">mu </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">(</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s1">sigma </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">ones</span><span class="s2">(</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">3</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">normal</span><span class="s2">(</span><span class="s1">mu</span><span class="s2">, </span><span class="s1">sigma</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s4">2</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_ragged_shuffle</span><span class="s2">():</span>
    <span class="s5"># GH 18142</span>
    <span class="s1">seq </span><span class="s2">= [[], [], </span><span class="s4">1</span><span class="s2">]</span>
    <span class="s1">gen </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">0</span><span class="s2">))</span>
    <span class="s1">assert_no_warnings</span><span class="s2">(</span><span class="s1">gen</span><span class="s2">.</span><span class="s1">shuffle</span><span class="s2">, </span><span class="s1">seq</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">seq </span><span class="s2">== [</span><span class="s4">1</span><span class="s2">, [], []]</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;high&quot;</span><span class="s2">, [-</span><span class="s4">2</span><span class="s2">, [-</span><span class="s4">2</span><span class="s2">]])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;endpoint&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_single_arg_integer_exception</span><span class="s2">(</span><span class="s1">high</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">):</span>
    <span class="s5"># GH 14333</span>
    <span class="s1">gen </span><span class="s2">= </span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">MT19937</span><span class="s2">(</span><span class="s4">0</span><span class="s2">))</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">'high &lt; 0' </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s3">'high &lt;= 0'</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">gen</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(</span><span class="s1">high</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">)</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">'low &gt; high' </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s3">'low &gt;= high'</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">gen</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">(-</span><span class="s4">1</span><span class="s2">, </span><span class="s1">high</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">gen</span><span class="s2">.</span><span class="s1">integers</span><span class="s2">([-</span><span class="s4">1</span><span class="s2">], </span><span class="s1">high</span><span class="s2">, </span><span class="s1">endpoint</span><span class="s2">=</span><span class="s1">endpoint</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s3">&quot;f4&quot;</span><span class="s2">, </span><span class="s3">&quot;f8&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_c_contig_req_out</span><span class="s2">(</span><span class="s1">dtype</span><span class="s2">):</span>
    <span class="s5"># GH 18704</span>
    <span class="s1">out </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">), </span><span class="s1">order</span><span class="s2">=</span><span class="s3">&quot;F&quot;</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s1">shape </span><span class="s2">= [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">]</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;Supplied output array&quot;</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s3">&quot;Supplied output array&quot;</span><span class="s2">):</span>
        <span class="s1">random</span><span class="s2">.</span><span class="s1">standard_gamma</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;dtype&quot;</span><span class="s2">, [</span><span class="s3">&quot;f4&quot;</span><span class="s2">, </span><span class="s3">&quot;f8&quot;</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;order&quot;</span><span class="s2">, [</span><span class="s3">&quot;F&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;dist&quot;</span><span class="s2">, [</span><span class="s1">random</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">, </span><span class="s1">random</span><span class="s2">.</span><span class="s1">random</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_contig_req_out</span><span class="s2">(</span><span class="s1">dist</span><span class="s2">, </span><span class="s1">order</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">):</span>
    <span class="s5"># GH 18704</span>
    <span class="s1">out </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">empty</span><span class="s2">((</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">order</span><span class="s2">=</span><span class="s1">order</span><span class="s2">)</span>
    <span class="s1">variates </span><span class="s2">= </span><span class="s1">dist</span><span class="s2">(</span><span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">variates </span><span class="s0">is </span><span class="s1">out</span>
    <span class="s1">variates </span><span class="s2">= </span><span class="s1">dist</span><span class="s2">(</span><span class="s1">out</span><span class="s2">=</span><span class="s1">out</span><span class="s2">, </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">dtype</span><span class="s2">, </span><span class="s1">size</span><span class="s2">=</span><span class="s1">out</span><span class="s2">.</span><span class="s1">shape</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">variates </span><span class="s0">is </span><span class="s1">out</span>


<span class="s0">def </span><span class="s1">test_generator_ctor_old_style_pickle</span><span class="s2">():</span>
    <span class="s1">rg </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">PCG64DXSM</span><span class="s2">(</span><span class="s4">0</span><span class="s2">))</span>
    <span class="s1">rg</span><span class="s2">.</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s4">1</span><span class="s2">)</span>
    <span class="s5"># Directly call reduce which is used in pickling</span>
    <span class="s1">ctor</span><span class="s2">, (</span><span class="s1">bit_gen</span><span class="s2">, ), </span><span class="s1">_ </span><span class="s2">= </span><span class="s1">rg</span><span class="s2">.</span><span class="s1">__reduce__</span><span class="s2">()</span>
    <span class="s5"># Simulate unpickling an old pickle that only has the name</span>
    <span class="s0">assert </span><span class="s1">bit_gen</span><span class="s2">.</span><span class="s1">__class__</span><span class="s2">.</span><span class="s1">__name__ </span><span class="s2">== </span><span class="s3">&quot;PCG64DXSM&quot;</span>
    <span class="s1">print</span><span class="s2">(</span><span class="s1">ctor</span><span class="s2">)</span>
    <span class="s1">b </span><span class="s2">= </span><span class="s1">ctor</span><span class="s2">(*(</span><span class="s3">&quot;PCG64DXSM&quot;</span><span class="s2">,))</span>
    <span class="s1">print</span><span class="s2">(</span><span class="s1">b</span><span class="s2">)</span>
    <span class="s1">b</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state </span><span class="s2">= </span><span class="s1">bit_gen</span><span class="s2">.</span><span class="s1">state</span>
    <span class="s1">state_b </span><span class="s2">= </span><span class="s1">b</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state</span>
    <span class="s0">assert </span><span class="s1">bit_gen</span><span class="s2">.</span><span class="s1">state </span><span class="s2">== </span><span class="s1">state_b</span>


<span class="s0">def </span><span class="s1">test_pickle_preserves_seed_sequence</span><span class="s2">():</span>
    <span class="s5"># GH 26234</span>
    <span class="s5"># Add explicit test that bit generators preserve seed sequences</span>
    <span class="s0">import </span><span class="s1">pickle</span>

    <span class="s1">rg </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">Generator</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">PCG64DXSM</span><span class="s2">(</span><span class="s4">20240411</span><span class="s2">))</span>
    <span class="s1">ss </span><span class="s2">= </span><span class="s1">rg</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">seed_seq</span>
    <span class="s1">rg_plk </span><span class="s2">= </span><span class="s1">pickle</span><span class="s2">.</span><span class="s1">loads</span><span class="s2">(</span><span class="s1">pickle</span><span class="s2">.</span><span class="s1">dumps</span><span class="s2">(</span><span class="s1">rg</span><span class="s2">))</span>
    <span class="s1">ss_plk </span><span class="s2">= </span><span class="s1">rg_plk</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">seed_seq</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">ss</span><span class="s2">.</span><span class="s1">state</span><span class="s2">, </span><span class="s1">ss_plk</span><span class="s2">.</span><span class="s1">state</span><span class="s2">)</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">ss</span><span class="s2">.</span><span class="s1">pool</span><span class="s2">, </span><span class="s1">ss_plk</span><span class="s2">.</span><span class="s1">pool</span><span class="s2">)</span>

    <span class="s1">rg</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">seed_seq</span><span class="s2">.</span><span class="s1">spawn</span><span class="s2">(</span><span class="s4">10</span><span class="s2">)</span>
    <span class="s1">rg_plk </span><span class="s2">= </span><span class="s1">pickle</span><span class="s2">.</span><span class="s1">loads</span><span class="s2">(</span><span class="s1">pickle</span><span class="s2">.</span><span class="s1">dumps</span><span class="s2">(</span><span class="s1">rg</span><span class="s2">))</span>
    <span class="s1">ss_plk </span><span class="s2">= </span><span class="s1">rg_plk</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">seed_seq</span>
    <span class="s1">assert_equal</span><span class="s2">(</span><span class="s1">ss</span><span class="s2">.</span><span class="s1">state</span><span class="s2">, </span><span class="s1">ss_plk</span><span class="s2">.</span><span class="s1">state</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;version&quot;</span><span class="s2">, [</span><span class="s4">121</span><span class="s2">, </span><span class="s4">126</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_legacy_pickle</span><span class="s2">(</span><span class="s1">version</span><span class="s2">):</span>
    <span class="s5"># Pickling format was changes in 1.22.x and in 2.0.x</span>
    <span class="s0">import </span><span class="s1">pickle</span>
    <span class="s0">import </span><span class="s1">gzip</span>

    <span class="s1">base_path </span><span class="s2">= </span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span><span class="s2">.</span><span class="s1">abspath</span><span class="s2">(</span><span class="s1">__file__</span><span class="s2">))[</span><span class="s4">0</span><span class="s2">]</span>
    <span class="s1">pkl_file </span><span class="s2">= </span><span class="s1">os</span><span class="s2">.</span><span class="s1">path</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span>
        <span class="s1">base_path</span><span class="s2">, </span><span class="s3">&quot;data&quot;</span><span class="s2">, </span><span class="s3">f&quot;generator_pcg64_np</span><span class="s0">{</span><span class="s1">version</span><span class="s0">}</span><span class="s3">.pkl.gz&quot;</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">gzip</span><span class="s2">.</span><span class="s1">open</span><span class="s2">(</span><span class="s1">pkl_file</span><span class="s2">) </span><span class="s0">as </span><span class="s1">gz</span><span class="s2">:</span>
        <span class="s1">rg </span><span class="s2">= </span><span class="s1">pickle</span><span class="s2">.</span><span class="s1">load</span><span class="s2">(</span><span class="s1">gz</span><span class="s2">)</span>
    <span class="s1">state </span><span class="s2">= </span><span class="s1">rg</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">.</span><span class="s1">state</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">]</span>

    <span class="s0">assert </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">rg</span><span class="s2">, </span><span class="s1">Generator</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">rg</span><span class="s2">.</span><span class="s1">bit_generator</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">PCG64</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">state</span><span class="s2">[</span><span class="s3">'state'</span><span class="s2">] == </span><span class="s4">35399562948360463058890781895381311971</span>
    <span class="s0">assert </span><span class="s1">state</span><span class="s2">[</span><span class="s3">'inc'</span><span class="s2">] == </span><span class="s4">87136372517582989555478159403783844777</span>
</pre>
</body>
</html>