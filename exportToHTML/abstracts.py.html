<html>
<head>
<title>abstracts.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #5f826b; font-style: italic;}
.s3 { color: #cf8e6d;}
.s4 { color: #bcbec4;}
.s5 { color: #6aab73;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
abstracts.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright (c) 2023, 2024, Oracle and/or its affiliates.</span>
<span class="s0">#</span>
<span class="s0"># This program is free software; you can redistribute it and/or modify</span>
<span class="s0"># it under the terms of the GNU General Public License, version 2.0, as</span>
<span class="s0"># published by the Free Software Foundation.</span>
<span class="s0">#</span>
<span class="s0"># This program is designed to work with certain software (including</span>
<span class="s0"># but not limited to OpenSSL) that is licensed under separate terms,</span>
<span class="s0"># as designated in a particular file or component or in included license</span>
<span class="s0"># documentation. The authors of MySQL hereby grant you an</span>
<span class="s0"># additional permission to link the program and your derivative works</span>
<span class="s0"># with the separately licensed software that they have either included with</span>
<span class="s0"># the program or referenced in the documentation.</span>
<span class="s0">#</span>
<span class="s0"># Without limiting anything contained in the foregoing, this file,</span>
<span class="s0"># which is part of MySQL Connector/Python, is also subject to the</span>
<span class="s0"># Universal FOSS Exception, version 1.0, a copy of which can be found at</span>
<span class="s0"># http://oss.oracle.com/licenses/universal-foss-exception.</span>
<span class="s0">#</span>
<span class="s0"># This program is distributed in the hope that it will be useful, but</span>
<span class="s0"># WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="s0"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="s0"># See the GNU General Public License, version 2.0, for more details.</span>
<span class="s0">#</span>
<span class="s0"># You should have received a copy of the GNU General Public License</span>
<span class="s0"># along with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="s0"># 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA</span>

<span class="s0"># mypy: disable-error-code=&quot;assignment,attr-defined&quot;</span>
<span class="s0"># pylint: disable=dangerous-default-value</span>

<span class="s2">&quot;&quot;&quot;Module gathering all abstract base classes.&quot;&quot;&quot;</span>

<span class="s3">from </span><span class="s1">__future__ </span><span class="s3">import </span><span class="s1">annotations</span>

<span class="s1">__all__ </span><span class="s4">= [</span><span class="s5">&quot;MySQLConnectionAbstract&quot;</span><span class="s4">, </span><span class="s5">&quot;MySQLCursorAbstract&quot;</span><span class="s4">, </span><span class="s5">&quot;ServerInfo&quot;</span><span class="s4">]</span>

<span class="s3">import </span><span class="s1">asyncio</span>
<span class="s3">import </span><span class="s1">os</span>
<span class="s3">import </span><span class="s1">re</span>
<span class="s3">import </span><span class="s1">weakref</span>

<span class="s3">from </span><span class="s1">abc </span><span class="s3">import </span><span class="s1">ABC</span><span class="s4">, </span><span class="s1">abstractmethod</span>
<span class="s3">from </span><span class="s1">dataclasses </span><span class="s3">import </span><span class="s1">dataclass</span><span class="s4">, </span><span class="s1">field</span>
<span class="s3">from </span><span class="s1">inspect </span><span class="s3">import </span><span class="s1">signature</span>
<span class="s3">from </span><span class="s1">types </span><span class="s3">import </span><span class="s1">TracebackType</span>
<span class="s3">from </span><span class="s1">typing </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">TYPE_CHECKING</span><span class="s4">,</span>
    <span class="s1">Any</span><span class="s4">,</span>
    <span class="s1">AsyncGenerator</span><span class="s4">,</span>
    <span class="s1">BinaryIO</span><span class="s4">,</span>
    <span class="s1">Callable</span><span class="s4">,</span>
    <span class="s1">Dict</span><span class="s4">,</span>
    <span class="s1">Generator</span><span class="s4">,</span>
    <span class="s1">Iterator</span><span class="s4">,</span>
    <span class="s1">List</span><span class="s4">,</span>
    <span class="s1">Mapping</span><span class="s4">,</span>
    <span class="s1">NoReturn</span><span class="s4">,</span>
    <span class="s1">Optional</span><span class="s4">,</span>
    <span class="s1">Sequence</span><span class="s4">,</span>
    <span class="s1">Tuple</span><span class="s4">,</span>
    <span class="s1">Type</span><span class="s4">,</span>
    <span class="s1">Union</span><span class="s4">,</span>
<span class="s4">)</span>

<span class="s3">from </span><span class="s4">..</span><span class="s1">abstracts </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">DUPLICATED_IN_LIST_ERROR</span><span class="s4">,</span>
    <span class="s1">KRB_SERVICE_PINCIPAL_ERROR</span><span class="s4">,</span>
    <span class="s1">MYSQL_PY_TYPES</span><span class="s4">,</span>
    <span class="s1">TLS_V1_3_SUPPORTED</span><span class="s4">,</span>
    <span class="s1">TLS_VER_NO_SUPPORTED</span><span class="s4">,</span>
    <span class="s1">TLS_VERSION_ERROR</span><span class="s4">,</span>
    <span class="s1">TLS_VERSION_UNACCEPTABLE_ERROR</span><span class="s4">,</span>
<span class="s4">)</span>
<span class="s3">from </span><span class="s4">..</span><span class="s1">constants </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">CONN_ATTRS_DN</span><span class="s4">,</span>
    <span class="s1">DEFAULT_CONFIGURATION</span><span class="s4">,</span>
    <span class="s1">MYSQL_DEFAULT_CHARSET_ID_57</span><span class="s4">,</span>
    <span class="s1">MYSQL_DEFAULT_CHARSET_ID_80</span><span class="s4">,</span>
    <span class="s1">OPENSSL_CS_NAMES</span><span class="s4">,</span>
    <span class="s1">TLS_CIPHER_SUITES</span><span class="s4">,</span>
    <span class="s1">TLS_VERSIONS</span><span class="s4">,</span>
    <span class="s1">ClientFlag</span><span class="s4">,</span>
<span class="s4">)</span>
<span class="s3">from </span><span class="s4">..</span><span class="s1">conversion </span><span class="s3">import </span><span class="s1">MySQLConverter</span><span class="s4">, </span><span class="s1">MySQLConverterBase</span>
<span class="s3">from </span><span class="s4">..</span><span class="s1">errors </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">Error</span><span class="s4">,</span>
    <span class="s1">InterfaceError</span><span class="s4">,</span>
    <span class="s1">InternalError</span><span class="s4">,</span>
    <span class="s1">NotSupportedError</span><span class="s4">,</span>
    <span class="s1">ProgrammingError</span><span class="s4">,</span>
<span class="s4">)</span>
<span class="s3">from </span><span class="s4">..</span><span class="s1">tls_ciphers </span><span class="s3">import </span><span class="s1">UNACCEPTABLE_TLS_CIPHERSUITES</span><span class="s4">, </span><span class="s1">UNACCEPTABLE_TLS_VERSIONS</span>
<span class="s3">from </span><span class="s4">..</span><span class="s1">types </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">BinaryProtocolType</span><span class="s4">,</span>
    <span class="s1">DescriptionType</span><span class="s4">,</span>
    <span class="s1">EofPacketType</span><span class="s4">,</span>
    <span class="s1">HandShakeType</span><span class="s4">,</span>
    <span class="s1">OkPacketType</span><span class="s4">,</span>
    <span class="s1">ParamsSequenceType</span><span class="s4">,</span>
    <span class="s1">ResultType</span><span class="s4">,</span>
    <span class="s1">RowType</span><span class="s4">,</span>
    <span class="s1">StatsPacketType</span><span class="s4">,</span>
    <span class="s1">StrOrBytes</span><span class="s4">,</span>
    <span class="s1">WarningType</span><span class="s4">,</span>
<span class="s4">)</span>
<span class="s3">from </span><span class="s4">..</span><span class="s1">utils </span><span class="s3">import </span><span class="s1">GenericWrapper</span><span class="s4">, </span><span class="s1">import_object</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">authentication </span><span class="s3">import </span><span class="s1">MySQLAuthenticator</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">charsets </span><span class="s3">import </span><span class="s1">Charset</span><span class="s4">, </span><span class="s1">charsets</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">protocol </span><span class="s3">import </span><span class="s1">MySQLProtocol</span>

<span class="s3">if </span><span class="s1">TYPE_CHECKING</span><span class="s4">:</span>
    <span class="s3">from </span><span class="s4">.</span><span class="s1">network </span><span class="s3">import </span><span class="s1">MySQLTcpSocket</span><span class="s4">, </span><span class="s1">MySQLUnixSocket</span>


<span class="s1">IS_POSIX </span><span class="s4">= </span><span class="s1">os</span><span class="s4">.</span><span class="s1">name </span><span class="s4">== </span><span class="s5">&quot;posix&quot;</span>
<span class="s1">NAMED_TUPLE_CACHE</span><span class="s4">: </span><span class="s1">weakref</span><span class="s4">.</span><span class="s1">WeakValueDictionary</span><span class="s4">[</span><span class="s1">Any</span><span class="s4">, </span><span class="s1">Any</span><span class="s4">] = </span><span class="s1">weakref</span><span class="s4">.</span><span class="s1">WeakValueDictionary</span><span class="s4">()</span>


<span class="s4">@</span><span class="s1">dataclass</span>
<span class="s3">class </span><span class="s1">ServerInfo</span><span class="s4">:</span>
    <span class="s2">&quot;&quot;&quot;Stores the server information retrieved on the handshake. 
 
    Also parses and validates the server version, storing it as a tuple. 
    &quot;&quot;&quot;</span>

    <span class="s1">protocol</span><span class="s4">: </span><span class="s1">int</span>
    <span class="s1">version</span><span class="s4">: </span><span class="s1">str</span>
    <span class="s1">version_tuple</span><span class="s4">: </span><span class="s1">Tuple</span><span class="s4">[</span><span class="s1">int</span><span class="s4">, ...] = </span><span class="s1">field</span><span class="s4">(</span><span class="s1">init</span><span class="s4">=</span><span class="s3">False</span><span class="s4">)</span>
    <span class="s1">thread_id</span><span class="s4">: </span><span class="s1">int</span>
    <span class="s1">charset</span><span class="s4">: </span><span class="s1">int</span>
    <span class="s1">status_flags</span><span class="s4">: </span><span class="s1">int</span>
    <span class="s1">auth_plugin</span><span class="s4">: </span><span class="s1">str</span>
    <span class="s1">auth_data</span><span class="s4">: </span><span class="s1">bytes</span>
    <span class="s1">capabilities</span><span class="s4">: </span><span class="s1">int</span>
    <span class="s1">query_attrs_is_supported</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span>

    <span class="s3">def </span><span class="s1">__post_init__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Parse and validate server version. 
 
        Raises: 
            InterfaceError: If parsing fails or MySQL version is not supported. 
        &quot;&quot;&quot;</span>
        <span class="s1">version_re </span><span class="s4">= </span><span class="s1">re</span><span class="s4">.</span><span class="s1">compile</span><span class="s4">(</span><span class="s5">r&quot;^(\d{1,2})\.(\d{1,2})\.(\d{1,3})(.*)&quot;</span><span class="s4">)</span>
        <span class="s1">match </span><span class="s4">= </span><span class="s1">version_re</span><span class="s4">.</span><span class="s1">match</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">version</span><span class="s4">)</span>
        <span class="s3">if not </span><span class="s1">match</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span><span class="s5">&quot;Failed parsing MySQL version&quot;</span><span class="s4">)</span>

        <span class="s1">version </span><span class="s4">= </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">int</span><span class="s4">(</span><span class="s1">v</span><span class="s4">) </span><span class="s3">for </span><span class="s1">v </span><span class="s3">in </span><span class="s1">match</span><span class="s4">.</span><span class="s1">groups</span><span class="s4">()[</span><span class="s6">0</span><span class="s4">:</span><span class="s6">3</span><span class="s4">])</span>
        <span class="s3">if </span><span class="s1">version </span><span class="s4">&lt; (</span><span class="s6">4</span><span class="s4">, </span><span class="s6">1</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span><span class="s5">f&quot;MySQL Version '</span><span class="s3">{</span><span class="s1">self</span><span class="s4">.</span><span class="s1">version</span><span class="s3">}</span><span class="s5">' is not supported&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">version_tuple </span><span class="s4">= </span><span class="s1">version</span>


<span class="s3">class </span><span class="s1">MySQLConnectionAbstract</span><span class="s4">(</span><span class="s1">ABC</span><span class="s4">):</span>
    <span class="s2">&quot;&quot;&quot;Defines the MySQL connection interface.&quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">__init__</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s4">*,</span>
        <span class="s1">user</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">password</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">host</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;127.0.0.1&quot;</span><span class="s4">,</span>
        <span class="s1">port</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">3306</span><span class="s4">,</span>
        <span class="s1">database</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">password1</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">password2</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">password3</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">charset</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">collation</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">auth_plugin</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">client_flags</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">compress</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">consume_results</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">autocommit</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">time_zone</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">conn_attrs</span><span class="s4">: </span><span class="s1">Dict</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">str</span><span class="s4">] = {},</span>
        <span class="s1">sql_mode</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">init_command</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">get_warnings</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">raise_on_warnings</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">buffered</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">raw</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">kerberos_auth_mode</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">krb_service_principal</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">webauthn_callback</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Union</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Callable</span><span class="s4">[[</span><span class="s1">str</span><span class="s4">], </span><span class="s3">None</span><span class="s4">]]] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">allow_local_infile</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">DEFAULT_CONFIGURATION</span><span class="s4">[</span><span class="s5">&quot;allow_local_infile&quot;</span><span class="s4">],</span>
        <span class="s1">allow_local_infile_in_path</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">DEFAULT_CONFIGURATION</span><span class="s4">[</span>
            <span class="s5">&quot;allow_local_infile_in_path&quot;</span>
        <span class="s4">],</span>
        <span class="s1">converter_class</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">MySQLConverter</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">converter_str_fallback</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">connection_timeout</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s1">DEFAULT_CONFIGURATION</span><span class="s4">[</span><span class="s5">&quot;connect_timeout&quot;</span><span class="s4">],</span>
        <span class="s1">unix_socket</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">use_unicode</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">True</span><span class="s4">,</span>
        <span class="s1">ssl_ca</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">ssl_cert</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">ssl_key</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">ssl_verify_cert</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">ssl_verify_identity</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">ssl_disabled</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s1">DEFAULT_CONFIGURATION</span><span class="s4">[</span><span class="s5">&quot;ssl_disabled&quot;</span><span class="s4">],</span>
        <span class="s1">tls_versions</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">str</span><span class="s4">]] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">tls_ciphersuites</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">str</span><span class="s4">]] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">loop</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">asyncio</span><span class="s4">.</span><span class="s1">AbstractEventLoop</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
    <span class="s4">):</span>
        <span class="s0"># private (shouldn't be manipulated directly internally)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">__charset</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Charset</span><span class="s4">] = </span><span class="s3">None</span>
        <span class="s5">&quot;&quot;&quot;It shouldn't be manipulated directly, even internally. If you need 
        to manipulate the charset object, use the property `_charset` (read &amp; write) 
        instead. Similarly, `_charset` shouldn't be manipulated externally. 
        &quot;&quot;&quot;</span>

        <span class="s0"># protected (can be manipulated directly internally)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_user</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s1">user</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_password</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s1">password</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_host</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s1">host</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_port</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s1">port</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_database</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s1">database</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_password1</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s1">password1</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_password2</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s1">password2</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_password3</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s1">password3</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_unix_socket</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s1">unix_socket</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_connection_timeout</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s1">connection_timeout</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_connection_attrs</span><span class="s4">: </span><span class="s1">Dict</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">str</span><span class="s4">] = </span><span class="s1">conn_attrs</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_compress</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">compress</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_consume_results</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">consume_results</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_autocommit</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">autocommit</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_time_zone</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">time_zone</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_sql_mode</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">sql_mode</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_init_command</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">init_command</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_protocol</span><span class="s4">: </span><span class="s1">MySQLProtocol </span><span class="s4">= </span><span class="s1">MySQLProtocol</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_socket</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Union</span><span class="s4">[</span><span class="s1">MySQLTcpSocket</span><span class="s4">, </span><span class="s1">MySQLUnixSocket</span><span class="s4">]] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_charset_name</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">charset</span>
        <span class="s5">&quot;&quot;&quot;Charset name provided by the user at connection time.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_charset_collation</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">collation</span>
        <span class="s5">&quot;&quot;&quot;Collation provided by the user at connection time.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_active</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_disabled</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">ssl_disabled</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_ca</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">ssl_ca</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_cert</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">ssl_cert</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_key</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">ssl_key</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_verify_cert</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s1">ssl_verify_cert</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_verify_identity</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s1">ssl_verify_identity</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_versions</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">str</span><span class="s4">]] = </span><span class="s1">tls_versions</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_ciphersuites</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">str</span><span class="s4">]] = </span><span class="s1">tls_ciphersuites</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_auth_plugin</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">auth_plugin</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_auth_plugin_class</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_handshake</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">HandShakeType</span><span class="s4">] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_loop</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">asyncio</span><span class="s4">.</span><span class="s1">AbstractEventLoop</span><span class="s4">] = (</span>
            <span class="s1">loop </span><span class="s3">or </span><span class="s1">asyncio</span><span class="s4">.</span><span class="s1">get_event_loop</span><span class="s4">()</span>
        <span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_client_flags</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s1">client_flags </span><span class="s3">or </span><span class="s1">ClientFlag</span><span class="s4">.</span><span class="s1">get_default</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_server_info</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">ServerInfo</span><span class="s4">] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_cursors</span><span class="s4">: </span><span class="s1">weakref</span><span class="s4">.</span><span class="s1">WeakSet </span><span class="s4">= </span><span class="s1">weakref</span><span class="s4">.</span><span class="s1">WeakSet</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_query_attrs</span><span class="s4">: </span><span class="s1">Dict</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">BinaryProtocolType</span><span class="s4">] = {}</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_query_attrs_supported</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s3">False</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_columns_desc</span><span class="s4">: </span><span class="s1">List</span><span class="s4">[</span><span class="s1">DescriptionType</span><span class="s4">] = []</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_authenticator</span><span class="s4">: </span><span class="s1">MySQLAuthenticator </span><span class="s4">= </span><span class="s1">MySQLAuthenticator</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_converter_class</span><span class="s4">: </span><span class="s1">Type</span><span class="s4">[</span><span class="s1">MySQLConverter</span><span class="s4">] = </span><span class="s1">converter_class </span><span class="s3">or </span><span class="s1">MySQLConverter</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_converter_str_fallback</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">converter_str_fallback</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_kerberos_auth_mode</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">kerberos_auth_mode</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_krb_service_principal</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">krb_service_principal</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_allow_local_infile</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">allow_local_infile</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_allow_local_infile_in_path</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s1">allow_local_infile_in_path</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_get_warnings</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">get_warnings</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">raise_on_warnings</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">raise_on_warnings</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_buffered</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">buffered</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_raw</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">raw</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_use_unicode</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s1">use_unicode</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_have_next_result</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_unread_result</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_in_transaction</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_oci_config_file</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_oci_config_profile</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_webauthn_callback</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Union</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Callable</span><span class="s4">[[</span><span class="s1">str</span><span class="s4">], </span><span class="s3">None</span><span class="s4">]]] = (</span>
            <span class="s1">webauthn_callback</span>
        <span class="s4">)</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">converter</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">MySQLConverter</span><span class="s4">] = </span><span class="s3">None</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">_validate_connection_options</span><span class="s4">()</span>

    <span class="s3">async def </span><span class="s1">__aenter__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; MySQLConnectionAbstract</span><span class="s4">:</span>
        <span class="s3">if not </span><span class="s1">self</span><span class="s4">.</span><span class="s1">is_socket_connected</span><span class="s4">():</span>
            <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">connect</span><span class="s4">()</span>
        <span class="s3">return </span><span class="s1">self</span>

    <span class="s3">async def </span><span class="s1">__aexit__</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">exc_type</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Type</span><span class="s4">[</span><span class="s1">BaseException</span><span class="s4">]] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">exc_value</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">BaseException</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">traceback</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">TracebackType</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">close</span><span class="s4">()</span>

    <span class="s3">def </span><span class="s1">_validate_connection_options</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Validate connection options.&quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_user</span><span class="s4">:</span>
            <span class="s3">try</span><span class="s4">:</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_user </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_user</span><span class="s4">.</span><span class="s1">strip</span><span class="s4">()</span>
            <span class="s3">except </span><span class="s1">AttributeError </span><span class="s3">as </span><span class="s1">err</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span><span class="s5">&quot;'user' must be a string&quot;</span><span class="s4">) </span><span class="s3">from </span><span class="s1">err</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_compress</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">set_client_flags</span><span class="s4">([</span><span class="s1">ClientFlag</span><span class="s4">.</span><span class="s1">COMPRESS</span><span class="s4">])</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_allow_local_infile_in_path</span><span class="s4">:</span>
            <span class="s1">infile_in_path </span><span class="s4">= </span><span class="s1">os</span><span class="s4">.</span><span class="s1">path</span><span class="s4">.</span><span class="s1">abspath</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_allow_local_infile_in_path</span><span class="s4">)</span>
            <span class="s3">if </span><span class="s4">(</span>
                <span class="s1">infile_in_path</span>
                <span class="s3">and </span><span class="s1">os</span><span class="s4">.</span><span class="s1">path</span><span class="s4">.</span><span class="s1">exists</span><span class="s4">(</span><span class="s1">infile_in_path</span><span class="s4">)</span>
                <span class="s3">and not </span><span class="s1">os</span><span class="s4">.</span><span class="s1">path</span><span class="s4">.</span><span class="s1">isdir</span><span class="s4">(</span><span class="s1">infile_in_path</span><span class="s4">)</span>
                <span class="s3">or </span><span class="s1">os</span><span class="s4">.</span><span class="s1">path</span><span class="s4">.</span><span class="s1">islink</span><span class="s4">(</span><span class="s1">infile_in_path</span><span class="s4">)</span>
            <span class="s4">):</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span><span class="s5">&quot;allow_local_infile_in_path must be a directory&quot;</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_allow_local_infile </span><span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_allow_local_infile_in_path</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">set_client_flags</span><span class="s4">([</span><span class="s1">ClientFlag</span><span class="s4">.</span><span class="s1">LOCAL_FILES</span><span class="s4">])</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">set_client_flags</span><span class="s4">([-</span><span class="s1">ClientFlag</span><span class="s4">.</span><span class="s1">LOCAL_FILES</span><span class="s4">])</span>

        <span class="s0"># Disallow the usage of some default authentication plugins</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_auth_plugin </span><span class="s4">== </span><span class="s5">&quot;authentication_webauthn_client&quot;</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                <span class="s5">f&quot;'</span><span class="s3">{</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_auth_plugin</span><span class="s3">}</span><span class="s5">' cannot be used as the default authentication &quot;</span>
                <span class="s5">&quot;plugin&quot;</span>
            <span class="s4">)</span>

        <span class="s0"># Disable SSL for unix socket connections</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_unix_socket </span><span class="s3">and </span><span class="s1">os</span><span class="s4">.</span><span class="s1">name </span><span class="s4">== </span><span class="s5">&quot;posix&quot;</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_disabled </span><span class="s4">= </span><span class="s3">True</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_disabled </span><span class="s3">and </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_auth_plugin </span><span class="s4">== </span><span class="s5">&quot;mysql_clear_password&quot;</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                <span class="s5">&quot;Clear password authentication is not supported over insecure &quot;</span>
                <span class="s5">&quot; channels&quot;</span>
            <span class="s4">)</span>

        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_port</span><span class="s4">, </span><span class="s1">int</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span><span class="s5">&quot;TCP/IP port number should be an integer&quot;</span><span class="s4">)</span>

        <span class="s3">if </span><span class="s1">any</span><span class="s4">([</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_ca</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_cert</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_key</span><span class="s4">]):</span>
            <span class="s0"># Make sure both ssl_key/ssl_cert are set, or neither (XOR)</span>
            <span class="s3">if not </span><span class="s1">all</span><span class="s4">([</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_key</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_cert</span><span class="s4">]):</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                    <span class="s5">&quot;ssl_key and ssl_cert need to be both specified, or neither&quot;</span>
                <span class="s4">)</span>

            <span class="s3">if </span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_key </span><span class="s3">is None</span><span class="s4">) != (</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_cert </span><span class="s3">is None</span><span class="s4">):</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                    <span class="s5">&quot;ssl_key and ssl_cert need to be both set, or neither&quot;</span>
                <span class="s4">)</span>
            <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_versions </span><span class="s3">is not None</span><span class="s4">:</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_validate_tls_versions</span><span class="s4">()</span>

            <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_ciphersuites </span><span class="s3">is not None</span><span class="s4">:</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_validate_tls_ciphersuites</span><span class="s4">()</span>

        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_connection_attrs</span><span class="s4">, </span><span class="s1">dict</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span><span class="s5">&quot;conn_attrs must be of type dict&quot;</span><span class="s4">)</span>

        <span class="s3">for </span><span class="s1">attr_name</span><span class="s4">, </span><span class="s1">attr_value </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_connection_attrs</span><span class="s4">.</span><span class="s1">items</span><span class="s4">():</span>
            <span class="s3">if </span><span class="s1">attr_name </span><span class="s3">in </span><span class="s1">CONN_ATTRS_DN</span><span class="s4">:</span>
                <span class="s3">continue</span>
            <span class="s0"># Validate name type</span>
            <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">attr_name</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s5">&quot;Attribute name should be a string, found: &quot;</span>
                    <span class="s5">f&quot;'</span><span class="s3">{</span><span class="s1">attr_name</span><span class="s3">}</span><span class="s5">' in '</span><span class="s3">{</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_connection_attrs</span><span class="s3">}</span><span class="s5">'&quot;</span>
                <span class="s4">)</span>
            <span class="s0"># Validate attribute name limit 32 characters</span>
            <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">attr_name</span><span class="s4">) &gt; </span><span class="s6">32</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s5">f&quot;Attribute name '</span><span class="s3">{</span><span class="s1">attr_name</span><span class="s3">}</span><span class="s5">' exceeds 32 characters limit size&quot;</span>
                <span class="s4">)</span>
            <span class="s0"># Validate names in connection attributes cannot start with &quot;_&quot;</span>
            <span class="s3">if </span><span class="s1">attr_name</span><span class="s4">.</span><span class="s1">startswith</span><span class="s4">(</span><span class="s5">&quot;_&quot;</span><span class="s4">):</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s5">&quot;Key names in connection attributes cannot start with &quot;</span>
                    <span class="s5">&quot;'_', found: '{attr_name}'&quot;</span>
                <span class="s4">)</span>
            <span class="s0"># Validate value type</span>
            <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">attr_value</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s5">f&quot;Attribute '</span><span class="s3">{</span><span class="s1">attr_name</span><span class="s3">}</span><span class="s5">' value: '</span><span class="s3">{</span><span class="s1">attr_value</span><span class="s3">}</span><span class="s5">' must &quot;</span>
                    <span class="s5">&quot;be a string type&quot;</span>
                <span class="s4">)</span>
            <span class="s0"># Validate attribute value limit 1024 characters</span>
            <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">attr_value</span><span class="s4">) &gt; </span><span class="s6">1024</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s5">f&quot;Attribute '</span><span class="s3">{</span><span class="s1">attr_name</span><span class="s3">}</span><span class="s5">' value: '</span><span class="s3">{</span><span class="s1">attr_value</span><span class="s3">}</span><span class="s5">' &quot;</span>
                    <span class="s5">&quot;exceeds 1024 characters limit size&quot;</span>
                <span class="s4">)</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_client_flags </span><span class="s4">&amp; </span><span class="s1">ClientFlag</span><span class="s4">.</span><span class="s1">CONNECT_ARGS</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_add_default_conn_attrs</span><span class="s4">()</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_kerberos_auth_mode</span><span class="s4">:</span>
            <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_kerberos_auth_mode</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span><span class="s5">&quot;'kerberos_auth_mode' must be of type str&quot;</span><span class="s4">)</span>
            <span class="s1">kerberos_auth_mode </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_kerberos_auth_mode</span><span class="s4">.</span><span class="s1">lower</span><span class="s4">()</span>
            <span class="s3">if </span><span class="s1">kerberos_auth_mode </span><span class="s4">== </span><span class="s5">&quot;sspi&quot;</span><span class="s4">:</span>
                <span class="s3">if </span><span class="s1">os</span><span class="s4">.</span><span class="s1">name </span><span class="s4">!= </span><span class="s5">&quot;nt&quot;</span><span class="s4">:</span>
                    <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                        <span class="s5">&quot;'kerberos_auth_mode=SSPI' is only available on Windows&quot;</span>
                    <span class="s4">)</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_auth_plugin_class </span><span class="s4">= </span><span class="s5">&quot;MySQLSSPIKerberosAuthPlugin&quot;</span>
            <span class="s3">elif </span><span class="s1">kerberos_auth_mode </span><span class="s4">== </span><span class="s5">&quot;gssapi&quot;</span><span class="s4">:</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_auth_plugin_class </span><span class="s4">= </span><span class="s5">&quot;MySQLKerberosAuthPlugin&quot;</span>
            <span class="s3">else</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s5">&quot;Invalid 'kerberos_auth_mode' mode. Please use 'SSPI' or 'GSSAPI'&quot;</span>
                <span class="s4">)</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_krb_service_principal</span><span class="s4">:</span>
            <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_krb_service_principal</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s1">KRB_SERVICE_PINCIPAL_ERROR</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">error</span><span class="s4">=</span><span class="s5">&quot;is not a string&quot;</span><span class="s4">)</span>
                <span class="s4">)</span>
            <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_krb_service_principal </span><span class="s4">== </span><span class="s5">&quot;&quot;</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s1">KRB_SERVICE_PINCIPAL_ERROR</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span>
                        <span class="s1">error</span><span class="s4">=</span><span class="s5">&quot;can not be an empty string&quot;</span>
                    <span class="s4">)</span>
                <span class="s4">)</span>
            <span class="s3">if </span><span class="s5">&quot;/&quot; </span><span class="s3">not in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_krb_service_principal</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span>
                    <span class="s1">KRB_SERVICE_PINCIPAL_ERROR</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">error</span><span class="s4">=</span><span class="s5">&quot;is incorrectly formatted&quot;</span><span class="s4">)</span>
                <span class="s4">)</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_webauthn_callback</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_validate_callable</span><span class="s4">(</span><span class="s5">&quot;webauth_callback&quot;</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_webauthn_callback</span><span class="s4">, </span><span class="s6">1</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">_validate_tls_ciphersuites</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Validates the tls_ciphersuites option.&quot;&quot;&quot;</span>
        <span class="s1">tls_ciphersuites </span><span class="s4">= []</span>
        <span class="s1">tls_cs </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_ciphersuites</span>

        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">tls_cs</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
            <span class="s3">if not </span><span class="s4">(</span><span class="s1">tls_cs</span><span class="s4">.</span><span class="s1">startswith</span><span class="s4">(</span><span class="s5">&quot;[&quot;</span><span class="s4">) </span><span class="s3">and </span><span class="s1">tls_cs</span><span class="s4">.</span><span class="s1">endswith</span><span class="s4">(</span><span class="s5">&quot;]&quot;</span><span class="s4">)):</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                    <span class="s5">f&quot;tls_ciphersuites must be a list, found: '</span><span class="s3">{</span><span class="s1">tls_cs</span><span class="s3">}</span><span class="s5">'&quot;</span>
                <span class="s4">)</span>
            <span class="s1">tls_css </span><span class="s4">= </span><span class="s1">tls_cs</span><span class="s4">[</span><span class="s6">1</span><span class="s4">:-</span><span class="s6">1</span><span class="s4">].</span><span class="s1">split</span><span class="s4">(</span><span class="s5">&quot;,&quot;</span><span class="s4">)</span>
            <span class="s3">if not </span><span class="s1">tls_css</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                    <span class="s5">&quot;No valid cipher suite found in 'tls_ciphersuites' list&quot;</span>
                <span class="s4">)</span>
            <span class="s3">for </span><span class="s1">_tls_cs </span><span class="s3">in </span><span class="s1">tls_css</span><span class="s4">:</span>
                <span class="s1">_tls_cs </span><span class="s4">= </span><span class="s1">tls_cs</span><span class="s4">.</span><span class="s1">strip</span><span class="s4">().</span><span class="s1">upper</span><span class="s4">()</span>
                <span class="s3">if </span><span class="s1">_tls_cs</span><span class="s4">:</span>
                    <span class="s1">tls_ciphersuites</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">_tls_cs</span><span class="s4">)</span>

        <span class="s3">elif </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">tls_cs</span><span class="s4">, (</span><span class="s1">list</span><span class="s4">, </span><span class="s1">set</span><span class="s4">)):</span>
            <span class="s1">tls_ciphersuites </span><span class="s4">= [</span><span class="s1">tls_cs </span><span class="s3">for </span><span class="s1">tls_cs </span><span class="s3">in </span><span class="s1">tls_cs </span><span class="s3">if </span><span class="s1">tls_cs</span><span class="s4">]</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                <span class="s5">&quot;tls_ciphersuites should be a list with one or more &quot;</span>
                <span class="s5">f&quot;ciphersuites. Found: '</span><span class="s3">{</span><span class="s1">tls_cs</span><span class="s3">}</span><span class="s5">'&quot;</span>
            <span class="s4">)</span>

        <span class="s1">tls_versions </span><span class="s4">= (</span>
            <span class="s1">TLS_VERSIONS</span><span class="s4">[:] </span><span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_versions </span><span class="s3">is None else </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_versions</span><span class="s4">[:]</span>
        <span class="s4">)</span>

        <span class="s0"># A newer TLS version can use a cipher introduced on</span>
        <span class="s0"># an older version.</span>
        <span class="s1">tls_versions</span><span class="s4">.</span><span class="s1">sort</span><span class="s4">(</span><span class="s1">reverse</span><span class="s4">=</span><span class="s3">True</span><span class="s4">)</span>
        <span class="s1">newer_tls_ver </span><span class="s4">= </span><span class="s1">tls_versions</span><span class="s4">[</span><span class="s6">0</span><span class="s4">]</span>
        <span class="s0"># translated_names[0] are TLSv1.2 only</span>
        <span class="s0"># translated_names[1] are TLSv1.3 only</span>
        <span class="s1">translated_names</span><span class="s4">: </span><span class="s1">List</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">str</span><span class="s4">]] = [[], []]</span>
        <span class="s1">iani_cipher_suites_names </span><span class="s4">= {}</span>
        <span class="s1">ossl_cipher_suites_names</span><span class="s4">: </span><span class="s1">List</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = []</span>

        <span class="s0"># Old ciphers can work with new TLS versions.</span>
        <span class="s0"># Find all the ciphers introduced on previous TLS versions.</span>
        <span class="s3">for </span><span class="s1">tls_ver </span><span class="s3">in </span><span class="s1">TLS_VERSIONS</span><span class="s4">[: </span><span class="s1">TLS_VERSIONS</span><span class="s4">.</span><span class="s1">index</span><span class="s4">(</span><span class="s1">newer_tls_ver</span><span class="s4">) + </span><span class="s6">1</span><span class="s4">]:</span>
            <span class="s1">iani_cipher_suites_names</span><span class="s4">.</span><span class="s1">update</span><span class="s4">(</span><span class="s1">TLS_CIPHER_SUITES</span><span class="s4">[</span><span class="s1">tls_ver</span><span class="s4">])</span>
            <span class="s1">ossl_cipher_suites_names</span><span class="s4">.</span><span class="s1">extend</span><span class="s4">(</span><span class="s1">OPENSSL_CS_NAMES</span><span class="s4">[</span><span class="s1">tls_ver</span><span class="s4">])</span>

        <span class="s3">for </span><span class="s1">name </span><span class="s3">in </span><span class="s1">tls_ciphersuites</span><span class="s4">:</span>
            <span class="s3">if </span><span class="s5">&quot;-&quot; </span><span class="s3">in </span><span class="s1">name </span><span class="s3">and </span><span class="s1">name </span><span class="s3">in </span><span class="s1">ossl_cipher_suites_names</span><span class="s4">:</span>
                <span class="s3">if </span><span class="s1">name </span><span class="s3">in </span><span class="s1">OPENSSL_CS_NAMES</span><span class="s4">[</span><span class="s5">&quot;TLSv1.3&quot;</span><span class="s4">]:</span>
                    <span class="s1">translated_names</span><span class="s4">[</span><span class="s6">1</span><span class="s4">].</span><span class="s1">append</span><span class="s4">(</span><span class="s1">name</span><span class="s4">)</span>
                <span class="s3">else</span><span class="s4">:</span>
                    <span class="s1">translated_names</span><span class="s4">[</span><span class="s6">0</span><span class="s4">].</span><span class="s1">append</span><span class="s4">(</span><span class="s1">name</span><span class="s4">)</span>
            <span class="s3">elif </span><span class="s1">name </span><span class="s3">in </span><span class="s1">iani_cipher_suites_names</span><span class="s4">:</span>
                <span class="s1">translated_name </span><span class="s4">= </span><span class="s1">iani_cipher_suites_names</span><span class="s4">[</span><span class="s1">name</span><span class="s4">]</span>
                <span class="s3">if </span><span class="s1">translated_name </span><span class="s3">in </span><span class="s1">translated_names</span><span class="s4">:</span>
                    <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                        <span class="s1">DUPLICATED_IN_LIST_ERROR</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span>
                            <span class="s1">list</span><span class="s4">=</span><span class="s5">&quot;tls_ciphersuites&quot;</span><span class="s4">, </span><span class="s1">value</span><span class="s4">=</span><span class="s1">translated_name</span>
                        <span class="s4">)</span>
                    <span class="s4">)</span>
                <span class="s3">if </span><span class="s1">name </span><span class="s3">in </span><span class="s1">TLS_CIPHER_SUITES</span><span class="s4">[</span><span class="s5">&quot;TLSv1.3&quot;</span><span class="s4">]:</span>
                    <span class="s1">translated_names</span><span class="s4">[</span><span class="s6">1</span><span class="s4">].</span><span class="s1">append</span><span class="s4">(</span><span class="s1">iani_cipher_suites_names</span><span class="s4">[</span><span class="s1">name</span><span class="s4">])</span>
                <span class="s3">else</span><span class="s4">:</span>
                    <span class="s1">translated_names</span><span class="s4">[</span><span class="s6">0</span><span class="s4">].</span><span class="s1">append</span><span class="s4">(</span><span class="s1">iani_cipher_suites_names</span><span class="s4">[</span><span class="s1">name</span><span class="s4">])</span>
            <span class="s3">else</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                    <span class="s5">f&quot;The value '</span><span class="s3">{</span><span class="s1">name</span><span class="s3">}</span><span class="s5">' in tls_ciphersuites is not a valid &quot;</span>
                    <span class="s5">&quot;cipher suite&quot;</span>
                <span class="s4">)</span>
        <span class="s3">if not </span><span class="s1">translated_names</span><span class="s4">[</span><span class="s6">0</span><span class="s4">] </span><span class="s3">and not </span><span class="s1">translated_names</span><span class="s4">[</span><span class="s6">1</span><span class="s4">]:</span>
            <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                <span class="s5">&quot;No valid cipher suite found in the 'tls_ciphersuites' list&quot;</span>
            <span class="s4">)</span>

        <span class="s0"># raise an error when using an unacceptable cipher</span>
        <span class="s3">for </span><span class="s1">cipher_as_ossl </span><span class="s3">in </span><span class="s1">translated_names</span><span class="s4">[</span><span class="s6">0</span><span class="s4">]:</span>
            <span class="s3">if </span><span class="s1">cipher_as_ossl </span><span class="s3">in </span><span class="s1">UNACCEPTABLE_TLS_CIPHERSUITES</span><span class="s4">[</span><span class="s5">&quot;TLSv1.2&quot;</span><span class="s4">].</span><span class="s1">values</span><span class="s4">():</span>
                <span class="s3">raise </span><span class="s1">NotSupportedError</span><span class="s4">(</span>
                    <span class="s5">f&quot;Cipher </span><span class="s3">{</span><span class="s1">cipher_as_ossl</span><span class="s3">} </span><span class="s5">when used with TLSv1.2 is unacceptable.&quot;</span>
                <span class="s4">)</span>
        <span class="s3">for </span><span class="s1">cipher_as_ossl </span><span class="s3">in </span><span class="s1">translated_names</span><span class="s4">[</span><span class="s6">1</span><span class="s4">]:</span>
            <span class="s3">if </span><span class="s1">cipher_as_ossl </span><span class="s3">in </span><span class="s1">UNACCEPTABLE_TLS_CIPHERSUITES</span><span class="s4">[</span><span class="s5">&quot;TLSv1.3&quot;</span><span class="s4">].</span><span class="s1">values</span><span class="s4">():</span>
                <span class="s3">raise </span><span class="s1">NotSupportedError</span><span class="s4">(</span>
                    <span class="s5">f&quot;Cipher </span><span class="s3">{</span><span class="s1">cipher_as_ossl</span><span class="s3">} </span><span class="s5">when used with TLSv1.3 is unacceptable.&quot;</span>
                <span class="s4">)</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_ciphersuites </span><span class="s4">= [</span>
            <span class="s5">&quot;:&quot;</span><span class="s4">.</span><span class="s1">join</span><span class="s4">(</span><span class="s1">translated_names</span><span class="s4">[</span><span class="s6">0</span><span class="s4">]),</span>
            <span class="s5">&quot;:&quot;</span><span class="s4">.</span><span class="s1">join</span><span class="s4">(</span><span class="s1">translated_names</span><span class="s4">[</span><span class="s6">1</span><span class="s4">]),</span>
        <span class="s4">]</span>

    <span class="s3">def </span><span class="s1">_validate_tls_versions</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Validates the tls_versions option.&quot;&quot;&quot;</span>
        <span class="s1">tls_versions </span><span class="s4">= []</span>
        <span class="s1">tls_version </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_versions</span>

        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">tls_version</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
            <span class="s3">if not </span><span class="s4">(</span><span class="s1">tls_version</span><span class="s4">.</span><span class="s1">startswith</span><span class="s4">(</span><span class="s5">&quot;[&quot;</span><span class="s4">) </span><span class="s3">and </span><span class="s1">tls_version</span><span class="s4">.</span><span class="s1">endswith</span><span class="s4">(</span><span class="s5">&quot;]&quot;</span><span class="s4">)):</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                    <span class="s5">f&quot;tls_versions must be a list, found: '</span><span class="s3">{</span><span class="s1">tls_version</span><span class="s3">}</span><span class="s5">'&quot;</span>
                <span class="s4">)</span>
            <span class="s1">tls_vers </span><span class="s4">= </span><span class="s1">tls_version</span><span class="s4">[</span><span class="s6">1</span><span class="s4">:-</span><span class="s6">1</span><span class="s4">].</span><span class="s1">split</span><span class="s4">(</span><span class="s5">&quot;,&quot;</span><span class="s4">)</span>
            <span class="s3">for </span><span class="s1">tls_ver </span><span class="s3">in </span><span class="s1">tls_vers</span><span class="s4">:</span>
                <span class="s1">tls_version </span><span class="s4">= </span><span class="s1">tls_ver</span><span class="s4">.</span><span class="s1">strip</span><span class="s4">()</span>
                <span class="s3">if </span><span class="s1">tls_version </span><span class="s4">== </span><span class="s5">&quot;&quot;</span><span class="s4">:</span>
                    <span class="s3">continue</span>
                <span class="s3">if </span><span class="s1">tls_version </span><span class="s3">in </span><span class="s1">tls_versions</span><span class="s4">:</span>
                    <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                        <span class="s1">DUPLICATED_IN_LIST_ERROR</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span>
                            <span class="s1">list</span><span class="s4">=</span><span class="s5">&quot;tls_versions&quot;</span><span class="s4">, </span><span class="s1">value</span><span class="s4">=</span><span class="s1">tls_version</span>
                        <span class="s4">)</span>
                    <span class="s4">)</span>
                <span class="s1">tls_versions</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">tls_version</span><span class="s4">)</span>
            <span class="s3">if </span><span class="s1">tls_vers </span><span class="s4">== [</span><span class="s5">&quot;TLSv1.3&quot;</span><span class="s4">] </span><span class="s3">and not </span><span class="s1">TLS_V1_3_SUPPORTED</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                    <span class="s1">TLS_VER_NO_SUPPORTED</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">tls_version</span><span class="s4">, </span><span class="s1">TLS_VERSIONS</span><span class="s4">)</span>
                <span class="s4">)</span>
        <span class="s3">elif </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">tls_version</span><span class="s4">, </span><span class="s1">list</span><span class="s4">):</span>
            <span class="s3">if not </span><span class="s1">tls_version</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                    <span class="s5">&quot;At least one TLS protocol version must be specified in &quot;</span>
                    <span class="s5">&quot;'tls_versions' list&quot;</span>
                <span class="s4">)</span>
            <span class="s3">for </span><span class="s1">tls_ver </span><span class="s3">in </span><span class="s1">tls_version</span><span class="s4">:</span>
                <span class="s3">if </span><span class="s1">tls_ver </span><span class="s3">in </span><span class="s1">tls_versions</span><span class="s4">:</span>
                    <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                        <span class="s1">DUPLICATED_IN_LIST_ERROR</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span>
                            <span class="s1">list</span><span class="s4">=</span><span class="s5">&quot;tls_versions&quot;</span><span class="s4">, </span><span class="s1">value</span><span class="s4">=</span><span class="s1">tls_ver</span>
                        <span class="s4">)</span>
                    <span class="s4">)</span>
                <span class="s1">tls_versions</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">tls_ver</span><span class="s4">)</span>
        <span class="s3">elif </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">tls_version</span><span class="s4">, </span><span class="s1">set</span><span class="s4">):</span>
            <span class="s3">for </span><span class="s1">tls_ver </span><span class="s3">in </span><span class="s1">tls_version</span><span class="s4">:</span>
                <span class="s1">tls_versions</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">tls_ver</span><span class="s4">)</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                <span class="s5">&quot;tls_versions should be a list with one or more of versions &quot;</span>
                <span class="s5">f&quot;in </span><span class="s3">{</span><span class="s5">', '</span><span class="s4">.</span><span class="s1">join</span><span class="s4">(</span><span class="s1">TLS_VERSIONS</span><span class="s4">)</span><span class="s3">}</span><span class="s5">. found: '</span><span class="s3">{</span><span class="s1">tls_versions</span><span class="s3">}</span><span class="s5">'&quot;</span>
            <span class="s4">)</span>

        <span class="s3">if not </span><span class="s1">tls_versions</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span>
                <span class="s5">&quot;At least one TLS protocol version must be specified &quot;</span>
                <span class="s5">&quot;in 'tls_versions' list when this option is given&quot;</span>
            <span class="s4">)</span>

        <span class="s1">use_tls_versions </span><span class="s4">= []</span>
        <span class="s1">unacceptable_tls_versions </span><span class="s4">= []</span>
        <span class="s1">invalid_tls_versions </span><span class="s4">= []</span>
        <span class="s3">for </span><span class="s1">tls_ver </span><span class="s3">in </span><span class="s1">tls_versions</span><span class="s4">:</span>
            <span class="s3">if </span><span class="s1">tls_ver </span><span class="s3">in </span><span class="s1">TLS_VERSIONS</span><span class="s4">:</span>
                <span class="s1">use_tls_versions</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">tls_ver</span><span class="s4">)</span>
            <span class="s3">if </span><span class="s1">tls_ver </span><span class="s3">in </span><span class="s1">UNACCEPTABLE_TLS_VERSIONS</span><span class="s4">:</span>
                <span class="s1">unacceptable_tls_versions</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">tls_ver</span><span class="s4">)</span>
            <span class="s3">else</span><span class="s4">:</span>
                <span class="s1">invalid_tls_versions</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">tls_ver</span><span class="s4">)</span>

        <span class="s3">if </span><span class="s1">use_tls_versions</span><span class="s4">:</span>
            <span class="s3">if </span><span class="s1">use_tls_versions </span><span class="s4">== [</span><span class="s5">&quot;TLSv1.3&quot;</span><span class="s4">] </span><span class="s3">and not </span><span class="s1">TLS_V1_3_SUPPORTED</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">NotSupportedError</span><span class="s4">(</span>
                    <span class="s1">TLS_VER_NO_SUPPORTED</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">tls_version</span><span class="s4">, </span><span class="s1">TLS_VERSIONS</span><span class="s4">)</span>
                <span class="s4">)</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_tls_versions </span><span class="s4">= </span><span class="s1">use_tls_versions</span>
        <span class="s3">elif </span><span class="s1">unacceptable_tls_versions</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">NotSupportedError</span><span class="s4">(</span>
                <span class="s1">TLS_VERSION_UNACCEPTABLE_ERROR</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span>
                    <span class="s1">unacceptable_tls_versions</span><span class="s4">, </span><span class="s1">TLS_VERSIONS</span>
                <span class="s4">)</span>
            <span class="s4">)</span>
        <span class="s3">elif </span><span class="s1">invalid_tls_versions</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">AttributeError</span><span class="s4">(</span><span class="s1">TLS_VERSION_ERROR</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">tls_ver</span><span class="s4">, </span><span class="s1">TLS_VERSIONS</span><span class="s4">))</span>

    <span class="s4">@</span><span class="s1">staticmethod</span>
    <span class="s3">def </span><span class="s1">_validate_callable</span><span class="s4">(</span>
        <span class="s1">option_name</span><span class="s4">: </span><span class="s1">str</span><span class="s4">, </span><span class="s1">callback</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Callable</span><span class="s4">], </span><span class="s1">num_args</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">0</span>
    <span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Validates if it's a Python callable. 
 
         Args: 
             option_name (str): Connection option name. 
             callback (str or callable): The fully qualified path to the callable or 
                                         a callable. 
             num_args (int): Number of positional arguments allowed. 
 
        Raises: 
             ProgrammingError: If `callback` is not valid or wrong number of positional 
                               arguments. 
 
        .. versionadded:: 8.2.0 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">callback</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
            <span class="s3">try</span><span class="s4">:</span>
                <span class="s1">callback </span><span class="s4">= </span><span class="s1">import_object</span><span class="s4">(</span><span class="s1">callback</span><span class="s4">)</span>
            <span class="s3">except </span><span class="s1">ValueError </span><span class="s3">as </span><span class="s1">err</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span><span class="s5">f&quot;</span><span class="s3">{</span><span class="s1">err</span><span class="s3">}</span><span class="s5">&quot;</span><span class="s4">) </span><span class="s3">from </span><span class="s1">err</span>

        <span class="s3">if not </span><span class="s1">callable</span><span class="s4">(</span><span class="s1">callback</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span><span class="s5">f&quot;Expected a callable for '</span><span class="s3">{</span><span class="s1">option_name</span><span class="s3">}</span><span class="s5">'&quot;</span><span class="s4">)</span>

        <span class="s0"># Check if the callable signature has &lt;num_args&gt; positional arguments</span>
        <span class="s1">num_params </span><span class="s4">= </span><span class="s1">len</span><span class="s4">(</span><span class="s1">signature</span><span class="s4">(</span><span class="s1">callback</span><span class="s4">).</span><span class="s1">parameters</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">num_params </span><span class="s4">!= </span><span class="s1">num_args</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
                <span class="s5">f&quot;'</span><span class="s3">{</span><span class="s1">option_name</span><span class="s3">}</span><span class="s5">' requires </span><span class="s3">{</span><span class="s1">num_args</span><span class="s3">} </span><span class="s5">positional argument, but the &quot;</span>
                <span class="s5">f&quot;callback provided has </span><span class="s3">{</span><span class="s1">num_params</span><span class="s3">}</span><span class="s5">&quot;</span>
            <span class="s4">)</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">def </span><span class="s1">connection_id</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;MySQL connection ID.&quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">user</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;User used while connecting to MySQL.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_user</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">server_host</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;MySQL server IP address or name.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_host</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">server_port</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; int</span><span class="s4">:</span>
        <span class="s2">&quot;MySQL server TCP/IP port.&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_port</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">unix_socket</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">]:</span>
        <span class="s2">&quot;MySQL Unix socket file location.&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_unix_socket</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">database</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Get the current database.&quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
            <span class="s5">&quot;The use of async properties are not supported by Python. &quot;</span>
            <span class="s5">&quot;Use `await get_database()` to get the database instead&quot;</span>
        <span class="s4">)</span>

    <span class="s4">@</span><span class="s1">database</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">database</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set the current database.&quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
            <span class="s5">&quot;The use of async properties are not supported by Python. &quot;</span>
            <span class="s5">&quot;Use `await set_database(name)` to set the database instead&quot;</span>
        <span class="s4">)</span>

    <span class="s3">async def </span><span class="s1">get_database</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Get the current database.&quot;&quot;&quot;</span>
        <span class="s1">result </span><span class="s4">= </span><span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">info_query</span><span class="s4">(</span><span class="s5">&quot;SELECT DATABASE()&quot;</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">result</span><span class="s4">[</span><span class="s6">0</span><span class="s4">]  </span><span class="s0"># type: ignore[return-value]</span>

    <span class="s3">async def </span><span class="s1">set_database</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set the current database.&quot;&quot;&quot;</span>
        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">cmd_query</span><span class="s4">(</span><span class="s5">f&quot;USE </span><span class="s3">{</span><span class="s1">value</span><span class="s3">}</span><span class="s5">&quot;</span><span class="s4">)</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">can_consume_results</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Returns whether to consume results&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_consume_results</span>

    <span class="s4">@</span><span class="s1">can_consume_results</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">can_consume_results</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">bool</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set if can consume results.&quot;&quot;&quot;</span>
        <span class="s3">assert </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">value</span><span class="s4">, </span><span class="s1">bool</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_consume_results </span><span class="s4">= </span><span class="s1">value</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">in_transaction</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;MySQL session has started a transaction.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_in_transaction</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">loop</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; asyncio</span><span class="s4">.</span><span class="s1">AbstractEventLoop</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Return the event loop.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_loop</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">is_secure</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Return True if is a secure connection.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_ssl_active </span><span class="s3">or </span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_unix_socket </span><span class="s3">is not None and </span><span class="s1">IS_POSIX</span><span class="s4">)</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">query_attrs</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; List</span><span class="s4">[</span><span class="s1">Tuple</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">BinaryProtocolType</span><span class="s4">]]:</span>
        <span class="s2">&quot;&quot;&quot;Returns query attributes list.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">list</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_query_attrs</span><span class="s4">.</span><span class="s1">items</span><span class="s4">())</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">have_next_result</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Return if have next result.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_have_next_result</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">autocommit</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Get whether autocommit is on or off.&quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
            <span class="s5">&quot;The use of async properties are not supported by Python. &quot;</span>
            <span class="s5">&quot;Use `await get_autocommit()` to get the autocommit instead&quot;</span>
        <span class="s4">)</span>

    <span class="s4">@</span><span class="s1">autocommit</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">autocommit</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">bool</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Toggle autocommit.&quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
            <span class="s5">&quot;The use of async properties are not supported by Python. &quot;</span>
            <span class="s5">&quot;Use `await set_autocommit(value)` to set the autocommit instead&quot;</span>
        <span class="s4">)</span>

    <span class="s3">async def </span><span class="s1">get_autocommit</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Get whether autocommit is on or off.&quot;&quot;&quot;</span>
        <span class="s1">value </span><span class="s4">= </span><span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">info_query</span><span class="s4">(</span><span class="s5">&quot;SELECT @@session.autocommit&quot;</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">value</span><span class="s4">[</span><span class="s6">0</span><span class="s4">] == </span><span class="s6">1</span>

    <span class="s3">async def </span><span class="s1">set_autocommit</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">bool</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Toggle autocommit.&quot;&quot;&quot;</span>
        <span class="s1">switch </span><span class="s4">= </span><span class="s5">&quot;ON&quot; </span><span class="s3">if </span><span class="s1">value </span><span class="s3">else </span><span class="s5">&quot;OFF&quot;</span>
        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">cmd_query</span><span class="s4">(</span><span class="s5">f&quot;SET @@session.autocommit = </span><span class="s3">{</span><span class="s1">switch</span><span class="s3">}</span><span class="s5">&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_autocommit </span><span class="s4">= </span><span class="s1">value</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">time_zone</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Gets the current time zone.&quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
            <span class="s5">&quot;The use of async properties are not supported by Python. &quot;</span>
            <span class="s5">&quot;Use `await get_time_zone()` to get the time zone instead&quot;</span>
        <span class="s4">)</span>

    <span class="s4">@</span><span class="s1">time_zone</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">time_zone</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Sets the time zone.&quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
            <span class="s5">&quot;The use of async properties are not supported by Python. &quot;</span>
            <span class="s5">&quot;Use `await get_autocommit(value)` to get the autocommit instead&quot;</span>
        <span class="s4">)</span>

    <span class="s3">async def </span><span class="s1">get_time_zone</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Gets the current time zone.&quot;&quot;&quot;</span>
        <span class="s1">value </span><span class="s4">= </span><span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">info_query</span><span class="s4">(</span><span class="s5">&quot;SELECT @@session.time_zone&quot;</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">value</span><span class="s4">[</span><span class="s6">0</span><span class="s4">]  </span><span class="s0"># type: ignore[return-value]</span>

    <span class="s3">async def </span><span class="s1">set_time_zone</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Sets the time zone.&quot;&quot;&quot;</span>
        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">cmd_query</span><span class="s4">(</span><span class="s5">f&quot;SET @@session.time_zone = '</span><span class="s3">{</span><span class="s1">value</span><span class="s3">}</span><span class="s5">'&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_time_zone </span><span class="s4">= </span><span class="s1">value</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">async def </span><span class="s1">sql_mode</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Gets the SQL mode.&quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
            <span class="s5">&quot;The use of async properties are not supported by Python. &quot;</span>
            <span class="s5">&quot;Use `await get_sql_mode()` to get the SQL mode instead&quot;</span>
        <span class="s4">)</span>

    <span class="s4">@</span><span class="s1">sql_mode</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">async def </span><span class="s1">sql_mode</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Sequence</span><span class="s4">[</span><span class="s1">int</span><span class="s4">]]) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Sets the SQL mode. 
 
        This method sets the SQL Mode for the current connection. The value 
        argument can be either a string with comma separate mode names, or 
        a sequence of mode names. 
 
        It is good practice to use the constants class `SQLMode`: 
        ``` 
        &gt;&gt;&gt; from mysql.connector.constants import SQLMode 
        &gt;&gt;&gt; cnx.sql_mode = [SQLMode.NO_ZERO_DATE, SQLMode.REAL_AS_FLOAT] 
        ``` 
        &quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
            <span class="s5">&quot;The use of async properties are not supported by Python. &quot;</span>
            <span class="s5">&quot;Use `await set_sql_mode(value)` to set the SQL mode instead&quot;</span>
        <span class="s4">)</span>

    <span class="s3">async def </span><span class="s1">get_sql_mode</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Gets the SQL mode.&quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_sql_mode </span><span class="s3">is None</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_sql_mode </span><span class="s4">= (</span><span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">info_query</span><span class="s4">(</span><span class="s5">&quot;SELECT @@session.sql_mode&quot;</span><span class="s4">))[</span><span class="s6">0</span><span class="s4">]</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_sql_mode</span>

    <span class="s3">async def </span><span class="s1">set_sql_mode</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Sequence</span><span class="s4">[</span><span class="s1">int</span><span class="s4">]]) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Sets the SQL mode. 
 
        This method sets the SQL Mode for the current connection. The value 
        argument can be either a string with comma separate mode names, or 
        a sequence of mode names. 
 
        It is good practice to use the constants class `SQLMode`: 
        ``` 
        &gt;&gt;&gt; from mysql.connector.constants import SQLMode 
        &gt;&gt;&gt; cnx.sql_mode = [SQLMode.NO_ZERO_DATE, SQLMode.REAL_AS_FLOAT] 
        ``` 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">value</span><span class="s4">, (</span><span class="s1">list</span><span class="s4">, </span><span class="s1">tuple</span><span class="s4">)):</span>
            <span class="s1">value </span><span class="s4">= </span><span class="s5">&quot;,&quot;</span><span class="s4">.</span><span class="s1">join</span><span class="s4">(</span><span class="s1">value</span><span class="s4">)</span>
        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">cmd_query</span><span class="s4">(</span><span class="s5">f&quot;SET @@session.sql_mode = '</span><span class="s3">{</span><span class="s1">value</span><span class="s3">}</span><span class="s5">'&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_sql_mode </span><span class="s4">= </span><span class="s1">value</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">get_warnings</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Get whether this connection retrieves warnings automatically. 
 
        This method returns whether this connection retrieves warnings automatically. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_get_warnings</span>

    <span class="s4">@</span><span class="s1">get_warnings</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">get_warnings</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">bool</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set whether warnings should be automatically retrieved. 
 
        The toggle-argument must be a boolean. When True, cursors for this connection 
        will retrieve information about warnings (if any). 
 
        Raises: 
            ValueError: When the value is not a bool type. 
        &quot;&quot;&quot;</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">value</span><span class="s4">, </span><span class="s1">bool</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;Expected a boolean type&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_get_warnings </span><span class="s4">= </span><span class="s1">value</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">raise_on_warnings</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Get whether this connection raises an error on warnings. 
 
        This method returns whether this connection will raise errors when MySQL 
        reports warnings. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_raise_on_warnings</span>

    <span class="s4">@</span><span class="s1">raise_on_warnings</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">raise_on_warnings</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">bool</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set whether warnings raise an error. 
 
        The toggle-argument must be a boolean. When True, cursors for this connection 
        will raise an error when MySQL reports warnings. 
 
        Raising on warnings implies retrieving warnings automatically. 
        In other words: warnings will be set to True. If set to False, warnings will 
        be also set to False. 
 
        Raises: 
            ValueError: When the value is not a bool type. 
        &quot;&quot;&quot;</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">value</span><span class="s4">, </span><span class="s1">bool</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;Expected a boolean type&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_raise_on_warnings </span><span class="s4">= </span><span class="s1">value</span>
        <span class="s0"># Don't disable warning retrieval if raising explicitly disabled</span>
        <span class="s3">if </span><span class="s1">value</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_get_warnings </span><span class="s4">= </span><span class="s1">value</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">unread_result</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Get whether there is an unread result. 
 
        This method is used by cursors to check whether another cursor still needs to 
        retrieve its result set. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_unread_result</span>

    <span class="s4">@</span><span class="s1">unread_result</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">unread_result</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">bool</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set whether there is an unread result. 
 
        This method is used by cursors to let other cursors know there is still a 
        result set that needs to be retrieved. 
 
        Raises: 
            ValueError: When the value is not a bool type. 
        &quot;&quot;&quot;</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">value</span><span class="s4">, </span><span class="s1">bool</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;Expected a boolean type&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_unread_result </span><span class="s4">= </span><span class="s1">value</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">collation</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Returns the collation for current connection. 
 
        This property returns the collation name of the current connection. 
        The server is queried when the connection is active. If not connected, 
        the configured collation name is returned. 
 
        Returns a string. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">collation</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">charset</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Return the character set for current connection. 
 
        This property returns the character set name of the current connection. 
        The server is queried when the connection is active. 
        If not connected, the configured character set name is returned. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">name</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">charset_id</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; int</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;The charset ID utilized during the connection phase. 
 
        If the charset ID hasn't been set, the default charset ID is returned. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">charset_id</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">_charset</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Charset</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;The charset object encapsulates charset and collation information.&quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">__charset </span><span class="s3">is None</span><span class="s4">:</span>
            <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_server_info </span><span class="s3">is None</span><span class="s4">:</span>
                <span class="s0"># We mustn't set `_charset`  since we still don't know</span>
                <span class="s0"># the server version. We temporarily return the default</span>
                <span class="s0"># charset for undefined scenarios - eventually, the server</span>
                <span class="s0"># info will be available and `_charset` (data class) will be set.</span>
                <span class="s3">return </span><span class="s1">charsets</span><span class="s4">.</span><span class="s1">get_by_id</span><span class="s4">(</span><span class="s1">MYSQL_DEFAULT_CHARSET_ID_57</span><span class="s4">)</span>

            <span class="s1">self</span><span class="s4">.</span><span class="s1">__charset </span><span class="s4">= </span><span class="s1">charsets</span><span class="s4">.</span><span class="s1">get_by_id</span><span class="s4">(</span>
                <span class="s4">(</span>
                    <span class="s1">MYSQL_DEFAULT_CHARSET_ID_57</span>
                    <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_server_info</span><span class="s4">.</span><span class="s1">version_tuple </span><span class="s4">&lt; (</span><span class="s6">8</span><span class="s4">, </span><span class="s6">0</span><span class="s4">)</span>
                    <span class="s3">else </span><span class="s1">MYSQL_DEFAULT_CHARSET_ID_80</span>
                <span class="s4">)</span>
            <span class="s4">)</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">__charset</span>

    <span class="s4">@</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">_charset</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">Charset</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;The charset object encapsulates charset and collation information.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">__charset </span><span class="s4">= </span><span class="s1">value</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">python_charset</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Return the Python character set for current connection. 
 
        This property returns the character set name of the current connection. 
        Note that, unlike property charset, this checks if the previously set 
        character set is supported by Python and if not, it returns the equivalent 
        character set that Python supports. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset </span><span class="s3">is None or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">name </span><span class="s3">in </span><span class="s4">(</span>
            <span class="s5">&quot;utf8mb4&quot;</span><span class="s4">,</span>
            <span class="s5">&quot;utf8mb3&quot;</span><span class="s4">,</span>
            <span class="s5">&quot;binary&quot;</span><span class="s4">,</span>
        <span class="s4">):</span>
            <span class="s3">return </span><span class="s5">&quot;utf8&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">name</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">def </span><span class="s1">_add_default_conn_attrs</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Add the default connection attributes.&quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">_execute_query</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">query</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; ResultType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Execute a query. 
 
        This method simply calls cmd_query() after checking for unread result. If there 
        are still unread result, an InterfaceError is raised. Otherwise whatever 
        cmd_query() returns is returned. 
        &quot;&quot;&quot;</span>

    <span class="s3">async def </span><span class="s1">_post_connection</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Executes commands after connection has been established. 
 
        This method executes commands after the connection has been established. 
        Some setting like autocommit, character set, and SQL mode are set using this 
        method. 
        &quot;&quot;&quot;</span>
        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">set_charset_collation</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">=</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">charset_id</span><span class="s4">)</span>
        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">set_autocommit</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_autocommit</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_time_zone</span><span class="s4">:</span>
            <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">set_time_zone</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_time_zone</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_sql_mode</span><span class="s4">:</span>
            <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">set_sql_mode</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_sql_mode</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_init_command</span><span class="s4">:</span>
            <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_execute_query</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_init_command</span><span class="s4">)</span>

    <span class="s3">async def </span><span class="s1">set_charset_collation</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">, </span><span class="s1">charset</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Union</span><span class="s4">[</span><span class="s1">int</span><span class="s4">, </span><span class="s1">str</span><span class="s4">]] = </span><span class="s3">None</span><span class="s4">, </span><span class="s1">collation</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">] = </span><span class="s3">None</span>
    <span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set the character set and collation for the current connection. 
 
        This method sets the character set and collation to be used for the current 
        connection. The charset argument can be either the name of a character set as 
        a string, or the numerical equivalent as defined in constants.CharacterSet. 
 
        When the collation is not given, the default will be looked up and used. 
 
        Args: 
            charset: Can be either the name of a character set, or the numerical 
                     equivalent as defined in `constants.CharacterSet`. 
            collation: When collation is `None`, the default collation for the 
                       character set is used. 
 
        Examples: 
            The following will set the collation for the latin1 character set to 
            `latin1_general_ci`: 
            ``` 
            &gt;&gt;&gt; cnx = mysql.connector.connect(user='scott') 
            &gt;&gt;&gt; cnx.set_charset_collation('latin1', 'latin1_general_ci') 
            ``` 
        &quot;&quot;&quot;</span>
        <span class="s1">err_msg </span><span class="s4">= </span><span class="s5">&quot;{} should be either integer, string or None&quot;</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">, (</span><span class="s1">int</span><span class="s4">, </span><span class="s1">str</span><span class="s4">)) </span><span class="s3">and </span><span class="s1">charset </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s1">err_msg</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s5">&quot;charset&quot;</span><span class="s4">))</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">collation</span><span class="s4">, </span><span class="s1">str</span><span class="s4">) </span><span class="s3">and </span><span class="s1">collation </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;collation should be either string or None&quot;</span><span class="s4">)</span>

        <span class="s3">if </span><span class="s1">charset </span><span class="s3">and </span><span class="s1">collation</span><span class="s4">:</span>
            <span class="s1">charset_str</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= (</span>
                <span class="s1">charsets</span><span class="s4">.</span><span class="s1">get_by_id</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">).</span><span class="s1">name</span>
                <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">, </span><span class="s1">int</span><span class="s4">)</span>
                <span class="s3">else </span><span class="s1">charset</span>
            <span class="s4">)</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_charset </span><span class="s4">= </span><span class="s1">charsets</span><span class="s4">.</span><span class="s1">get_by_name_and_collation</span><span class="s4">(</span><span class="s1">charset_str</span><span class="s4">, </span><span class="s1">collation</span><span class="s4">)</span>
        <span class="s3">elif </span><span class="s1">charset</span><span class="s4">:</span>
            <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">, </span><span class="s1">int</span><span class="s4">):</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_charset </span><span class="s4">= </span><span class="s1">charsets</span><span class="s4">.</span><span class="s1">get_by_id</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">)</span>
            <span class="s3">elif </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_charset </span><span class="s4">= </span><span class="s1">charsets</span><span class="s4">.</span><span class="s1">get_by_name</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">)</span>
            <span class="s3">else</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s1">err_msg</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s5">&quot;charset&quot;</span><span class="s4">))</span>
        <span class="s3">elif </span><span class="s1">collation</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_charset </span><span class="s4">= </span><span class="s1">charsets</span><span class="s4">.</span><span class="s1">get_by_collation</span><span class="s4">(</span><span class="s1">collation</span><span class="s4">)</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">charset </span><span class="s4">= </span><span class="s1">DEFAULT_CONFIGURATION</span><span class="s4">[</span><span class="s5">&quot;charset&quot;</span><span class="s4">]</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_charset </span><span class="s4">= </span><span class="s1">charsets</span><span class="s4">.</span><span class="s1">get_by_name</span><span class="s4">(</span><span class="s1">charset</span><span class="s4">)  </span><span class="s0"># type: ignore[arg-type]</span>

        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">cmd_query</span><span class="s4">(</span>
            <span class="s5">f&quot;SET NAMES '</span><span class="s3">{</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">name</span><span class="s3">}</span><span class="s5">' COLLATE '</span><span class="s3">{</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">collation</span><span class="s3">}</span><span class="s5">'&quot;</span>
        <span class="s4">)</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">converter</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">converter</span><span class="s4">.</span><span class="s1">set_charset</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">name</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">isset_client_flag</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">flag</span><span class="s4">: </span><span class="s1">int</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Checks if a client flag is set. 
 
        Returns: 
            `True` if the client flag was set, `False` otherwise. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_client_flags </span><span class="s4">&amp; </span><span class="s1">flag</span><span class="s4">) &gt; </span><span class="s6">0</span>

    <span class="s3">def </span><span class="s1">set_allow_local_infile_in_path</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">path</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set the path that user can upload files. 
 
        Args: 
            path (str): Path that user can upload files. 
        &quot;&quot;&quot;</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">_allow_local_infile_in_path </span><span class="s4">= </span><span class="s1">path</span>

    <span class="s3">def </span><span class="s1">get_self</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; MySQLConnectionAbstract</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Return self for weakref.proxy. 
 
        This method is used when the original object is needed when using 
        weakref.proxy. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span>

    <span class="s3">def </span><span class="s1">get_server_version</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">Tuple</span><span class="s4">[</span><span class="s1">int</span><span class="s4">, ...]]:</span>
        <span class="s2">&quot;&quot;&quot;Gets the MySQL version. 
 
        Returns: 
            The MySQL server version as a tuple. If not previously connected, it will 
            return `None`. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_server_info </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_server_info</span><span class="s4">.</span><span class="s1">version  </span><span class="s0"># type: ignore[return-value]</span>
        <span class="s3">return None</span>

    <span class="s3">def </span><span class="s1">get_server_info</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Gets the original MySQL version information. 
 
        Returns: 
            The original MySQL server as text. If not previously connected, it will 
            return `None`. 
        &quot;&quot;&quot;</span>
        <span class="s3">try</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_handshake</span><span class="s4">[</span><span class="s5">&quot;server_version_original&quot;</span><span class="s4">]  </span><span class="s0"># type: ignore[return-value]</span>
        <span class="s3">except </span><span class="s4">(</span><span class="s1">TypeError</span><span class="s4">, </span><span class="s1">KeyError</span><span class="s4">):</span>
            <span class="s3">return None</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">def </span><span class="s1">is_socket_connected</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Reports whether the socket is connected. 
 
        Instead of ping the server like ``is_connected()``, it only checks if the 
        socket connection flag is set. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">is_connected</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Reports whether the connection to MySQL Server is available. 
 
        This method checks whether the connection to MySQL is available. 
        It is similar to ``ping()``, but unlike the ``ping()`` method, either `True` 
        or `False` is returned and no exception is raised. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">ping</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">, </span><span class="s1">reconnect</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">, </span><span class="s1">attempts</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">1</span><span class="s4">, </span><span class="s1">delay</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">0</span>
    <span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Check availability of the MySQL server. 
 
        When reconnect is set to `True`, one or more attempts are made to try to 
        reconnect to the MySQL server using the ``reconnect()`` method. 
 
        ``delay`` is the number of seconds to wait between each retry. 
 
        When the connection is not available, an InterfaceError is raised. Use the 
        ``is_connected()`` method if you just want to check the connection without 
        raising an error. 
 
        Raises: 
            InterfaceError: On errors. 
        &quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">set_client_flags</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">flags</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">int</span><span class="s4">, </span><span class="s1">Sequence</span><span class="s4">[</span><span class="s1">int</span><span class="s4">]]) </span><span class="s1">-&gt; int</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set the client flags. 
 
        The flags-argument can be either an int or a list (or tuple) of ClientFlag 
        values. If it is an integer, it will set client_flags to flags as is. 
        If flags is a list or tuple, each flag will be set or unset when it's negative. 
 
        set_client_flags([ClientFlag.FOUND_ROWS,-ClientFlag.LONG_FLAG]) 
 
        Raises: 
            ProgrammingError: When the flags argument is not a set or an integer bigger 
                              than 0. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">flags</span><span class="s4">, </span><span class="s1">int</span><span class="s4">) </span><span class="s3">and </span><span class="s1">flags </span><span class="s4">&gt; </span><span class="s6">0</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_client_flags </span><span class="s4">= </span><span class="s1">flags</span>
        <span class="s3">elif </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">flags</span><span class="s4">, (</span><span class="s1">tuple</span><span class="s4">, </span><span class="s1">list</span><span class="s4">)):</span>
            <span class="s3">for </span><span class="s1">flag </span><span class="s3">in </span><span class="s1">flags</span><span class="s4">:</span>
                <span class="s3">if </span><span class="s1">flag </span><span class="s4">&lt; </span><span class="s6">0</span><span class="s4">:</span>
                    <span class="s1">self</span><span class="s4">.</span><span class="s1">_client_flags </span><span class="s4">&amp;= ~</span><span class="s1">abs</span><span class="s4">(</span><span class="s1">flag</span><span class="s4">)</span>
                <span class="s3">else</span><span class="s4">:</span>
                    <span class="s1">self</span><span class="s4">.</span><span class="s1">_client_flags </span><span class="s4">|= </span><span class="s1">flag</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span><span class="s5">&quot;set_client_flags expect integer (&gt;0) or set&quot;</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_client_flags</span>

    <span class="s3">def </span><span class="s1">set_converter_class</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">convclass</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Type</span><span class="s4">[</span><span class="s1">MySQLConverter</span><span class="s4">]]) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Set the converter class to be used. 
 
        This should be a class overloading methods and members of 
        conversion.MySQLConverter. 
 
        Raises: 
            TypeError: When the class is not a subclass of `conversion.MySQLConverter`. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">convclass </span><span class="s3">and </span><span class="s1">issubclass</span><span class="s4">(</span><span class="s1">convclass</span><span class="s4">, </span><span class="s1">MySQLConverterBase</span><span class="s4">):</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_converter_class </span><span class="s4">= </span><span class="s1">convclass</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">converter </span><span class="s4">= </span><span class="s1">convclass</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_charset</span><span class="s4">.</span><span class="s1">name</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_use_unicode</span><span class="s4">)</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">converter</span><span class="s4">.</span><span class="s1">str_fallback </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_converter_str_fallback</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span>
                <span class="s5">&quot;Converter class should be a subclass of conversion.MySQLConverter&quot;</span>
            <span class="s4">)</span>

    <span class="s3">def </span><span class="s1">query_attrs_append</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">Tuple</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">BinaryProtocolType</span><span class="s4">]) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Add element to the query attributes list on the connector's side. 
 
        If an element in the query attributes list already matches 
        the attribute name provided, the new element will NOT be added. 
 
        Args: 
            value: key-value as a 2-tuple. 
        &quot;&quot;&quot;</span>
        <span class="s1">attr_name</span><span class="s4">, </span><span class="s1">attr_value </span><span class="s4">= </span><span class="s1">value</span>
        <span class="s3">if </span><span class="s1">attr_name </span><span class="s3">not in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_query_attrs</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_query_attrs</span><span class="s4">[</span><span class="s1">attr_name</span><span class="s4">] = </span><span class="s1">attr_value</span>

    <span class="s3">def </span><span class="s1">query_attrs_remove</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">name</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; BinaryProtocolType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Remove element by name from the query attributes list. 
 
        If no match, `None` is returned, else the corresponding value is returned. 
 
        Args: 
            name: key name. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_query_attrs</span><span class="s4">.</span><span class="s1">pop</span><span class="s4">(</span><span class="s1">name</span><span class="s4">, </span><span class="s3">None</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">query_attrs_clear</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Clears query attributes list on the connector's side.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_query_attrs </span><span class="s4">= {}</span>

    <span class="s3">async def </span><span class="s1">handle_unread_result</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Handle unread result. 
 
        Consume pending results if is configured for it. 
 
        Raises: 
            InternalError: When there are pending results and they were not consumed. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_consume_results</span><span class="s4">:</span>
            <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">consume_results</span><span class="s4">()</span>
        <span class="s3">elif </span><span class="s1">self</span><span class="s4">.</span><span class="s1">unread_result</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">InternalError</span><span class="s4">(</span><span class="s5">&quot;Unread result found&quot;</span><span class="s4">)</span>

    <span class="s3">async def </span><span class="s1">consume_results</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Consume pending results.&quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">unread_result</span><span class="s4">:</span>
            <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">get_rows</span><span class="s4">()</span>

    <span class="s3">async def </span><span class="s1">info_query</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">query</span><span class="s4">: </span><span class="s1">StrOrBytes</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">RowType</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Send a query which only returns 1 row.&quot;&quot;&quot;</span>
        <span class="s3">async with await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">cursor</span><span class="s4">(</span><span class="s1">buffered</span><span class="s4">=</span><span class="s3">True</span><span class="s4">) </span><span class="s3">as </span><span class="s1">cursor</span><span class="s4">:</span>
            <span class="s3">await </span><span class="s1">cursor</span><span class="s4">.</span><span class="s1">execute</span><span class="s4">(</span><span class="s1">query</span><span class="s4">)</span>
            <span class="s3">return await </span><span class="s1">cursor</span><span class="s4">.</span><span class="s1">fetchone</span><span class="s4">()</span>

    <span class="s3">def </span><span class="s1">add_cursor</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">cursor</span><span class="s4">: </span><span class="s1">MySQLCursorAbstract</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Add cursor to the weakref set.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_cursors</span><span class="s4">.</span><span class="s1">add</span><span class="s4">(</span><span class="s1">cursor</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">remove_cursor</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">cursor</span><span class="s4">: </span><span class="s1">MySQLCursorAbstract</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Remove cursor from the weakref set.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_cursors</span><span class="s4">.</span><span class="s1">remove</span><span class="s4">(</span><span class="s1">cursor</span><span class="s4">)</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">connect</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Connect to the MySQL server.&quot;&quot;&quot;</span>

    <span class="s3">async def </span><span class="s1">reconnect</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">attempts</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">1</span><span class="s4">, </span><span class="s1">delay</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">0</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Attempts to reconnect to the MySQL server. 
 
        The argument `attempts` should be the number of times a reconnect is tried. 
        The `delay` argument is the number of seconds to wait between each retry. 
 
        You may want to set the number of attempts higher and use delay when you expect 
        the MySQL server to be down for maintenance or when you expect the network to 
        be temporary unavailable. 
 
        Args: 
            attempts: Number of attempts to make when reconnecting. 
            delay: Use it (defined in seconds) if you want to wait between each retry. 
 
        Raises: 
            InterfaceError: When reconnection fails. 
        &quot;&quot;&quot;</span>
        <span class="s1">counter </span><span class="s4">= </span><span class="s6">0</span>
        <span class="s3">while </span><span class="s1">counter </span><span class="s4">!= </span><span class="s1">attempts</span><span class="s4">:</span>
            <span class="s1">counter </span><span class="s4">= </span><span class="s1">counter </span><span class="s4">+ </span><span class="s6">1</span>
            <span class="s3">try</span><span class="s4">:</span>
                <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">disconnect</span><span class="s4">()</span>
                <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">connect</span><span class="s4">()</span>
                <span class="s3">if await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">is_connected</span><span class="s4">():</span>
                    <span class="s3">break</span>
            <span class="s3">except </span><span class="s4">(</span><span class="s1">Error</span><span class="s4">, </span><span class="s1">IOError</span><span class="s4">) </span><span class="s3">as </span><span class="s1">err</span><span class="s4">:</span>
                <span class="s3">if </span><span class="s1">counter </span><span class="s4">== </span><span class="s1">attempts</span><span class="s4">:</span>
                    <span class="s1">msg </span><span class="s4">= (</span>
                        <span class="s5">f&quot;Can not reconnect to MySQL after </span><span class="s3">{</span><span class="s1">attempts</span><span class="s3">} </span><span class="s5">&quot;</span>
                        <span class="s5">f&quot;attempt(s): </span><span class="s3">{</span><span class="s1">err</span><span class="s3">}</span><span class="s5">&quot;</span>
                    <span class="s4">)</span>
                    <span class="s3">raise </span><span class="s1">InterfaceError</span><span class="s4">(</span><span class="s1">msg</span><span class="s4">) </span><span class="s3">from </span><span class="s1">err</span>
            <span class="s3">if </span><span class="s1">delay </span><span class="s4">&gt; </span><span class="s6">0</span><span class="s4">:</span>
                <span class="s3">await </span><span class="s1">asyncio</span><span class="s4">.</span><span class="s1">sleep</span><span class="s4">(</span><span class="s1">delay</span><span class="s4">)</span>

    <span class="s3">async def </span><span class="s1">shutdown</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; NoReturn</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Shuts down connection to MySQL Server. 
 
        This method closes the socket. It raises no exceptions. 
 
        Unlike `disconnect()`, `shutdown()` closes the client connection without 
        attempting to send a `QUIT` command to the server first. Thus, it will not 
        block if the connection is disrupted for some reason such as network failure. 
        &quot;&quot;&quot;</span>
        <span class="s3">raise </span><span class="s1">NotImplementedError</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">close</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Close the connection. 
 
        It closes any opened cursor associated to this connection, and closes the 
        underling socket connection. 
 
        `MySQLConnection.close()` is a synonymous for `MySQLConnection.disconnect()` 
        method name and more commonly used. 
 
        This method tries to send a `QUIT` command and close the socket. It raises 
        no exceptions. 
        &quot;&quot;&quot;</span>

    <span class="s1">disconnect</span><span class="s4">: </span><span class="s1">Callable</span><span class="s4">[[], </span><span class="s1">Any</span><span class="s4">] = </span><span class="s1">close</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cursor</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">buffered</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">raw</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">prepared</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">cursor_class</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Type</span><span class="s4">[</span><span class="s1">MySQLCursorAbstract</span><span class="s4">]] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">dictionary</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">named_tuple</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; MySQLCursorAbstract</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Instantiate and return a cursor. 
 
        By default, MySQLCursor is returned. Depending on the options while 
        connecting, a buffered and/or raw cursor is instantiated instead. 
        Also depending upon the cursor options, rows can be returned as dictionary or 
        named tuple. 
 
        It is possible to also give a custom cursor through the cursor_class 
        parameter, but it needs to be a subclass of 
        mysql.connector.aio.abstracts.MySQLCursorAbstract. 
 
        Raises: 
            ProgrammingError: When cursor_class is not a subclass of 
                              MySQLCursor. 
            ValueError: When cursor is not available. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">get_row</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">binary</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">columns</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">DescriptionType</span><span class="s4">]] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">raw</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; Tuple</span><span class="s4">[</span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">RowType</span><span class="s4">], </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">EofPacketType</span><span class="s4">]]:</span>
        <span class="s2">&quot;&quot;&quot;Get the next rows returned by the MySQL server. 
 
        This method gets one row from the result set after sending, for example, the 
        query command. The result is a tuple consisting of the row and the EOF packet. 
        If no row was available in the result set, the row data will be None. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">get_rows</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">count</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">binary</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">columns</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">DescriptionType</span><span class="s4">]] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">raw</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">bool</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">prep_stmt</span><span class="s4">: </span><span class="s1">Any </span><span class="s4">= </span><span class="s3">None</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; Tuple</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">RowType</span><span class="s4">], </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">EofPacketType</span><span class="s4">]]:</span>
        <span class="s2">&quot;&quot;&quot;Get all rows returned by the MySQL server. 
 
        This method gets all rows returned by the MySQL server after sending, for 
        example, the query command. The result is a tuple consisting of a list of rows 
        and the EOF packet. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">commit</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Commit current transaction.&quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">rollback</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Rollback current transaction.&quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_reset_connection</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Resets the session state without re-authenticating. 
 
        Reset command only works on MySQL server 5.7.3 or later. 
        The result is True for a successful reset otherwise False. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_init_db</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">database</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; OkPacketType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Change the current database. 
 
        This method changes the current (default) database by sending the INIT_DB 
        command. The result is a dictionary containing the OK packet infawaitormation. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_query</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">query</span><span class="s4">: </span><span class="s1">StrOrBytes</span><span class="s4">,</span>
        <span class="s1">raw</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">buffered</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s1">raw_as_string</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; ResultType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Send a query to the MySQL server. 
 
        This method send the query to the MySQL server and returns the result. 
 
        If there was a text result, a tuple will be returned consisting of the number 
        of columns and a list containing information about these columns. 
 
        When the query doesn't return a text result, the OK or EOF packet information 
        as dictionary will be returned. In case the result was an error, exception 
        Error will be raised. 
        &quot;&quot;&quot;</span>

    <span class="s3">async def </span><span class="s1">cmd_query_iter</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">, </span><span class="s1">statements</span><span class="s4">: </span><span class="s1">StrOrBytes</span>
    <span class="s4">) </span><span class="s1">-&gt; Generator</span><span class="s4">[</span><span class="s1">ResultType</span><span class="s4">, </span><span class="s3">None</span><span class="s4">, </span><span class="s3">None</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Send one or more statements to the MySQL server. 
 
        Similar to the cmd_query method, but instead returns a generator 
        object to iterate through results. It sends the statements to the 
        MySQL server and through the iterator you can get the results. 
 
        statement = 'SELECT 1; INSERT INTO t1 VALUES (); SELECT 2' 
        for result in await cnx.cmd_query(statement, iterate=True): 
            if 'columns' in result: 
                columns = result['columns'] 
                rows = await cnx.get_rows() 
            else: 
                # do something useful with INSERT result 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_stmt_fetch</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">statement_id</span><span class="s4">: </span><span class="s1">int</span><span class="s4">, </span><span class="s1">rows</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">1</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Fetch a MySQL statement Result Set. 
 
        This method will send the FETCH command to MySQL together with the given 
        statement id and the number of rows to fetch. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_stmt_prepare</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">, </span><span class="s1">statement</span><span class="s4">: </span><span class="s1">bytes</span>
    <span class="s4">) </span><span class="s1">-&gt; Mapping</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">int</span><span class="s4">, </span><span class="s1">List</span><span class="s4">[</span><span class="s1">DescriptionType</span><span class="s4">]]]:</span>
        <span class="s2">&quot;&quot;&quot;Prepare a MySQL statement. 
 
        This method will send the PREPARE command to MySQL together with the given 
        statement. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_stmt_execute</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">statement_id</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">int</span><span class="s4">, </span><span class="s1">CMySQLPrepStmt</span><span class="s4">],</span>
        <span class="s1">data</span><span class="s4">: </span><span class="s1">Sequence</span><span class="s4">[</span><span class="s1">BinaryProtocolType</span><span class="s4">] = (),</span>
        <span class="s1">parameters</span><span class="s4">: </span><span class="s1">Sequence </span><span class="s4">= (),</span>
        <span class="s1">flags</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">0</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">Union</span><span class="s4">[</span><span class="s1">Dict</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Any</span><span class="s4">], </span><span class="s1">Tuple</span><span class="s4">]]:</span>
        <span class="s2">&quot;&quot;&quot;Execute a prepared MySQL statement.&quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_stmt_reset</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">statement_id</span><span class="s4">: </span><span class="s1">int</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Reset data for prepared statement sent as long data. 
 
        The result is a dictionary with OK packet information. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_stmt_close</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">statement_id</span><span class="s4">: </span><span class="s1">int</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Deallocate a prepared MySQL statement. 
 
        This method deallocates the prepared statement using the statement_id. 
        Note that the MySQL server does not return anything. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_refresh</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">options</span><span class="s4">: </span><span class="s1">int</span><span class="s4">) </span><span class="s1">-&gt; OkPacketType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Send the Refresh command to the MySQL server. 
 
        This method sends the Refresh command to the MySQL server. The options 
        argument should be a bitwise value using constants.RefreshOption. 
 
        Usage example: 
           RefreshOption = mysql.connector.RefreshOption 
           refresh = RefreshOption.LOG | RefreshOption.INFO 
           cnx.cmd_refresh(refresh) 
        &quot;&quot;&quot;</span>

    <span class="s3">async def </span><span class="s1">cmd_stmt_send_long_data</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">, </span><span class="s1">statement_id</span><span class="s4">: </span><span class="s1">int</span><span class="s4">, </span><span class="s1">param_id</span><span class="s4">: </span><span class="s1">int</span><span class="s4">, </span><span class="s1">data</span><span class="s4">: </span><span class="s1">BinaryIO</span>
    <span class="s4">) </span><span class="s1">-&gt; int</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Send data for a column. 
 
        This methods send data for a column (for example BLOB) for statement identified 
        by statement_id. The param_id indicate which parameter the data belongs too. 
        The data argument should be a file-like object. 
 
        Since MySQL does not send anything back, no error is raised. When the MySQL 
        server is not reachable, an OperationalError is raised. 
 
        cmd_stmt_send_long_data should be called before cmd_stmt_execute. 
 
        The total bytes send is returned. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_quit</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bytes</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Close the current connection with the server. 
 
        Send the QUIT command to the MySQL server, closing the current connection. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_shutdown</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">shutdown_type</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Shut down the MySQL Server. 
 
        This method sends the SHUTDOWN command to the MySQL server. 
        The `shutdown_type` is not used, and it's kept for backward compatibility. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_statistics</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; StatsPacketType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Send the statistics command to the MySQL Server. 
 
        This method sends the STATISTICS command to the MySQL server. The result is a 
        dictionary with various statistical information. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_process_kill</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">mysql_pid</span><span class="s4">: </span><span class="s1">int</span><span class="s4">) </span><span class="s1">-&gt; OkPacketType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Kill a MySQL process. 
 
        This method send the PROCESS_KILL command to the server along with the 
        process ID. The result is a dictionary with the OK packet information. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_debug</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; EofPacketType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Send the DEBUG command. 
 
        This method sends the DEBUG command to the MySQL server, which requires the 
        MySQL user to have SUPER privilege. The output will go to the MySQL server 
        error log and the result of this method is a dictionary with EOF packet 
        information. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_ping</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; OkPacketType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Send the PING command. 
 
        This method sends the PING command to the MySQL server. It is used to check 
        if the the connection is still valid. The result of this method is dictionary 
        with OK packet information. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">cmd_change_user</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">username</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">password</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">database</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">charset</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">password1</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">password2</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">password3</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">oci_config_file</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
        <span class="s1">oci_config_profile</span><span class="s4">: </span><span class="s1">str </span><span class="s4">= </span><span class="s5">&quot;&quot;</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">OkPacketType</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Changes the current logged in user. 
 
        It also causes the specified database to become the default (current) 
        database. It is also possible to change the character set using the 
        charset argument. The character set passed during initial connection 
        is reused if no value of charset is passed via this method. 
 
        Args: 
            username: New account's username. 
            password: New account's password. 
            database: Database to become the default (current) database. 
            charset: Client charset (see [1]), only the lower 8-bits. 
            password1: New account's password factor 1 - it's used instead 
                       of `password` if set (higher precedence). 
            password2: New account's password factor 2. 
            password3: New account's password factor 3. 
            oci_config_file: OCI configuration file location (path-like string). 
            oci_config_profile: OCI configuration profile location (path-like string). 
 
        Returns: 
            ok_packet: Dictionary containing the OK packet information. 
 
        Examples: 
            ``` 
            &gt;&gt;&gt; cnx.cmd_change_user(username='', password='', database='', charset=33) 
            ``` 
 
        References: 
            [1]: https://dev.mysql.com/doc/dev/mysql-server/latest/\ 
                page_protocol_basic_character_set.html#a_protocol_character_set 
        &quot;&quot;&quot;</span>


<span class="s3">class </span><span class="s1">MySQLCursorAbstract</span><span class="s4">(</span><span class="s1">ABC</span><span class="s4">):</span>
    <span class="s2">&quot;&quot;&quot;Defines the MySQL cursor interface.&quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">__init__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">connection</span><span class="s4">: </span><span class="s1">MySQLConnectionAbstract</span><span class="s4">):</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_connection</span><span class="s4">: </span><span class="s1">MySQLConnectionAbstract </span><span class="s4">= </span><span class="s1">connection</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_loop</span><span class="s4">: </span><span class="s1">asyncio</span><span class="s4">.</span><span class="s1">AbstractEventLoop </span><span class="s4">= </span><span class="s1">connection</span><span class="s4">.</span><span class="s1">loop</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_description</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">DescriptionType</span><span class="s4">]] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_last_insert_id</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_warnings</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">WarningType</span><span class="s4">]] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_warning_count</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">0</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_executed</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">StrOrBytes</span><span class="s4">] = </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_executed_list</span><span class="s4">: </span><span class="s1">List</span><span class="s4">[</span><span class="s1">StrOrBytes</span><span class="s4">] = []</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_stored_results</span><span class="s4">: </span><span class="s1">List</span><span class="s4">[</span><span class="s1">Any</span><span class="s4">] = []</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_binary</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_raw</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_rowcount</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= -</span><span class="s6">1</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_nextrow</span><span class="s4">: </span><span class="s1">Tuple</span><span class="s4">[</span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">RowType</span><span class="s4">], </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">EofPacketType</span><span class="s4">]] = (</span>
            <span class="s3">None</span><span class="s4">,</span>
            <span class="s3">None</span><span class="s4">,</span>
        <span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">arraysize</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">1</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_connection</span><span class="s4">.</span><span class="s1">add_cursor</span><span class="s4">(</span><span class="s1">self</span><span class="s4">)</span>

    <span class="s3">async def </span><span class="s1">__aenter__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; MySQLCursorAbstract</span><span class="s4">:</span>
        <span class="s3">return </span><span class="s1">self</span>

    <span class="s3">async def </span><span class="s1">__aexit__</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">exc_type</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">Type</span><span class="s4">[</span><span class="s1">BaseException</span><span class="s4">]] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">exc_value</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">BaseException</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">traceback</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">TracebackType</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">close</span><span class="s4">()</span>

    <span class="s3">async def </span><span class="s1">__aiter__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Iterator</span><span class="s4">[</span><span class="s1">RowType</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Iterate over result set. 
 
        Iteration over the result set which calls self.fetchone() 
        and returns the next row. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self  </span><span class="s0"># type: ignore[return-value]</span>

    <span class="s3">async def </span><span class="s1">__next__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; RowType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot; 
        Used for iterating over the result set. Calles self.fetchone() 
        to get the next row. 
        &quot;&quot;&quot;</span>
        <span class="s3">try</span><span class="s4">:</span>
            <span class="s1">row </span><span class="s4">= </span><span class="s3">await </span><span class="s1">self</span><span class="s4">.</span><span class="s1">fetchone</span><span class="s4">()</span>
        <span class="s3">except </span><span class="s1">InterfaceError</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">StopAsyncIteration </span><span class="s3">from None</span>
        <span class="s3">if not </span><span class="s1">row</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">StopAsyncIteration</span>
        <span class="s3">return </span><span class="s1">row</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">description</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">DescriptionType</span><span class="s4">]]:</span>
        <span class="s2">&quot;&quot;&quot;Return description of columns in a result. 
 
        This property returns a list of tuples describing the columns in in a result 
        set. A tuple is described as follows: 
 
                (column_name, 
                 type, 
                 None, 
                 None, 
                 None, 
                 None, 
                 null_ok, 
                 column_flags)  # Addition to PEP-249 specs 
 
        Returns a list of tuples. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_description</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">rowcount</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; int</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Return the number of rows produced or affected. 
 
        This property returns the number of rows produced by queries such as a 
        SELECT, or affected rows when executing DML statements like INSERT or UPDATE. 
 
        Note that for non-buffered cursors it is impossible to know the number of rows 
        produced before having fetched them all. For those, the number of rows will 
        be -1 right after execution, and incremented when fetching rows. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_rowcount</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">lastrowid</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Return the value generated for an AUTO_INCREMENT column. 
 
        Returns the value generated for an AUTO_INCREMENT column by the previous 
        INSERT or UPDATE statement or None when there is no such value available. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_last_insert_id</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">warnings</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">WarningType</span><span class="s4">]]:</span>
        <span class="s2">&quot;&quot;&quot;Return warnings.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_warnings</span>

    <span class="s3">def </span><span class="s1">fetchwarnings</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">WarningType</span><span class="s4">]]:</span>
        <span class="s2">&quot;&quot;&quot;Returns Warnings.&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_warnings</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">warning_count</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; int</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Return the number of warnings. 
 
        This property returns the number of warnings generated by the previously 
        executed operation. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_warning_count</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">column_names</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Tuple</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, ...]:</span>
        <span class="s2">&quot;&quot;&quot;Returns column names. 
 
        This property returns the columns names as a tuple. 
        &quot;&quot;&quot;</span>
        <span class="s3">if not </span><span class="s1">self</span><span class="s4">.</span><span class="s1">description</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">tuple</span><span class="s4">()</span>
        <span class="s3">return </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">d</span><span class="s4">[</span><span class="s6">0</span><span class="s4">] </span><span class="s3">for </span><span class="s1">d </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">description</span><span class="s4">)</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">statement</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">str</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Returns the executed statement 
 
        This property returns the executed statement. 
        When multiple statements were executed, the current statement in the iterator 
        will be returned. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_executed </span><span class="s3">is None</span><span class="s4">:</span>
            <span class="s3">return None</span>
        <span class="s3">try</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_executed</span><span class="s4">.</span><span class="s1">strip</span><span class="s4">().</span><span class="s1">decode</span><span class="s4">()  </span><span class="s0"># type: ignore[union-attr]</span>
        <span class="s3">except </span><span class="s4">(</span><span class="s1">AttributeError</span><span class="s4">, </span><span class="s1">UnicodeDecodeError</span><span class="s4">):</span>
            <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_executed</span><span class="s4">.</span><span class="s1">strip</span><span class="s4">()  </span><span class="s0"># type: ignore[return-value]</span>

    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">with_rows</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Returns whether the cursor could have rows returned. 
 
        This property returns True when column descriptions are available and possibly 
        also rows, which will need to be fetched. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">bool</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_description</span><span class="s4">)</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">def </span><span class="s1">stored_results</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Iterator</span><span class="s4">[</span><span class="s1">MySQLCursorAbstract</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Returns an iterator for stored results. 
 
        This method returns an iterator over results which are stored when callproc() 
        is called. The iterator will provide MySQLCursorBuffered instances. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">execute</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">operation</span><span class="s4">: </span><span class="s1">StrOrBytes</span><span class="s4">,</span>
        <span class="s1">params</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">Sequence</span><span class="s4">[</span><span class="s1">Any</span><span class="s4">], </span><span class="s1">Dict</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Any</span><span class="s4">]] = (),</span>
        <span class="s1">multi</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Executes the given operation. 
 
        Executes the given operation substituting any markers with the given 
        parameters. 
 
        For example, getting all rows where id is 5: 
          await cursor.execute(&quot;SELECT * FROM t1 WHERE id = %s&quot;, (5,)) 
 
        If the `multi`` parameter is used a `ProgrammingError` is raised. The method for 
        executing multiple statements is `executemulti()`. 
 
        If warnings where generated, and connection.get_warnings is True, then 
        self._warnings will be a list containing these warnings. 
 
        Raises: 
            ProgramingError: If multi parameter is used. 
        &quot;&quot;&quot;</span>

    <span class="s3">async def </span><span class="s1">executemulti</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">operation</span><span class="s4">: </span><span class="s1">StrOrBytes</span><span class="s4">,</span>
        <span class="s1">params</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">Sequence</span><span class="s4">[</span><span class="s1">Any</span><span class="s4">], </span><span class="s1">Dict</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Any</span><span class="s4">]] = (),</span>
    <span class="s4">) </span><span class="s1">-&gt; AsyncGenerator</span><span class="s4">[</span><span class="s1">MySQLCursorAbstract</span><span class="s4">, </span><span class="s3">None</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Execute multiple statements. 
 
        Executes the given operation substituting any markers with the given 
        parameters. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">executemany</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">operation</span><span class="s4">: </span><span class="s1">str</span><span class="s4">,</span>
        <span class="s1">seq_params</span><span class="s4">: </span><span class="s1">Sequence</span><span class="s4">[</span><span class="s1">ParamsSequenceType</span><span class="s4">],</span>
    <span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Prepare and execute a MySQL Prepared Statement many times. 
 
        This method will prepare the given operation and execute with each tuple found 
        the list seq_params. 
 
        If the cursor instance already had a prepared statement, it is first closed. 
 
        executemany() simply calls execute(). 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">fetchone</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">RowType</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Return next row of a query result set. 
 
        Raises: 
            InterfaceError: If there is no result to fetch. 
 
        Returns: 
            tuple or None: A row from query result set. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">fetchall</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; List</span><span class="s4">[</span><span class="s1">RowType</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Return all rows of a query result set. 
 
        Raises: 
            InterfaceError: If there is no result to fetch. 
 
        Returns: 
            list: A list of tuples with all rows of a query result set. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">fetchmany</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">size</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">1</span><span class="s4">) </span><span class="s1">-&gt; List</span><span class="s4">[</span><span class="s1">Sequence</span><span class="s4">[</span><span class="s1">Any</span><span class="s4">]]:</span>
        <span class="s2">&quot;&quot;&quot;Return the next set of rows of a query result set. 
 
        When no more rows are available, it returns an empty list. 
        The number of rows returned can be specified using the size argument, which 
        defaults to one. 
 
        Returns: 
            list: The next set of rows of a query result set. 
        &quot;&quot;&quot;</span>

    <span class="s4">@</span><span class="s1">abstractmethod</span>
    <span class="s3">async def </span><span class="s1">close</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Close the cursor.&quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">getlastrowid</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Return the value generated for an AUTO_INCREMENT column. 
 
        Returns the value generated for an AUTO_INCREMENT column by the previous 
        INSERT or UPDATE statement. 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_last_insert_id</span>

    <span class="s3">async def </span><span class="s1">reset</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">free</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">True</span><span class="s4">) </span><span class="s1">-&gt; Any</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Reset the cursor to default.&quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">get_attributes</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; Optional</span><span class="s4">[</span><span class="s1">List</span><span class="s4">[</span><span class="s1">Tuple</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">BinaryProtocolType</span><span class="s4">]]]:</span>
        <span class="s2">&quot;&quot;&quot;Gets a list of query attributes from the connector's side. 
 
        Returns: 
            List of existing query attributes. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">hasattr</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s5">&quot;_connection&quot;</span><span class="s4">):</span>
            <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_connection</span><span class="s4">.</span><span class="s1">query_attrs</span>
        <span class="s3">return None</span>

    <span class="s3">def </span><span class="s1">add_attribute</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">name</span><span class="s4">: </span><span class="s1">str</span><span class="s4">, </span><span class="s1">value</span><span class="s4">: </span><span class="s1">BinaryProtocolType</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Add a query attribute and its value into the connector's query attributes. 
 
        Query attributes must be enabled on the server - they are disabled by default. A 
        warning is logged when setting query attributes for a server connection 
        that does not support them. 
 
        Args: 
            name: Key name used to identify the attribute. 
            value: A value converted to the MySQL Binary Protocol. 
 
        Raises: 
            ProgrammingError: If the value's conversion fails. 
        &quot;&quot;&quot;</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">name</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span><span class="s5">&quot;Parameter `name` must be a string type&quot;</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">value </span><span class="s3">is not None and not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">value</span><span class="s4">, </span><span class="s1">MYSQL_PY_TYPES</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span>
                <span class="s5">f&quot;Object </span><span class="s3">{</span><span class="s1">value</span><span class="s3">} </span><span class="s5">cannot be converted to a MySQL type&quot;</span>
            <span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_connection</span><span class="s4">.</span><span class="s1">query_attrs_append</span><span class="s4">((</span><span class="s1">name</span><span class="s4">, </span><span class="s1">value</span><span class="s4">))</span>

    <span class="s3">def </span><span class="s1">remove_attribute</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">name</span><span class="s4">: </span><span class="s1">str</span><span class="s4">) </span><span class="s1">-&gt; BinaryProtocolType</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Removes a query attribute by name from the connector's query attributes. 
 
        If no match, `None` is returned, else the corresponding value is returned. 
 
        Args: 
            name: Key name used to identify the attribute. 
 
        Returns: 
            value: Attribute's value. 
        &quot;&quot;&quot;</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">name</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ProgrammingError</span><span class="s4">(</span><span class="s5">&quot;Parameter `name` must be a string type&quot;</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_connection</span><span class="s4">.</span><span class="s1">query_attrs_remove</span><span class="s4">(</span><span class="s1">name</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">clear_attributes</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Clears the list of query attributes on the connector's side.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_connection</span><span class="s4">.</span><span class="s1">query_attrs_clear</span><span class="s4">()</span>


<span class="s3">class </span><span class="s1">CMySQLPrepStmt</span><span class="s4">(</span><span class="s1">GenericWrapper</span><span class="s4">):</span>
    <span class="s2">&quot;&quot;&quot;Structure to represent a result from `CMySQLConnection.cmd_stmt_prepare`. 
    It can be used consistently as a type hint. 
 
    `_mysql_connector.MySQLPrepStmt` isn't available when the C-ext isn't built. 
 
    In this regard, `CmdStmtPrepareResult` acts as a proxy/wrapper entity for a 
    `_mysql_connector.MySQLPrepStmt` instance. 
    &quot;&quot;&quot;</span>
</pre>
</body>
</html>