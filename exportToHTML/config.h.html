<html>
<head>
<title>config.h</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #7a7e85;}
.s2 { color: #cf8e6d;}
.s3 { color: #2aacb8;}
.s4 { color: #c77dbb;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
config.h</font>
</center></td></tr></table>
<pre><span class="s0">#pragma once</span>

<span class="s1">// Define math constants if they are not available</span>
<span class="s2">#ifndef </span><span class="s0">M_E</span>
<span class="s2">#define </span><span class="s0">M_E </span><span class="s3">2.71828182845904523536</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_LOG2E</span>
<span class="s2">#define </span><span class="s0">M_LOG2E </span><span class="s3">1.44269504088896340736</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_LOG10E</span>
<span class="s2">#define </span><span class="s0">M_LOG10E </span><span class="s3">0.434294481903251827651</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_LN2</span>
<span class="s2">#define </span><span class="s0">M_LN2 </span><span class="s3">0.693147180559945309417</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_LN10</span>
<span class="s2">#define </span><span class="s0">M_LN10 </span><span class="s3">2.30258509299404568402</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_PI</span>
<span class="s2">#define </span><span class="s0">M_PI </span><span class="s3">3.14159265358979323846</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_PI_2</span>
<span class="s2">#define </span><span class="s0">M_PI_2 </span><span class="s3">1.57079632679489661923</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_PI_4</span>
<span class="s2">#define </span><span class="s0">M_PI_4 </span><span class="s3">0.785398163397448309616</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_1_PI</span>
<span class="s2">#define </span><span class="s0">M_1_PI </span><span class="s3">0.318309886183790671538</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_2_PI</span>
<span class="s2">#define </span><span class="s0">M_2_PI </span><span class="s3">0.636619772367581343076</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_2_SQRTPI</span>
<span class="s2">#define </span><span class="s0">M_2_SQRTPI </span><span class="s3">1.12837916709551257390</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_SQRT2</span>
<span class="s2">#define </span><span class="s0">M_SQRT2 </span><span class="s3">1.41421356237309504880</span>
<span class="s2">#endif</span>

<span class="s2">#ifndef </span><span class="s0">M_SQRT1_2</span>
<span class="s2">#define </span><span class="s0">M_SQRT1_2 </span><span class="s3">0.707106781186547524401</span>
<span class="s2">#endif</span>

<span class="s2">#ifdef </span><span class="s0">__CUDACC__</span>
<span class="s2">#define </span><span class="s0">SPECFUN_HOST_DEVICE __host__ __device__</span>

<span class="s2">#include </span><span class="s0">&lt;cuda/std/algorithm&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;cuda/std/cmath&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;cuda/std/cstdint&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;cuda/std/limits&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;cuda/std/type_traits&gt;</span>

<span class="s1">// Fallback to global namespace for functions unsupported on NVRTC Jit</span>
<span class="s2">#ifdef </span><span class="s0">_LIBCUDACXX_COMPILER_NVRTC</span>
<span class="s2">#include </span><span class="s0">&lt;cuda_runtime.h&gt;</span>
<span class="s2">#endif</span>

<span class="s4">namespace </span><span class="s0">std {</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">abs(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::abs(num); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">exp(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::exp(num); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">log(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::log(num); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">sqrt(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::sqrt(num); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">bool </span><span class="s0">isinf(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::isinf(num); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">bool </span><span class="s0">isnan(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::isnan(num); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">bool </span><span class="s0">isfinite(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::isfinite(num); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">pow(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">cuda::std::pow(x, y); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">sin(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::sin(x); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">cos(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::cos(x); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">tan(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::tan(x); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">atan(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::atan(x); }</span>

<span class="s0">SPECFUN_HOSt_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">acos(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::acos(x); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">sinh(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::sinh(x); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">cosh(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::cosh(x); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">asinh(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::asinh(x); }</span>

<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">bool </span><span class="s0">signbit(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::signbit(x); }</span>

<span class="s1">// Fallback to global namespace for functions unsupported on NVRTC</span>
<span class="s2">#ifndef </span><span class="s0">_LIBCUDACXX_COMPILER_NVRTC</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">ceil(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::ceil(x); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">floor(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::floor(x); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">round(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::round(x); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">trunc(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">cuda::std::trunc(x); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">fma(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y, </span><span class="s2">double </span><span class="s0">z) { </span><span class="s2">return </span><span class="s0">cuda::std::fma(x, y, z); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">copysign(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">cuda::std::copysign(x, y); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">modf(</span><span class="s2">double </span><span class="s0">value, </span><span class="s2">double </span><span class="s0">*iptr) { </span><span class="s2">return </span><span class="s0">cuda::std::modf(value, iptr); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">fmax(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">cuda::std::fmax(x, y); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">fmin(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">cuda::std::fmin(x, y); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">log10(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::log10(num); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">log1p(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">cuda::std::log1p(num); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">frexp(</span><span class="s2">double </span><span class="s0">num, </span><span class="s2">int </span><span class="s0">*exp) { </span><span class="s2">return </span><span class="s0">cuda::std::frexp(num); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">ldexp(</span><span class="s2">double </span><span class="s0">num, </span><span class="s2">int </span><span class="s0">*exp) { </span><span class="s2">return </span><span class="s0">cuda::std::ldexp(num); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">fmod(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">cuda::std::fmod(x, y); }</span>
<span class="s2">#else</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">ceil(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">::ceil(x); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">floor(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">::floor(x); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">round(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">::round(x); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">trunc(</span><span class="s2">double </span><span class="s0">x) { </span><span class="s2">return </span><span class="s0">::trunc(x); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">fma(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y, </span><span class="s2">double </span><span class="s0">z) { </span><span class="s2">return </span><span class="s0">::fma(x, y, z); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">copysign(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">::copysign(x, y); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">modf(</span><span class="s2">double </span><span class="s0">value, </span><span class="s2">double </span><span class="s0">*iptr) { </span><span class="s2">return </span><span class="s0">::modf(value, iptr); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">fmax(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">::fmax(x, y); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">fmin(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">::fmin(x, y); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">log10(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">::log10(num); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">log1p(</span><span class="s2">double </span><span class="s0">num) { </span><span class="s2">return </span><span class="s0">::log1p(num); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">frexp(</span><span class="s2">double </span><span class="s0">num, </span><span class="s2">int </span><span class="s0">*exp) { </span><span class="s2">return </span><span class="s0">::frexp(num); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">ldexp(</span><span class="s2">double </span><span class="s0">num, </span><span class="s2">int </span><span class="s0">*exp) { </span><span class="s2">return </span><span class="s0">::ldexp(num); }</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s4">inline </span><span class="s2">double </span><span class="s0">fmod(</span><span class="s2">double </span><span class="s0">x, </span><span class="s2">double </span><span class="s0">y) { </span><span class="s2">return </span><span class="s0">::fmod(x, y); }</span>
<span class="s2">#endif</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s2">void </span><span class="s0">swap(T &amp;a, T &amp;b) {</span>
    <span class="s0">cuda::std::swap(a, b);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE </span><span class="s2">const </span><span class="s0">T &amp;clamp(</span><span class="s2">const </span><span class="s0">T &amp;v, </span><span class="s2">const </span><span class="s0">T &amp;lo, </span><span class="s2">const </span><span class="s0">T &amp;hi) {</span>
    <span class="s2">return </span><span class="s0">cuda::std::clamp(v, lo, hi);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s4">using </span><span class="s0">numeric_limits = cuda::std::numeric_limits&lt;T&gt;;</span>

<span class="s1">// Must use thrust for complex types in order to support CuPy</span>
<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s4">using </span><span class="s0">complex = thrust::complex&lt;T&gt;;</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE T abs(</span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;z) {</span>
    <span class="s2">return </span><span class="s0">thrust::abs(z);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE complex&lt;T&gt; exp(</span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;z) {</span>
    <span class="s2">return </span><span class="s0">thrust::exp(z);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE complex&lt;T&gt; log(</span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;z) {</span>
    <span class="s2">return </span><span class="s0">thrust::log(z);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE T norm(</span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;z) {</span>
    <span class="s2">return </span><span class="s0">thrust::norm(z);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE complex&lt;T&gt; sqrt(</span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;z) {</span>
    <span class="s2">return </span><span class="s0">thrust::sqrt(z);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE complex&lt;T&gt; conj(</span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;z) {</span>
    <span class="s2">return </span><span class="s0">thrust::conj(z);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE complex&lt;T&gt; pow(</span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;x, </span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;y) {</span>
    <span class="s2">return </span><span class="s0">thrust::pow(x, y);</span>
<span class="s0">}</span>

<span class="s0">template &lt;</span><span class="s4">typename </span><span class="s0">T&gt;</span>
<span class="s0">SPECFUN_HOST_DEVICE complex&lt;T&gt; pow(</span><span class="s2">const </span><span class="s0">complex&lt;T&gt; &amp;x, </span><span class="s2">const </span><span class="s0">T &amp;y) {</span>
    <span class="s2">return </span><span class="s0">thrust::pow(x, y);</span>
<span class="s0">}</span>

<span class="s1">// Other types and utilities</span>
<span class="s4">using </span><span class="s0">cuda::std::is_floating_point;</span>
<span class="s4">using </span><span class="s0">cuda::std::pair;</span>
<span class="s4">using </span><span class="s0">cuda::std::uint64_t;</span>

<span class="s2">#define </span><span class="s0">SPECFUN_ASSERT(a)</span>

<span class="s0">} </span><span class="s1">// namespace std</span>

<span class="s2">#else</span>
<span class="s2">#define </span><span class="s0">SPECFUN_HOST_DEVICE</span>

<span class="s2">#include </span><span class="s0">&lt;algorithm&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;cassert&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;cmath&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;complex&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;cstdint&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;cstddef&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;iterator&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;limits&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;math.h&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;type_traits&gt;</span>
<span class="s2">#include </span><span class="s0">&lt;utility&gt;</span>

<span class="s2">#ifdef </span><span class="s0">DEBUG</span>
<span class="s2">#define </span><span class="s0">SPECFUN_ASSERT(a) assert(a)</span>
<span class="s2">#else</span>
<span class="s2">#define </span><span class="s0">SPECFUN_ASSERT(a)</span>
<span class="s2">#endif</span>

<span class="s2">#endif</span>
</pre>
</body>
</html>