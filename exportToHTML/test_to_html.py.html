<html>
<head>
<title>test_to_html.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #5f826b; font-style: italic;}
.s5 { color: #2aacb8;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_to_html.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">datetime</span>
<span class="s0">from </span><span class="s1">io </span><span class="s0">import </span><span class="s1">StringIO</span>
<span class="s0">import </span><span class="s1">itertools</span>
<span class="s0">import </span><span class="s1">re</span>
<span class="s0">import </span><span class="s1">textwrap</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s2">(</span>
    <span class="s1">DataFrame</span><span class="s2">,</span>
    <span class="s1">Index</span><span class="s2">,</span>
    <span class="s1">MultiIndex</span><span class="s2">,</span>
    <span class="s1">get_option</span><span class="s2">,</span>
    <span class="s1">option_context</span><span class="s2">,</span>
<span class="s2">)</span>
<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">_testing </span><span class="s0">as </span><span class="s1">tm</span>

<span class="s0">import </span><span class="s1">pandas</span><span class="s2">.</span><span class="s1">io</span><span class="s2">.</span><span class="s1">formats</span><span class="s2">.</span><span class="s1">format </span><span class="s0">as </span><span class="s1">fmt</span>

<span class="s1">lorem_ipsum </span><span class="s2">= (</span>
    <span class="s3">&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod &quot;</span>
    <span class="s3">&quot;tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim &quot;</span>
    <span class="s3">&quot;veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex &quot;</span>
    <span class="s3">&quot;ea commodo consequat. Duis aute irure dolor in reprehenderit in &quot;</span>
    <span class="s3">&quot;voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur &quot;</span>
    <span class="s3">&quot;sint occaecat cupidatat non proident, sunt in culpa qui officia &quot;</span>
    <span class="s3">&quot;deserunt mollit anim id est laborum.&quot;</span>
<span class="s2">)</span>


<span class="s0">def </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">name</span><span class="s2">):</span>
    <span class="s4">&quot;&quot;&quot; 
    Read HTML file from formats data directory. 
 
    Parameters 
    ---------- 
    datapath : pytest fixture 
        The datapath fixture injected into a test by pytest. 
    name : str 
        The name of the HTML file without the suffix. 
 
    Returns 
    ------- 
    str : contents of HTML file. 
    &quot;&quot;&quot;</span>
    <span class="s1">filename </span><span class="s2">= </span><span class="s3">&quot;.&quot;</span><span class="s2">.</span><span class="s1">join</span><span class="s2">([</span><span class="s1">name</span><span class="s2">, </span><span class="s3">&quot;html&quot;</span><span class="s2">])</span>
    <span class="s1">filepath </span><span class="s2">= </span><span class="s1">datapath</span><span class="s2">(</span><span class="s3">&quot;io&quot;</span><span class="s2">, </span><span class="s3">&quot;formats&quot;</span><span class="s2">, </span><span class="s3">&quot;data&quot;</span><span class="s2">, </span><span class="s3">&quot;html&quot;</span><span class="s2">, </span><span class="s1">filename</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">filepath</span><span class="s2">, </span><span class="s1">encoding</span><span class="s2">=</span><span class="s3">&quot;utf-8&quot;</span><span class="s2">) </span><span class="s0">as </span><span class="s1">f</span><span class="s2">:</span>
        <span class="s1">html </span><span class="s2">= </span><span class="s1">f</span><span class="s2">.</span><span class="s1">read</span><span class="s2">()</span>
    <span class="s0">return </span><span class="s1">html</span><span class="s2">.</span><span class="s1">rstrip</span><span class="s2">()</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span><span class="s2">(</span><span class="s1">params</span><span class="s2">=[</span><span class="s3">&quot;mixed&quot;</span><span class="s2">, </span><span class="s3">&quot;empty&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">biggie_df_fixture</span><span class="s2">(</span><span class="s1">request</span><span class="s2">):</span>
    <span class="s4">&quot;&quot;&quot;Fixture for a big mixed Dataframe and an empty Dataframe&quot;&quot;&quot;</span>
    <span class="s0">if </span><span class="s1">request</span><span class="s2">.</span><span class="s1">param </span><span class="s2">== </span><span class="s3">&quot;mixed&quot;</span><span class="s2">:</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span>
                <span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s5">200</span><span class="s2">),</span>
                <span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">i</span><span class="s0">}</span><span class="s3">?!&quot; </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s5">200</span><span class="s2">)]),</span>
            <span class="s2">},</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">200</span><span class="s2">),</span>
        <span class="s2">)</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[:</span><span class="s5">20</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">loc</span><span class="s2">[:</span><span class="s5">20</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">] = </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span>
        <span class="s0">return </span><span class="s1">df</span>
    <span class="s0">elif </span><span class="s1">request</span><span class="s2">.</span><span class="s1">param </span><span class="s2">== </span><span class="s3">&quot;empty&quot;</span><span class="s2">:</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">200</span><span class="s2">))</span>
        <span class="s0">return </span><span class="s1">df</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span><span class="s2">(</span><span class="s1">params</span><span class="s2">=</span><span class="s1">fmt</span><span class="s2">.</span><span class="s1">VALID_JUSTIFY_PARAMETERS</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">justify</span><span class="s2">(</span><span class="s1">request</span><span class="s2">):</span>
    <span class="s0">return </span><span class="s1">request</span><span class="s2">.</span><span class="s1">param</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;col_space&quot;</span><span class="s2">, [</span><span class="s5">30</span><span class="s2">, </span><span class="s5">50</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_to_html_with_col_space</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">):</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">random</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">)))</span>
    <span class="s6"># check that col_space affects HTML generation</span>
    <span class="s6"># and be very brittle about it.</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">=</span><span class="s1">col_space</span><span class="s2">)</span>
    <span class="s1">hdrs </span><span class="s2">= [</span><span class="s1">x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">result</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">r&quot;\n&quot;</span><span class="s2">) </span><span class="s0">if </span><span class="s1">re</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(</span><span class="s3">r&quot;&lt;th[&gt;\s]&quot;</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)]</span>
    <span class="s0">assert </span><span class="s1">len</span><span class="s2">(</span><span class="s1">hdrs</span><span class="s2">) &gt; </span><span class="s5">0</span>
    <span class="s0">for </span><span class="s1">h </span><span class="s0">in </span><span class="s1">hdrs</span><span class="s2">:</span>
        <span class="s0">assert </span><span class="s3">&quot;min-width&quot; </span><span class="s0">in </span><span class="s1">h</span>
        <span class="s0">assert </span><span class="s1">str</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">) </span><span class="s0">in </span><span class="s1">h</span>


<span class="s0">def </span><span class="s1">test_to_html_with_column_specific_col_space_raises</span><span class="s2">():</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">random</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s2">)), </span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]</span>
    <span class="s2">)</span>

    <span class="s1">msg </span><span class="s2">= (</span>
        <span class="s3">&quot;Col_space length</span><span class="s0">\\</span><span class="s3">(</span><span class="s0">\\</span><span class="s3">d+</span><span class="s0">\\</span><span class="s3">) should match &quot;</span>
        <span class="s3">&quot;DataFrame number of columns</span><span class="s0">\\</span><span class="s3">(</span><span class="s0">\\</span><span class="s3">d+</span><span class="s0">\\</span><span class="s3">)&quot;</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">=[</span><span class="s5">30</span><span class="s2">, </span><span class="s5">40</span><span class="s2">])</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">=[</span><span class="s5">30</span><span class="s2">, </span><span class="s5">40</span><span class="s2">, </span><span class="s5">50</span><span class="s2">, </span><span class="s5">60</span><span class="s2">])</span>

    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;unknown column&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">={</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">: </span><span class="s5">23</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">: </span><span class="s5">34</span><span class="s2">})</span>


<span class="s0">def </span><span class="s1">test_to_html_with_column_specific_col_space</span><span class="s2">():</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">random</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s2">)), </span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]</span>
    <span class="s2">)</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">={</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s3">&quot;2em&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">: </span><span class="s5">23</span><span class="s2">})</span>
    <span class="s1">hdrs </span><span class="s2">= [</span><span class="s1">x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">result</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s2">) </span><span class="s0">if </span><span class="s1">re</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(</span><span class="s3">r&quot;&lt;th[&gt;\s]&quot;</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)]</span>
    <span class="s0">assert </span><span class="s3">'min-width: 2em;&quot;&gt;a&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs</span><span class="s2">[</span><span class="s5">1</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s3">'min-width: 23px;&quot;&gt;b&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs</span><span class="s2">[</span><span class="s5">2</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s3">&quot;&lt;th&gt;c&lt;/th&gt;&quot; </span><span class="s0">in </span><span class="s1">hdrs</span><span class="s2">[</span><span class="s5">3</span><span class="s2">]</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">=[</span><span class="s3">&quot;1em&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">])</span>
    <span class="s1">hdrs </span><span class="s2">= [</span><span class="s1">x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">result</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s2">) </span><span class="s0">if </span><span class="s1">re</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(</span><span class="s3">r&quot;&lt;th[&gt;\s]&quot;</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)]</span>
    <span class="s0">assert </span><span class="s3">'min-width: 1em;&quot;&gt;a&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs</span><span class="s2">[</span><span class="s5">1</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s3">'min-width: 2px;&quot;&gt;b&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs</span><span class="s2">[</span><span class="s5">2</span><span class="s2">]</span>
    <span class="s0">assert </span><span class="s3">'min-width: 3px;&quot;&gt;c&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs</span><span class="s2">[</span><span class="s5">3</span><span class="s2">]</span>


<span class="s0">def </span><span class="s1">test_to_html_with_empty_string_label</span><span class="s2">():</span>
    <span class="s6"># GH 3547, to_html regards empty string labels as repeated labels</span>
    <span class="s1">data </span><span class="s2">= {</span><span class="s3">&quot;c1&quot;</span><span class="s2">: [</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], </span><span class="s3">&quot;c2&quot;</span><span class="s2">: [</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">], </span><span class="s3">&quot;data&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]}</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">).</span><span class="s1">set_index</span><span class="s2">([</span><span class="s3">&quot;c1&quot;</span><span class="s2">, </span><span class="s3">&quot;c2&quot;</span><span class="s2">])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">()</span>
    <span class="s0">assert </span><span class="s3">&quot;rowspan&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;df,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;</span><span class="s0">\u03c3</span><span class="s3">&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">10.0</span><span class="s2">)}), </span><span class="s3">&quot;unicode_1&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s3">&quot;</span><span class="s0">\u03c3</span><span class="s3">&quot;</span><span class="s2">]}), </span><span class="s3">&quot;unicode_2&quot;</span><span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_unicode</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">()</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_encoding</span><span class="s2">(</span><span class="s1">float_frame</span><span class="s2">, </span><span class="s1">tmp_path</span><span class="s2">):</span>
    <span class="s6"># GH 28663</span>
    <span class="s1">path </span><span class="s2">= </span><span class="s1">tmp_path </span><span class="s2">/ </span><span class="s3">&quot;test.html&quot;</span>
    <span class="s1">float_frame</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">path</span><span class="s2">, </span><span class="s1">encoding</span><span class="s2">=</span><span class="s3">&quot;gbk&quot;</span><span class="s2">)</span>
    <span class="s0">with </span><span class="s1">open</span><span class="s2">(</span><span class="s1">str</span><span class="s2">(</span><span class="s1">path</span><span class="s2">), </span><span class="s1">encoding</span><span class="s2">=</span><span class="s3">&quot;gbk&quot;</span><span class="s2">) </span><span class="s0">as </span><span class="s1">f</span><span class="s2">:</span>
        <span class="s0">assert </span><span class="s1">float_frame</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">() == </span><span class="s1">f</span><span class="s2">.</span><span class="s1">read</span><span class="s2">()</span>


<span class="s0">def </span><span class="s1">test_to_html_decimal</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH 12031</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">6.0</span><span class="s2">, </span><span class="s5">3.1</span><span class="s2">, </span><span class="s5">2.2</span><span class="s2">]})</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">decimal</span><span class="s2">=</span><span class="s3">&quot;,&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh12031_expected_output&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;kwargs,string,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">({}, </span><span class="s3">&quot;&lt;type 'str'&gt;&quot;</span><span class="s2">, </span><span class="s3">&quot;escaped&quot;</span><span class="s2">),</span>
        <span class="s2">({</span><span class="s3">&quot;escape&quot;</span><span class="s2">: </span><span class="s0">False</span><span class="s2">}, </span><span class="s3">&quot;&lt;b&gt;bold&lt;/b&gt;&quot;</span><span class="s2">, </span><span class="s3">&quot;escape_disabled&quot;</span><span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_escaped</span><span class="s2">(</span><span class="s1">kwargs</span><span class="s2">, </span><span class="s1">string</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">a </span><span class="s2">= </span><span class="s3">&quot;str&lt;ing1 &amp;amp;&quot;</span>
    <span class="s1">b </span><span class="s2">= </span><span class="s3">&quot;stri&gt;ng2 &amp;amp;&quot;</span>

    <span class="s1">test_dict </span><span class="s2">= {</span><span class="s3">&quot;co&lt;l1&quot;</span><span class="s2">: {</span><span class="s1">a</span><span class="s2">: </span><span class="s1">string</span><span class="s2">, </span><span class="s1">b</span><span class="s2">: </span><span class="s1">string</span><span class="s2">}, </span><span class="s3">&quot;co&gt;l2&quot;</span><span class="s2">: {</span><span class="s1">a</span><span class="s2">: </span><span class="s1">string</span><span class="s2">, </span><span class="s1">b</span><span class="s2">: </span><span class="s1">string</span><span class="s2">}}</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">test_dict</span><span class="s2">).</span><span class="s1">to_html</span><span class="s2">(**</span><span class="s1">kwargs</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;index_is_named&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_to_html_multiindex_index_false</span><span class="s2">(</span><span class="s1">index_is_named</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH 8452</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s2">{</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">2</span><span class="s2">), </span><span class="s3">&quot;b&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">5</span><span class="s2">), </span><span class="s3">&quot;c&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">5</span><span class="s2">, </span><span class="s5">7</span><span class="s2">), </span><span class="s3">&quot;d&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">3</span><span class="s2">, </span><span class="s5">5</span><span class="s2">)}</span>
    <span class="s2">)</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">([[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], [</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">]])</span>
    <span class="s0">if </span><span class="s1">index_is_named</span><span class="s2">:</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">(</span><span class="s1">df</span><span class="s2">.</span><span class="s1">index</span><span class="s2">.</span><span class="s1">values</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;idx&quot;</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh8452_expected_output&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;multi_sparse,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s0">False</span><span class="s2">, </span><span class="s3">&quot;multiindex_sparsify_false_multi_sparse_1&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s0">False</span><span class="s2">, </span><span class="s3">&quot;multiindex_sparsify_false_multi_sparse_2&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s0">True</span><span class="s2">, </span><span class="s3">&quot;multiindex_sparsify_1&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s0">True</span><span class="s2">, </span><span class="s3">&quot;multiindex_sparsify_2&quot;</span><span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_multiindex_sparsify</span><span class="s2">(</span><span class="s1">multi_sparse</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">index </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_arrays</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]], </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">])</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], [</span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">], [</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">]], </span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">)</span>
    <span class="s0">if </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">endswith</span><span class="s2">(</span><span class="s3">&quot;2&quot;</span><span class="s2">):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">index</span><span class="s2">[::</span><span class="s5">2</span><span class="s2">]</span>
    <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.multi_sparse&quot;</span><span class="s2">, </span><span class="s1">multi_sparse</span><span class="s2">):</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">()</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;max_rows,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s5">60</span><span class="s2">, </span><span class="s3">&quot;gh14882_expected_output_1&quot;</span><span class="s2">),</span>
        <span class="s6"># Test that ... appears in a middle level</span>
        <span class="s2">(</span><span class="s5">56</span><span class="s2">, </span><span class="s3">&quot;gh14882_expected_output_2&quot;</span><span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_multiindex_odd_even_truncate</span><span class="s2">(</span><span class="s1">max_rows</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH 14882 - Issue on truncation with odd length DataFrame</span>
    <span class="s1">index </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">(</span>
        <span class="s2">[[</span><span class="s5">100</span><span class="s2">, </span><span class="s5">200</span><span class="s2">, </span><span class="s5">300</span><span class="s2">], [</span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s2">, </span><span class="s5">30</span><span class="s2">], [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">]], </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]</span>
    <span class="s2">)</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;n&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s1">len</span><span class="s2">(</span><span class="s1">index</span><span class="s2">))}, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">max_rows</span><span class="s2">=</span><span class="s1">max_rows</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;df,formatters,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span>
            <span class="s1">DataFrame</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], [</span><span class="s5">4</span><span class="s2">, </span><span class="s5">5</span><span class="s2">], [</span><span class="s5">6</span><span class="s2">, </span><span class="s5">7</span><span class="s2">]],</span>
                <span class="s1">columns</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">),</span>
                <span class="s1">index</span><span class="s2">=</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">4</span><span class="s2">),</span>
            <span class="s2">),</span>
            <span class="s2">{</span><span class="s3">&quot;__index__&quot;</span><span class="s2">: </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s3">&quot;abcd&quot;</span><span class="s2">[</span><span class="s1">x</span><span class="s2">]},</span>
            <span class="s3">&quot;index_formatter&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;months&quot;</span><span class="s2">: [</span><span class="s1">datetime</span><span class="s2">(</span><span class="s5">2016</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">), </span><span class="s1">datetime</span><span class="s2">(</span><span class="s5">2016</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s2">)]}),</span>
            <span class="s2">{</span><span class="s3">&quot;months&quot;</span><span class="s2">: </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x</span><span class="s2">.</span><span class="s1">strftime</span><span class="s2">(</span><span class="s3">&quot;%Y-%m&quot;</span><span class="s2">)},</span>
            <span class="s3">&quot;datetime64_monthformatter&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">DataFrame</span><span class="s2">(</span>
                <span class="s2">{</span>
                    <span class="s3">&quot;hod&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">to_datetime</span><span class="s2">(</span>
                        <span class="s2">[</span><span class="s3">&quot;10:10:10.100&quot;</span><span class="s2">, </span><span class="s3">&quot;12:12:12.120&quot;</span><span class="s2">], </span><span class="s1">format</span><span class="s2">=</span><span class="s3">&quot;%H:%M:%S.%f&quot;</span>
                    <span class="s2">)</span>
                <span class="s2">}</span>
            <span class="s2">),</span>
            <span class="s2">{</span><span class="s3">&quot;hod&quot;</span><span class="s2">: </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">x</span><span class="s2">.</span><span class="s1">strftime</span><span class="s2">(</span><span class="s3">&quot;%H:%M&quot;</span><span class="s2">)},</span>
            <span class="s3">&quot;datetime64_hourformatter&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">DataFrame</span><span class="s2">(</span>
                <span class="s2">{</span>
                    <span class="s3">&quot;i&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;int64&quot;</span><span class="s2">),</span>
                    <span class="s3">&quot;f&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;float64&quot;</span><span class="s2">),</span>
                    <span class="s3">&quot;I&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;Int64&quot;</span><span class="s2">),</span>
                    <span class="s3">&quot;s&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;string&quot;</span><span class="s2">),</span>
                    <span class="s3">&quot;b&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Series</span><span class="s2">([</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;boolean&quot;</span><span class="s2">),</span>
                    <span class="s3">&quot;c&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Series</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">pd</span><span class="s2">.</span><span class="s1">CategoricalDtype</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">])),</span>
                    <span class="s3">&quot;o&quot;</span><span class="s2">: </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">Series</span><span class="s2">([</span><span class="s5">1</span><span class="s2">, </span><span class="s3">&quot;2&quot;</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">),</span>
                <span class="s2">}</span>
            <span class="s2">),</span>
            <span class="s2">[</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s3">&quot;formatted&quot;</span><span class="s2">] * </span><span class="s5">7</span><span class="s2">,</span>
            <span class="s3">&quot;various_dtypes_formatted&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_formatters</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">formatters</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">formatters</span><span class="s2">=</span><span class="s1">formatters</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_regression_GH6098</span><span class="s2">():</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s2">{</span>
            <span class="s3">&quot;clé1&quot;</span><span class="s2">: [</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">],</span>
            <span class="s3">&quot;clé2&quot;</span><span class="s2">: [</span><span class="s3">&quot;1er&quot;</span><span class="s2">, </span><span class="s3">&quot;2ème&quot;</span><span class="s2">, </span><span class="s3">&quot;1er&quot;</span><span class="s2">, </span><span class="s3">&quot;2ème&quot;</span><span class="s2">, </span><span class="s3">&quot;1er&quot;</span><span class="s2">],</span>
            <span class="s3">&quot;données1&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s5">5</span><span class="s2">),</span>
            <span class="s3">&quot;données2&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s5">5</span><span class="s2">),</span>
        <span class="s2">}</span>
    <span class="s2">)</span>

    <span class="s6"># it works</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">pivot_table</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=[</span><span class="s3">&quot;clé1&quot;</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;clé2&quot;</span><span class="s2">]).</span><span class="s1">_repr_html_</span><span class="s2">()</span>


<span class="s0">def </span><span class="s1">test_to_html_truncate</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">index </span><span class="s2">= </span><span class="s1">pd</span><span class="s2">.</span><span class="s1">date_range</span><span class="s2">(</span><span class="s1">start</span><span class="s2">=</span><span class="s3">&quot;20010101&quot;</span><span class="s2">, </span><span class="s1">freq</span><span class="s2">=</span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s1">periods</span><span class="s2">=</span><span class="s5">20</span><span class="s2">)</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">range</span><span class="s2">(</span><span class="s5">20</span><span class="s2">))</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">max_rows</span><span class="s2">=</span><span class="s5">8</span><span class="s2">, </span><span class="s1">max_cols</span><span class="s2">=</span><span class="s5">4</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;truncate&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;size&quot;</span><span class="s2">, [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">5</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_html_invalid_formatters_arg_raises</span><span class="s2">(</span><span class="s1">size</span><span class="s2">):</span>
    <span class="s6"># issue-28469</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">])</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Formatters length({}) should match DataFrame number of columns(3)&quot;</span>
    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">re</span><span class="s2">.</span><span class="s1">escape</span><span class="s2">(</span><span class="s1">msg</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">size</span><span class="s2">))):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">formatters</span><span class="s2">=[</span><span class="s3">&quot;{}&quot;</span><span class="s2">.</span><span class="s1">format</span><span class="s2">] * </span><span class="s1">size</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_to_html_truncate_formatter</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># issue-25955</span>
    <span class="s1">data </span><span class="s2">= [</span>
        <span class="s2">{</span><span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">},</span>
        <span class="s2">{</span><span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s5">5</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">: </span><span class="s5">7</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">: </span><span class="s5">8</span><span class="s2">},</span>
        <span class="s2">{</span><span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s5">9</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s5">10</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">: </span><span class="s5">11</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">: </span><span class="s5">12</span><span class="s2">},</span>
        <span class="s2">{</span><span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s5">13</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s5">14</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">: </span><span class="s5">15</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">},</span>
    <span class="s2">]</span>

    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>
    <span class="s1">fmt </span><span class="s2">= </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">str</span><span class="s2">(</span><span class="s1">x</span><span class="s2">) + </span><span class="s3">&quot;_mod&quot;</span>
    <span class="s1">formatters </span><span class="s2">= [</span><span class="s1">fmt</span><span class="s2">, </span><span class="s1">fmt</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">]</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">formatters</span><span class="s2">=</span><span class="s1">formatters</span><span class="s2">, </span><span class="s1">max_cols</span><span class="s2">=</span><span class="s5">3</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;truncate_formatter&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;sparsify,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[(</span><span class="s0">True</span><span class="s2">, </span><span class="s3">&quot;truncate_multi_index&quot;</span><span class="s2">), (</span><span class="s0">False</span><span class="s2">, </span><span class="s3">&quot;truncate_multi_index_sparse_off&quot;</span><span class="s2">)],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_truncate_multi_index</span><span class="s2">(</span><span class="s1">sparsify</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">arrays </span><span class="s2">= [</span>
        <span class="s2">[</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;baz&quot;</span><span class="s2">, </span><span class="s3">&quot;baz&quot;</span><span class="s2">, </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;qux&quot;</span><span class="s2">, </span><span class="s3">&quot;qux&quot;</span><span class="s2">],</span>
        <span class="s2">[</span><span class="s3">&quot;one&quot;</span><span class="s2">, </span><span class="s3">&quot;two&quot;</span><span class="s2">, </span><span class="s3">&quot;one&quot;</span><span class="s2">, </span><span class="s3">&quot;two&quot;</span><span class="s2">, </span><span class="s3">&quot;one&quot;</span><span class="s2">, </span><span class="s3">&quot;two&quot;</span><span class="s2">, </span><span class="s3">&quot;one&quot;</span><span class="s2">, </span><span class="s3">&quot;two&quot;</span><span class="s2">],</span>
    <span class="s2">]</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s1">arrays</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">arrays</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">max_rows</span><span class="s2">=</span><span class="s5">7</span><span class="s2">, </span><span class="s1">max_cols</span><span class="s2">=</span><span class="s5">7</span><span class="s2">, </span><span class="s1">sparsify</span><span class="s2">=</span><span class="s1">sparsify</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;option,result,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s0">None</span><span class="s2">, </span><span class="s0">lambda </span><span class="s1">df</span><span class="s2">: </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(), </span><span class="s3">&quot;1&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s0">None</span><span class="s2">, </span><span class="s0">lambda </span><span class="s1">df</span><span class="s2">: </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">border</span><span class="s2">=</span><span class="s5">2</span><span class="s2">), </span><span class="s3">&quot;2&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s5">2</span><span class="s2">, </span><span class="s0">lambda </span><span class="s1">df</span><span class="s2">: </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(), </span><span class="s3">&quot;2&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s5">2</span><span class="s2">, </span><span class="s0">lambda </span><span class="s1">df</span><span class="s2">: </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">(), </span><span class="s3">&quot;2&quot;</span><span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_border</span><span class="s2">(</span><span class="s1">option</span><span class="s2">, </span><span class="s1">result</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]})</span>
    <span class="s0">if </span><span class="s1">option </span><span class="s0">is None</span><span class="s2">:</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">result</span><span class="s2">(</span><span class="s1">df</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.html.border&quot;</span><span class="s2">, </span><span class="s1">option</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">result</span><span class="s2">(</span><span class="s1">df</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s3">f'border=&quot;</span><span class="s0">{</span><span class="s1">expected</span><span class="s0">}</span><span class="s3">&quot;'</span>
    <span class="s0">assert </span><span class="s1">expected </span><span class="s0">in </span><span class="s1">result</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;biggie_df_fixture&quot;</span><span class="s2">, [</span><span class="s3">&quot;mixed&quot;</span><span class="s2">], </span><span class="s1">indirect</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html</span><span class="s2">(</span><span class="s1">biggie_df_fixture</span><span class="s2">):</span>
    <span class="s6"># TODO: split this test</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">biggie_df_fixture</span>
    <span class="s1">s </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">()</span>

    <span class="s1">buf </span><span class="s2">= </span><span class="s1">StringIO</span><span class="s2">()</span>
    <span class="s1">retval </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">buf</span><span class="s2">=</span><span class="s1">buf</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">retval </span><span class="s0">is None</span>
    <span class="s0">assert </span><span class="s1">buf</span><span class="s2">.</span><span class="s1">getvalue</span><span class="s2">() == </span><span class="s1">s</span>

    <span class="s0">assert </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">s</span><span class="s2">, </span><span class="s1">str</span><span class="s2">)</span>

    <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">], </span><span class="s1">col_space</span><span class="s2">=</span><span class="s5">17</span><span class="s2">)</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">], </span><span class="s1">formatters</span><span class="s2">={</span><span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">x</span><span class="s0">:</span><span class="s3">.1f</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">})</span>

    <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">], </span><span class="s1">float_format</span><span class="s2">=</span><span class="s1">str</span><span class="s2">)</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">], </span><span class="s1">col_space</span><span class="s2">=</span><span class="s5">12</span><span class="s2">, </span><span class="s1">float_format</span><span class="s2">=</span><span class="s1">str</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;biggie_df_fixture&quot;</span><span class="s2">, [</span><span class="s3">&quot;empty&quot;</span><span class="s2">], </span><span class="s1">indirect</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_empty_dataframe</span><span class="s2">(</span><span class="s1">biggie_df_fixture</span><span class="s2">):</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">biggie_df_fixture</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">()</span>


<span class="s0">def </span><span class="s1">test_to_html_filename</span><span class="s2">(</span><span class="s1">biggie_df_fixture</span><span class="s2">, </span><span class="s1">tmpdir</span><span class="s2">):</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">biggie_df_fixture</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">()</span>
    <span class="s1">path </span><span class="s2">= </span><span class="s1">tmpdir</span><span class="s2">.</span><span class="s1">join</span><span class="s2">(</span><span class="s3">&quot;test.html&quot;</span><span class="s2">)</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">path</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">path</span><span class="s2">.</span><span class="s1">read</span><span class="s2">()</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_with_no_bold</span><span class="s2">():</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;x&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(</span><span class="s5">5</span><span class="s2">)})</span>
    <span class="s1">html </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">bold_rows</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">html</span><span class="s2">[</span><span class="s1">html</span><span class="s2">.</span><span class="s1">find</span><span class="s2">(</span><span class="s3">&quot;&lt;/thead&gt;&quot;</span><span class="s2">)]</span>
    <span class="s0">assert </span><span class="s3">&quot;&lt;strong&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s0">def </span><span class="s1">test_to_html_columns_arg</span><span class="s2">(</span><span class="s1">float_frame</span><span class="s2">):</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">float_frame</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;A&quot;</span><span class="s2">])</span>
    <span class="s0">assert </span><span class="s3">&quot;&lt;th&gt;B&lt;/th&gt;&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;columns,justify,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span>
            <span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_arrays</span><span class="s2">(</span>
                <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">repeat</span><span class="s2">(</span><span class="s5">2</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">mod</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s5">4</span><span class="s2">), </span><span class="s5">2</span><span class="s2">)],</span>
                <span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;CL0&quot;</span><span class="s2">, </span><span class="s3">&quot;CL1&quot;</span><span class="s2">],</span>
            <span class="s2">),</span>
            <span class="s3">&quot;left&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;multiindex_1&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_arrays</span><span class="s2">([</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">4</span><span class="s2">), </span><span class="s1">np</span><span class="s2">.</span><span class="s1">mod</span><span class="s2">(</span><span class="s1">range</span><span class="s2">(</span><span class="s5">4</span><span class="s2">), </span><span class="s5">2</span><span class="s2">)]),</span>
            <span class="s3">&quot;right&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;multiindex_2&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_multiindex</span><span class="s2">(</span><span class="s1">columns</span><span class="s2">, </span><span class="s1">justify</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([</span><span class="s1">list</span><span class="s2">(</span><span class="s3">&quot;abcd&quot;</span><span class="s2">), </span><span class="s1">list</span><span class="s2">(</span><span class="s3">&quot;efgh&quot;</span><span class="s2">)], </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">columns</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">justify</span><span class="s2">=</span><span class="s1">justify</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_justify</span><span class="s2">(</span><span class="s1">justify</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s2">{</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">6</span><span class="s2">, </span><span class="s5">30000</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], </span><span class="s3">&quot;B&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">70000</span><span class="s2">], </span><span class="s3">&quot;C&quot;</span><span class="s2">: [</span><span class="s5">223442</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]},</span>
        <span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">justify</span><span class="s2">=</span><span class="s1">justify</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;justify&quot;</span><span class="s2">).</span><span class="s1">format</span><span class="s2">(</span><span class="s1">justify</span><span class="s2">=</span><span class="s1">justify</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;justify&quot;</span><span class="s2">, [</span><span class="s3">&quot;super-right&quot;</span><span class="s2">, </span><span class="s3">&quot;small-left&quot;</span><span class="s2">, </span><span class="s3">&quot;noinherit&quot;</span><span class="s2">, </span><span class="s3">&quot;tiny&quot;</span><span class="s2">, </span><span class="s3">&quot;pandas&quot;</span><span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_invalid_justify</span><span class="s2">(</span><span class="s1">justify</span><span class="s2">):</span>
    <span class="s6"># GH 17527</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">()</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;Invalid value for justify parameter&quot;</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">ValueError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">justify</span><span class="s2">=</span><span class="s1">justify</span><span class="s2">)</span>


<span class="s0">class </span><span class="s1">TestHTMLIndex</span><span class="s2">:</span>
    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span>
    <span class="s0">def </span><span class="s1">df</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">index </span><span class="s2">= [</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;baz&quot;</span><span class="s2">]</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s2">{</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">], </span><span class="s3">&quot;B&quot;</span><span class="s2">: [</span><span class="s5">1.2</span><span class="s2">, </span><span class="s5">3.4</span><span class="s2">, </span><span class="s5">5.6</span><span class="s2">], </span><span class="s3">&quot;C&quot;</span><span class="s2">: [</span><span class="s3">&quot;one&quot;</span><span class="s2">, </span><span class="s3">&quot;two&quot;</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">]},</span>
            <span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">],</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s0">return </span><span class="s1">df</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">fixture</span>
    <span class="s0">def </span><span class="s1">expected_without_index</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
        <span class="s0">return </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;index_2&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">test_to_html_flat_index_without_name</span><span class="s2">(</span>
        <span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">df</span><span class="s2">, </span><span class="s1">expected_without_index</span>
    <span class="s2">):</span>
        <span class="s1">expected_with_index </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;index_1&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">() == </span><span class="s1">expected_with_index</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">index</span><span class="s2">:</span>
            <span class="s0">assert </span><span class="s1">i </span><span class="s0">not in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected_without_index</span>

    <span class="s0">def </span><span class="s1">test_to_html_flat_index_with_name</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">df</span><span class="s2">, </span><span class="s1">expected_without_index</span><span class="s2">):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;baz&quot;</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;idx&quot;</span><span class="s2">)</span>
        <span class="s1">expected_with_index </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;index_3&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">() == </span><span class="s1">expected_with_index</span>
        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">) == </span><span class="s1">expected_without_index</span>

    <span class="s0">def </span><span class="s1">test_to_html_multiindex_without_names</span><span class="s2">(</span>
        <span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">df</span><span class="s2">, </span><span class="s1">expected_without_index</span>
    <span class="s2">):</span>
        <span class="s1">tuples </span><span class="s2">= [(</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;car&quot;</span><span class="s2">), (</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bike&quot;</span><span class="s2">), (</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;car&quot;</span><span class="s2">)]</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_tuples</span><span class="s2">(</span><span class="s1">tuples</span><span class="s2">)</span>

        <span class="s1">expected_with_index </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;index_4&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">() == </span><span class="s1">expected_with_index</span>

        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s2">[</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;car&quot;</span><span class="s2">, </span><span class="s3">&quot;bike&quot;</span><span class="s2">]:</span>
            <span class="s0">assert </span><span class="s1">i </span><span class="s0">not in </span><span class="s1">result</span>
        <span class="s6"># must be the same result as normal index</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected_without_index</span>

    <span class="s0">def </span><span class="s1">test_to_html_multiindex_with_names</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">df</span><span class="s2">, </span><span class="s1">expected_without_index</span><span class="s2">):</span>
        <span class="s1">tuples </span><span class="s2">= [(</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;car&quot;</span><span class="s2">), (</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bike&quot;</span><span class="s2">), (</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s3">&quot;car&quot;</span><span class="s2">)]</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_tuples</span><span class="s2">(</span><span class="s1">tuples</span><span class="s2">, </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;idx1&quot;</span><span class="s2">, </span><span class="s3">&quot;idx2&quot;</span><span class="s2">])</span>
        <span class="s1">expected_with_index </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;index_5&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">() == </span><span class="s1">expected_with_index</span>
        <span class="s0">assert </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">) == </span><span class="s1">expected_without_index</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;classes&quot;</span><span class="s2">, [</span><span class="s3">&quot;sortable draggable&quot;</span><span class="s2">, [</span><span class="s3">&quot;sortable&quot;</span><span class="s2">, </span><span class="s3">&quot;draggable&quot;</span><span class="s2">]])</span>
<span class="s0">def </span><span class="s1">test_to_html_with_classes</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">()</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;with_classes&quot;</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_no_index_max_rows</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH 14998</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">]})</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">max_rows</span><span class="s2">=</span><span class="s5">1</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh14998_expected_output&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_multiindex_max_cols</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH 6131</span>
    <span class="s1">index </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">(</span>
        <span class="s1">levels</span><span class="s2">=[[</span><span class="s3">&quot;ba&quot;</span><span class="s2">, </span><span class="s3">&quot;bb&quot;</span><span class="s2">, </span><span class="s3">&quot;bc&quot;</span><span class="s2">], [</span><span class="s3">&quot;ca&quot;</span><span class="s2">, </span><span class="s3">&quot;cb&quot;</span><span class="s2">, </span><span class="s3">&quot;cc&quot;</span><span class="s2">]],</span>
        <span class="s1">codes</span><span class="s2">=[[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]],</span>
        <span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s1">columns </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">(</span>
        <span class="s1">levels</span><span class="s2">=[[</span><span class="s3">&quot;d&quot;</span><span class="s2">], [</span><span class="s3">&quot;aa&quot;</span><span class="s2">, </span><span class="s3">&quot;ab&quot;</span><span class="s2">, </span><span class="s3">&quot;ac&quot;</span><span class="s2">]],</span>
        <span class="s1">codes</span><span class="s2">=[[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">], [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]],</span>
        <span class="s1">names</span><span class="s2">=[</span><span class="s0">None</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s1">data </span><span class="s2">= </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">(</span>
        <span class="s2">[[</span><span class="s5">1.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">2.0</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">], [</span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s1">np</span><span class="s2">.</span><span class="s1">nan</span><span class="s2">, </span><span class="s5">3.0</span><span class="s2">]]</span>
    <span class="s2">)</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">max_cols</span><span class="s2">=</span><span class="s5">2</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh6131_expected_output&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_multi_indexes_index_false</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH 22579</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s2">{</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">10</span><span class="s2">), </span><span class="s3">&quot;b&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s2">), </span><span class="s3">&quot;c&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s2">), </span><span class="s3">&quot;d&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s2">)}</span>
    <span class="s2">)</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">([[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], [</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">]])</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">index </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">([[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], [</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">, </span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;f&quot;</span><span class="s2">, </span><span class="s3">&quot;g&quot;</span><span class="s2">]])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh22579_expected_output&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;index_names&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;header&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;index&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;column_index, column_type&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]), </span><span class="s3">&quot;unnamed_standard&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;columns.name&quot;</span><span class="s2">), </span><span class="s3">&quot;named_standard&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">([[</span><span class="s3">&quot;a&quot;</span><span class="s2">], [</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]]), </span><span class="s3">&quot;unnamed_multi&quot;</span><span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s3">&quot;a&quot;</span><span class="s2">], [</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]], </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;columns.name.0&quot;</span><span class="s2">, </span><span class="s3">&quot;columns.name.1&quot;</span><span class="s2">]</span>
            <span class="s2">),</span>
            <span class="s3">&quot;named_multi&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;row_index, row_type&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">]), </span><span class="s3">&quot;unnamed_standard&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s1">Index</span><span class="s2">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;index.name&quot;</span><span class="s2">), </span><span class="s3">&quot;named_standard&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">([[</span><span class="s3">&quot;a&quot;</span><span class="s2">], [</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]]), </span><span class="s3">&quot;unnamed_multi&quot;</span><span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s3">&quot;a&quot;</span><span class="s2">], [</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s2">]], </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;index.name.0&quot;</span><span class="s2">, </span><span class="s3">&quot;index.name.1&quot;</span><span class="s2">]</span>
            <span class="s2">),</span>
            <span class="s3">&quot;named_multi&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_basic_alignment</span><span class="s2">(</span>
    <span class="s1">datapath</span><span class="s2">, </span><span class="s1">row_index</span><span class="s2">, </span><span class="s1">row_type</span><span class="s2">, </span><span class="s1">column_index</span><span class="s2">, </span><span class="s1">column_type</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">header</span><span class="s2">, </span><span class="s1">index_names</span>
<span class="s2">):</span>
    <span class="s6"># GH 22747, GH 22579</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">zeros</span><span class="s2">((</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s2">), </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">int</span><span class="s2">), </span><span class="s1">index</span><span class="s2">=</span><span class="s1">row_index</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">column_index</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">, </span><span class="s1">header</span><span class="s2">=</span><span class="s1">header</span><span class="s2">, </span><span class="s1">index_names</span><span class="s2">=</span><span class="s1">index_names</span><span class="s2">)</span>

    <span class="s0">if not </span><span class="s1">index</span><span class="s2">:</span>
        <span class="s1">row_type </span><span class="s2">= </span><span class="s3">&quot;none&quot;</span>
    <span class="s0">elif not </span><span class="s1">index_names </span><span class="s0">and </span><span class="s1">row_type</span><span class="s2">.</span><span class="s1">startswith</span><span class="s2">(</span><span class="s3">&quot;named&quot;</span><span class="s2">):</span>
        <span class="s1">row_type </span><span class="s2">= </span><span class="s3">&quot;un&quot; </span><span class="s2">+ </span><span class="s1">row_type</span>

    <span class="s0">if not </span><span class="s1">header</span><span class="s2">:</span>
        <span class="s1">column_type </span><span class="s2">= </span><span class="s3">&quot;none&quot;</span>
    <span class="s0">elif not </span><span class="s1">index_names </span><span class="s0">and </span><span class="s1">column_type</span><span class="s2">.</span><span class="s1">startswith</span><span class="s2">(</span><span class="s3">&quot;named&quot;</span><span class="s2">):</span>
        <span class="s1">column_type </span><span class="s2">= </span><span class="s3">&quot;un&quot; </span><span class="s2">+ </span><span class="s1">column_type</span>

    <span class="s1">filename </span><span class="s2">= </span><span class="s3">&quot;index_&quot; </span><span class="s2">+ </span><span class="s1">row_type </span><span class="s2">+ </span><span class="s3">&quot;_columns_&quot; </span><span class="s2">+ </span><span class="s1">column_type</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">filename</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;index_names&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;header&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;index&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;column_index, column_type&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">8</span><span class="s2">)), </span><span class="s3">&quot;unnamed_standard&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">8</span><span class="s2">), </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;columns.name&quot;</span><span class="s2">), </span><span class="s3">&quot;named_standard&quot;</span><span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">([[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], [</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">], [</span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;f&quot;</span><span class="s2">]]),</span>
            <span class="s3">&quot;unnamed_multi&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], [</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">], [</span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;f&quot;</span><span class="s2">]], </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s3">&quot;baz&quot;</span><span class="s2">]</span>
            <span class="s2">),</span>
            <span class="s3">&quot;named_multi&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;row_index, row_type&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">8</span><span class="s2">)), </span><span class="s3">&quot;unnamed_standard&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s1">Index</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">8</span><span class="s2">), </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;index.name&quot;</span><span class="s2">), </span><span class="s3">&quot;named_standard&quot;</span><span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">([[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], [</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">], [</span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;f&quot;</span><span class="s2">]]),</span>
            <span class="s3">&quot;unnamed_multi&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
        <span class="s2">(</span>
            <span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">(</span>
                <span class="s2">[[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], [</span><span class="s3">&quot;c&quot;</span><span class="s2">, </span><span class="s3">&quot;d&quot;</span><span class="s2">], [</span><span class="s3">&quot;e&quot;</span><span class="s2">, </span><span class="s3">&quot;f&quot;</span><span class="s2">]], </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s3">&quot;baz&quot;</span><span class="s2">]</span>
            <span class="s2">),</span>
            <span class="s3">&quot;named_multi&quot;</span><span class="s2">,</span>
        <span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_alignment_with_truncation</span><span class="s2">(</span>
    <span class="s1">datapath</span><span class="s2">, </span><span class="s1">row_index</span><span class="s2">, </span><span class="s1">row_type</span><span class="s2">, </span><span class="s1">column_index</span><span class="s2">, </span><span class="s1">column_type</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">header</span><span class="s2">, </span><span class="s1">index_names</span>
<span class="s2">):</span>
    <span class="s6"># GH 22747, GH 22579</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">64</span><span class="s2">).</span><span class="s1">reshape</span><span class="s2">(</span><span class="s5">8</span><span class="s2">, </span><span class="s5">8</span><span class="s2">), </span><span class="s1">index</span><span class="s2">=</span><span class="s1">row_index</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">column_index</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span>
        <span class="s1">max_rows</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">max_cols</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">, </span><span class="s1">header</span><span class="s2">=</span><span class="s1">header</span><span class="s2">, </span><span class="s1">index_names</span><span class="s2">=</span><span class="s1">index_names</span>
    <span class="s2">)</span>

    <span class="s0">if not </span><span class="s1">index</span><span class="s2">:</span>
        <span class="s1">row_type </span><span class="s2">= </span><span class="s3">&quot;none&quot;</span>
    <span class="s0">elif not </span><span class="s1">index_names </span><span class="s0">and </span><span class="s1">row_type</span><span class="s2">.</span><span class="s1">startswith</span><span class="s2">(</span><span class="s3">&quot;named&quot;</span><span class="s2">):</span>
        <span class="s1">row_type </span><span class="s2">= </span><span class="s3">&quot;un&quot; </span><span class="s2">+ </span><span class="s1">row_type</span>

    <span class="s0">if not </span><span class="s1">header</span><span class="s2">:</span>
        <span class="s1">column_type </span><span class="s2">= </span><span class="s3">&quot;none&quot;</span>
    <span class="s0">elif not </span><span class="s1">index_names </span><span class="s0">and </span><span class="s1">column_type</span><span class="s2">.</span><span class="s1">startswith</span><span class="s2">(</span><span class="s3">&quot;named&quot;</span><span class="s2">):</span>
        <span class="s1">column_type </span><span class="s2">= </span><span class="s3">&quot;un&quot; </span><span class="s2">+ </span><span class="s1">column_type</span>

    <span class="s1">filename </span><span class="s2">= </span><span class="s3">&quot;trunc_df_index_&quot; </span><span class="s2">+ </span><span class="s1">row_type </span><span class="s2">+ </span><span class="s3">&quot;_columns_&quot; </span><span class="s2">+ </span><span class="s1">column_type</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">filename</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;index&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_to_html_truncation_index_false_max_rows</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">index</span><span class="s2">):</span>
    <span class="s6"># GH 15019</span>
    <span class="s1">data </span><span class="s2">= [</span>
        <span class="s2">[</span><span class="s5">1.764052</span><span class="s2">, </span><span class="s5">0.400157</span><span class="s2">],</span>
        <span class="s2">[</span><span class="s5">0.978738</span><span class="s2">, </span><span class="s5">2.240893</span><span class="s2">],</span>
        <span class="s2">[</span><span class="s5">1.867558</span><span class="s2">, -</span><span class="s5">0.977278</span><span class="s2">],</span>
        <span class="s2">[</span><span class="s5">0.950088</span><span class="s2">, -</span><span class="s5">0.151357</span><span class="s2">],</span>
        <span class="s2">[-</span><span class="s5">0.103219</span><span class="s2">, </span><span class="s5">0.410599</span><span class="s2">],</span>
    <span class="s2">]</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">max_rows</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh15019_expected_output&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;index&quot;</span><span class="s2">, [</span><span class="s0">False</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;col_index_named, expected_output&quot;</span><span class="s2">,</span>
    <span class="s2">[(</span><span class="s0">False</span><span class="s2">, </span><span class="s3">&quot;gh22783_expected_output&quot;</span><span class="s2">), (</span><span class="s0">True</span><span class="s2">, </span><span class="s3">&quot;gh22783_named_columns_index&quot;</span><span class="s2">)],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_truncation_index_false_max_cols</span><span class="s2">(</span>
    <span class="s1">datapath</span><span class="s2">, </span><span class="s1">index</span><span class="s2">, </span><span class="s1">col_index_named</span><span class="s2">, </span><span class="s1">expected_output</span>
<span class="s2">):</span>
    <span class="s6"># GH 22783</span>
    <span class="s1">data </span><span class="s2">= [</span>
        <span class="s2">[</span><span class="s5">1.764052</span><span class="s2">, </span><span class="s5">0.400157</span><span class="s2">, </span><span class="s5">0.978738</span><span class="s2">, </span><span class="s5">2.240893</span><span class="s2">, </span><span class="s5">1.867558</span><span class="s2">],</span>
        <span class="s2">[-</span><span class="s5">0.977278</span><span class="s2">, </span><span class="s5">0.950088</span><span class="s2">, -</span><span class="s5">0.151357</span><span class="s2">, -</span><span class="s5">0.103219</span><span class="s2">, </span><span class="s5">0.410599</span><span class="s2">],</span>
    <span class="s2">]</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">)</span>
    <span class="s0">if </span><span class="s1">col_index_named</span><span class="s2">:</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">rename</span><span class="s2">(</span><span class="s3">&quot;columns.name&quot;</span><span class="s2">, </span><span class="s1">inplace</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">max_cols</span><span class="s2">=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">index</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected_output</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;notebook&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s0">False</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_to_html_notebook_has_style</span><span class="s2">(</span><span class="s1">notebook</span><span class="s2">):</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]})</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">notebook</span><span class="s2">=</span><span class="s1">notebook</span><span class="s2">)</span>

    <span class="s0">if </span><span class="s1">notebook</span><span class="s2">:</span>
        <span class="s0">assert </span><span class="s3">&quot;tbody tr th:only-of-type&quot; </span><span class="s0">in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s3">&quot;vertical-align: middle;&quot; </span><span class="s0">in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s3">&quot;thead th&quot; </span><span class="s0">in </span><span class="s1">result</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s0">assert </span><span class="s3">&quot;tbody tr th:only-of-type&quot; </span><span class="s0">not in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s3">&quot;vertical-align: middle;&quot; </span><span class="s0">not in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s3">&quot;thead th&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s0">def </span><span class="s1">test_to_html_with_index_names_false</span><span class="s2">():</span>
    <span class="s6"># GH 16493</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]}, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;myindexname&quot;</span><span class="s2">))</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index_names</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s3">&quot;myindexname&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s0">def </span><span class="s1">test_to_html_with_id</span><span class="s2">():</span>
    <span class="s6"># GH 8496</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]}, </span><span class="s1">index</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;myindexname&quot;</span><span class="s2">))</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">index_names</span><span class="s2">=</span><span class="s0">False</span><span class="s2">, </span><span class="s1">table_id</span><span class="s2">=</span><span class="s3">&quot;TEST_ID&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s3">' id=&quot;TEST_ID&quot;' </span><span class="s0">in </span><span class="s1">result</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;value,float_format,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s5">0.19999</span><span class="s2">, </span><span class="s3">&quot;%.3f&quot;</span><span class="s2">, </span><span class="s3">&quot;gh21625_expected_output&quot;</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s5">100.0</span><span class="s2">, </span><span class="s3">&quot;%.0f&quot;</span><span class="s2">, </span><span class="s3">&quot;gh22270_expected_output&quot;</span><span class="s2">),</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_float_format_no_fixed_width</span><span class="s2">(</span><span class="s1">value</span><span class="s2">, </span><span class="s1">float_format</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH 21625, GH 22270</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;x&quot;</span><span class="s2">: [</span><span class="s1">value</span><span class="s2">]})</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">float_format</span><span class="s2">=</span><span class="s1">float_format</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;render_links,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[(</span><span class="s0">True</span><span class="s2">, </span><span class="s3">&quot;render_links_true&quot;</span><span class="s2">), (</span><span class="s0">False</span><span class="s2">, </span><span class="s3">&quot;render_links_false&quot;</span><span class="s2">)],</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">test_to_html_render_links</span><span class="s2">(</span><span class="s1">render_links</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH 2679</span>
    <span class="s1">data </span><span class="s2">= [</span>
        <span class="s2">[</span><span class="s5">0</span><span class="s2">, </span><span class="s3">&quot;https://pandas.pydata.org/?q1=a&amp;q2=b&quot;</span><span class="s2">, </span><span class="s3">&quot;pydata.org&quot;</span><span class="s2">],</span>
        <span class="s2">[</span><span class="s5">0</span><span class="s2">, </span><span class="s3">&quot;www.pydata.org&quot;</span><span class="s2">, </span><span class="s3">&quot;pydata.org&quot;</span><span class="s2">],</span>
    <span class="s2">]</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">Index</span><span class="s2">([</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s1">object</span><span class="s2">))</span>

    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">render_links</span><span class="s2">=</span><span class="s1">render_links</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
    <span class="s3">&quot;method,expected&quot;</span><span class="s2">,</span>
    <span class="s2">[</span>
        <span class="s2">(</span><span class="s3">&quot;to_html&quot;</span><span class="s2">, </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">lorem_ipsum</span><span class="s2">),</span>
        <span class="s2">(</span><span class="s3">&quot;_repr_html_&quot;</span><span class="s2">, </span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s1">lorem_ipsum</span><span class="s2">[: </span><span class="s1">x </span><span class="s2">- </span><span class="s5">4</span><span class="s2">] + </span><span class="s3">&quot;...&quot;</span><span class="s2">),  </span><span class="s6"># regression case</span>
    <span class="s2">],</span>
<span class="s2">)</span>
<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;max_colwidth&quot;</span><span class="s2">, [</span><span class="s5">10</span><span class="s2">, </span><span class="s5">20</span><span class="s2">, </span><span class="s5">50</span><span class="s2">, </span><span class="s5">100</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_ignore_display_max_colwidth</span><span class="s2">(</span><span class="s1">method</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">, </span><span class="s1">max_colwidth</span><span class="s2">):</span>
    <span class="s6"># see gh-17004</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([</span><span class="s1">lorem_ipsum</span><span class="s2">])</span>
    <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_colwidth&quot;</span><span class="s2">, </span><span class="s1">max_colwidth</span><span class="s2">):</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">getattr</span><span class="s2">(</span><span class="s1">df</span><span class="s2">, </span><span class="s1">method</span><span class="s2">)()</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">(</span><span class="s1">max_colwidth</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">expected </span><span class="s0">in </span><span class="s1">result</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;classes&quot;</span><span class="s2">, [</span><span class="s0">True</span><span class="s2">, </span><span class="s5">0</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_to_html_invalid_classes_type</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">):</span>
    <span class="s6"># GH 25608</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">()</span>
    <span class="s1">msg </span><span class="s2">= </span><span class="s3">&quot;classes must be a string, list, or tuple&quot;</span>

    <span class="s0">with </span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">raises</span><span class="s2">(</span><span class="s1">TypeError</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">test_to_html_round_column_headers</span><span class="s2">():</span>
    <span class="s6"># GH 17280</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([</span><span class="s5">1</span><span class="s2">], </span><span class="s1">columns</span><span class="s2">=[</span><span class="s5">0.55555</span><span class="s2">])</span>
    <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.precision&quot;</span><span class="s2">, </span><span class="s5">3</span><span class="s2">):</span>
        <span class="s1">html </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">notebook</span><span class="s2">=</span><span class="s0">False</span><span class="s2">)</span>
        <span class="s1">notebook </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">notebook</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s3">&quot;0.55555&quot; </span><span class="s0">in </span><span class="s1">html</span>
    <span class="s0">assert </span><span class="s3">&quot;0.556&quot; </span><span class="s0">in </span><span class="s1">notebook</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;unit&quot;</span><span class="s2">, [</span><span class="s3">&quot;100px&quot;</span><span class="s2">, </span><span class="s3">&quot;10%&quot;</span><span class="s2">, </span><span class="s3">&quot;5em&quot;</span><span class="s2">, </span><span class="s5">150</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_to_html_with_col_space_units</span><span class="s2">(</span><span class="s1">unit</span><span class="s2">):</span>
    <span class="s6"># GH 25941</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">random</span><span class="s2">(</span><span class="s1">size</span><span class="s2">=(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">)))</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">=</span><span class="s1">unit</span><span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">result</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;tbody&quot;</span><span class="s2">)[</span><span class="s5">0</span><span class="s2">]</span>
    <span class="s1">hdrs </span><span class="s2">= [</span><span class="s1">x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">result</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;</span><span class="s0">\n</span><span class="s3">&quot;</span><span class="s2">) </span><span class="s0">if </span><span class="s1">re</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(</span><span class="s3">r&quot;&lt;th[&gt;\s]&quot;</span><span class="s2">, </span><span class="s1">x</span><span class="s2">)]</span>
    <span class="s0">if </span><span class="s1">isinstance</span><span class="s2">(</span><span class="s1">unit</span><span class="s2">, </span><span class="s1">int</span><span class="s2">):</span>
        <span class="s1">unit </span><span class="s2">= </span><span class="s1">str</span><span class="s2">(</span><span class="s1">unit</span><span class="s2">) + </span><span class="s3">&quot;px&quot;</span>
    <span class="s0">for </span><span class="s1">h </span><span class="s0">in </span><span class="s1">hdrs</span><span class="s2">:</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s3">f'&lt;th style=&quot;min-width: </span><span class="s0">{</span><span class="s1">unit</span><span class="s0">}</span><span class="s3">;&quot;&gt;'</span>
        <span class="s0">assert </span><span class="s1">expected </span><span class="s0">in </span><span class="s1">h</span>


<span class="s0">class </span><span class="s1">TestReprHTML</span><span class="s2">:</span>
    <span class="s0">def </span><span class="s1">test_html_repr_min_rows_default</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
        <span class="s6"># gh-27991</span>

        <span class="s6"># default setting no truncation even if above min_rows</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">20</span><span class="s2">)})</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;html_repr_min_rows_default_no_truncation&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

        <span class="s6"># default of max_rows 60 triggers truncation if above</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">61</span><span class="s2">)})</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;html_repr_min_rows_default_truncated&quot;</span><span class="s2">)</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span>
        <span class="s3">&quot;max_rows,min_rows,expected&quot;</span><span class="s2">,</span>
        <span class="s2">[</span>
            <span class="s6"># truncated after first two rows</span>
            <span class="s2">(</span><span class="s5">10</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s3">&quot;html_repr_max_rows_10_min_rows_4&quot;</span><span class="s2">),</span>
            <span class="s6"># when set to None, follow value of max_rows</span>
            <span class="s2">(</span><span class="s5">12</span><span class="s2">, </span><span class="s0">None</span><span class="s2">, </span><span class="s3">&quot;html_repr_max_rows_12_min_rows_None&quot;</span><span class="s2">),</span>
            <span class="s6"># when set value higher as max_rows, use the minimum</span>
            <span class="s2">(</span><span class="s5">10</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s3">&quot;html_repr_max_rows_10_min_rows_12&quot;</span><span class="s2">),</span>
            <span class="s6"># max_rows of None -&gt; never truncate</span>
            <span class="s2">(</span><span class="s0">None</span><span class="s2">, </span><span class="s5">12</span><span class="s2">, </span><span class="s3">&quot;html_repr_max_rows_None_min_rows_12&quot;</span><span class="s2">),</span>
        <span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s0">def </span><span class="s1">test_html_repr_min_rows</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">max_rows</span><span class="s2">, </span><span class="s1">min_rows</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">):</span>
        <span class="s6"># gh-27991</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s1">range</span><span class="s2">(</span><span class="s5">61</span><span class="s2">)})</span>
        <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s1">expected</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s1">max_rows</span><span class="s2">, </span><span class="s3">&quot;display.min_rows&quot;</span><span class="s2">, </span><span class="s1">min_rows</span><span class="s2">):</span>
            <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>

    <span class="s0">def </span><span class="s1">test_repr_html_ipython_config</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">ip</span><span class="s2">):</span>
        <span class="s1">code </span><span class="s2">= </span><span class="s1">textwrap</span><span class="s2">.</span><span class="s1">dedent</span><span class="s2">(</span>
            <span class="s3">&quot;&quot;&quot;</span><span class="s0">\ 
        </span><span class="s3">from pandas import DataFrame 
        df = DataFrame({&quot;A&quot;: [1, 2]}) 
        df._repr_html_() 
 
        cfg = get_ipython().config 
        cfg['IPKernelApp']['parent_appname'] 
        df._repr_html_() 
        &quot;&quot;&quot;</span>
        <span class="s2">)</span>
        <span class="s1">result </span><span class="s2">= </span><span class="s1">ip</span><span class="s2">.</span><span class="s1">run_cell</span><span class="s2">(</span><span class="s1">code</span><span class="s2">, </span><span class="s1">silent</span><span class="s2">=</span><span class="s0">True</span><span class="s2">)</span>
        <span class="s0">assert not </span><span class="s1">result</span><span class="s2">.</span><span class="s1">error_in_exec</span>

    <span class="s0">def </span><span class="s1">test_info_repr_html</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">max_rows </span><span class="s2">= </span><span class="s5">60</span>
        <span class="s1">max_cols </span><span class="s2">= </span><span class="s5">20</span>
        <span class="s6"># Long</span>
        <span class="s1">h</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">+ </span><span class="s5">1</span><span class="s2">, </span><span class="s1">max_cols </span><span class="s2">- </span><span class="s5">1</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s1">k</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">) </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">w</span><span class="s2">)})</span>
        <span class="s0">assert </span><span class="s3">r&quot;&amp;lt;class&quot; </span><span class="s0">not in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.large_repr&quot;</span><span class="s2">, </span><span class="s3">&quot;info&quot;</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">r&quot;&amp;lt;class&quot; </span><span class="s0">in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

        <span class="s6"># Wide</span>
        <span class="s1">h</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">- </span><span class="s5">1</span><span class="s2">, </span><span class="s1">max_cols </span><span class="s2">+ </span><span class="s5">1</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s1">k</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">) </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">w</span><span class="s2">)})</span>
        <span class="s0">assert </span><span class="s3">&quot;&lt;class&quot; </span><span class="s0">not in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span>
            <span class="s3">&quot;display.large_repr&quot;</span><span class="s2">, </span><span class="s3">&quot;info&quot;</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s1">max_cols</span>
        <span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;&amp;lt;class&quot; </span><span class="s0">in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_fake_qtconsole_repr_html</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">float_frame</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">float_frame</span>

        <span class="s0">def </span><span class="s1">get_ipython</span><span class="s2">():</span>
            <span class="s0">return </span><span class="s2">{</span><span class="s3">&quot;config&quot;</span><span class="s2">: {</span><span class="s3">&quot;KernelApp&quot;</span><span class="s2">: {</span><span class="s3">&quot;parent_appname&quot;</span><span class="s2">: </span><span class="s3">&quot;ipython-qtconsole&quot;</span><span class="s2">}}}</span>

        <span class="s1">repstr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s1">repstr </span><span class="s0">is not None</span>

        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">5</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s2">):</span>
            <span class="s1">repstr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

        <span class="s0">assert </span><span class="s3">&quot;class&quot; </span><span class="s0">in </span><span class="s1">repstr  </span><span class="s6"># info fallback</span>

    <span class="s0">def </span><span class="s1">test_repr_html</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s1">float_frame</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">float_frame</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s2">):</span>
            <span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.notebook_repr_html&quot;</span><span class="s2">, </span><span class="s0">False</span><span class="s2">):</span>
            <span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">]])</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.show_dimensions&quot;</span><span class="s2">, </span><span class="s0">True</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;2 rows&quot; </span><span class="s0">in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.show_dimensions&quot;</span><span class="s2">, </span><span class="s0">False</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;2 rows&quot; </span><span class="s0">not in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_repr_html_mathjax</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">], [</span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s2">]])</span>
        <span class="s0">assert </span><span class="s3">&quot;tex2jax_ignore&quot; </span><span class="s0">not in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.html.use_mathjax&quot;</span><span class="s2">, </span><span class="s0">False</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;tex2jax_ignore&quot; </span><span class="s0">in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_repr_html_wide</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">max_cols </span><span class="s2">= </span><span class="s5">20</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s3">&quot;a&quot; </span><span class="s2">* </span><span class="s5">25</span><span class="s2">] * (</span><span class="s1">max_cols </span><span class="s2">- </span><span class="s5">1</span><span class="s2">)] * </span><span class="s5">10</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">60</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s5">20</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;...&quot; </span><span class="s0">not in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

        <span class="s1">wide_df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s3">&quot;a&quot; </span><span class="s2">* </span><span class="s5">25</span><span class="s2">] * (</span><span class="s1">max_cols </span><span class="s2">+ </span><span class="s5">1</span><span class="s2">)] * </span><span class="s5">10</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">60</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s5">20</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;...&quot; </span><span class="s0">in </span><span class="s1">wide_df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_repr_html_wide_multiindex_cols</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">max_cols </span><span class="s2">= </span><span class="s5">20</span>

        <span class="s1">mcols </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">(</span>
            <span class="s2">[</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">max_cols </span><span class="s2">// </span><span class="s5">2</span><span class="s2">), [</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">]], </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;first&quot;</span><span class="s2">, </span><span class="s3">&quot;second&quot;</span><span class="s2">]</span>
        <span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s3">&quot;a&quot; </span><span class="s2">* </span><span class="s5">25</span><span class="s2">] * </span><span class="s1">len</span><span class="s2">(</span><span class="s1">mcols</span><span class="s2">)] * </span><span class="s5">10</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">mcols</span><span class="s2">)</span>
        <span class="s1">reg_repr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s3">&quot;...&quot; </span><span class="s0">not in </span><span class="s1">reg_repr</span>

        <span class="s1">mcols </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_product</span><span class="s2">(</span>
            <span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1 </span><span class="s2">+ (</span><span class="s1">max_cols </span><span class="s2">// </span><span class="s5">2</span><span class="s2">)), [</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">]), </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;first&quot;</span><span class="s2">, </span><span class="s3">&quot;second&quot;</span><span class="s2">]</span>
        <span class="s2">)</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s3">&quot;a&quot; </span><span class="s2">* </span><span class="s5">25</span><span class="s2">] * </span><span class="s1">len</span><span class="s2">(</span><span class="s1">mcols</span><span class="s2">)] * </span><span class="s5">10</span><span class="s2">, </span><span class="s1">columns</span><span class="s2">=</span><span class="s1">mcols</span><span class="s2">)</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">60</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s5">20</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;...&quot; </span><span class="s0">in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">test_repr_html_long</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">60</span><span class="s2">):</span>
            <span class="s1">max_rows </span><span class="s2">= </span><span class="s1">get_option</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">)</span>
            <span class="s1">h </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">- </span><span class="s5">1</span>
            <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">), </span><span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">41</span><span class="s2">, </span><span class="s5">41 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">)})</span>
            <span class="s1">reg_repr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
            <span class="s0">assert </span><span class="s3">&quot;..&quot; </span><span class="s0">not in </span><span class="s1">reg_repr</span>
            <span class="s0">assert </span><span class="s1">str</span><span class="s2">(</span><span class="s5">41 </span><span class="s2">+ </span><span class="s1">max_rows </span><span class="s2">// </span><span class="s5">2</span><span class="s2">) </span><span class="s0">in </span><span class="s1">reg_repr</span>

            <span class="s1">h </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">+ </span><span class="s5">1</span>
            <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">), </span><span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">41</span><span class="s2">, </span><span class="s5">41 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">)})</span>
            <span class="s1">long_repr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
            <span class="s0">assert </span><span class="s3">&quot;..&quot; </span><span class="s0">in </span><span class="s1">long_repr</span>
            <span class="s0">assert </span><span class="s1">str</span><span class="s2">(</span><span class="s5">41 </span><span class="s2">+ </span><span class="s1">max_rows </span><span class="s2">// </span><span class="s5">2</span><span class="s2">) </span><span class="s0">not in </span><span class="s1">long_repr</span>
            <span class="s0">assert </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">h</span><span class="s0">} </span><span class="s3">rows &quot; </span><span class="s0">in </span><span class="s1">long_repr</span>
            <span class="s0">assert </span><span class="s3">&quot;2 columns&quot; </span><span class="s0">in </span><span class="s1">long_repr</span>

    <span class="s0">def </span><span class="s1">test_repr_html_float</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">60</span><span class="s2">):</span>
            <span class="s1">max_rows </span><span class="s2">= </span><span class="s1">get_option</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">)</span>
            <span class="s1">h </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">- </span><span class="s5">1</span>
            <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
                <span class="s2">{</span>
                    <span class="s3">&quot;idx&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(-</span><span class="s5">10</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s1">h</span><span class="s2">),</span>
                    <span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">),</span>
                    <span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">41</span><span class="s2">, </span><span class="s5">41 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">),</span>
                <span class="s2">}</span>
            <span class="s2">).</span><span class="s1">set_index</span><span class="s2">(</span><span class="s3">&quot;idx&quot;</span><span class="s2">)</span>
            <span class="s1">reg_repr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
            <span class="s0">assert </span><span class="s3">&quot;..&quot; </span><span class="s0">not in </span><span class="s1">reg_repr</span>
            <span class="s0">assert </span><span class="s3">f&quot;&lt;td&gt;</span><span class="s0">{</span><span class="s5">40 </span><span class="s2">+ </span><span class="s1">h</span><span class="s0">}</span><span class="s3">&lt;/td&gt;&quot; </span><span class="s0">in </span><span class="s1">reg_repr</span>

            <span class="s1">h </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">+ </span><span class="s5">1</span>
            <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
                <span class="s2">{</span>
                    <span class="s3">&quot;idx&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">linspace</span><span class="s2">(-</span><span class="s5">10</span><span class="s2">, </span><span class="s5">10</span><span class="s2">, </span><span class="s1">h</span><span class="s2">),</span>
                    <span class="s3">&quot;A&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">),</span>
                    <span class="s3">&quot;B&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">41</span><span class="s2">, </span><span class="s5">41 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">),</span>
                <span class="s2">}</span>
            <span class="s2">).</span><span class="s1">set_index</span><span class="s2">(</span><span class="s3">&quot;idx&quot;</span><span class="s2">)</span>
            <span class="s1">long_repr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
            <span class="s0">assert </span><span class="s3">&quot;..&quot; </span><span class="s0">in </span><span class="s1">long_repr</span>
            <span class="s0">assert </span><span class="s3">&quot;&lt;td&gt;31&lt;/td&gt;&quot; </span><span class="s0">not in </span><span class="s1">long_repr</span>
            <span class="s0">assert </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">h</span><span class="s0">} </span><span class="s3">rows &quot; </span><span class="s0">in </span><span class="s1">long_repr</span>
            <span class="s0">assert </span><span class="s3">&quot;2 columns&quot; </span><span class="s0">in </span><span class="s1">long_repr</span>

    <span class="s0">def </span><span class="s1">test_repr_html_long_multiindex</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">max_rows </span><span class="s2">= </span><span class="s5">60</span>
        <span class="s1">max_L1 </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">// </span><span class="s5">2</span>

        <span class="s1">tuples </span><span class="s2">= </span><span class="s1">list</span><span class="s2">(</span><span class="s1">itertools</span><span class="s2">.</span><span class="s1">product</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">max_L1</span><span class="s2">), [</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">]))</span>
        <span class="s1">idx </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_tuples</span><span class="s2">(</span><span class="s1">tuples</span><span class="s2">, </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;first&quot;</span><span class="s2">, </span><span class="s3">&quot;second&quot;</span><span class="s2">])</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">((</span><span class="s1">max_L1 </span><span class="s2">* </span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s2">)),</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">idx</span><span class="s2">,</span>
            <span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">],</span>
        <span class="s2">)</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">60</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s5">20</span><span class="s2">):</span>
            <span class="s1">reg_repr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s3">&quot;...&quot; </span><span class="s0">not in </span><span class="s1">reg_repr</span>

        <span class="s1">tuples </span><span class="s2">= </span><span class="s1">list</span><span class="s2">(</span><span class="s1">itertools</span><span class="s2">.</span><span class="s1">product</span><span class="s2">(</span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">max_L1 </span><span class="s2">+ </span><span class="s5">1</span><span class="s2">), [</span><span class="s3">&quot;foo&quot;</span><span class="s2">, </span><span class="s3">&quot;bar&quot;</span><span class="s2">]))</span>
        <span class="s1">idx </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_tuples</span><span class="s2">(</span><span class="s1">tuples</span><span class="s2">, </span><span class="s1">names</span><span class="s2">=[</span><span class="s3">&quot;first&quot;</span><span class="s2">, </span><span class="s3">&quot;second&quot;</span><span class="s2">])</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
            <span class="s1">np</span><span class="s2">.</span><span class="s1">random</span><span class="s2">.</span><span class="s1">default_rng</span><span class="s2">(</span><span class="s5">2</span><span class="s2">).</span><span class="s1">standard_normal</span><span class="s2">(((</span><span class="s1">max_L1 </span><span class="s2">+ </span><span class="s5">1</span><span class="s2">) * </span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s2">)),</span>
            <span class="s1">index</span><span class="s2">=</span><span class="s1">idx</span><span class="s2">,</span>
            <span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">],</span>
        <span class="s2">)</span>
        <span class="s1">long_repr </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>
        <span class="s0">assert </span><span class="s3">&quot;...&quot; </span><span class="s0">in </span><span class="s1">long_repr</span>

    <span class="s0">def </span><span class="s1">test_repr_html_long_and_wide</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">max_cols </span><span class="s2">= </span><span class="s5">20</span>
        <span class="s1">max_rows </span><span class="s2">= </span><span class="s5">60</span>

        <span class="s1">h</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">- </span><span class="s5">1</span><span class="s2">, </span><span class="s1">max_cols </span><span class="s2">- </span><span class="s5">1</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s1">k</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">) </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">w</span><span class="s2">)})</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">60</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s5">20</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;...&quot; </span><span class="s0">not in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>

        <span class="s1">h</span><span class="s2">, </span><span class="s1">w </span><span class="s2">= </span><span class="s1">max_rows </span><span class="s2">+ </span><span class="s5">1</span><span class="s2">, </span><span class="s1">max_cols </span><span class="s2">+ </span><span class="s5">1</span>
        <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s1">k</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1 </span><span class="s2">+ </span><span class="s1">h</span><span class="s2">) </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">np</span><span class="s2">.</span><span class="s1">arange</span><span class="s2">(</span><span class="s1">w</span><span class="s2">)})</span>
        <span class="s0">with </span><span class="s1">option_context</span><span class="s2">(</span><span class="s3">&quot;display.max_rows&quot;</span><span class="s2">, </span><span class="s5">60</span><span class="s2">, </span><span class="s3">&quot;display.max_columns&quot;</span><span class="s2">, </span><span class="s5">20</span><span class="s2">):</span>
            <span class="s0">assert </span><span class="s3">&quot;...&quot; </span><span class="s0">in </span><span class="s1">df</span><span class="s2">.</span><span class="s1">_repr_html_</span><span class="s2">()</span>


<span class="s0">def </span><span class="s1">test_to_html_multilevel</span><span class="s2">(</span><span class="s1">multiindex_year_month_day_dataframe_random_data</span><span class="s2">):</span>
    <span class="s1">ymd </span><span class="s2">= </span><span class="s1">multiindex_year_month_day_dataframe_random_data</span>

    <span class="s1">ymd</span><span class="s2">.</span><span class="s1">columns</span><span class="s2">.</span><span class="s1">name </span><span class="s2">= </span><span class="s3">&quot;foo&quot;</span>
    <span class="s1">ymd</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">()</span>
    <span class="s1">ymd</span><span class="s2">.</span><span class="s1">T</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">()</span>


<span class="s2">@</span><span class="s1">pytest</span><span class="s2">.</span><span class="s1">mark</span><span class="s2">.</span><span class="s1">parametrize</span><span class="s2">(</span><span class="s3">&quot;na_rep&quot;</span><span class="s2">, [</span><span class="s3">&quot;NaN&quot;</span><span class="s2">, </span><span class="s3">&quot;Ted&quot;</span><span class="s2">])</span>
<span class="s0">def </span><span class="s1">test_to_html_na_rep_and_float_format</span><span class="s2">(</span><span class="s1">na_rep</span><span class="s2">, </span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># https://github.com/pandas-dev/pandas/issues/13828</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span>
        <span class="s2">[</span>
            <span class="s2">[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s5">1.2225</span><span class="s2">],</span>
            <span class="s2">[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">],</span>
        <span class="s2">],</span>
        <span class="s1">columns</span><span class="s2">=[</span><span class="s3">&quot;Group&quot;</span><span class="s2">, </span><span class="s3">&quot;Data&quot;</span><span class="s2">],</span>
    <span class="s2">)</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">na_rep</span><span class="s2">=</span><span class="s1">na_rep</span><span class="s2">, </span><span class="s1">float_format</span><span class="s2">=</span><span class="s3">&quot;{:.2f}&quot;</span><span class="s2">.</span><span class="s1">format</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh13828_expected_output&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">na_rep</span><span class="s2">=</span><span class="s1">na_rep</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_na_rep_non_scalar_data</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH47103</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([{</span><span class="s3">&quot;a&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]}])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">na_rep</span><span class="s2">=</span><span class="s3">&quot;-&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh47103_expected_output&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_float_format_object_col</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">):</span>
    <span class="s6"># GH#40024</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">(</span><span class="s1">data</span><span class="s2">={</span><span class="s3">&quot;x&quot;</span><span class="s2">: [</span><span class="s5">1000.0</span><span class="s2">, </span><span class="s3">&quot;test&quot;</span><span class="s2">]})</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">float_format</span><span class="s2">=</span><span class="s0">lambda </span><span class="s1">x</span><span class="s2">: </span><span class="s3">f&quot;</span><span class="s0">{</span><span class="s1">x</span><span class="s0">:</span><span class="s3">,.0f</span><span class="s0">}</span><span class="s3">&quot;</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= </span><span class="s1">expected_html</span><span class="s2">(</span><span class="s1">datapath</span><span class="s2">, </span><span class="s3">&quot;gh40024_expected_output&quot;</span><span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_multiindex_col_with_colspace</span><span class="s2">():</span>
    <span class="s6"># GH#53885</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">([[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">]])</span>
    <span class="s1">df</span><span class="s2">.</span><span class="s1">columns </span><span class="s2">= </span><span class="s1">MultiIndex</span><span class="s2">.</span><span class="s1">from_tuples</span><span class="s2">([(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">), (</span><span class="s5">2</span><span class="s2">, </span><span class="s5">1</span><span class="s2">)])</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">=</span><span class="s5">100</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= (</span>
        <span class="s3">'&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">&quot;  &lt;thead&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;    &lt;tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;1&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;2&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">&quot;    &lt;/tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;    &lt;tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;1&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;1&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">&quot;    &lt;/tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;/thead&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;tbody&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;    &lt;tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;      &lt;th&gt;0&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;      &lt;td&gt;1&lt;/td&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;      &lt;td&gt;2&lt;/td&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;    &lt;/tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;/tbody&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;&lt;/table&gt;&quot;</span>
    <span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_tuple_col_with_colspace</span><span class="s2">():</span>
    <span class="s6"># GH#53885</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({(</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">): [</span><span class="s5">1</span><span class="s2">], </span><span class="s3">&quot;b&quot;</span><span class="s2">: [</span><span class="s5">2</span><span class="s2">]})</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">=</span><span class="s5">100</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= (</span>
        <span class="s3">'&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">&quot;  &lt;thead&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">'    &lt;tr style=&quot;text-align: right;&quot;&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;(a, b)&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;b&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">&quot;    &lt;/tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;/thead&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;tbody&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;    &lt;tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;      &lt;th&gt;0&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;      &lt;td&gt;1&lt;/td&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;      &lt;td&gt;2&lt;/td&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;    &lt;/tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;/tbody&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;&lt;/table&gt;&quot;</span>
    <span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_empty_complex_array</span><span class="s2">():</span>
    <span class="s6"># GH#54167</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;x&quot;</span><span class="s2">: </span><span class="s1">np</span><span class="s2">.</span><span class="s1">array</span><span class="s2">([], </span><span class="s1">dtype</span><span class="s2">=</span><span class="s3">&quot;complex&quot;</span><span class="s2">)})</span>
    <span class="s1">result </span><span class="s2">= </span><span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s1">col_space</span><span class="s2">=</span><span class="s5">100</span><span class="s2">)</span>
    <span class="s1">expected </span><span class="s2">= (</span>
        <span class="s3">'&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">&quot;  &lt;thead&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">'    &lt;tr style=&quot;text-align: right;&quot;&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">'      &lt;th style=&quot;min-width: 100px;&quot;&gt;x&lt;/th&gt;</span><span class="s0">\n</span><span class="s3">'</span>
        <span class="s3">&quot;    &lt;/tr&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;/thead&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;tbody&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;  &lt;/tbody&gt;</span><span class="s0">\n</span><span class="s3">&quot;</span>
        <span class="s3">&quot;&lt;/table&gt;&quot;</span>
    <span class="s2">)</span>
    <span class="s0">assert </span><span class="s1">result </span><span class="s2">== </span><span class="s1">expected</span>


<span class="s0">def </span><span class="s1">test_to_html_pos_args_deprecation</span><span class="s2">():</span>
    <span class="s6"># GH-54229</span>
    <span class="s1">df </span><span class="s2">= </span><span class="s1">DataFrame</span><span class="s2">({</span><span class="s3">&quot;a&quot;</span><span class="s2">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">]})</span>
    <span class="s1">msg </span><span class="s2">= (</span>
        <span class="s3">r&quot;Starting with pandas version 3.0 all arguments of to_html except for the &quot;</span>
        <span class="s3">r&quot;argument 'buf' will be keyword-only.&quot;</span>
    <span class="s2">)</span>
    <span class="s0">with </span><span class="s1">tm</span><span class="s2">.</span><span class="s1">assert_produces_warning</span><span class="s2">(</span><span class="s1">FutureWarning</span><span class="s2">, </span><span class="s1">match</span><span class="s2">=</span><span class="s1">msg</span><span class="s2">):</span>
        <span class="s1">df</span><span class="s2">.</span><span class="s1">to_html</span><span class="s2">(</span><span class="s0">None</span><span class="s2">, </span><span class="s0">None</span><span class="s2">)</span>
</pre>
</body>
</html>