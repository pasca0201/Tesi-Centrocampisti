<html>
<head>
<title>test_stat_reductions.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_stat_reductions.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
Tests for statistical reductions of 2nd moment or higher: var, skew, kurt, ... 
&quot;&quot;&quot;</span>
<span class="s2">import </span><span class="s1">inspect</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">from </span><span class="s1">pandas </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">DataFrame</span><span class="s3">,</span>
    <span class="s1">Series</span><span class="s3">,</span>
    <span class="s1">date_range</span><span class="s3">,</span>
<span class="s3">)</span>
<span class="s2">import </span><span class="s1">pandas</span><span class="s3">.</span><span class="s1">_testing </span><span class="s2">as </span><span class="s1">tm</span>


<span class="s2">class </span><span class="s1">TestDatetimeLikeStatReductions</span><span class="s3">:</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;box&quot;</span><span class="s3">, [</span><span class="s1">Series</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">array</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_dt64_mean</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">tz_naive_fixture</span><span class="s3">, </span><span class="s1">box</span><span class="s3">):</span>
        <span class="s1">tz </span><span class="s3">= </span><span class="s1">tz_naive_fixture</span>

        <span class="s1">dti </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2001-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">11</span><span class="s3">, </span><span class="s1">tz</span><span class="s3">=</span><span class="s1">tz</span><span class="s3">)</span>
        <span class="s6"># shuffle so that we are not just working with monotone-increasing</span>
        <span class="s1">dti </span><span class="s3">= </span><span class="s1">dti</span><span class="s3">.</span><span class="s1">take</span><span class="s3">([</span><span class="s5">4</span><span class="s3">, </span><span class="s5">1</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">10</span><span class="s3">, </span><span class="s5">9</span><span class="s3">, </span><span class="s5">7</span><span class="s3">, </span><span class="s5">8</span><span class="s3">, </span><span class="s5">5</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">6</span><span class="s3">])</span>
        <span class="s1">dtarr </span><span class="s3">= </span><span class="s1">dti</span><span class="s3">.</span><span class="s1">_data</span>

        <span class="s1">obj </span><span class="s3">= </span><span class="s1">box</span><span class="s3">(</span><span class="s1">dtarr</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">() == </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s4">&quot;2001-01-06&quot;</span><span class="s3">, </span><span class="s1">tz</span><span class="s3">=</span><span class="s1">tz</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">(</span><span class="s1">skipna</span><span class="s3">=</span><span class="s2">False</span><span class="s3">) == </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s4">&quot;2001-01-06&quot;</span><span class="s3">, </span><span class="s1">tz</span><span class="s3">=</span><span class="s1">tz</span><span class="s3">)</span>

        <span class="s6"># dtarr[-2] will be the first date 2001-01-1</span>
        <span class="s1">dtarr</span><span class="s3">[-</span><span class="s5">2</span><span class="s3">] = </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">NaT</span>

        <span class="s1">obj </span><span class="s3">= </span><span class="s1">box</span><span class="s3">(</span><span class="s1">dtarr</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">() == </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Timestamp</span><span class="s3">(</span><span class="s4">&quot;2001-01-06 07:12:00&quot;</span><span class="s3">, </span><span class="s1">tz</span><span class="s3">=</span><span class="s1">tz</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">(</span><span class="s1">skipna</span><span class="s3">=</span><span class="s2">False</span><span class="s3">) </span><span class="s2">is </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">NaT</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;box&quot;</span><span class="s3">, [</span><span class="s1">Series</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">array</span><span class="s3">])</span>
    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;freq&quot;</span><span class="s3">, [</span><span class="s4">&quot;s&quot;</span><span class="s3">, </span><span class="s4">&quot;h&quot;</span><span class="s3">, </span><span class="s4">&quot;D&quot;</span><span class="s3">, </span><span class="s4">&quot;W&quot;</span><span class="s3">, </span><span class="s4">&quot;B&quot;</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_period_mean</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">box</span><span class="s3">, </span><span class="s1">freq</span><span class="s3">):</span>
        <span class="s6"># GH#24757</span>
        <span class="s1">dti </span><span class="s3">= </span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2001-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">11</span><span class="s3">)</span>
        <span class="s6"># shuffle so that we are not just working with monotone-increasing</span>
        <span class="s1">dti </span><span class="s3">= </span><span class="s1">dti</span><span class="s3">.</span><span class="s1">take</span><span class="s3">([</span><span class="s5">4</span><span class="s3">, </span><span class="s5">1</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">10</span><span class="s3">, </span><span class="s5">9</span><span class="s3">, </span><span class="s5">7</span><span class="s3">, </span><span class="s5">8</span><span class="s3">, </span><span class="s5">5</span><span class="s3">, </span><span class="s5">0</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">6</span><span class="s3">])</span>

        <span class="s1">warn </span><span class="s3">= </span><span class="s1">FutureWarning </span><span class="s2">if </span><span class="s1">freq </span><span class="s3">== </span><span class="s4">&quot;B&quot; </span><span class="s2">else None</span>
        <span class="s1">msg </span><span class="s3">= </span><span class="s4">r&quot;PeriodDtype\[B\] is deprecated&quot;</span>
        <span class="s2">with </span><span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_produces_warning</span><span class="s3">(</span><span class="s1">warn</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
            <span class="s1">parr </span><span class="s3">= </span><span class="s1">dti</span><span class="s3">.</span><span class="s1">_data</span><span class="s3">.</span><span class="s1">to_period</span><span class="s3">(</span><span class="s1">freq</span><span class="s3">)</span>
        <span class="s1">obj </span><span class="s3">= </span><span class="s1">box</span><span class="s3">(</span><span class="s1">parr</span><span class="s3">)</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;ambiguous&quot;</span><span class="s3">):</span>
            <span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">()</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;ambiguous&quot;</span><span class="s3">):</span>
            <span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">(</span><span class="s1">skipna</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

        <span class="s6"># parr[-2] will be the first date 2001-01-1</span>
        <span class="s1">parr</span><span class="s3">[-</span><span class="s5">2</span><span class="s3">] = </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">NaT</span>

        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;ambiguous&quot;</span><span class="s3">):</span>
            <span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">()</span>
        <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s4">&quot;ambiguous&quot;</span><span class="s3">):</span>
            <span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">(</span><span class="s1">skipna</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">mark</span><span class="s3">.</span><span class="s1">parametrize</span><span class="s3">(</span><span class="s4">&quot;box&quot;</span><span class="s3">, [</span><span class="s1">Series</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">Index</span><span class="s3">, </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">array</span><span class="s3">])</span>
    <span class="s2">def </span><span class="s1">test_td64_mean</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">box</span><span class="s3">):</span>
        <span class="s1">m8values </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span><span class="s5">0</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, -</span><span class="s5">2</span><span class="s3">, -</span><span class="s5">7</span><span class="s3">, </span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, -</span><span class="s5">1</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s5">5</span><span class="s3">, -</span><span class="s5">2</span><span class="s3">, </span><span class="s5">4</span><span class="s3">], </span><span class="s4">&quot;m8[D]&quot;</span><span class="s3">)</span>
        <span class="s1">tdi </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">TimedeltaIndex</span><span class="s3">(</span><span class="s1">m8values</span><span class="s3">).</span><span class="s1">as_unit</span><span class="s3">(</span><span class="s4">&quot;ns&quot;</span><span class="s3">)</span>

        <span class="s1">tdarr </span><span class="s3">= </span><span class="s1">tdi</span><span class="s3">.</span><span class="s1">_data</span>
        <span class="s1">obj </span><span class="s3">= </span><span class="s1">box</span><span class="s3">(</span><span class="s1">tdarr</span><span class="s3">, </span><span class="s1">copy</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">()</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">tdarr</span><span class="s3">).</span><span class="s1">mean</span><span class="s3">()</span>
        <span class="s2">assert </span><span class="s1">result </span><span class="s3">== </span><span class="s1">expected</span>

        <span class="s1">tdarr</span><span class="s3">[</span><span class="s5">0</span><span class="s3">] = </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">NaT</span>
        <span class="s2">assert </span><span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">(</span><span class="s1">skipna</span><span class="s3">=</span><span class="s2">False</span><span class="s3">) </span><span class="s2">is </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">NaT</span>

        <span class="s1">result2 </span><span class="s3">= </span><span class="s1">obj</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">(</span><span class="s1">skipna</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">result2 </span><span class="s3">== </span><span class="s1">tdi</span><span class="s3">[</span><span class="s5">1</span><span class="s3">:].</span><span class="s1">mean</span><span class="s3">()</span>

        <span class="s6"># exact equality fails by 1 nanosecond</span>
        <span class="s2">assert </span><span class="s1">result2</span><span class="s3">.</span><span class="s1">round</span><span class="s3">(</span><span class="s4">&quot;us&quot;</span><span class="s3">) == (</span><span class="s1">result </span><span class="s3">* </span><span class="s5">11.0 </span><span class="s3">/ </span><span class="s5">10</span><span class="s3">).</span><span class="s1">round</span><span class="s3">(</span><span class="s4">&quot;us&quot;</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestSeriesStatReductions</span><span class="s3">:</span>
    <span class="s6"># Note: the name TestSeriesStatReductions indicates these tests</span>
    <span class="s6">#  were moved from a series-specific test file, _not_ that these tests are</span>
    <span class="s6">#  intended long-term to be series-specific</span>

    <span class="s2">def </span><span class="s1">_check_stat_op</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">, </span><span class="s1">name</span><span class="s3">, </span><span class="s1">alternate</span><span class="s3">, </span><span class="s1">string_series_</span><span class="s3">, </span><span class="s1">check_objects</span><span class="s3">=</span><span class="s2">False</span><span class="s3">, </span><span class="s1">check_allna</span><span class="s3">=</span><span class="s2">False</span>
    <span class="s3">):</span>
        <span class="s2">with </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">option_context</span><span class="s3">(</span><span class="s4">&quot;use_bottleneck&quot;</span><span class="s3">, </span><span class="s2">False</span><span class="s3">):</span>
            <span class="s1">f </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">Series</span><span class="s3">, </span><span class="s1">name</span><span class="s3">)</span>

            <span class="s6"># add some NaNs</span>
            <span class="s1">string_series_</span><span class="s3">[</span><span class="s5">5</span><span class="s3">:</span><span class="s5">15</span><span class="s3">] = </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>

            <span class="s6"># mean, idxmax, idxmin, min, and max are valid for dates</span>
            <span class="s2">if </span><span class="s1">name </span><span class="s2">not in </span><span class="s3">[</span><span class="s4">&quot;max&quot;</span><span class="s3">, </span><span class="s4">&quot;min&quot;</span><span class="s3">, </span><span class="s4">&quot;mean&quot;</span><span class="s3">, </span><span class="s4">&quot;median&quot;</span><span class="s3">, </span><span class="s4">&quot;std&quot;</span><span class="s3">]:</span>
                <span class="s1">ds </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2001&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">10</span><span class="s3">))</span>
                <span class="s1">msg </span><span class="s3">= </span><span class="s4">f&quot;does not support reduction '</span><span class="s2">{</span><span class="s1">name</span><span class="s2">}</span><span class="s4">'&quot;</span>
                <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
                    <span class="s1">f</span><span class="s3">(</span><span class="s1">ds</span><span class="s3">)</span>

            <span class="s6"># skipna or no</span>
            <span class="s2">assert </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">notna</span><span class="s3">(</span><span class="s1">f</span><span class="s3">(</span><span class="s1">string_series_</span><span class="s3">))</span>
            <span class="s2">assert </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">f</span><span class="s3">(</span><span class="s1">string_series_</span><span class="s3">, </span><span class="s1">skipna</span><span class="s3">=</span><span class="s2">False</span><span class="s3">))</span>

            <span class="s6"># check the result is correct</span>
            <span class="s1">nona </span><span class="s3">= </span><span class="s1">string_series_</span><span class="s3">.</span><span class="s1">dropna</span><span class="s3">()</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">f</span><span class="s3">(</span><span class="s1">nona</span><span class="s3">), </span><span class="s1">alternate</span><span class="s3">(</span><span class="s1">nona</span><span class="s3">.</span><span class="s1">values</span><span class="s3">))</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">f</span><span class="s3">(</span><span class="s1">string_series_</span><span class="s3">), </span><span class="s1">alternate</span><span class="s3">(</span><span class="s1">nona</span><span class="s3">.</span><span class="s1">values</span><span class="s3">))</span>

            <span class="s1">allna </span><span class="s3">= </span><span class="s1">string_series_ </span><span class="s3">* </span><span class="s1">np</span><span class="s3">.</span><span class="s1">nan</span>

            <span class="s2">if </span><span class="s1">check_allna</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">f</span><span class="s3">(</span><span class="s1">allna</span><span class="s3">))</span>

            <span class="s6"># dtype=object with None, it works!</span>
            <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">([</span><span class="s5">1</span><span class="s3">, </span><span class="s5">2</span><span class="s3">, </span><span class="s5">3</span><span class="s3">, </span><span class="s2">None</span><span class="s3">, </span><span class="s5">5</span><span class="s3">])</span>
            <span class="s1">f</span><span class="s3">(</span><span class="s1">s</span><span class="s3">)</span>

            <span class="s6"># GH#2888</span>
            <span class="s1">items </span><span class="s3">= [</span><span class="s5">0</span><span class="s3">]</span>
            <span class="s1">items</span><span class="s3">.</span><span class="s1">extend</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">2</span><span class="s3">**</span><span class="s5">40</span><span class="s3">, </span><span class="s5">2</span><span class="s3">**</span><span class="s5">40 </span><span class="s3">+ </span><span class="s5">1000</span><span class="s3">))</span>
            <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">items</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s4">&quot;int64&quot;</span><span class="s3">)</span>
            <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">float</span><span class="s3">(</span><span class="s1">f</span><span class="s3">(</span><span class="s1">s</span><span class="s3">)), </span><span class="s1">float</span><span class="s3">(</span><span class="s1">alternate</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">values</span><span class="s3">)))</span>

            <span class="s6"># check date range</span>
            <span class="s2">if </span><span class="s1">check_objects</span><span class="s3">:</span>
                <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">bdate_range</span><span class="s3">(</span><span class="s4">&quot;1/1/2000&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">10</span><span class="s3">))</span>
                <span class="s1">res </span><span class="s3">= </span><span class="s1">f</span><span class="s3">(</span><span class="s1">s</span><span class="s3">)</span>
                <span class="s1">exp </span><span class="s3">= </span><span class="s1">alternate</span><span class="s3">(</span><span class="s1">s</span><span class="s3">)</span>
                <span class="s2">assert </span><span class="s1">res </span><span class="s3">== </span><span class="s1">exp</span>

            <span class="s6"># check on string data</span>
            <span class="s2">if </span><span class="s1">name </span><span class="s2">not in </span><span class="s3">[</span><span class="s4">&quot;sum&quot;</span><span class="s3">, </span><span class="s4">&quot;min&quot;</span><span class="s3">, </span><span class="s4">&quot;max&quot;</span><span class="s3">]:</span>
                <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">TypeError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s2">None</span><span class="s3">):</span>
                    <span class="s1">f</span><span class="s3">(</span><span class="s1">Series</span><span class="s3">(</span><span class="s1">list</span><span class="s3">(</span><span class="s4">&quot;abc&quot;</span><span class="s3">)))</span>

            <span class="s6"># Invalid axis.</span>
            <span class="s1">msg </span><span class="s3">= </span><span class="s4">&quot;No axis named 1 for object type Series&quot;</span>
            <span class="s2">with </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">raises</span><span class="s3">(</span><span class="s1">ValueError</span><span class="s3">, </span><span class="s1">match</span><span class="s3">=</span><span class="s1">msg</span><span class="s3">):</span>
                <span class="s1">f</span><span class="s3">(</span><span class="s1">string_series_</span><span class="s3">, </span><span class="s1">axis</span><span class="s3">=</span><span class="s5">1</span><span class="s3">)</span>

            <span class="s2">if </span><span class="s4">&quot;numeric_only&quot; </span><span class="s2">in </span><span class="s1">inspect</span><span class="s3">.</span><span class="s1">getfullargspec</span><span class="s3">(</span><span class="s1">f</span><span class="s3">).</span><span class="s1">args</span><span class="s3">:</span>
                <span class="s6"># only the index is string; dtype is float</span>
                <span class="s1">f</span><span class="s3">(</span><span class="s1">string_series_</span><span class="s3">, </span><span class="s1">numeric_only</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_sum</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;sum&quot;</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">sum</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">, </span><span class="s1">check_allna</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_mean</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;mean&quot;</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">mean</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_median</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;median&quot;</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">median</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">)</span>

        <span class="s6"># test with integers, test failure</span>
        <span class="s1">int_ts </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s5">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">int</span><span class="s3">), </span><span class="s1">index</span><span class="s3">=</span><span class="s1">range</span><span class="s3">(</span><span class="s5">10</span><span class="s3">))</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">median</span><span class="s3">(</span><span class="s1">int_ts</span><span class="s3">), </span><span class="s1">int_ts</span><span class="s3">.</span><span class="s1">median</span><span class="s3">())</span>

    <span class="s2">def </span><span class="s1">test_prod</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;prod&quot;</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">prod</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_min</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;min&quot;</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">min</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">, </span><span class="s1">check_objects</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_max</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;max&quot;</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">max</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">, </span><span class="s1">check_objects</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_var_std</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>
        <span class="s1">datetime_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">10</span><span class="s3">),</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;ts&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>

        <span class="s1">alt </span><span class="s3">= </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">std</span><span class="s3">(</span><span class="s1">x</span><span class="s3">, </span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">1</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;std&quot;</span><span class="s3">, </span><span class="s1">alt</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">)</span>

        <span class="s1">alt </span><span class="s3">= </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">var</span><span class="s3">(</span><span class="s1">x</span><span class="s3">, </span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">1</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;var&quot;</span><span class="s3">, </span><span class="s1">alt</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">std</span><span class="s3">(</span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">4</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">std</span><span class="s3">(</span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">4</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">var</span><span class="s3">(</span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">4</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">var</span><span class="s3">(</span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">4</span><span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s6"># 1 - element series with ddof=1</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[[</span><span class="s5">0</span><span class="s3">]]</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">var</span><span class="s3">(</span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">result</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">std</span><span class="s3">(</span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">result</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_sem</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>
        <span class="s1">datetime_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span>
            <span class="s1">np</span><span class="s3">.</span><span class="s1">arange</span><span class="s3">(</span><span class="s5">10</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">),</span>
            <span class="s1">index</span><span class="s3">=</span><span class="s1">date_range</span><span class="s3">(</span><span class="s4">&quot;2020-01-01&quot;</span><span class="s3">, </span><span class="s1">periods</span><span class="s3">=</span><span class="s5">10</span><span class="s3">),</span>
            <span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;ts&quot;</span><span class="s3">,</span>
        <span class="s3">)</span>

        <span class="s1">alt </span><span class="s3">= </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">np</span><span class="s3">.</span><span class="s1">std</span><span class="s3">(</span><span class="s1">x</span><span class="s3">, </span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">1</span><span class="s3">) / </span><span class="s1">np</span><span class="s3">.</span><span class="s1">sqrt</span><span class="s3">(</span><span class="s1">len</span><span class="s3">(</span><span class="s1">x</span><span class="s3">))</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;sem&quot;</span><span class="s3">, </span><span class="s1">alt</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">)</span>

        <span class="s1">result </span><span class="s3">= </span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">sem</span><span class="s3">(</span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">4</span><span class="s3">)</span>
        <span class="s1">expected </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">std</span><span class="s3">(</span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">values</span><span class="s3">, </span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">4</span><span class="s3">) / </span><span class="s1">np</span><span class="s3">.</span><span class="s1">sqrt</span><span class="s3">(</span>
            <span class="s1">len</span><span class="s3">(</span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">values</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s1">tm</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">result</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

        <span class="s6"># 1 - element series with ddof=1</span>
        <span class="s1">s </span><span class="s3">= </span><span class="s1">datetime_series</span><span class="s3">.</span><span class="s1">iloc</span><span class="s3">[[</span><span class="s5">0</span><span class="s3">]]</span>
        <span class="s1">result </span><span class="s3">= </span><span class="s1">s</span><span class="s3">.</span><span class="s1">sem</span><span class="s3">(</span><span class="s1">ddof</span><span class="s3">=</span><span class="s5">1</span><span class="s3">)</span>
        <span class="s2">assert </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">isna</span><span class="s3">(</span><span class="s1">result</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_skew</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">sp_stats </span><span class="s3">= </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy.stats&quot;</span><span class="s3">)</span>

        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>

        <span class="s1">alt </span><span class="s3">= </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">sp_stats</span><span class="s3">.</span><span class="s1">skew</span><span class="s3">(</span><span class="s1">x</span><span class="s3">, </span><span class="s1">bias</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;skew&quot;</span><span class="s3">, </span><span class="s1">alt</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">)</span>

        <span class="s6"># test corner cases, skew() returns NaN unless there's at least 3</span>
        <span class="s6"># values</span>
        <span class="s1">min_N </span><span class="s3">= </span><span class="s5">3</span>
        <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s1">min_N </span><span class="s3">+ </span><span class="s5">1</span><span class="s3">):</span>
            <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s1">i</span><span class="s3">))</span>
            <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">((</span><span class="s1">i</span><span class="s3">, </span><span class="s1">i</span><span class="s3">)))</span>
            <span class="s2">if </span><span class="s1">i </span><span class="s3">&lt; </span><span class="s1">min_N</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">skew</span><span class="s3">())</span>
                <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">skew</span><span class="s3">()).</span><span class="s1">all</span><span class="s3">()</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s5">0 </span><span class="s3">== </span><span class="s1">s</span><span class="s3">.</span><span class="s1">skew</span><span class="s3">()</span>
                <span class="s2">assert </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">skew</span><span class="s3">(), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)  </span><span class="s6"># GH53482</span>
                <span class="s2">assert </span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">skew</span><span class="s3">() == </span><span class="s5">0</span><span class="s3">).</span><span class="s1">all</span><span class="s3">()</span>

    <span class="s2">def </span><span class="s1">test_kurt</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">sp_stats </span><span class="s3">= </span><span class="s1">pytest</span><span class="s3">.</span><span class="s1">importorskip</span><span class="s3">(</span><span class="s4">&quot;scipy.stats&quot;</span><span class="s3">)</span>

        <span class="s1">string_series </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s5">20</span><span class="s3">), </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">, </span><span class="s1">name</span><span class="s3">=</span><span class="s4">&quot;series&quot;</span><span class="s3">)</span>

        <span class="s1">alt </span><span class="s3">= </span><span class="s2">lambda </span><span class="s1">x</span><span class="s3">: </span><span class="s1">sp_stats</span><span class="s3">.</span><span class="s1">kurtosis</span><span class="s3">(</span><span class="s1">x</span><span class="s3">, </span><span class="s1">bias</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_check_stat_op</span><span class="s3">(</span><span class="s4">&quot;kurt&quot;</span><span class="s3">, </span><span class="s1">alt</span><span class="s3">, </span><span class="s1">string_series</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_kurt_corner</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s6"># test corner cases, kurt() returns NaN unless there's at least 4</span>
        <span class="s6"># values</span>
        <span class="s1">min_N </span><span class="s3">= </span><span class="s5">4</span>
        <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range</span><span class="s3">(</span><span class="s5">1</span><span class="s3">, </span><span class="s1">min_N </span><span class="s3">+ </span><span class="s5">1</span><span class="s3">):</span>
            <span class="s1">s </span><span class="s3">= </span><span class="s1">Series</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">(</span><span class="s1">i</span><span class="s3">))</span>
            <span class="s1">df </span><span class="s3">= </span><span class="s1">DataFrame</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">ones</span><span class="s3">((</span><span class="s1">i</span><span class="s3">, </span><span class="s1">i</span><span class="s3">)))</span>
            <span class="s2">if </span><span class="s1">i </span><span class="s3">&lt; </span><span class="s1">min_N</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">kurt</span><span class="s3">())</span>
                <span class="s2">assert </span><span class="s1">np</span><span class="s3">.</span><span class="s1">isnan</span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">kurt</span><span class="s3">()).</span><span class="s1">all</span><span class="s3">()</span>
            <span class="s2">else</span><span class="s3">:</span>
                <span class="s2">assert </span><span class="s5">0 </span><span class="s3">== </span><span class="s1">s</span><span class="s3">.</span><span class="s1">kurt</span><span class="s3">()</span>
                <span class="s2">assert </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">s</span><span class="s3">.</span><span class="s1">kurt</span><span class="s3">(), </span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)  </span><span class="s6"># GH53482</span>
                <span class="s2">assert </span><span class="s3">(</span><span class="s1">df</span><span class="s3">.</span><span class="s1">kurt</span><span class="s3">() == </span><span class="s5">0</span><span class="s3">).</span><span class="s1">all</span><span class="s3">()</span>
</pre>
</body>
</html>